'use strict'; 
"use strict";
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['reportembed.bundle.min.js'] || {};
marker.startEval = Date.now();
var __extends=this&&this.__extends||(function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}})(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))(function(r,a){function n(e){try{l(o.next(e))}catch(e){a(e)}}function s(e){try{l(o.throw(e))}catch(e){a(e)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(n,s)}l((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return o([e,t])}}function o(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,a=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(n=l.trys,!(n=n.length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){l.label=i[1];break}if(6===i[0]&&l.label<n[1]){l.label=n[1],n=i;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(i);break}n[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,a,n,s,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},powerbi;!(function(e){var t;!(function(t){var i;!(function(t){t.contentPackDirtyShowNotification="contentPackDirty",t.reportDeletedEventName="reportDeleted",t.onDatasetAddedEventName="onDatasetAdded",t.deleteModelFailedEventName="deleteModelFailed",t.deleteModelStartedEventName="deleteModelStarted",t.onDashboardShallowEditEventName="onDashboardShallowEdit",t.mergeDashboardContainerModelsReportsAndPackagesEventName="mergeDashboardContainerModelsReportsAndPackages",t.updateDashboardContainerEventName="updateDashboardContainer",t.addOrUpdateDashboardEventName="addOrUpdateDashboard",t.samplesContentProviderId=-1,t.initialDashboardContainerLoadingState="#loading#",t.initialDashboardContainerErrorState="#error#",t.initialDashboardContainerReadyEventName="initialDashboardContainerReady",t.CannotDeleteModelPublishedToOrganizationalAppHeader="CannotDeleteModelPublishedToOrganizationalApp",t.seenDashboardsStorageKey="seenSharedDashboards",t.ScopedInstanceProviderName="dataServices",t.dashboardElementName=".dashboard";var i;!(function(e){e.reloadExcelWorkbookEventName="reloadExcelWorkbook",e.pinClickedEventName="pinClicked",e.editInExcelOnlineClickedEventName="editInExcelOnlineClicked",e.editInExcelClickedEventName="editInExcelClicked",e.calculateWorkbookClickedEventName="calculateWorkbookClicked",e.openWorkbookContextMenuEventName="openWorkbookContextMenu",e.viewWorkbookEventName="viewWorkbook",e.renameWorkbookEventName="renameWorkbook",e.editWorkbookEventName="editWorkbook",e.scheduleRefreshWorkbookEventName="scheduleRefreshWorkbook",e.refreshNowWorkbookEventName="refreshNowWorkbook",e.removeWorkbookEventName="removeWorkbook",e.excelWebAppScriptsLoaded="excelWebAppScriptsLoaded",e.defaultKeepOriginalContentSize=!1})(i=t.workbook||(t.workbook={})),t.SingleValueRealTimeWindow=250,t.MultipleValueRealTimeWindow=6e4,t.RealTimeIntervals=[1,5,10,15,20,25,30,45,60],t.RealTimeDataSourceName="_RealTimeSchema_",t.modelPlaceholderImageUrl="/"+e.build+"/images/modelPlaceholder.png",t.packagePublishedSuccessfullyEventName="packagePublishedSuccessfully";var o;!(function(e){e.TileConfigVersion="1.5",e.NoVisualType="No visual type"})(o=t.upgrader||(t.upgrader={}))})(i=t.constants||(t.constants={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(i,o,a,n,s,l){var c={visualType:i,source:o,lineNumber:a,columnNumber:n,stack:s,message:l};return{name:t.TileDataUpdateExceptionEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:r(),formatted:function(){return e.extendFormatted({visualType:c.visualType,source:c.source,lineNumber:c.lineNumber,columnNumber:c.columnNumber,stack:c.stack,message:c.message},null)},info:c,loggers:t.TileDataUpdateExceptionLoggers}}function o(i,o){var a={tileType:i,message:o};return{name:t.DashboardTileErrorEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:r(),formatted:function(){return e.extendFormatted({tileType:a.tileType,message:a.message},null)},info:a,loggers:t.DashboardTileErrorLoggers}}var r,a=jsCommon.Utility,n=e.telemetry.EventFactories;r=a?a.generateGuid:Function.prototype,t.TileDataUpdateExceptionEventName="PBI.TileDataUpdateException",t.TileDataUpdateException=i,n[t.TileDataUpdateExceptionEventName]=function(i){return e.telemetryEventFactory(t.TileDataUpdateExceptionEventName,i,t.TileDataUpdateExceptionLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},t.DashboardTileErrorEventName="PBI.Dashboard.TileError",t.DashboardTileError=o,n[t.DashboardTileErrorEventName]=function(i){return e.telemetryEventFactory(t.DashboardTileErrorEventName,i,t.DashboardTileErrorLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)}})(t=e.telemetry||(e.telemetry={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){e[e.composite=0]="composite",e[e.iframe=1]="iframe",e[e.image=2]="image",e[e.model=3]="model",e[e.ssrs=4]="ssrs",e[e.workbook=5]="workbook",e[e.report=6]="report",e[e.realTime=8]="realTime"})(t=e.TileType||(e.TileType={}));var i;!(function(e){e[e.PowerBIServiceException=0]="PowerBIServiceException",e[e.DSRException=1]="DSRException"})(i=e.QueryResultErrorType||(e.QueryResultErrorType={}))})(t=e.contracts||(e.contracts={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){function t(){var e;return e={},e.Light={name:"Light",foreground:"#000000",background:"#EAEAEA",dataColors:["#01B8AA","#374649","#FD625E","#F2C80F","#5F6B6D","#8AD4EB","#FE9666","#A66999"],tiles:{background:"#FFFFFF",color:"#000000"},visualStyles:{"*":{"*":{"*":[{color:{solid:{color:"#000000"}}}]}}}},e.Dark={name:"Dark",foreground:"#FFFFFF",background:"#484644",dataColors:["#51CFBE","#F55965","#FE9666","#92BEFF","#B577DF","#29B9EF","#3599B8","#DFBFBF"],tableAccent:"#E2A84E",tiles:{background:"#2B2B30",color:"#FFFFFF"},visualStyles:{"*":{"*":{"*":[{color:{solid:{color:"#FFFFFF"}}},{labelColor:{solid:{color:"#CECECE"}}}]}}}},e["Color-blind friendly"]={name:"Color-blind friendly",background:"#EAEAEA",foreground:"#000000",dataColors:["#074650","#009292","#FE6DB6","#FEB5DA","#480091","#B66DFF","#B5DAFE","#6DB6FF","#914800","#23FD23"],tiles:{background:"#FFFFFF",color:"#000000"},visualStyles:{"*":{"*":{"*":[{color:{solid:{color:"#000000"}}}]}}}},e}e.BuiltInThemeNamesResourceValues={Light:"Light",Dark:"Dark","Color-blind friendly":"Color_Blind_Friendly",Custom:"Custom"},e.createBuiltInThemesFactory=t})(t=e.contracts||(e.contracts={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){e[e.Dashboard=0]="Dashboard",e[e.Report=1]="Report",e[e.Model=2]="Model",e[e.Workbook=3]="Workbook"})(t=e.ContentPackItems||(e.ContentPackItems={}))})(t=e.models||(e.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e.AppModelIconColors=["#000","#FFF"],e.AppModelIconBackgroundColors=[{color:"#374649",fontColor:"#FFF"},{color:"#01B8AA",fontColor:"#000"},{color:"#FD625E",fontColor:"#FFF"},{color:"#F2C80F",fontColor:"#000"},{color:"#5F6B6D",fontColor:"#000"},{color:"#8AD4EB",fontColor:"#000"},{color:"#FE9666",fontColor:"#000"},{color:"#A66999",fontColor:"#000"},{color:"#3599B8",fontColor:"#000"},{color:"#DFBFBF",fontColor:"#000"}],e.ServiceAppFallbackColors={color:"#374649",fontColor:"#FFF"},e.AppModelIcons=["financial","emi","group","realtime","image","pc1","paintbrush","world","streaming-data","user","barchart","gauge","globe","piedouble","areachart","comment","visualinteraction","code","shapes","piechart","stackedcolumn","scatter","database","home","insight"]})(t=e.models||(e.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var o=e.common.contracts.ContentTileType,r=jsCommon.Lazy;i.DashboardAsyncLayoutDelayMs=100;var a=(function(){function e(e){this.contract=e,this.isEnabled=!0,this.isUsedByContentPack=!1,this.isLoaded=e&&null!=e.tiles,this.hitCount=0,this.lazyTiles=null,this.uniqueId=o.Dashboard+"_"+this.contract.id}return e.prototype.getPermissions=function(){var e;return this.getPermissionsCallback&&null!=(e=this.getPermissionsCallback())?e:this.contract&&this.contract.permissions},e.prototype.increaseHitCount=function(){this.hitCount++},Object.defineProperty(e.prototype,"tiles",{get:function(){return this.lazyTiles||(this.lazyTiles=new r(function(){return[]})),this.lazyTiles.getValue()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.contract.id},set:function(e){this.contract.id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"folderId",{get:function(){return this.contract.folderId},set:function(e){this.contract.folderId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"objectId",{get:function(){return this.contract.objectId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canEdit",{get:function(){return t.DashboardUtils.isWriteable(this.contract)&&!(this.gridLayoutService&&this.gridLayoutService.strategy.isLayoutLocked)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentTileType",{get:function(){return o.Dashboard},enumerable:!0,configurable:!0}),e.prototype.isFilled=function(){return this.contract.tiles&&this.tiles.length===this.contract.tiles.length},e.prototype.calculateLayout=function(){this.layoutRequired=!1;var e=this.tiles;if(!_.isEmpty(e))for(var t=0,i=e;t<i.length;t++){var o=i[t];o.calculateLayout()}},e.prototype.applyLayout=function(){var e=this.tiles;if(!_.isEmpty(e))for(var t=0,i=e;t<i.length;t++){var o=i[t];o.applyLayout()}},e.prototype.runLayoutIfRequired=function(){this.layoutRequired&&(this.calculateLayout(),this.applyLayout())},e.prototype.scheduleDelayedLayout=function(e){var t=this;void 0===e&&(e=!1),this.layoutRequired||(this.layoutRequired=!0,e||setTimeout((function(){t.layoutRequired&&(t.calculateLayout(),t.applyLayout())}),i.DashboardAsyncLayoutDelayMs))},e.prototype.findTile=function(e){return _.find(this.tiles,(function(t){return t.id===e}))},e.prototype.findTileByObjectIdOrOriginalObjectId=function(e,t){if(e||t)return _.find(this.tiles,(function(i){return!_.isEmpty(e)&&i.contract.objectId===e||!_.isEmpty(t)&&i.contract.originalTileObjectId===t}))},e.prototype.getTileIndex=function(e){return _.findIndex(this.tiles,(function(t){return t.id===e}))},e.prototype.getTileContractIndex=function(e){return _.findIndex(this.contract.tiles,(function(t){return t.id===e}))},e.prototype.getUniquePackageId=function(){var e=this.contract;return e.originalPackageId?e.originalPackageId:e.packageIds&&1===e.packageIds.length?e.packageIds[0]:void 0},e.prototype.hasModel=function(e){return _.some(this.tiles,(function(t){return t.contract.modelId===e}))},e.prototype.hasOwnerInfo=function(){return!_.isEmpty(this.ownerFullname)||!_.isEmpty(this.ownerMail)},e})();i.Dashboard=a})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.contract=e}return e.prototype.getPermissions=function(){var e;return this.getPermissionsCallback&&(e=this.getPermissionsCallback()),e?e:this.contract&&this.contract.permissions},e.prototype.hasUpdate=function(){return this.version&&this.latestVersion&&this.version!==this.latestVersion},e})();e.Package=t})(t=e.models||(e.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(t){var i=window,o=(function(){function t(e,t){this.datasetInfo=e,this.definition=t}return Object.defineProperty(t.prototype,"databaseName",{get:function(){return this.datasetInfo.databaseName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"primaryKey",{get:function(){return this.datasetInfo.resourceKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"secondaryKey",{get:function(){return this.datasetInfo.resourceKeySecondary},enumerable:!0,configurable:!0}),t.prototype.getPushUrl=function(){var e=window.tenantId,t=window.apiUri;"https://wabi-staging-us-east-redirect.analysis.windows.net"===i.clusterUri&&(t="https://powerbistagingapi.analysis.windows.net");var o="/beta/"+e+"/datasets/"+this.databaseName+"/rows",r=jsCommon.Utility.urlCombine(t,o),a={};return a.key=this.primaryKey,jsCommon.QueryStringUtil.addOrUpdateQueryStringToUrl(r,a)},t.createRealTimeDatasetDefinition=function(i,o,r){var a=r.schema(e.constants.RealTimeDataSourceName).entities,n=_.head(a),s=[];return _.map(n.properties,(function(e){s.push({name:e.displayName,dataType:t.convertToRealTimeDataType(e.type)})})),{name:i,columns:s,mode:o,tableName:n.name}},t.convertToRealTimeDataType=function(e){switch(e.primitiveType){case 3:case 4:return 1;case 7:return 2;case 1:return 0;case 5:return 3}},t})();t.RealTimeModel=o})(t=e.models||(e.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=e.common.models.DefaultGridLayoutStrategy,o=e.common.directives.InViewport,r=(function(t){function i(e,i){var o=t.call(this)||this;return o.displayWidth=e,o.displayHeight=i,o.minNumOfColumns=2,o.isLayoutLocked=!0,o}return __extends(i,t),i.prototype.calculateDisplayPositions=function(e){t.prototype.calculateDisplayPositions.call(this,e),this.scaleDashboard(e)},i.prototype.scaleDashboard=function(t){var r=this.getDashboardSize(t),a=i.calculateDashboardScaleFactor(r.width,this.displayWidth);if(!(a<=0)){var n={transform:"scale("+a+")",width:r.width+"px",height:this.displayHeight/a+"px",left:0};$(e.dataServices.constants.dashboardElementName).css(n);o.getRefreshAllHandler()()}},i.prototype.getDashboardSize=function(t){var i=this.getMaxColumnInLayout(t),o=this.getMaxRowInLayout(t);i<this.minNumOfColumns&&(i=this.minNumOfColumns);var r=e.common.GridLayoutConstants.defaultGridItemSpacing;return{width:i*this.gridWidth+r,height:o*this.gridHeight+r}},i.calculateDashboardScaleFactor=function(e,t){return t/e},i.prototype.getMaxRowInLayout=function(e){return _.maxBy(_.map(e,(function(e){return e.displayRow-1+e.displaySize.rowSpan})))},i.prototype.getMaxColumnInLayout=function(e){return _.maxBy(_.map(e,(function(e){return e.displayCol-1+e.displaySize.colSpan})))},i})(i);t.PhoneLandscapeTileLayoutStrategy=r})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i,o=e.dataServices.contracts.TileType;!(function(e){e.tileSpacing=12,e.smallTileRowSpan=4,e.defaultTileRowSpan=6,e.mediumTileRowSpan=7,e.largeTileRowSpan=9,e.resizeBuffer=10,e.aspectRatio=.1111})(i=t.PhoneTileLayoutConstants||(t.PhoneTileLayoutConstants={}));var r=(function(){function t(t){this.isLayoutLocked=!0,this.willOverrideDisplayPosition=!0,this.gridItemSpacing=i.tileSpacing,this.tileTypeRowSpanMap={},this.visualTypeRowSpanMap={},this.gridWidth=t-this.gridItemSpacing,this.gridHeight=Math.round(this.gridWidth*i.aspectRatio),this.gridMinWidthOnResize=this.gridWidth-i.resizeBuffer,this.gridMinHeightOnResize=this.gridHeight-i.resizeBuffer,this.gridMaxWidthOnResize=this.gridWidth*e.common.models.gridLayoutConstants.gridMaxColSpan,this.gridMaxHeightOnResize=this.gridHeight*e.common.models.gridLayoutConstants.gridMaxColSpan,this.tileTypeRowSpanMap[o.report]=i.mediumTileRowSpan,this.visualTypeRowSpanMap[e.visuals.plugins.card.name]=i.smallTileRowSpan,this.visualTypeRowSpanMap[e.visuals.plugins.animatedNumber.name]=i.smallTileRowSpan,this.visualTypeRowSpanMap[e.visuals.plugins.textbox.name]=i.smallTileRowSpan}return t.prototype.calculateDisplayPositions=function(t){for(var i=e.dataServices.DashboardUtils.orderItems(_.map(t,(function(e){return{getActiveLayoutPosition:function(){return e.getLayoutPosition()},getItem:function(){return e}}}))),o=1,r=0,a=i;r<a.length;r++){var n=a[r];n.displayCol=1,n.displayRow=o,this.calculateDisplaySize(n),o+=n.displaySize.rowSpan}this.removeScale()},t.prototype.calculateDisplaySize=function(e){var t=this.getRowSpan(e);e.displaySize={colSpan:1,rowSpan:t}},t.prototype.getRowSpan=function(e){var t=e.gridItem,o=this.tileTypeRowSpanMap[t.type];if(!o&&t.composite){var r=t.composite;null!==r&&(o=this.visualTypeRowSpanMap[r.visual.type])}return o||i.defaultTileRowSpan},t.prototype.removeScale=function(){$(e.dataServices.constants.dashboardElementName).removeAttr("style")},t.prototype.isDynamic=function(){return!1},t})();t.PhonePortraitTileLayoutStrategy=r})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=e.common.GridLayoutConstants,o=(function(e){function t(t,i){var o=e.call(this,t,i)||this;return o.maxColumnsToDisaply=7,o.minColumnsToDisplay=3,o.portionOfNextColumn=.2,o}return __extends(t,e),t.prototype.getDashboardSize=function(e){var t=this.getMaxColumnInLayout(e),o=this.getMaxRowInLayout(e);t>this.maxColumnsToDisaply?t=this.maxColumnsToDisaply+this.portionOfNextColumn:t<this.minColumnsToDisplay&&(t=this.minColumnsToDisplay);var r=i.defaultGridItemSpacing;return{width:t*this.gridWidth+r,height:o*this.gridHeight+r}},t})(t.PhoneLandscapeTileLayoutStrategy);t.TabletTileLayoutStrategy=o})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(o){function r(e,t,i,o,r,a,n,s,l,c,u,d,p,m){return new g(e,t,i,o,r,a,n,s,l,c,u,d,p,m)}function a(e,t){return e.webUri&&e.etagHash?e.webUri+"/_layouts/WopiFrame.aspx?sourcedoc={"+e.etagHash+"}&action="+t:""}var n=jsCommon.ArrayExtensions,s=e.common.contracts,l=s.ContentProviderCategory,c=s.ContentTileType,u=t.models,d=jsCommon.JsonExtensions,p=jsCommon.Lazy,m=e.common.helpers.ModelConverterHelper,f=e.common.models.Report,h=t.contracts.TileType;o.createDataServiceModelConverter=r,o.getWorkbookActionUrl=a;var g=(function(){function r(e,t,i,r,a,n,s,l,c,u,d,p,m,f){this.geolocationService=e,this.telemetryService=t,this.visualPlugins=i,this.visualPluginOps=r,this.featureSwitchService=a,this.geocoder=n,this.promiseFactory=s,this.moduleLoader=l,this.permissionService=c,this.tileConfigUpgraderService=u,this.localizationService=d,this.explorationSerializer=p,this.themeService=m,this.authenticationService=f,this.tileModelConverter=o.createTileModelConverter(this.geolocationService,this.telemetryService,this.visualPlugins,this.visualPluginOps,this.featureSwitchService,this.geocoder,this.promiseFactory,this.moduleLoader,this.tileConfigUpgraderService,this.explorationSerializer,this.themeService,this.authenticationService)}return r.prototype.setModelMerger=function(e){this.modelMerger=e},r.prototype.convertCompositeTile=function(e){return this.tileModelConverter.convertCompositeTile(e)},r.prototype.convertTileData=function(e){return this.tileModelConverter.convertTileData(e)},r.prototype.convertDashboard=function(e,t,i,o){var r=this,a=this.convertDashboardShallow(e);return e.tiles&&(a.lazyTiles=new p(function(){return _.map(e.tiles,(function(e){return r.convertTile(e,t,i,o)}))})),a},r.prototype.convertDashboardShallow=function(e){var t=this,i=new o.Dashboard(e);return i.getPermissionsCallback=function(){return t.permissionService.getDashboardEffectivePermissions(e)},i.dataClassificationId=e.dataClassificationId,i.folderId=e.folderId,this.modelMerger.mergeDashboardShallow(i,e),i},r.prototype.convertIframeTile=function(e){if(!e||e.type!==h.iframe)return null;var t=new o.IframeTileModel(e),i=this.convertTileConfig(e);return this.convertTileLayoutConfig(e),i&&i.iframe&&(t.srcUrl=i.iframe.srcUrl,t.embedCode=i.iframe.embedCode),t.isLoading=o.TileFactory.isTileLoading(e),t},r.prototype.convertImageTile=function(e){if(!e||e.type!==h.image)return null;var i=new o.ImageTileModel(e);return this.convertTileLayoutConfig(e),i.displayText=e.displayText,i.subDisplayText=e.subDisplayText,"number"!=typeof i.contract.reportId||e.config?(i.isStatic=!1,i.imageUrl=this.getImageUrl(e)):(i.isStatic=!0,i.imageUrl=t.constants.modelPlaceholderImageUrl),i.isLoading=o.TileFactory.isTileLoading(e),i},r.prototype.convertContentPackBase=function(e){if(e){var i,o,r,a,n=d.tryParseJSON(e.providerConfig),s=n,c=s&&s.appSettings&&s.appSettings.allowCopyContent,u=e.category;u===l.Organizational||u===l.OrganizationalApp||u===l.OrganizationalTemplate||u===l.OrganizationalTemplateApp?a=n:r=n,n&&(r?(i=r.shortDescription||r.description,o=r.author):a&&(i=a.description,o=a.author));return{providerContract:e,providerConfig:r,organizationalProviderConfig:a,providerId:e.providerId,displayText:e.displayText,iconUrl:e.iconUrl||"",description:i,publishTime:t.DateUtils.convertDate(e.publishTime),providerKey:e.providerKey,author:o,category:e.category,allowCopyContent:!!c,dashboardIds:e.dashboardIds||[],reportIds:e.reportIds||[],modelIds:e.modelIds||[],workbookIds:e.workbookIds||[]}}},r.prototype.convertAppModelBase=function(e){var o=d.tryParseJSON(e.providerConfig);if(o&&o.appSettings){var r=o.appSettings;return{icon:r.iconName,iconColor:r.iconColor,iconBackgroundColor:r.iconBackgroundColor,headerBackgroundColor:r.headerBackgroundColor||t.AppUtils.getAppHeaderBackgroundColor(r.iconBackgroundColor),defaultContent:r.defaultAppArtifact,defaultContentOption:r.defaultAppArtifact?1:0,appPush:!!r.appPush,canExploreDataset:null==r.exploreDataset||r.exploreDataset}}if(e.category===l.ServiceApp||e.category===l.Services)return{iconColor:i.ServiceAppFallbackColors.fontColor,iconBackgroundColor:i.ServiceAppFallbackColors.color,headerBackgroundColor:t.AppUtils.getAppHeaderBackgroundColor(i.ServiceAppFallbackColors.color),defaultContentOption:0}},r.prototype.convertInstalledAppModel=function(e,i){var o=this.convertContentPackBase(e);if(o){var r=this.convertAppModelBase(e),a=d.tryParseJSON(e.providerConfig),n=__assign({objectId:e.providerKey,contentTileType:c.OrgApp,packageId:i.id,uniqueId:i.id,displayName:e.displayText,publishTime:t.DateUtils.convertDate(e.publishTime),getPermissions:function(){return 17},dashboards:[],models:[],reports:[],workbooks:[],displayDate:t.AppUtils.convertDisplayDate(a&&a.creationTime||e.publishTime,this.localizationService),isFavorite:!1,isFavoriteDisabled:!1,favoriteInfo:void 0,groupObjectId:e.groupObjectId},o,r);return t.AppUtils.isOrgApp(e)||(n.displayDate=t.AppUtils.convertDisplayDate(i.lastRefreshTime,this.localizationService)),n}},r.prototype.convertModel=function(e){var t=this.convertModelShallow(e);return this.updateModelProperties(t,e),t},r.prototype.convertModelTile=function(e){if(!e||e.type!==h.model)return null;var t=new o.ModelTileModel(e);return this.convertTileLayoutConfig(e),t.displayText=e.displayText,t.isLoading=o.TileFactory.isTileLoading(e),t.subDisplayText=e.subDisplayText,t},r.prototype.convertModelShallow=function(t){return new e.common.models.Model(t)},r.prototype.convertCdsaModel=function(e){var t=this.convertCdsaModelShallow(e);return this.modelMerger.mergeCdsaModel(t,e),t},r.prototype.convertCdsaModelShallow=function(t){return new e.common.models.CdsaModel(t)},r.prototype.convertPackage=function(e){var t=this,i=this.convertPackageShallow(e);return e&&(i.contract=e,i.id=e.id,i.contentProviderId=e.contentProviderId,i.lastRefreshTime=e.lastRefreshTime,i.latestVersion=e.latestVersion,i.version=e.version,i.name=e.name,i.publishOrRefreshStatus=e.publishOrRefreshStatus||0,i.packageType=e.packageType,i.originalPackageId=e.originalPackageId,i.getPermissionsCallback=function(){return t.permissionService.getPackageEffectivePermissions(e)}),i},r.prototype.convertPackageShallow=function(e){return new u.Package(e)},r.prototype.convertRealTimeTile=function(e){if(!e||e.type!==h.realTime)return null;var i=this.convertTileConfig(e);this.convertTileLayoutConfig(e);var r=new o.RealTimeTileModel(e,this.visualPlugins,this.visualPluginOps,this.featureSwitchService,this.geolocationService,this.geocoder,this.promiseFactory,this.moduleLoader,this.telemetryService,this.themeService,this.authenticationService);i&&i.realTimeVisual&&(r.config=i.realTimeVisual),r.displayText=e.displayText,r.subDisplayText=e.subDisplayText;var a=t.ContractUtils.getMasterLayoutPosition(e);return r.size={rowSpan:a.height,colSpan:a.width},r},r.prototype.convertReport=function(e){var t=this,i=this.convertReportShallow(e);return e&&(i.id=e.id,i.modelId=e.modelId,i.reportUrl=e.reportUrl,i.packagePublishStatus=e.packagePublishStatus||0,i.name=e.name,i.displayName=e.displayName,i.description=e.description,i.fileName=e.fileName,i.packageId=e.packageId,i.packageVersion=e.packageVersion,i.contentProviderId=e.contentProviderId,i.objectId=e.objectId,i.isNew=e.isNew,i.isHidden=e.isHidden,i.sharedTime=e.sharedTime||"/Date(0)/",e.ownerInfo&&this.modelMerger.mergeArtifactOwnerInfo(i,e.ownerInfo),i.getPermissionsCallback=function(){return t.permissionService.getReportEffectivePermissions(e)},this.fillReport(i,e)),i},r.prototype.convertReportShallow=function(e){return new f(e)},r.prototype.convertReportTile=function(e){return e&&e.type===h.report?(this.convertTileLayoutConfig(e),new o.ReportTileModel(e)):null},r.prototype.convertSpecificTileShallow=function(e,i){switch(this.convertTileLayoutConfig(e),e.type){case h.composite:var r=this.convertTileConfig(e);if(r&&r.visualContainer&&(i.composite=new o.SingleVisualCompositeTileModel(e,this.visualPlugins,this.visualPluginOps,this.featureSwitchService,this.geolocationService,this.geocoder,this.promiseFactory,this.moduleLoader,this.telemetryService,this.themeService,this.authenticationService)),i.composite){var a=t.ContractUtils.getMasterLayoutPosition(e);i.composite.size={rowSpan:a.height,colSpan:a.width},i.composite.isLoading=o.TileFactory.isTileLoading(e)}break;case h.iframe:i.iframe=new o.IframeTileModel(e),i.iframe.isLoading=o.TileFactory.isTileLoading(e);break;case h.image:i.image=new o.ImageTileModel(e),i.image.isLoading=o.TileFactory.isTileLoading(e);break;case h.model:i.model=new o.ModelTileModel(e),i.model.isLoading=o.TileFactory.isTileLoading(e);break;case h.ssrs:i.model=new o.SsrsTileModel(e),i.model.isLoading=o.TileFactory.isTileLoading(e);break;case h.workbook:i.workbook=new o.WorkbookTileModel(e,i),i.workbook.isLoading=o.TileFactory.isTileLoading(e);break;case h.report:i.model=new o.ReportTileModel(e),i.model.isLoading=o.TileFactory.isTileLoading(e);break;case h.realTime:this.convertTileConfig(e),i.realTime=new o.RealTimeTileModel(e,this.visualPlugins,this.visualPluginOps,this.featureSwitchService,this.geolocationService,this.geocoder,this.promiseFactory,this.moduleLoader,this.telemetryService,this.themeService,this.authenticationService)}},r.prototype.convertSsrsTile=function(e){if(!e||e.type!==h.ssrs)return null;this.convertTileLayoutConfig(e);var t=new o.SsrsTileModel(e);return e.config&&(t.imageUrl=this.getSsrsImageUrl(e)),t.isLoading=o.TileFactory.isTileLoading(e),t},r.prototype.convertTile=function(e,t,i,o){this.convertTileLayoutConfig(e);var r=this.convertTileShallow(e,t,i);if(this.modelMerger.mergeTile(r,e,t,i,o),null!=e.reportId){var a=this.getTileReport(e.reportId,i);a&&(r.report=r.report||new f(a),this.fillReport(r.report,a))}return r},r.prototype.convertTileLayoutConfig=function(e){return this.tileModelConverter.convertTileLayoutConfig(e)},r.prototype.convertTileAction=function(e){var t=e.$action;if(!t){var i;if(e.action&&0===e.action.indexOf("{"))try{i=JSON.parse(e.action)}catch(e){}else i={action:e.action};t=e.$action=i}return t},r.prototype.convertTileConfig=function(e){return this.tileModelConverter.convertTileConfig(e)},r.prototype.convertTileShallow=function(e,t,i){this.convertTileLayoutConfig(e);var r=new o.Tile(e,this.localizationService);return this.modelMerger.mergeTileShallow(r,e,t,i),r},r.prototype.convertWorkbook=function(e){var t=this,i=this.convertWorkbookShallow(e);return e&&(i.id=e.id,i.modelId=e.modelId,i.viewUrl=this.getWorkbookViewUrl(e),i.editUrl=this.getWorkbookEditUrl(e),i.embedUrl=this.getWorkbookEmbedView(e),i.name=e.name,i.displayName=e.displayName,i.description=e.description,i.fileName=e.fileName,i.packageId=e.packageId,i.isNew=e.isNew,i.getPermissionsCallback=function(){return t.permissionService.getWorkbookEffectivePermissions(e)}),i},r.prototype.convertWorkbookShallow=function(e){return new o.Workbook(e)},r.prototype.convertWorkbookTile=function(e,i,r){if(!e||e.type!==h.workbook)return null;this.convertTileLayoutConfig(e);var a=new o.WorkbookTileModel(e,r);a.displayText=e.displayText,a.subDisplayText=e.subDisplayText,a.isLoading=o.TileFactory.isTileLoading(e),a.image=e.tileDataBinaryBase64Encoded,e.$config.workbookTile&&e.$config.workbookTile.keepOriginalContentSize?a.keepOriginalContentSize=e.$config.workbookTile.keepOriginalContentSize:a.keepOriginalContentSize=t.constants.workbook.defaultKeepOriginalContentSize;var n=e.$config.workbookTile;return i&&(n&&(a.embedUrl=i.embedUrl+"&item="+n.item),i.contract&&(a.webUri=i.contract.webUri)),a},r.prototype.fillDashboardChildren=function(e,t,i,o){var r=this,a=e.contract;e.displayName!==a.displayName&&(e.displayName=a.displayName),a.tiles&&(e.lazyTiles=new p(function(){return a.tiles.map((function(e){return r.convertTile(e,t,i,o)}))}))},r.prototype.fillModel=function(e,t){e.id=t.id,e.contract=t},r.prototype.fillReport=function(e,t){e.id=t.id,e.contract=t,e.reportUrl=t.reportUrl},r.prototype.getImageUrl=function(e){var t=this.convertTileConfig(e);if(t&&t.imageTile)return t.imageTile.imageUrl},r.prototype.getSsrsImageUrl=function(e){var t=this.convertTileConfig(e);if(t&&t.ssrsTile)return t.ssrsTile.imageUrl},r.prototype.getTileModel=function(e,t){var i;if(t){var o=n.indexOf(t,(function(t){return t&&t.id===e}));o!==-1&&(i=t[o])}return i},r.prototype.getTileReport=function(e,t){var i;if(t){var o=n.indexOf(t,(function(t){return t&&t.id===e}));o!==-1&&(i=t[o])}return i},r.prototype.getTileWorkbook=function(e,t,i){var o;if(i){var r=n.indexOf(i,(function(i){return i.id===e&&i.packageId===t}));r!==-1&&(o=i[r])}return o},r.prototype.resolveTilePackage=function(e,t){if(e.packageId){var i=n.indexOf(t,(function(t){return t.id===e.packageId}));i!==-1&&(e.tilePackage=t[i])}},r.prototype.getWorkbookViewUrl=function(e){return a(e,"view")},r.prototype.getWorkbookEditUrl=function(e){return a(e,"edit")},r.prototype.getWorkbookEmbedView=function(e){return a(e,"embedview")},r.prototype.updateModelProperties=function(e,t){var i=this;t&&(e.id=t.id,e.isNew=t.isNew,e.cloudRlsEnabled=t.cloudRlsEnabled,e.name=t.name,e.displayName=t.displayName,e.description=t.description,e.fileName=t.fileName,e.packageId=t.packageId,e.packageVersion=t.packageVersion,e.contentProviderId=t.contentProviderId,e.isHidden=t.isHidden||!1,e.isRefreshInProgress=t.currentRefreshStartingTime&&m.convertRefreshTimeToJsDateTime(t.currentRefreshStartingTime).getTime()+18e5>Date.now(),e.dbName=t.dbName,e.vsName=t.vsName,e.realTimeMode=t.realTimeMode,e.getPermissionsCallback=function(){
return i.permissionService.getModelEffectivePermissions(t)},this.fillModel(e,t))},r})()})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){function o(e,t){return new l(e,t)}var r=jsCommon.ArrayExtensions,a=jsCommon.Lazy,n=e.common.helpers.ModelConverterHelper,s=e.common.helpers.UserInfoHelper;i.createDataServiceModelMerger=o;var l=(function(){function e(e,t){this.modelConverter=e,this.permissionService=t}return e.prototype.mergeCdsaModel=function(e,t){e.contract=t,e.name=t.name,e.displayName=t.displayName,e.description=t.description,e.id=t.id,e.currentRefreshStatus=t.lastRefreshStatus},e.prototype.mergeDashboard=function(e,t,i,o,r){var n=this,s=this.modelConverter.convertDashboard(t,i,o,r);e.contract=t,e.displayName=s.displayName,e.getPermissionsCallback=function(){return n.permissionService.getDashboardEffectivePermissions(t)},e.contract.modelIds=t.modelIds,e.contract.reportIds=t.reportIds,e.contract.packageIds=t.packageIds,e.contract.workbookIds=t.workbookIds,e.qnaEnabled=t.qnaEnabled,e.gravityEnabled=t.gravityEnabled,e.annotationsEnabled=t.annotationsEnabled,e.isSharedFromSecurityGroup=t.isSharedFromSecurityGroup,e.isHidden=t.isHidden;var l=e.tiles;e.lazyTiles=new a(function(){var e=[];if(_.isEmpty(s.tiles))return e;for(var t=_.keyBy(l,(function(e){return e&&e.id})),a=0,c=s.tiles;a<c.length;a++){var u=c[a],d=t[u.id];d?(e.push(d),n.mergeTile(d,u.contract,i,o,r)):e.push(u)}return e})},e.prototype.mergeArtifactOwnerInfo=function(e,t){e.ownerFullname=s.getFullName(t.givenName,t.familyName),e.ownerMail=t.emailAddress,t.userObjectId&&(e.ownerUserObjectId=t.userObjectId),t.groupObjectId&&(e.ownerGroupObjectId=t.groupObjectId),e.contract.ownerInfo||(e.contract.ownerInfo=t)},e.prototype.mergeDashboardShallow=function(e,t){var i=this;if(t.displayName&&(e.displayName=t.displayName),void 0!==t.permissions&&(e.getPermissionsCallback=function(){return i.permissionService.getDashboardEffectivePermissions(t)},e.contract.permissions=t.permissions),t.modelIds&&(e.contract.modelIds=t.modelIds),t.reportIds&&(e.contract.reportIds=t.reportIds),t.workbookIds&&(e.contract.workbookIds=t.workbookIds),t.packageIds&&(e.contract.packageIds=t.packageIds),void 0!==t.isStaging&&(e.contract.isStaging=t.isStaging),void 0!==t.qnaEnabled&&(e.qnaEnabled=t.qnaEnabled),void 0!==t.gravityEnabled&&(e.gravityEnabled=t.gravityEnabled),void 0!==t.annotationsEnabled&&(e.annotationsEnabled=t.annotationsEnabled),void 0!==t.isSharedFromSecurityGroup&&(e.isSharedFromSecurityGroup=t.isSharedFromSecurityGroup),void 0!==t.isHidden&&(e.isHidden=t.isHidden),void 0!==t.ownerInfo){var o=t.ownerInfo;this.mergeArtifactOwnerInfo(e,o)}e.sharedTime=t.sharedTime||"/Date(0)/"},e.prototype.mergeDashboardTiles=function(e,t){var i=t.models||[],o=t.reports||[],r=t.workbooks||[],a=t.packages||[],n=e.contract.tiles;if(n)for(var s=0,l=n;s<l.length;s++){var c=l[s];this.modelConverter.resolveTilePackage(c,a)}var u=e.tiles;if(u)for(var d=0,p=u;d<p.length;d++){var m=p[d];this.mergeTile(m,m.contract,i,o,r)}},e.prototype.mergeModel=function(e,t){var i=this;e&&t&&(e.contract=t,e.id=t.id||e.id,e.isNew=t.isNew||e.isNew,e.getPermissionsCallback=function(){return i.permissionService.getModelEffectivePermissions(t)},e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.fileName=t.fileName||e.fileName,e.packageId=t.packageId||e.packageId,e.packageVersion=t.packageVersion||e.packageVersion,e.contentProviderId=t.contentProviderId||e.contentProviderId,e.packagePublishStatus=null!=t.packagePublishStatus?t.packagePublishStatus:e.packagePublishStatus,e.isRefreshInProgress=t.currentRefreshStartingTime&&n.convertRefreshTimeToJsDateTime(t.currentRefreshStartingTime).getTime()+18e5>Date.now(),e.cloudRlsEnabled=t.cloudRlsEnabled,e.realTimeMode=t.realTimeMode)},e.prototype.mergeModelContentProviderId=function(e,i){if(e)for(var o=0,r=e;o<r.length;o++){var a=r[o];a.contentProviderId=a.contentProviderId||t.ContractUtils.findContentProviderId(i,a.packageId)}},e.prototype.mergeReport=function(e,t){var i=this;e&&t&&(e.contract=t,e.id=t.id||e.id,e.objectId=t.objectId||e.objectId,e.modelId=t.modelId||e.modelId,e.reportUrl=t.reportUrl||e.reportUrl,e.getPermissionsCallback=function(){return i.permissionService.getReportEffectivePermissions(t)},e.packagePublishStatus=t.packagePublishStatus||e.packagePublishStatus,e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.fileName=t.fileName||e.fileName,e.packageId=t.packageId||e.packageId,e.packageVersion=t.packageVersion||e.packageVersion,e.contentProviderId=t.contentProviderId||e.contentProviderId,e.isHidden=t.isHidden,t.ownerInfo&&this.mergeArtifactOwnerInfo(e,t.ownerInfo))},e.prototype.mergeTileShallow=function(e,t,o,r){this.modelConverter.convertTileLayoutConfig(t),e.contract=t,e.type=t.type,this.mergeTileLayoutConfig(e,t),e.displayText=t.displayText,e.subDisplayText=t.subDisplayText,e.backgroundImageUrl=this.modelConverter.getImageUrl(t),e.errorCode=t.errorCode;var a=this.modelConverter.getTileReport(t.reportId,r);if(t.query&&t.query.modelQuery&&(e.utterance=t.query.modelQuery.utterance),e.action=this.modelConverter.convertTileAction(t),e.config=this.modelConverter.convertTileConfig(t),e.isLoading=i.TileFactory.isTileLoading(t),e.isLocked=i.TileFactory.isTileLocked(t),t.modelId){var n=this.modelConverter.getTileModel(t.modelId,o);n&&(e.vsName=n.vsName,e.dbName=n.dbName)}t.reportId&&(e.report=e.report||this.modelConverter.convertReport(a),e.report.id=t.reportId),a&&(this.modelConverter.fillReport(e.report,a),e.action||(e.action={action:"/openReport"})),this.modelConverter.convertSpecificTileShallow(t,e)},e.prototype.mergeTileLayoutConfig=function(e,t){if(!(e.layoutPosition.x&&e.layoutPosition.y&&e.layoutPosition.width&&e.layoutPosition.height)){var i=r.extendWithId(t.$layoutConfig.layouts),o=e.gridLayoutContext,a=o?o.getActiveLayout():0,n=i.withId(a);n&&this.mergeLayoutPosition(e.layoutPosition,n.position)}},e.prototype.mergeLayoutPosition=function(e,t){t&&(e.x=e.x||t.x,e.y=e.y||t.y,e.width=e.width||t.width,e.height=e.height||t.height)},e.prototype.mergeTile=function(e,t,o,r,a,n){var s=e.composite,l=e.realTime;this.mergeTileShallow(e,t,o,r),e.composite=this.modelConverter.convertCompositeTile(t),s&&e.composite&&(e.composite.setDataLoadEventDelegate(s.dataLoadEventDelegate),e.composite.copyDependencies(s),s instanceof i.SingleVisualCompositeTileModel&&e.composite instanceof i.SingleVisualCompositeTileModel&&this.mergeVisual(e.composite.visual,s.visual),s.tileDataIsVolatile&&s.tileData&&s.tileData.data&&(e.composite.tileData=s.tileData)),e.iframe=this.modelConverter.convertIframeTile(t),e.image=this.modelConverter.convertImageTile(t),e.model=this.modelConverter.convertModelTile(t),e.ssrs=this.modelConverter.convertSsrsTile(t);var c=this.modelConverter.convertRealTimeTile(t);if(this.updateTileRealTimeModel(e,l,c),e&&e.reportTile){var u=e.reportTile.exploration;e.reportTile=this.modelConverter.convertReportTile(t),e.reportTile.exploration=u}else e.reportTile=this.modelConverter.convertReportTile(t);if(!_.isEmpty(a)){var d=this.modelConverter.getTileWorkbook(t.workbookId,t.packageId,a);if(d){var p=this.modelConverter.convertWorkbook(d);e.workbook=this.modelConverter.convertWorkbookTile(t,p,e)}}if(r){var m=this.modelConverter.getTileReport(t.reportId,r);m?(e.report=e.report||this.modelConverter.convertReport(m),this.modelConverter.fillReport(e.report,m)):e.report=null,e.contractsReport=this.modelConverter.getTileReport(t.reportId,r)}else if(n){for(var f=void 0,h=0,g=n.length;h<g;h++)if(t.reportId===n[h].id){f=n[h];break}f&&(e.report=e.report||f,this.modelConverter.fillReport(e.report,f.contract),e.contractsReport=f.contract)}t.modelId&&(e.contractsModel=this.modelConverter.getTileModel(t.modelId,o))},e.prototype.mergeWorkbook=function(e,t){var i=this;e&&t&&(e.contract=t,e.id=t.id||e.id,e.getPermissionsCallback=function(){return i.permissionService.getWorkbookEffectivePermissions(t)},e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.packageId=t.packageId||e.packageId)},e.prototype.mergePackage=function(e,t){var i=this;e&&t&&(e.contract=t,e.contentProviderId=t.contentProviderId,e.id=t.id,e.lastRefreshTime=t.lastRefreshTime,e.latestVersion=t.latestVersion,e.name=t.name,e.publishOrRefreshStatus=t.publishOrRefreshStatus,e.version=t.version,e.originalPackageId=t.originalPackageId||e.originalPackageId,e.packageType=t.packageType||e.packageType,e.getPermissionsCallback=function(){return i.permissionService.getPackageEffectivePermissions(t)})},e.prototype.mergeInstalledAppModel=function(e,t,i){var o=this.modelConverter.convertInstalledAppModel(t,i);delete o.isFavorite,delete o.isFavoriteDisabled,delete o.favoriteInfo,_.extend(e,o)},e.prototype.updateTileRealTimeModel=function(e,t,i){e.realTime=i,t&&e.realTime&&e.realTime.copyRealTimeModelDependencies(t)},e.prototype.mergeVisual=function(e,t){t.visual&&e.type===t.type&&(e.visual=t.visual),e.viewport=t.viewport},e})();i.DataServiceModelMerger=l})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var o,r=e.common.GridLayoutConstants,a=e.data.services.DataViewObjectSerializer,n=e.data.services.DataViewTransformActionsSerializer,s=e.common.models.gridLayoutConstants,l=e.explore.contracts.PinData,c=e.data.SQExpr,u=t.constants.upgrader.TileConfigVersion,d=t.contracts.TileType,p=jsCommon.Utility;!(function(i){function o(e,t,i){for(var o=0,r=i.length;o<r;o++){var a=i[o];if(a.vsName===e&&a.dbName===t)return a}}function m(e,t,i,o){return P(e,d.composite,t,i,o)}function f(e,t){var i=h(e,t),o={version:u};if(null!=e.realTimeDataWindow){var r=i;r.dataWindow=e.realTimeDataWindow,o.realTimeVisual=r}else o.visualContainer=i;return o}function h(t,i){var o={$visualContainer:t.visualContainer,$modelExtensions:t.modelExtensions,themeCollection:e.visualHost.ThemeUtils.cloneThemeCollection(t.themeCollection),dataSourceVariables:t.dataSourceVariables};return g(o,t.dataTransforms,t.elements,t.tileLayoutType,t.queryMetadata,t.tileFilterDetails,t.tileHeading,t.tileSubDisplay,i,l.getVisualType(t)),o}function g(e,t,i,o,r,a,s,l,c,u){o&&(e.layoutType=o),i&&(e.elements=i),r&&(e.queryMetadata=r),s&&(e.heading1=s),a&&(e.heading2=a),l&&(e.heading3=l);var d=c.capabilities(u);t&&(e.transform=n.serializeTransformActions(n.serializeDataViewTransformActions(t,d&&d.objects)))}function v(e,t,i){var o=f(t,e);t.tileDataType&&(o.tileDataType=t.tileDataType);var r=P(o,null!=t.realTimeDataWindow?d.realTime:d.composite,t.query,t.dataViewSource,i);return r.publishState=2,t.action&&(r.action=JSON.stringify(t.action)),null!=t.utterance&&(r.query.modelQuery.utterance=t.utterance),t.name&&(r.name=t.name),r.reportId=t.reportId,t.modelId&&(r.modelId=t.modelId),t.packageId&&(r.packageId=t.packageId),r.resourcePackageIds=t.resourcePackageIds,r}function y(e){var i=_.omitBy({id:++L,type:e.type,query:e.query,action:e.action,$config:e.$config,tileData:e.tileData,tileDataSet:e.tileDataSet,publishState:e.publishState,displayText:e.displayText,subDisplayText:e.subDisplayText,modelId:e.modelId,reportId:e.reportId,workbookId:e.workbookId,packageId:e.packageId,name:e.name},(function(e){return void 0===e})),o=t.ContractUtils.getMasterLayoutPosition(e),r=t.ContractUtils.createMasterLayoutConfig({height:o.height,width:o.width});return i.$layoutConfig=r,i.layoutConfig=JSON.stringify(r),i}function T(e,i,o,a,n,l,c,p,m,f,h,g){var v={version:u};(p||m)&&(v.reportTile={pod:p,filters:m});var y;f&&(y={modelQuery:{utterance:f}});var T=2*r.defaultGridWidth,b=2*r.defaultGridHeight,S=h?h/T:2,C=g?g/b:2;0===Math.round(S)&&(S=2),0===Math.round(C)&&(S=2);var w=Math.round(r.gridItemMediumLandscapeColSpan*S),D=Math.round(r.gridItemMediumLandscapeRowSpan*C);w=w>s.gridMaxColSpan?s.gridMaxColSpan:w,D=D>s.gridMaxRowSpan?s.gridMaxRowSpan:D;var I=t.ContractUtils.createMasterLayoutConfig({width:w,height:D});return{id:++L,type:d.report,displayText:n,subDisplayText:l,action:JSON.stringify(c),reportId:e,sectionId:a,modelId:i,packageId:o,publishState:2,query:y,config:v?JSON.stringify(v):void 0,$config:v,layoutConfig:JSON.stringify(I),$layoutConfig:I}}function b(e){return 1===e.publishState}function S(e){return 20===e.errorCode}function C(e){var t=[],i=I(e);i&&!_.isEmpty(i.tiles)&&t.push(i);var o=k();return o&&!_.isEmpty(o.tiles)&&t.push(o),_.cloneDeep(t)}function w(e){for(var t=C(!0),i=0,o=t;i<o.length;i++){var r=o[i],a=_.find(r.tiles,(function(t){return t.id===e}));if(null!=a)return a.template}return null}function D(e){if(void 0!==e)return JSON.stringify(e,(function(e,t){return e&&e.charAt&&"$"===e.charAt(0)?void 0:t}))}function I(i){var o=[{id:1,title:e.common.localize.get("AddWidgetModal_IframeOption_Title"),description:e.common.localize.get("AddWidgetModal_IframeOption_Description"),iconClass:"pbi-glyph-iframe",template:"<edit-iframe-widget></edit-iframe-widget>",defaultTileContract:{type:d.iframe,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{iframe:{srcUrl:"",embedCode:""},version:"1.0",widget:{id:1,name:"webContent"}},$layoutConfig:t.ContractUtils.createMasterLayoutConfig()},disabled:!i,tooltip:i?void 0:e.common.localize.get("Dashboard_WebContentTiles_Disabled")},{id:2,title:e.common.localize.get("Image"),description:e.common.localize.get("AddWidgetModal_ImageOption_Description"),iconClass:"pbi-glyph-image",template:"<edit-image-widget></edit-image-widget>",defaultTileContract:{type:d.image,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{imageTile:{imageUrl:""},version:"1.0",widget:{id:2,name:"image"}},$layoutConfig:t.ContractUtils.createMasterLayoutConfig()}},{id:3,title:e.common.localize.get("Textbox"),description:e.common.localize.get("AddWidgetModal_TextOption_Description"),iconClass:"pbi-glyph-font",template:"<edit-text-widget></edit-text-widget>",defaultTileContract:{type:d.composite,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{version:"1.0",visualContainer:{layoutType:0,$visualContainer:{name:p.generateGuid(),config:{singleVisual:{objects:{},visualType:"textbox"}}},themeCollection:{}},widget:{id:3,name:"textbox"}},$layoutConfig:t.ContractUtils.createMasterLayoutConfig()}},{id:4,title:e.common.localize.get("AddWidgetModal_VideoOption_Title"),description:e.common.localize.get("AddWidgetModal_VideoOption_Description"),iconClass:"pbi-glyph-slideshow",template:"<edit-video-widget></edit-video-widget>",defaultTileContract:{type:d.iframe,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{iframe:{srcUrl:"",embedCode:""},version:"1.0",widget:{id:4,name:"video"}},$layoutConfig:t.ContractUtils.createMasterLayoutConfig()}}];return{title:e.common.localize.get("Add_Widgets_Section_Title"),tiles:o}}function k(){var i=[];return i.push({id:6,title:e.common.localize.get("Realtime_TileTitle"),description:e.common.localize.get("Realtime_TileDetails"),iconClass:"pbi-glyph-streaming-data",defaultTileContract:{type:d.realTime,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{realTimeVisual:{dataWindow:null,layoutType:0,$visualContainer:{name:p.generateGuid(),config:{singleVisual:null}},themeCollection:{}},version:"1.0"},$layoutConfig:t.ContractUtils.createMasterLayoutConfig({width:r.gridItemSmallLandscapeColSpan,height:r.gridItemSmallLandscapeRowSpan})}}),{title:e.common.localize.get("Add_Realtime_Section_Title"),tiles:i}}function P(i,o,a,n,s){var l=r.gridItemMediumLandscapeColSpan,c=r.gridItemMediumLandscapeRowSpan;t.TileUtils.getVisualType(i)===e.visuals.plugins.card.name&&(l=r.gridItemSmallLandscapeColSpan,c=r.gridItemSmallLandscapeRowSpan);var u=a?{modelQuery:{sq:JSON.stringify(a)}}:null,d=t.ContractUtils.createMasterLayoutConfig({width:l,height:c}),p={id:++L,type:o,query:u,$config:i,tileData:n?D(n.data):null,tileDataSet:n,layoutConfig:JSON.stringify(d),$layoutConfig:d},m=i.visualContainer;return m&&(p.displayText=m.heading1,p.subDisplayText=m.heading3),s&&(p.modelId=s.id),p}function E(t,i,o,r){if(t){var n=_.cloneDeep(t),s=n.realTimeVisual||n.visualContainer;if(s){if(r){var l=t.realTimeVisual||t.visualContainer;s.visualContainer=i.serializeVisualContainer(l.$visualContainer)}else{var u=s.$visualContainer.config.singleVisual,d=e.data.DataViewObjectDefinitions.getValue(u.vcObjects,{objectName:"stylePreset",propertyName:"name"},void 0);d&&c.isConstant(d)&&d.value&&(s.stylePresetName=d.value),s.visual=u.visualType,s.columnProperties=u.columnProperties;var l=t.realTimeVisual||t.visualContainer,p=l.$visualContainer.config.singleVisual.objects;if(p){var m=o.capabilities(u.visualType);m&&m.objects&&(s.objects=a.serializeObjects(p,m.objects))}var f=t.visualContainer&&l.$visualContainer.config.singleVisual.vcObjects;f&&(s.vcObjects=a.serializeObjects(f,e.explore.contracts.VisualContainer.CommonObjectDescriptors)),n.visualContainer&&(n.visual=s,delete n.visualContainer),n.version="0.1"}s.$modelExtensions&&(s.modelExtensions=i.serializeModelExtensions(s.$modelExtensions)),delete s.$visualContainer,delete s.$modelExtensions}return JSON.stringify(n)}}var L=100;i.findModel=o,i.createCompositeTile=m,i.createTileConfig=f,i.createTileForPinData=v,i.createNonVisualTileFromExisting=y,i.createReportTileForExploreData=T,i.isTileLoading=b,i.isTileLocked=S,i.getTileGalleryGroups=C,i.getTileTemplate=w,i.serializeTileConfig=E})(o=i.TileFactory||(i.TileFactory={}))})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=e.common.contracts.ContentTileType,o=jsCommon.EnumExtensions,r=e.common.models.ReportResource,a=(function(e){function t(t){var i=e.call(this,"undefined"==typeof t?0:t.id,1,"undefined"==typeof t?0:t.packageId)||this;return i.contract=t,i}return __extends(t,e),t.prototype.getPermissions=function(){var e;return this.getPermissionsCallback&&(e=this.getPermissionsCallback()),e?e:this.contract&&this.contract.permissions},Object.defineProperty(t.prototype,"contentTileType",{get:function(){return i.Workbook},enumerable:!0,configurable:!0}),t.prototype.isOwner=function(){return o.hasFlag(this.getPermissions(),7)},t.prototype.isPersonalized=function(){var e=this.getPermissions();return o.hasFlag(e,11)&&!o.hasFlag(e,7)},t.prototype.isEditable=function(){var e=this.editUrl;return this.isOwner()&&null!==e&&void 0!==e&&""!==e},Object.defineProperty(t.prototype,"displayNameWithExtension",{get:function(){var e=jsCommon.FileUtils.getFileExtension(this.contract.sourceFilePath);return this.displayName.concat(".").concat(e)},enumerable:!0,configurable:!0}),t})(r);t.Workbook=a})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var o=e.explore.services.createVisualHostServices,r=e.data.services.DataViewTransformActionsSerializer,a=e.common.models.gridLayoutConstants,n=e.common.helpers.ModelConverterHelper,s=e.data.SQExpr,l=e.explore.util.ThemeUtils,c=e.explore.util.VisualContainerUtils,u=(function(){function e(e,t,i){this.useSmallPlotArea=!1,this.contract=e,this.visualPluginService=t,this.pluginOps=i}return Object.defineProperty(e.prototype,"type",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileData",{get:function(){return null},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileDataIsVolatile",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isError",{get:function(){return this._isError},set:function(e){this._isError=e,this.onErrorDelegate&&this.onErrorDelegate()},enumerable:!0,configurable:!0}),e.prototype.isDataStale=function(e){return!1},Object.defineProperty(e.prototype,"heading1",{get:function(){return this.config.heading1||""},enumerable:!0,configurable:!0}),e.prototype.setDependencies=function(e){this.dataProxy=e},e.prototype.setDataLoadEventDelegate=function(e){this.dataLoadEventDelegate=e},e.prototype.copyDependencies=function(e){e.dataProxy&&this.setDependencies(e.dataProxy)},e})();i.CompositeTileModel=u,i.staleDataDeltaInMs=36e5;var d=(function(u){function d(e,t,i,o,r,a,n,s,l,c,d){var p=u.call(this,e,t,i)||this;return p.featureSwitchService=o,p.geolocationService=r,p.geocoder=a,p.promiseFactory=n,p.moduleLoader=s,p.telemetryService=l,p.themeService=c,p.authenticationService=d,p.requiresResize=!1,p._visual={hostServices:p.createHostServices(),themeCollection:{}},p}return __extends(d,u),Object.defineProperty(d.prototype,"type",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"visual",{get:function(){return this._visual},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"themeCollection",{get:function(){return this._visual&&this._visual.themeCollection},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"heading1",{get:function(){var t=this.config.heading1||"";if(!this.visual)return t;var i,o,r=this.visual.dataTransforms;r&&(i=r.selects);var a=this.visual.data;if(a&&(o=a.dataView),this.cachedShow!==!1&&void 0===this.cachedHeading){var n=c.evaluateObjectDefinitions(this.themeCollection,this.themeService,this.config.$visualContainer,this.featureSwitchService.featureSwitches,!1,o,i);if(n.dataViewObjects&&(void 0===this.cachedShow&&(this.cachedShow=e.DataViewObjects.getValue(n.dataViewObjects,{objectName:"title",propertyName:"show"},!0)),this.cachedShow)){var s=e.DataViewObjects.getValue(n.dataViewObjects,{objectName:"title",propertyName:"text"},null);null!==s?this.cachedHeading=s:_.isEmpty(t)&&(t=" ")}}return this.cachedHeading||t},enumerable:!0,configurable:!0}),d.prototype.setThemeName=function(e){this.ensureVisual();var t=this._visual.themeCollection;(t.customTheme=t.customTheme||l.getThemeMetadata(e,1)).name=e},d.prototype.isDataStale=function(e){if(!e)return!1;var t=this.contract,o=n.convertRefreshTimeToJsDateTime(t.tileDataUpdatedTime),r=o&&o.getTime();return!!r&&e-r>i.staleDataDeltaInMs},d.prototype.setData=function(t,i,o){try{this.ensureVisual(),this._visual.data=t,this._visual.dataTransforms=i,this._visual.type=o,this.clearCache()}catch(t){this.telemetryService.logEvent(e.telemetry.TileDataUpdateException,o,t.fileName,t.lineNumber,t.columnNumber,t.stack,t.message)}},d.prototype.createHostServices=function(){var t=this;return e.Prototype.inherit(o(this.promiseFactory,this.moduleLoader,this.geolocationService,this.geocoder),(function(e){e.authenticationService=function(){return t.authenticationService},e.canExpandCollapse=function(){return!0}}))},d.prototype.ensureVisual=function(){this._visual||(this._visual={hostServices:this.createHostServices(),themeCollection:{}},this.calculateLayout())},Object.defineProperty(d.prototype,"config",{get:function(){return this._config},set:function(t){if(this._config=t,this._visual){var i=t.$visualContainer.config.singleVisual,o=i.visualType;this._visual.type=o;var a=e.data.DataViewObjectDefinitions.getValue(i.vcObjects,{objectName:"stylePreset",propertyName:"name"},void 0);this._visual.stylePresetName=a&&s.isConstant(a)&&a.value,this._visual.themeCollection=_.cloneDeep(t.themeCollection);var n,l,c=this.visualPluginService.capabilities(o);c&&(n=c.objects,l=i.objects);var u=jsCommon.JsonExtensions.tryParseJSON(t.transform);u?this._visual.dataTransforms=r.deserializeDataViewTransformActions(u,c):this._visual.dataTransforms=r.createTransformActions(t.queryMetadata,t.elements,n,l)}},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"tileData",{get:function(){return this._tileData},set:function(e){this._tileData=e,this.readDataView(!0)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"tileDataIsVolatile",{get:function(){return this.contract.tileDataIsVolatile},enumerable:!0,configurable:!0}),d.prototype.refreshData=function(){this.readDataView(!1)},d.prototype.setDependencies=function(e){var t=!this.dataProxy&&this._tileData&&!this.isLoading;u.prototype.setDependencies.call(this,e),t&&this.refreshData()},d.prototype.readDataView=function(i){return __awaiter(this,void 0,e.Promise,(function(){var o,r,a,n,s,l,c,u,d,p;return __generator(this,(function(m){switch(m.label){case 0:if(o=this._visual.type,this.visual&&!this.requiresData())return[2];if(r=this.dataProxy,!r)return[2];if(this.contract.queryResultError&&(a=t.TileUtils.getTileErrorDetailsFromQueryResultError(this.contract.queryResultError),a?(this.isError=!0,this.errorDetails=a,this.errorText=a.message):this.errorText=e.common.localize.get("Tile_ErrorText")),!this._tileData||!this._tileData.data)return this.isLoading=!this.isError,[2];n=this._tileData,s={type:n.type,query:{dataSources:null,command:n.data},allowCache:i,perfId:o,kinds:this.pluginOps.dataViewKinds(o)},l=null,this.dataLoadEventDelegate&&(l=this.dataLoadEventDelegate(),this.dataLoadEventDelegate=null),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,r.execute(s)];case 2:return c=m.sent(),u={dataView:c&&c.dataReaderResult?c.dataReaderResult.dataView:null,dataViewSource:c&&c.dataViewSource?c.dataViewSource:null},d=c.dataReaderResult.error,this._visual.data=u,this.isError=this.isError||null!=d,l&&(this.isError?l.reject():l.resolve()),[3,4];case 3:return p=m.sent(),this.isError=!0,l&&l.reject(),[3,4];case 4:return[2]}}))}))},d.prototype.applyLayout=function(t){if(this.requiresResize){if(!this.featureSwitchService.featureSwitches.skipVisualManualUpdate){var i=this.visual;if(i&&i.visual){var o=i.visual,r=t===a.changeType.resized?2:t===a.changeType.resizing?1:void 0;o.update({viewport:i.viewport,dataViews:i.dataViews,suppressAnimations:!0,type:e.VisualUpdateType.Resize,resizeMode:r})}}this.requiresResize=!1}},d.prototype.calculateLayout=function(e,t){if(e&&(this.viewport&&this.viewport.height===e.height&&this.viewport.width===e.width||(this.requiresResize=!0),this.viewport=e),null!=t&&this.useSmallPlotArea!==t&&(this.useSmallPlotArea=t,this.requiresResize=!0),this.viewport){var o=this.viewport.height,r=this.viewport.width;switch(this._config&&this._config.layoutType){case 1:break;default:o-=this.useSmallPlotArea?i.TileConstants.VisualSmallVerticalMargin:i.TileConstants.VisualVerticalMargin,r-=i.TileConstants.VisualHorizontalMargin}this._visual&&(this._visual.viewport={height:o,width:r,scale:1})}},d.prototype.canResizeTo=function(t){var i=this._visual&&this._visual.visual;return!!i&&(!i.canResizeTo||i.canResizeTo(e.common.GridLayoutConstants.getDefaultGridItemViewport(t)))},d.prototype.getErrorLocId=function(e,t){return""},d.prototype.requiresData=function(){var e=this.visual,t=this.pluginOps;if(e){if(e&&e.type){if(!t)return!0;if(!t.isQueryVisual(e.type))return!1}return!0}},d.prototype.updateVisualInteractivityOptions=function(e){var t=this.visualPluginService.getInteractivityOptions(this._visual.type);"undefined"!=typeof t.isInteractiveLegend&&(t.isInteractiveLegend=t.isInteractiveLegend&&e),this._visual.interactivityOptions=t},d.prototype.clearCache=function(){this.cachedHeading=void 0},d})(u);i.SingleVisualCompositeTileModel=d})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.tileModel=e}return Object.defineProperty(e.prototype,"isSelected",{get:function(){return this.tileModel.isSelected},set:function(e){this.tileModel.isSelected=e},enumerable:!0,configurable:!0}),e})();e.DashboardTileModel=t})(t=e.models||(e.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=(function(){function t(e){this.contract=e}return t.prototype.canResizeTo=function(t){return t.rowSpan===e.common.GridLayoutConstants.gridItemMediumLandscapeRowSpan||t.colSpan===e.common.GridLayoutConstants.gridItemSmallLandscapeColSpan},t.prototype.getErrorLocId=function(e,t){return""},t})();t.IframeTileModel=i})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=(function(){function t(e){this.contract=e}return Object.defineProperty(t.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(e){this._imageUrl=e,e&&!this.isStatic&&0!==e.indexOf("data:")&&(this._imageUrl=jsCommon.Utility.getAbsoluteUri(e))},enumerable:!0,configurable:!0}),t.prototype.canResizeTo=function(t){return t.rowSpan===e.common.GridLayoutConstants.gridItemMediumLandscapeRowSpan||t.colSpan===e.common.GridLayoutConstants.gridItemSmallLandscapeColSpan},t.prototype.getErrorLocId=function(e,t){return""},t})();t.ImageTileModel=i})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=(function(){function t(e){this.contract=e}return t.prototype.canResizeTo=function(t){return t.rowSpan===e.common.GridLayoutConstants.gridItemSmallLandscapeRowSpan},t.prototype.getErrorLocId=function(e,t){return""},t})();t.ModelTileModel=i})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var o=t.constants.SingleValueRealTimeWindow,r=e.data.EmptyDataClientError,a=e.data.FailedRealTimeUpdateClientError,n=(function(n){function s(e,t,i,o,r,a,s,l,c,u,d){var p=n.call(this,e,t,i,o,r,a,s,l,c,u,d)||this;return p._visual=null,p}return __extends(s,n),s.prototype.setModelId=function(e){this.contract.modelId=e,this.initialize()},Object.defineProperty(s.prototype,"realTimeModelId",{get:function(){var e=this.contract,t=this.modelService?this.modelService.findModel(e.modelId,e.packageId):null;return t&&t.contract?{id:t.id,originalModelId:t.contract.originalModelId,tableName:this.getSchemaTableName(),schema:this.getRealTimeConceptualSchema(),packageId:e.packageId}:null},enumerable:!0,configurable:!0}),s.prototype.setRealTimeModelDependencies=function(e,t,i,o,r){n.prototype.setDependencies.call(this,e),this.visualQueryGenerator=t,this.conceptualSchemaProxy=i,this.realTimeDataService=o,this.modelService=r},s.prototype.copyRealTimeModelDependencies=function(e){e.schema&&(this.schema=e.schema),e.dataProxy&&e.realTimeDataService&&e.visualQueryGenerator&&e.conceptualSchemaProxy&&(this.setRealTimeModelDependencies(e.dataProxy,e.visualQueryGenerator,e.conceptualSchemaProxy,e.realTimeDataService,e.modelService),e.onErrorDelegate&&!this.onErrorDelegate&&(this.onErrorDelegate=e.onErrorDelegate),this.realTimeDataService.replaceListener(e.realTimeModelId,e,this))},s.prototype.onDataChanged=function(){var t=this;if(this.singleVisualConfig){var i=o,a=this.config;a&&a.dataWindow&&(i=a.dataWindow);var n=this.visualQueryGenerator.execute({dataSources:this.datasources,schema:this.schema,config:this.singleVisualConfig,additionalFilters:null,dataWindow:i});if(!n||n.error){var s=void 0;n&&n.error&&(s=n.error.getDetails(e.common.localize)),this.onError(s)}else this.dataProxy.execute(n.options).then((function(e){t.isError=!1;var i={dataView:e&&e.dataReaderResult?e.dataReaderResult.dataView:null},o=t.lastCategoryValue;try{var r=t.getLastDateOrNumericCategoryValue(i.dataView);if(null!=o&&null!=r&&o.valueOf()>=r.valueOf())return;t.lastCategoryValue=r}catch(e){}t.setData(i,n.transforms,t.config.$visualContainer.config.singleVisual.visualType),t.isLoading=!1}),(function(i){if(!(i instanceof r)){var o=i&&i.getDetails(e.common.localize);t.onError(o)}}))}},s.prototype.onError=function(t){t||(t=(new a).getDetails(e.common.localize)),this.setErrorDetails(t)},Object.defineProperty(s.prototype,"datasources",{get:function(){var e=this.realTimeModelId;if(e)return i.RealTimeModelUtility.getRealTimeDataSource(e.id,e.originalModelId)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"singleVisualConfig",{get:function(){return this.config.$visualContainer.config.singleVisual},set:function(e){this.config.$visualContainer.config.singleVisual=e,
this.onDataChanged()},enumerable:!0,configurable:!0}),s.prototype.isDataStale=function(){return!1},s.prototype.initialize=function(){var e=this,i=t.ContractUtils.getMasterLayoutPosition(this.contract);this.size={rowSpan:i.height,colSpan:i.width};var o=this.datasources;o&&this.conceptualSchemaProxy.get(o).then((function(t){e.fixUpSchema(t),e.schema=t,e.realTimeDataService.subscribe(e.realTimeModelId,e)}))},s.prototype.unsubscribe=function(){this.realTimeModelId&&this.realTimeDataService.unsubscribe(this.realTimeModelId,this)},s.prototype.fixUpSchema=function(i){for(var o=i.schema(t.constants.RealTimeDataSourceName).entities,r=o[0].properties,a=0,n=r;a<n.length;a++){var s=n[a];s.type!==e.ValueType.fromDescriptor({numeric:!0})&&s.type!==e.ValueType.fromDescriptor({integer:!0})||(s.kind=1)}},s.prototype.getSchemaTableName=function(){var e=this.getRealTimeConceptualSchema();if(e){var t=e.entities;return _.head(t).name}},s.prototype.getRealTimeConceptualSchema=function(){if(this.schema)return this.schema.schema(t.constants.RealTimeDataSourceName)},s.prototype.setErrorDetails=function(e){this.errorDetails=e,this.errorText=e.message,this.isError=!0},s.prototype.getLastDateOrNumericCategoryValue=function(e){var t=e&&e.categorical;if(t){var i=_.head(t.categories),o=i&&i.values;if(!_.isEmpty(o)){var r=_.last(o);return r&&!_.isBoolean(r)&&(_.isDate(r)||_.isNumber(r))?r:void 0}}},s})(i.SingleVisualCompositeTileModel);i.RealTimeTileModel=n})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var o,r=i.RealTimeModel;!(function(i){function o(i,o){if(i&&!(i<0))return e.explore.contracts.createDataSourceArray([{id:i,type:e.data.tabular.type,name:t.constants.RealTimeDataSourceName,tabular:{modelId:null!=o?o:i}}])}function a(t){var i=e.data.tabular.getColumnsMetadata(t);if(i){for(var o=[],a=0,n=i;a<n.length;a++){var s=n[a];o.push({name:s.name,dataType:r.convertToRealTimeDataType(e.ValueType.fromDescriptor(s.type))})}return o}}i.getRealTimeDataSource=o,i.convertToColumnsDefinition=a})(o=i.RealTimeModelUtility||(i.RealTimeModelUtility={}))})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=(function(){function t(e){this.contract=e,this.exploration={contract:void 0,exploreCanvas:void 0,sections:[]},this.isError=!1,this.tilesUpdated=!1}return t.prototype.canResizeTo=function(t){return t.rowSpan===e.common.GridLayoutConstants.gridItemMediumLandscapeRowSpan||t.colSpan===e.common.GridLayoutConstants.gridItemSmallLandscapeColSpan},t.prototype.getErrorLocId=function(e,t){return""},t})();t.ReportTileModel=i})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=(function(){function t(e){this.contract=e}return Object.defineProperty(t.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(e){e&&(0!==e.indexOf("data:")?this._imageUrl=jsCommon.Utility.getAbsoluteUri(e):this._imageUrl=e)},enumerable:!0,configurable:!0}),t.prototype.canResizeTo=function(t){return t.rowSpan===e.common.GridLayoutConstants.gridItemLargeLandscapeRowSpan||t.colSpan===e.common.GridLayoutConstants.gridItemLargeLandscapeColSpan},t.prototype.getErrorLocId=function(e,t){return""},t})();t.SsrsTileModel=i})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){function o(e){if(!(_.isEmpty(e)||e.length<i.DashboardIntraDomainNavigationPrefix.length)&&r(e))return e.substr(i.DashboardIntraDomainNavigationPrefix.length)}function r(e){return!_.isEmpty(e)&&0===e.toLowerCase().indexOf(i.DashboardIntraDomainNavigationPrefix)}function a(e){return!_.isEmpty(e)&&0===e.toLowerCase().indexOf(i.ReportIntraDomainNavigationPrefix)}function n(e){return!_.isEmpty(e)&&0===e.toLowerCase().indexOf(i.RdlReportIntraDomainNavigationPrefix)}function s(e){return!_.isEmpty(e)&&0===e.toLowerCase().indexOf(i.WorkbookIntraDomainNavigationPrefix)}function l(e){return r(e)||a(e)||n(e)||s(e)}var c,u=jsCommon.ArrayExtensions,d=jsCommon.DateExtensions,p=e.common.utils.DateFormatter,m=e.common.helpers.ModelConverterHelper,f=jsCommon.UrlUtils;!(function(e){e[e.Dashboard=0]="Dashboard",e[e.Report=1]="Report",e[e.RdlReport=2]="RdlReport"})(c=i.IntraDomainNavigationType||(i.IntraDomainNavigationType={})),i.getDashboardGuidFromUrl=o,i.IsDashboardIntraDomainPrefix=r,i.IsReportIntraDomainPrefix=a,i.IsRdlReportIntraDomainPrefix=n,i.IsWorkbookIntraDomainPrefix=s,i.IsValidIntraDomainPrefix=l,i.DashboardIntraDomainNavigationPrefix="/dashboards/",i.ReportIntraDomainNavigationPrefix="/reports/",i.RdlReportIntraDomainNavigationPrefix="/rdlreports/",i.WorkbookIntraDomainNavigationPrefix="/workbooks/";var h;!(function(e){e.SubtitleHeight=10,e.TileDefaultPadding=10,e.RegularHeaderHeight=50,e.SmallHeaderHeight=42,e.LargeHeaderHeight=65,e.VisualVerticalMargin=20,e.VisualHorizontalMargin=20,e.VisualSmallVerticalMargin=8})(h=i.TileConstants||(i.TileConstants={}));var g=(function(){function i(e,t){this.isSelected=!1,this.hasConversation=!1,this.hasSpotlight=!1,this.contract=e,this.tileHeaderSize=1,this.layoutPosition={},this.localizationService=t,this.themeName="Light",this.tileStyles={},this.tileHeaderStyles={},this.tileBackground={}}return Object.defineProperty(i.prototype,"gridLayouts",{get:function(){return this.contract.$layoutConfig.layouts},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"id",{get:function(){return this.contract.id},set:function(e){this.contract.id=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"objectId",{get:function(){return this.contract.objectId},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"details",{get:function(){switch(this.type){case t.contracts.TileType.composite:return this.composite;case t.contracts.TileType.iframe:return this.iframe;case t.contracts.TileType.image:return this.image;case t.contracts.TileType.model:return this.model;case t.contracts.TileType.ssrs:return this.ssrs;case t.contracts.TileType.workbook:return this.workbook;case t.contracts.TileType.report:return this.reportTile;case t.contracts.TileType.realTime:return this.realTime;default:return null}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shouldBeIncludedInTelemetryMeasurement",{get:function(){return this.details&&!!this.details.shouldBeIncludedInTelemetryMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isTemporary",{get:function(){return this.id<=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isTileLoading",{get:function(){return this.composite?this.composite.isLoading&&!this.composite.isError:this.isLoading},enumerable:!0,configurable:!0}),i.prototype.calculateLayout=function(e){var t=this.getHeaderSizeByType(this.tileHeaderSize);if(this.compositeTile&&e){var i=e,o=2===this.tileHeaderSize;if(o)if(this.hasTitle())i.height-=t;else{var r=this.composite&&this.composite.config&&this.composite.config.layoutType;1!==r&&(i.height-=h.TileDefaultPadding)}else this.hasTitle()&&(this.hasSubtitle()?i.height-=t:i.height-=t-h.SubtitleHeight);this.compositeTile.calculateLayout(i,o)}},i.prototype.applyLayout=function(e){this.compositeTile&&this.compositeTile.applyLayout(e)},i.prototype.invalidateLayout=function(){this.tryPopulateLayoutPositionValues()&&this.gridLayoutContext.onLayoutInvalidated()},i.prototype.tryPopulateLayoutPositionValues=function(){if(!this.gridLayoutContext||this.gridLayoutContext.isLayoutUpdateLocked)return!1;var e=this.gridLayoutContext.getActiveLayout(),t=u.extendWithId(this.contract.$layoutConfig.layouts),i=t.withId(e);return i&&i.position&&(this.layoutPosition=_.cloneDeep(i.position)),!0},i.prototype.applyChanges=function(){if(this.contract&&this.gridLayoutContext){var e=_.cloneDeep(this.layoutPosition),t=this.contract.$layoutConfig;this.addOrUpdateLayoutPosition(t,e),this.contract.layoutConfig=JSON.stringify(this.contract.$layoutConfig)}},i.isValidUrl=function(e,t){return!_.isEmpty(e)&&(f.isValidHttpUrl(e,!1)||t&&l(e))},i.prototype.getDisplayText=function(){return this.displayText?this.displayText:this.compositeTile?this.compositeTile.heading1:""},i.prototype.getSubDisplayText=function(){if(this.displayText&&this.subDisplayText)return this.subDisplayText;if(this.compositeTile){var e=this.compositeTile.config;if(!this.displayText&&e&&!_.isEmpty(e.heading3))return e.heading3}return""},i.prototype.shouldPlaceBulletSeperator=function(){return this.displayText&&this.displayText.length>0&&this.subDisplayText&&this.subDisplayText.length>0&&this.config&&this.config.lastRefreshTimeEnabled},Object.defineProperty(i.prototype,"hrefTarget",{get:function(){return this.action.openInSameTab?"_self":"_blank"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lastRefreshTimeInLocaleString",{get:function(){var e=m.convertRefreshTimeToJsDateTime(this.contract.tileDataUpdatedTime),t="";return e?t=e.toLocaleString():this.datasetModel&&(t=this.datasetModel.lastRefreshTimeInLocaleString),t||""},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"formattedTime",{get:function(){var e;if(this.workbook){var t=this.contract.tilePackage;e=t?m.convertRefreshTimeToJsDateTime(t.lastRefreshTime):null}else e=m.convertRefreshTimeToJsDateTime(this.contract.tileDataUpdatedTime);if(e){if(this.cachedRefreshTime&&e.getTime()===this.cachedRefreshTime.getTime())return this.cachedRefreshString;this.cachedRefreshTime=e;return this.cachedRefreshString=this.getFormattedDateString(e)}if(this.datasetModel)return this.datasetModel.lastRefreshTimeInLocaleString},enumerable:!0,configurable:!0}),i.prototype.getFormattedDateString=function(e){var t=v,i=d.isContainedInTimeFrame,o=d.isMomentPresent();return o&&i(e,t.Minute,t.MaxMinuteThreshold,!1)?p.getPrettyRelativeDate(e,this.localizationService):o&&i(e,t.Day,t.SameDayThreshold,!0)?d.GetTime(this.localizationService.currentLanguageLocale,e):o&&i(e,t.Day,t.YesterdayThreshold,!0)?this.localizationService.format("DashboardTile_YesterdayTemplate",[d.GetTime(this.localizationService.currentLanguageLocale,e)]):o&&i(e,t.Day,t.WeekThreshold,!0)?d.GetDayWithTime(this.localizationService.currentLanguageLocale,e):d.GetFullDateWithTime(this.localizationService.currentLanguageLocale,e)},i.prototype.setDatasetModelAndPackageInfo=function(e,t){e&&(this.datasetModel=e,t&&(this.datasetModel.packagePublishStatus=t.publishOrRefreshStatus))},i.prototype.hasTitle=function(){return(!this.config||!this.config.hideTitle)&&(!_.isEmpty(this.displayText)||this.compositeTile&&!_.isEmpty(this.compositeTile.heading1))},i.prototype.hasSubtitle=function(){var e=this.config;return(!e||!e.hideTitle)&&(!_.isEmpty(this.subDisplayText)||e&&e.lastRefreshTimeEnabled)},i.prototype.lastRefreshTimeInLocaleWithLabel=function(){if(this.config&&this.config.lastRefreshTimeEnabled)return this.localizationService.format("Refreshed",[this.formattedTime])},i.prototype.setTileHeaderSize=function(e){this.tileHeaderSize!==e&&(this.tileHeaderSize=e,this.invalidateLayout())},Object.defineProperty(i.prototype,"compositeTile",{get:function(){return this.composite||this.realTime},enumerable:!0,configurable:!0}),i.prototype.hasLayoutDefinition=function(e){return!!u.extendWithId(this.contract.$layoutConfig.layouts).withId(e)},i.prototype.hasLayoutPosition=function(e){return!!t.ContractUtils.getLayoutPosition(this.contract,e)},i.prototype.removeLayoutPosition=function(e){return void 0===e&&(e=1),this.hasLayoutDefinition(e)&&(this.addLayout({id:e,position:null},e),this.resetTileLayoutSizeAndPosition()),this.getCurrentTileLayoutDescriptor()},i.prototype.resetTileLayoutSizeAndPosition=function(){this.layoutPosition.x=null,this.layoutPosition.y=null,this.layoutPosition.height=null,this.layoutPosition.width=null,this.gridLayoutContext=null},i.prototype.removeLayoutDefinition=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=!0),this.hasLayoutDefinition(e)&&(_.remove(this.contract.$layoutConfig.layouts,(function(t){return t.id===e})),t&&this.resetTileLayoutSizeAndPosition()),this.getCurrentTileLayoutDescriptor()},i.prototype.applyLayoutSize=function(e,t){this.compositeTile&&(this.compositeTile.size={colSpan:e.colSpan,rowSpan:e.rowSpan}),this.applyLayout(t)},i.prototype.getCurrentTileLayoutDescriptor=function(e,t){var i=e?e:this.contract.$layoutConfig;return{id:this.id,row:null,col:null,rowSpan:null,colSpan:null,layoutConfig:JSON.stringify(i),query:t?t[0]:null,updatedQuery:t?t[1]:null,modelId:this.contract.modelId}},i.prototype.buildLayoutDescriptor=function(){var e=_.cloneDeep(this.layoutPosition),t=_.cloneDeep(this.contract.$layoutConfig);this.addOrUpdateLayoutPosition(t,e);var i=this.updateTileQueryAfterResize(e);return this.getCurrentTileLayoutDescriptor(t,i)},i.prototype.updateTileQueryAfterResize=function(i){var o=this.composite&&this.composite.contract&&this.composite.contract.query;if(o){var r=t.ContractUtils.convertToTileDataQuery(o);if(!r)return;for(var a=_.cloneDeep(o),n=i.width*e.common.GridLayoutConstants.defaultGridWidth,s=i.height*e.common.GridLayoutConstants.defaultGridHeight,l=!1,c=0,u=r.Commands;c<u.length;c++){var d=u[c],p=d.ScriptVisualCommand;if(p){var m=p.ViewportWidthPx,f=p.ViewportHeightPx;m===n&&f===s||(p.ViewportWidthPx=n,p.ViewportHeightPx=s,d.ScriptVisualCommand=p,l=!0)}}if(l){this.composite.contract.query.modelQuery.sq=JSON.stringify(r);return[a,JSON.stringify(this.composite.contract.query)]}}},i.prototype.addOrUpdateLayoutPosition=function(e,t){var i=this.gridLayoutContext.getActiveLayout(),o=u.extendWithId(e.layouts),r=o.withId(i);r||(r={id:i,position:{}},o.push(r)),r.position=t},i.prototype.addLayout=function(e,t){return this.removeLayoutDefinition(t),this.contract.$layoutConfig.layouts.push(e),this.getCurrentTileLayoutDescriptor()},i.prototype.getHeaderSizeByType=function(e){switch(e){case 0:return h.LargeHeaderHeight;case 2:return h.SmallHeaderHeight;case 1:default:return h.RegularHeaderHeight}},i})();i.Tile=g;var v;!(function(e){e.Minute="minute",e.Day="day",e.MaxMinuteThreshold=15,e.SameDayThreshold=0,e.YesterdayThreshold=1,e.WeekThreshold=6})(v||(v={}))})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=(function(){function t(e,t){this.contract=e,this.tileModel=t}return t.prototype.canResizeTo=function(t){return t.rowSpan===e.common.GridLayoutConstants.gridItemMediumLandscapeRowSpan||t.colSpan===e.common.GridLayoutConstants.gridItemSmallLandscapeColSpan},t.prototype.getErrorLocId=function(e,t){var i,o=[];switch(e){case 10:i="WorkbookTile_GeneralError";break;case 11:i="WorkbookTile_FileNotFound";break;case 12:i="WorkbookTile_ObjectNotFound",o=this.contract.$config.workbookTile?[this.contract.$config.workbookTile.item]:["pinned object"];break;case 13:i="WorkbookTile_Unauthorized";break;default:return""}return t.format(i,o)},t.prototype.hasImages=function(){return this.hasWorkbookTileConfig&&this.tileModel.config.workbookTile.images&&this.tileModel.config.workbookTile.images.length>0},Object.defineProperty(t.prototype,"images",{get:function(){return this.hasWorkbookTileConfig?this.tileModel.config.workbookTile.images:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasWorkbookTileConfig",{get:function(){return!!this.tileModel&&!!this.tileModel.config&&!!this.tileModel.config.workbookTile},enumerable:!0,configurable:!0}),t})();t.WorkbookTileModel=i})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t,i=jsCommon.ArrayExtensions;!(function(e){function t(e,t){if(e)for(var i=e.length,o=0;o<i;o++)if(e[o].id===t)return e[o].contentProviderId;return null}function o(e){var t=r(e);if(t&&t.Commands&&t.Commands.length>0){var i=t.Commands[0].SemanticQueryDataShapeCommand;return{defn:i.Query,shape:i.Binding}}return null}function r(e){if(e&&e.modelQuery&&e.modelQuery.sq){var t;try{t=JSON.parse(e.modelQuery.sq)}catch(e){}if(t){var i=null;return c(t)?i=t.dataQuery:u(t)?i=t:d(t)&&(i={Commands:[{SemanticQueryDataShapeCommand:{Query:t.defn,Binding:t.shape}}]}),i}}}function a(e){return void 0===e&&(e={}),{layouts:[{id:0,position:e}]}}function n(e){var t=s(e,0);return t}function s(e,t){var o=i.extendWithId(e.$layoutConfig.layouts),r=o.withId(t);return r?r.position:null}function l(e){switch(e){case 0:return"pbix";case 1:return"rdl";default:return"unknown"}}function c(e){return e.dataQuery&&e.dataQuery.Commands&&e.dataQuery.Commands.length>0}function u(e){return e.Commands&&e.Commands.length>0}function d(e){return e.defn}e.findContentProviderId=t,e.convertToSemanticQueryWithDataShapeBinding=o,e.convertToTileDataQuery=r,e.createMasterLayoutConfig=a,e.getMasterLayoutPosition=n,e.getLayoutPosition=s,e.reportTypeToString=l})(t=e.ContractUtils||(e.ContractUtils={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t,i=jsCommon.DateExtensions,o=jsCommon.Utility;!(function(e){function t(e){var t=o.getDateFromWcfJsonString(e,!0);return t||(t=i.parseIsoDate(e)),t}e.convertDate=t})(t=e.DateUtils||(e.DateUtils={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=jsCommon.Color,r=e.common.contracts.ContentProviderCategory,a=e.common.models.Model,n=jsCommon.Utility,s=t.models.Workbook;!(function(i){function l(e,t){var i=e.defaultContent;if(0!==e.defaultContentOption&&i)return t.getAppArtifact(e,{dashboardOriginalGUID:i.dashboardObjectId,reportOriginalGUID:i.reportObjectId,workbookID:i.workbookObjectId})}function c(e){return e&&e.category===r.OrganizationalApp}function u(e,t){var i=t.getAppInstance(e);return i&&c(i.providerContract)}function d(e){return e.category===r.OrganizationalTemplateApp||e.category===r.ServiceApp||e.category===r.Services}function p(e,t){var i=t.getAppInstance(e);return i&&d(i.providerContract)}function m(e,t){if(e&&e.contract){return h(e.getUniquePackageId&&e.getUniquePackageId(),t)}}function f(e,t){if(e)return h(e.packageId,t)}function h(e,t){if(e){var i=t.getAppInstance(e);return i&&i.providerContract.providerKey}}function g(e,t,i){var o=e.getAppInstancesForApp(i);if(!_.isEmpty(o)){var a=o[0];return a.category===r.OrganizationalApp,a.packageId}}function v(e,i){var o=t.DateUtils.convertDate(e);return o&&o.toLocaleDateString(i.currentLanguageLocale,{month:"short",day:"numeric",year:"numeric"})}function y(e){return!(e.icon||_.isEmpty(e.iconUrl)&&_.isEmpty(e.localAppLogoImageData))}function T(e,t){if(y(e)){if(e.localAppLogoImageData)return"url("+e.localAppLogoImageData+")";if(e.iconUrl){var i=e;return"url("+n.urlCombine(t,i.iconUrl)+")"}}}function b(e){if(!e)return"inherit";var t=o.parseColorString(e);return.299*t.R+.587*t.G+.144*t.B>125?"#000":"#FFF"}function S(e){if(e){return o.calculateHighlightColor(o.parseColorString(e),.8,.2)}}function C(e){return e instanceof a?e.dbName:e instanceof s?e.uniqueId:e.objectId}function w(e){var t=jsCommon.JsonExtensions.tryParseJSON(e.providerConfig);if(t)return t.author}function D(e,t){var i=_.find(t.packages,(function(t){return t.contract.folderId===e&&t.contract.serviceAppObjectId}));if(i)return i.id}function I(e,t){var i=t.findPackage(e);if(i&&i.contract&&i.contract.folderId)return D(i.contract.folderId,t)}function k(e,t){return!!I(e,t)}function P(t,i){var o="Unknown";if(t&&i)if(6===i)o="Excel Workbook";else if(7===i)o="Power BI Designer File";else if(17===i)o="OrgContent";else if(60===i)o="CSV File";else{var r=_.find(t,{id:i});r&&(o=r.clientCategory===e.common.contracts.ContentProviderClientCategory.Organizational?"OrgContent":r.displayText)}return o}i.getDefaultAppArtefact=l,i.isOrgApp=c,i.isOrgAppInstance=u,i.isParameterizedApp=d,i.isParameterizedAppInstance=p,i.getDashboardAppGUID=m,i.getResourceAppGUID=f,i.getAppGUIDByPackageId=h,i.getPackageIDByOrgAppGUID=g,i.convertDisplayDate=v,i.hasAppLogoImage=y,i.getAppLogoImageUrlStyle=T,i.getAppHeaderFontColor=b,i.getAppHeaderBackgroundColor=S,i.getAppContentModelObjectId=C,i.getAppAuthor=w,i.getServiceAppWorkspacePackageByFolderId=D,i.getServiceAppWorkspacePackage=I,i.isServiceApp=k,i.findContentProviderName=P})(i=t.AppUtils||(t.AppUtils={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=e.common.helpers.ModelConverterHelper,r=3;!(function(t){function i(e){return 2===(2&e.permissions)}function a(t,i,o,r){var a,n="NotifiedReadOnlyDashboard"+t.id;return a=r||!e.common.sessionStorageService.getData(n),a&&(i.notify({title:o.get("Warning_Title"),message:o.get("DashboardReadOnlyWarning_Message"),notificationType:1}),e.common.sessionStorageService.setData(n,!0)),a}function n(e,t,i){if(!e)return!1;var r=i.featureSwitches;return o.getIsQnaSupported(e,r)&&t.isExplorableModelContract(e)}function s(e,t){var i=[];if(!e)return i;var o=[],r=e.modelIds;_.isEmpty(r)||(o=r.slice(0));var a=e.tiles;if(_.map(a,(function(e){null!=e.modelId&&o.push(e.modelId)})),_.isEmpty(o))return i;o=_.uniq(o);for(var n=0,s=o.length;n<s;n++){var l=_.filter(t,(function(e){return e.id===o[n]}));_.isEmpty(l)||i.push(l[0])}return i}function l(e){for(var t=[],i=1e3,o=_.sortBy(e,(function(e){var t=e.getActiveLayoutPosition();return t.y*i+t.x})),r=0,a=o;r<a.length;r++){var n=a[r],s=n.getActiveLayoutPosition();c(t,s.y,s.height)}for(var l=[],d=1e3,p=_.sortBy(e,(function(e){var t=e.getActiveLayoutPosition();return t.x*d+t.y})),m=0,f=p;m<f.length;m++){var n=f[m],s=n.getActiveLayoutPosition();c(l,s.x,s.width)}for(var h=u(t,l,o,p),g=0===h?t:l,v=0===h?p:o,y=[],T=0,b=0,S=g;b<S.length;b++){for(var C=S[b],w=T+1;w<C.startPosition;w++)y.push(void 0);for(var D=C.startPosition;D<C.startPosition+C.size;D++)y.push(C.startPosition),T=D}for(var I=_.groupBy(v,(function(e){return y[(0===h?e.getActiveLayoutPosition().y:e.getActiveLayoutPosition().x)-1]})),k=[],P=0,E=g;P<E.length;P++){var C=E[P];k=k.concat(I[C.startPosition])}return _.map(k,(function(e){return e.getItem()}))}function c(e,t,i){var o=e.length,r=e[o-1];!_.isEmpty(e)&&t>=r.startPosition&&t<r.startPosition+r.size?t+i>r.startPosition+r.size&&(r.size=t+i-r.startPosition):e.push({startPosition:t,size:i})}function u(e,t,i,o){var r,a=_.isEmpty(e)?-(1/0):_.maxBy(e,(function(e){return e.size})).size,n=_.isEmpty(t)?-(1/0):_.maxBy(t,(function(e){return e.size})).size,s=_.every(e,(function(t){return t.size===e[0].size})),l=_.every(t,(function(e){return e.size===t[0].size}));return r=d(e,a,s)?0:d(t,n,l)?1:a<=n?0:1}function d(e,t,i){return e.length>1&&i&&t<=r}function p(e,t,i){if(!i||!i.tiles)return!1;switch(e){case 0:return _.some(i.tiles,(function(e){return e.hasLayoutDefinition(t)}));case 1:return _.some(i.tiles,(function(e){return e.hasLayoutPosition(t)}))}}function m(e){for(var t=[],i=0,o=e.tiles;i<o.length;i++){var r=o[i];r.hasLayoutDefinition(1)?r.shouldNewBadgeAppear=!1:(r.shouldNewBadgeAppear=!0,t.push(r.addLayout({id:1,position:null},1)))}return t}t.isWriteable=i,t.notifyReadOnly=a,t.isQnaSupportedModel=n,t.getDashboardModels=s,t.orderItems=l,t.containsLayout=p,t.markTilesAsNewIfNeeded=m})(i=t.DashboardUtils||(t.DashboardUtils={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=t.contracts,r=e.visuals.plugins,a="__default__",n=1;!(function(e){function t(e,t){void 0===t&&(t=1);var r=i[t];if(!r)return n;var s=o.TileType[e.type];if(!r[s]&&e.composite){var l=e.composite;l&&(s=l.visual.type)}return r[s]||r[a]}var i={},s={};s[o.TileType[o.TileType.report]]=6,s[r.card.name]=2,s[r.animatedNumber.name]=2,s[r.textbox.name]=2,s[a]=3,i[1]=s,e.getRowSpan=t})(i=t.TileDefaultSizesUtils||(t.TileDefaultSizesUtils={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=jsCommon.JsonExtensions,r=t.contracts.TileType;!(function(i){function a(i,o,a,n,s,l,c,u,d){var p=i.realTime,f=u.execute({dataSources:p.datasources,schema:s,config:o,additionalFilters:null,dataWindow:a}),h=l.getPinData({name:"tile"+i.id,config:{singleVisual:o},layouts:void 0},0,p.datasources,{},null,null,f,s);h.realTimeDataWindow=a;var g=t.models.TileFactory.createTileForPinData(c,h,n),v=g.$config;if(!v)return void d.logEvent(e.telemetry.DashboardTileError,r[r.realTime],m);v.hideTitle=i.config.hideTitle,i.config=v,i.realTime.config=v.realTimeVisual;var y=i.contract;if(y.query=g.query,y.modelId=g.modelId,i.isTemporary){var T=t.ContractUtils.getMasterLayoutPosition(y),b=t.ContractUtils.getMasterLayoutPosition(g);T.width=b.width,T.height=b.height;var S={colSpan:T.width,rowSpan:T.height};i.calculateLayout(e.common.GridLayoutConstants.getDefaultGridItemViewport(S)),i.invalidateLayout()}p.singleVisualConfig=o}function n(e){if(e){var t=e.visualContainer||e.realTimeVisual;return t&&t.$visualContainer?t.$visualContainer.config.singleVisual.visualType:void 0}}function s(e,t){return i.isScriptVisualTile(e,t)||i.countTileScriptVisuals(e,t).hasScriptVisuals}function l(e,t){return e&&e.type===r.composite&&t.isScriptVisual(i.getVisualType(e.config))}function c(t,i){var o=new f,a=t&&t.reportTile&&t.reportTile.exploration&&t.reportTile.exploration.sections;if(!a||t.type!==r.report)return o;for(var n=0,s=a;n<s.length;n++)for(var l=s[n],c=0,u=l.contract.visualContainers;c<u.length;c++){var d=u[c],p=e.explore.util.VisualContainerUtils.getVisualType(d);if(p&&i&&i.isScriptVisual(p))switch(e.explore.util.ScriptVisualsUtil.getScriptVisualType(p)){case 0:o.rScriptCount++;break;case 1:o.pythonScriptCount++}}return o}function u(e,t){return"tile_"+e.id+"_dash_"+t}function d(e,i,o){var r,a=1,n=6,s=t.TileDefaultSizesUtils.getRowSpan(o,a),l={id:a,position:{y:e,x:i,width:n,height:s}};return r=o.addLayout(l,a),o.layoutPosition.y=e,o.layoutPosition.x=i,o.layoutPosition.height=s,o.layoutPosition.width=n,r}function p(t){var i=o.tryParseJSON(t.errorDetail);if(i&&!_.isEmpty(i.DataShapes)){var r=i.DataShapes[0]["odata.error"];if(r){return new e.DsrClientError(r).getDetails(e.common.localize)}}}var m="Invalid tile config object",f=(function(){function e(){this.rScriptCount=0,this.pythonScriptCount=0}return Object.defineProperty(e.prototype,"hasScriptVisuals",{get:function(){return this.rScriptCount>0||this.pythonScriptCount>0},enumerable:!0,configurable:!0}),e})();i.ScriptVisualCounts=f,i.UpdateRealTimeTile=a,i.getVisualType=n,i.tileContainsScriptVisuals=s,i.isScriptVisualTile=l,i.countTileScriptVisuals=c,i.tileTrackerFn=u,i.createDefaultPhoneByTile=d,i.getTileErrorDetailsFromQueryResultError=p})(i=t.TileUtils||(t.TileUtils={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=jsCommon.EnumExtensions,r=e.common.contracts.PackageType;!(function(e){function t(e,t,o,r,a,n,s,l){if(t=t||[],i(e,t,o,r,a,n,s,l)){var c=void 0;if(!_.isEmpty(e))for(var u=0,d=e;u<d.length;u++){var m=d[u];c=s.findDashboardContract(m),c&&(c.permissions=p,t=_.union(t,c.reportIds))}var f=void 0;if(!_.isEmpty(t))for(var h=0,g=t;h<g.length;h++){var v=g[h];f=n.findReportContract(v),f&&(f.permissions=p)}}}function i(e,t,i,o,r,s,l,c){var u=c.findPackageContract(o);return!!a(u)&&n(e,t,i,u.id,r,s,l)}function a(e){return!(!e||e.packageType!==r.AppInstance)&&!(!e.contentProviderId&&!e.serviceContentProviderId)}function n(e,t,i,o,r,a,n){return!(_.isEmpty(e)&&_.isEmpty(t)&&_.isEmpty(i))&&(c(i,o,r)&&l(t,o,a)&&s(e,o,n))}function s(e,t,i){if(!_.isEmpty(e)){var o=_.uniq(e),r=_.filter(i.dashboards,(function(e){return e.contract&&e.contract.originalPackageId===t&&_.includes(o,e.id)}));if(_.isEmpty(r)||r.length!==o.length)return!1}return!0}function l(e,t,i){if(!_.isEmpty(e)){var o=_.uniq(e),r=_.filter(i.reports,(function(e){return e.packageId===t&&_.includes(o,e.id)}));if(_.isEmpty(r)||r.length!==o.length)return!1}return!0}function c(e,t,i){if(!_.isEmpty(e)){var o=_.uniq(e),r=_.filter(i.models,(function(e){return e.packageId===t&&_.includes(o,e.id)}));if(_.isEmpty(r)||r.length!==o.length)return!1}return!0}function u(e,t){return 8===t?o.hasFlag(e,6):o.hasFlag(e,6)}function d(e){return jsCommon.EnumExtensions.hasFlag(e,2)}var p=17;e.markDashboardAndReportsAsCopyableIfPartOfTemplateInstance=t,e.areArtifactsFromTemplateInstance=i,e.isPackageTemplateInstance=a,e.canReshare=u,e.hasWriteFlag=d})(i=t.PermissionsUtils||(t.PermissionsUtils={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e.syncServiceDashboardEditedEvent={name:"syncServiceDashboardEdited",type:4},e.syncServiceDashboardDeepEditedEvent={name:"syncServiceDashboardDeepEdited",type:4},e.syncServiceTilesAddedOrUpdated={name:"syncServiceTilesAddedOrUpdated",type:4},e.syncServiceCustomTilesUpdate={name:"syncServiceCustomTilesUpdate",type:4},e.syncServiceTileDeleted={name:"syncServiceTileDeleted",type:4}})(t=e.events||(e.events={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){function o(e,t,i,o,r,a,n,s,l,c,u,p){return new d(e,t,i,o,r,a,n,s,l,c,u,p)}var r=jsCommon.ArrayExtensions,a=jsCommon.GzipUtility,n=jsCommon.JsonExtensions,s=jsCommon.PerfTimer,l=t.contracts.TileType,c=jsCommon.Utility,u=jsCommon.Version;i.createTileModelConverter=o;var d=(function(){function o(e,t,i,o,r,a,n,s,l,c,u,d){this.geolocationService=e,this.telemetryService=t,this.visualPlugins=i,this.visualPluginOps=o,this.featureSwitchService=r,this.geocoder=a,this.promiseFactory=n,this.moduleLoader=s,this.tileConfigUpgraderService=l,this.explorationSerializer=c,this.themeService=u,this.authenticationService=d}return o.prototype.convertCompositeTile=function(o){if(!o||o.type!==l.composite)return null;var r=this.convertTileConfig(o);this.convertTileLayoutConfig(o);var a;if(!r||!r.visualContainer)return null;a=new i.SingleVisualCompositeTileModel(o,this.visualPlugins,this.visualPluginOps,this.featureSwitchService,this.geolocationService,this.geocoder,this.promiseFactory,this.moduleLoader,this.telemetryService,this.themeService,this.authenticationService),a.config=r.visualContainer,a.displayText=o.displayText,a.subDisplayText=o.subDisplayText;var n=t.ContractUtils.getMasterLayoutPosition(o);if(a.size={rowSpan:n.height,colSpan:n.width},a.isLoading=i.TileFactory.isTileLoading(o),o.queryResultError){a.isError=!0;var s=o.queryResultError;this.telemetryService.logEvent(e.telemetry.DashboardTileError,l[l.composite],jsCommon.StringExtensions.format("{0}:{1} with rootActivityId:{2}, modelId:{3} and tileId:{4}",jsCommon.EnumExtensions.toString(t.contracts.QueryResultErrorType,s.type),s.errorDetail,s.rootActivityId,o.modelId.toString(),o.id.toString()));var c=t.TileUtils.getTileErrorDetailsFromQueryResultError(s);c?(a.errorDetails=c,a.errorText=c.message):a.errorText=e.common.localize.get("Tile_ErrorText")}return a},o.prototype.convertTileData=function(t){if(t.tileDataSet)return t.tileDataSet;var i=this.convertTileConfig(t);try{t.tileDataSet=this.parseTileData(t,i.tileDataType)}catch(i){throw this.telemetryService.logEvent(e.telemetry.DashboardTileError,l[l.composite],jsCommon.StringExtensions.format("DsrParseError:{0} with modelId:{1} and tileId:{2}",i.message,t.modelId.toString(),t.id.toString())),c.ensureError(i)}return t.tileDataSet},o.prototype.convertTileConfig=function(e){var t=e.$config;if(!t){var i=s.start("Parse tile config");try{t=e.$config=this.deserializeTileConfig(e.config);var o=t.visualContainer||t.realTimeVisual;this.deserializeVisualContainer(o);var r=o||t.visual;this.deserializeModelExtensions(r),this.tileConfigUpgraderService.upgrade(e.id,t,e.query)}catch(e){}finally{i()}}return t},o.prototype.convertTileLayoutConfig=function(e){if(!e.$layoutConfig){var t={x:e.col,y:e.row,width:e.colSpan,height:e.rowSpan},i=void 0;if(e.layoutConfig)try{i=JSON.parse(e.layoutConfig);r.extendWithId(i.layouts).withId(0).position=t}catch(e){}else i={layouts:[{id:0,position:t}]};e.$layoutConfig=i,
e.layoutConfig=JSON.stringify(i)}return e.$layoutConfig},o.prototype.deserializeTileConfig=function(e){var t=n.tryParseJSON(e);return null==t&&(t={version:u.ZeroStr}),t},o.prototype.deserializeVisualContainer=function(e){e&&e.visualContainer&&!e.$visualContainer&&(e.$visualContainer=this.explorationSerializer.deserializeCanvasItem(e.visualContainer))},o.prototype.deserializeModelExtensions=function(e){e&&e.modelExtensions&&!e.$modelExtensions&&(e.$modelExtensions=this.explorationSerializer.deserializeModelExtensions(e.modelExtensions))},o.prototype.parseTileData=function(e,t){var i,o=s.start("Parse tile data");try{if(e.tileDataBinaryBase64Encoded){var r=a.uncompress(e.tileDataBinaryBase64Encoded);i=JSON.parse(r)}else e.tileData&&(i=JSON.parse(e.tileData));return{type:t,data:i}}finally{o()}},o})()})(i=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));;"use strict";var __awaiter=this&&this.__awaiter||function(e,t,r,o){return new(r||(r=Promise))(function(i,a){function n(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(n,s)}c((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function r(e){return function(t){return o([e,t])}}function o(r){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(n=2&r[0]?a.return:r[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,r[1])).done)return n;switch(a=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,a=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(n=c.trys,!(n=n.length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){c.label=r[1];break}if(6===r[0]&&c.label<n[1]){c.label=n[1],n=r;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(r);break}n[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],a=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var i,a,n,s,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},powerbi;!(function(e){var t;!(function(t){function r(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m){var g=t.CustomerAction(o,i,a,n,s,c,d,l,u,p,h,v,f,m),b=W(g.info,{reportType:r});return{name:t.DashboardRenameReportEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({reportType:b.reportType},null,g.formatted())},info:b,loggers:t.DashboardRenameReportLoggers}}function o(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m,g,b){var y=t.CustomerAction(a,n,s,c,d,l,u,p,h,v,f,m,g,b),S=W(y.info,{reportType:r,reportId:o,reportObjectId:i});return{name:t.DashboardDeleteReportEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({reportType:S.reportType,reportId:S.reportId,reportObjectId:S.reportObjectId},null,y.formatted())},info:S,loggers:t.DashboardDeleteReportLoggers}}function i(r,o,i,a,n,s,c,d,l,u,p,h,v,f){var m=t.Verbose(r,o,i,a,n,s,c,d,l,u,p,h,v,f),g=W(m.info,{});return{name:t.DashboardInitializeNavigationPaneReportsEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,m.formatted())},info:g,loggers:t.DashboardInitializeNavigationPaneReportsLoggers}}function a(r,o,i,a,n,s,c,d,l,u,p,h,v,f){var m=t.Verbose(r,o,i,a,n,s,c,d,l,u,p,h,v,f),g=W(m.info,{});return{name:t.DashboardInitializeNavigationPaneModelsEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,m.formatted())},info:g,loggers:t.DashboardInitializeNavigationPaneModelsLoggers}}function n(r,o,i,a,n,s,c,d,l,u,p,h,v,f){var m=t.CustomerAction(r,o,i,a,n,s,c,d,l,u,p,h,v,f),g=W(m.info,{});return{name:t.DashboardRenameDatasetEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,m.formatted())},info:g,loggers:t.DashboardRenameDatasetLoggers}}function s(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m,g){var b=t.CustomerAction(i,a,n,s,c,d,l,u,p,h,v,f,m,g),y=W(b.info,{cortanaValue:r,qnaValue:o});return{name:t.DashboardUpdateModelQnaFeaturesEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({cortanaValue:y.cortanaValue,qnaValue:y.qnaValue},null,b.formatted())},info:y,loggers:t.DashboardUpdateModelQnaFeaturesLoggers}}function c(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m){var g=t.CustomerAction(o,i,a,n,s,c,d,l,u,p,h,v,f,m),b=W(g.info,{count:r});return{name:t.DashboardUpdateFeaturedQuestionsEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({count:b.count},null,g.formatted())},info:b,loggers:t.DashboardUpdateFeaturedQuestionsLoggers}}function d(r,o,i,a,n,s,c,d,l,u,p,h,v,f){var m=t.CustomerAction(r,o,i,a,n,s,c,d,l,u,p,h,v,f),g=W(m.info,{});return{name:t.DashboardDeleteDatasetEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,m.formatted())},info:g,loggers:t.DashboardDeleteDatasetLoggers}}function l(r,o,i,a,n,s,c,d,l,u,p,h,v,f){var m=t.CustomerAction(r,o,i,a,n,s,c,d,l,u,p,h,v,f),g=W(m.info,{});return{name:t.DashboardAddUpdateDashboardEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,m.formatted())},info:g,loggers:t.DashboardAddUpdateDashboardLoggers}}function u(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m,g,b){var y=t.Verbose(a,n,s,c,d,l,u,p,h,v,f,m,g,b),S=W(y.info,{numNewUnseenSharedDashboards:r,numSharedDashboards:o,numAllDashboards:i});return{name:t.DashboardSharingNewUnseenDashboardsEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({numNewUnseenSharedDashboards:S.numNewUnseenSharedDashboards,numSharedDashboards:S.numSharedDashboards,numAllDashboards:S.numAllDashboards},null,y.formatted())},info:S,loggers:t.DashboardSharingNewUnseenDashboardsLoggers}}function p(r,o,i,a,n,s,c,d,l,u,p,h,v,f){var m=t.Verbose(r,o,i,a,n,s,c,d,l,u,p,h,v,f),g=W(m.info,{});return{name:t.DashboardInitializeNavigationPaneWorkbooksEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,m.formatted())},info:g,loggers:t.DashboardInitializeNavigationPaneWorkbooksLoggers}}function h(r,o,i,a,n,s,c,d,l,u,p,h,v,f){var m=t.CustomerAction(r,o,i,a,n,s,c,d,l,u,p,h,v,f),g=W(m.info,{});return{name:t.DashboardUpdateLocalWorkbookNeverShowExplanationEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,m.formatted())},info:g,loggers:t.DashboardUpdateLocalWorkbookNeverShowExplanationLoggers}}function v(r,o,i,a,n,s,c,d,l,u,p,h,v,f){var m=t.CustomerAction(r,o,i,a,n,s,c,d,l,u,p,h,v,f),g=W(m.info,{});return{name:t.DashboardRenameWorkbookEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,m.formatted())},info:g,loggers:t.DashboardRenameWorkbookLoggers}}function f(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m,g){var b=t.CustomerAction(i,a,n,s,c,d,l,u,p,h,v,f,m,g),y=W(b.info,{storageProvider:r,contentProvider:o});return{name:t.DashboardRemoveWorkbookEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({storageProvider:y.storageProvider,contentProvider:y.contentProvider},null,b.formatted())},info:y,loggers:t.DashboardRemoveWorkbookLoggers}}function m(r,o,i,a,n,s,c,d,l,u,p,h,v,f){var m=t.CustomerAction(r,o,i,a,n,s,c,d,l,u,p,h,v,f),g=W(m.info,{});return{name:t.DashboardGetWorkbookWopiAccessInformationEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,m.formatted())},info:g,loggers:t.DashboardGetWorkbookWopiAccessInformationLoggers}}function g(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m,g,b,y,S){var D=t.Verbose(s,c,d,l,u,p,h,v,f,m,g,b,y,S),k=W(D.info,{etagHash:r,correlationId:o,storageProvider:i,permissions:a,contentProvider:n});return{name:t.DashboardWorkbookEmbeddingExternalSuccessEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({etagHash:k.etagHash,correlationId:k.correlationId,storageProvider:k.storageProvider,permissions:k.permissions,contentProvider:k.contentProvider},null,D.formatted())},info:k,loggers:t.DashboardWorkbookEmbeddingExternalSuccessLoggers}}function b(r,o,i,a,n,s,c,d){var l={etagHash:r,errorCode:o,errorDescription:i,correlationId:a,storageProvider:n,permissions:s,contentProvider:c,message:d};return{name:t.DashboardWorkbookEmbeddingExternalFailureEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({etagHash:l.etagHash,errorCode:l.errorCode,errorDescription:l.errorDescription,correlationId:l.correlationId,storageProvider:l.storageProvider,permissions:l.permissions,contentProvider:l.contentProvider,message:l.message},null)},info:l,loggers:t.DashboardWorkbookEmbeddingExternalFailureLoggers}}function y(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m,g){var b=t.Verbose(i,a,n,s,c,d,l,u,p,h,v,f,m,g),y=W(b.info,{dashboardId:r,resourcePackagesCount:o});return{name:t.DashboardImportResourcePackagesOnLoadEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({dashboardId:y.dashboardId,resourcePackagesCount:y.resourcePackagesCount},null,b.formatted())},info:y,loggers:t.DashboardImportResourcePackagesOnLoadLoggers}}function S(r,o,i,a,n,s,c,d,l,u,p,h,v,f){var m=t.Verbose(r,o,i,a,n,s,c,d,l,u,p,h,v,f),g=W(m.info,{});return{name:t.DashboardGetNavigationPanePackageEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,m.formatted())},info:g,loggers:t.DashboardGetNavigationPanePackageLoggers}}function D(r,o,i,a){var n={Id:r,packageId:o,objectType:i,message:a};return{name:t.PermissionsObjectNotFoundEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({Id:n.Id,packageId:n.packageId,objectType:n.objectType,message:n.message},null)},info:n,loggers:t.PermissionsObjectNotFoundLoggers}}function k(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m){var g=t.Verbose(o,i,a,n,s,c,d,l,u,p,h,v,f,m),b=W(g.info,{appType:r});return{name:t.AppsGetAppEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({appType:b.appType},null,g.formatted())},info:b,loggers:t.AppsGetAppLoggers}}function E(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m,g){var b=t.CustomerAction(i,a,n,s,c,d,l,u,p,h,v,f,m,g),y=W(b.info,{appGUID:r,contentProviderCategory:o});return{name:t.AppsUninstallAppEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({appGUID:y.appGUID,contentProviderCategory:y.contentProviderCategory},null,b.formatted())},info:y,loggers:t.AppsUninstallAppLoggers}}function I(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m){var g=t.Verbose(o,i,a,n,s,c,d,l,u,p,h,v,f,m),b=W(g.info,{error:r});return{name:t.TileConfigUpgradeTileConfigEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({error:b.error},null,g.formatted())},info:b,loggers:t.TileConfigUpgradeTileConfigLoggers}}function C(r,o,i,a,n,s,c,d,l,u,p,h,v,f){var m=t.Verbose(r,o,i,a,n,s,c,d,l,u,p,h,v,f),g=W(m.info,{});return{name:t.AppServiceGetOrgAppsMetadataEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,m.formatted())},info:g,loggers:t.AppServiceGetOrgAppsMetadataLoggers}}function w(r){var o={requestType:r};return{name:t.EmailSubscriptionsRequestEventName,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({requestType:o.requestType},null)},info:o,loggers:t.EmailSubscriptionsRequestLoggers}}function P(){var r={};return{name:t.InstantEmailRequestEventName,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null)},info:r,loggers:t.InstantEmailRequestLoggers}}function T(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m,g){var b=t.CustomerAction(i,a,n,s,c,d,l,u,p,h,v,f,m,g),y=W(b.info,{flyoutOperationType:r,navigatedToMobileDashboard:o});return{name:t.MobileAuthoringDashboardOpenedFromFlyoutEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({flyoutOperationType:y.flyoutOperationType,navigatedToMobileDashboard:y.navigatedToMobileDashboard},null,b.formatted())},info:y,loggers:t.MobileAuthoringDashboardOpenedFromFlyoutLoggers}}function M(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m,g,b){var y=t.CustomerAction(a,n,s,c,d,l,u,p,h,v,f,m,g,b),S=W(y.info,{artifactId:r,artifactType:o,isVisible:i});return{name:t.PermissionsUpdateArtifactVisibilityEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({artifactId:S.artifactId,artifactType:S.artifactType,isVisible:S.isVisible},null,y.formatted())},info:S,loggers:t.PermissionsUpdateArtifactVisibilityLoggers}}function A(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m){var g=t.CustomerAction(o,i,a,n,s,c,d,l,u,p,h,v,f,m),b=W(g.info,{datapoolGuid:r});return{info:b,formatted:function(){return e.extendFormatted({datapoolGuid:b.datapoolGuid},null,g.formatted())}}}function F(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m){var g=A(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m),b=W(g.info,{});return{name:t.DatapoolDeleteDatapoolEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,g.formatted())},info:b,loggers:t.DatapoolDeleteDatapoolLoggers}}function R(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m){var g=A(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m),b=W(g.info,{});return{name:t.DatapoolUpdatePropertiesEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,g.formatted())},info:b,loggers:t.DatapoolUpdatePropertiesLoggers}}function N(r,o,i,a,n,s,c,d,l,u,p,h,v,f){var m=t.CustomerAction(r,o,i,a,n,s,c,d,l,u,p,h,v,f),g=W(m.info,{});return{name:t.DatasetOnDemandSmartAlertsEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,m.formatted())},info:g,loggers:t.DatasetOnDemandSmartAlertsLoggers}}function _(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m,g){var b=t.Verbose(i,a,n,s,c,d,l,u,p,h,v,f,m,g),y=W(b.info,{operation:r,count:o});return{name:t.HttpRequestThrottledEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({operation:y.operation,count:y.count},null,b.formatted())},info:y,loggers:t.HttpRequestThrottledLoggers}}function U(r,o,i,a,n,s,c,d,l,u,p,h,v,f){var m=t.Verbose(r,o,i,a,n,s,c,d,l,u,p,h,v,f),g=W(m.info,{});return{name:t.DatasetGetSharedDatasetsEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,m.formatted())},info:g,loggers:t.DatasetGetSharedDatasetsLoggers}}function O(r,o,i,a,n,s,c,d,l,u,p,h,v,f,m,g){var b=t.Verbose(i,a,n,s,c,d,l,u,p,h,v,f,m,g),y=W(b.info,{previousTenantIdOnWindow:r,previousTenantIdFromAppMetadata:o});return{name:t.UserInfoPreviousTenantIdEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({previousTenantIdOnWindow:y.previousTenantIdOnWindow,previousTenantIdFromAppMetadata:y.previousTenantIdFromAppMetadata},null,b.formatted())},info:y,loggers:t.UserInfoPreviousTenantIdLoggers}}var x,L=jsCommon.Utility,W=jsCommon.UnionExtensions.mergeUnionType,j=e.telemetry.EventFactories;x=L?L.generateGuid:Function.prototype,t.DashboardRenameReportEventName="PBI.Dashboard.RenameReport",t.DashboardRenameReport=r,j[t.DashboardRenameReportEventName]=function(r){return e.telemetryEventFactory(t.DashboardRenameReportEventName,r,t.DashboardRenameReportLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.DashboardDeleteReportEventName="PBI.Dashboard.DeleteReport",t.DashboardDeleteReport=o,j[t.DashboardDeleteReportEventName]=function(r){return e.telemetryEventFactory(t.DashboardDeleteReportEventName,r,t.DashboardDeleteReportLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.DashboardInitializeNavigationPaneReportsEventName="PBI.Dashboard.InitializeNavigationPaneReports",t.DashboardInitializeNavigationPaneReports=i,j[t.DashboardInitializeNavigationPaneReportsEventName]=function(r){return e.telemetryEventFactory(t.DashboardInitializeNavigationPaneReportsEventName,r,t.DashboardInitializeNavigationPaneReportsLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.DashboardInitializeNavigationPaneModelsEventName="PBI.Dashboard.InitializeNavigationPaneModels",t.DashboardInitializeNavigationPaneModels=a,j[t.DashboardInitializeNavigationPaneModelsEventName]=function(r){return e.telemetryEventFactory(t.DashboardInitializeNavigationPaneModelsEventName,r,t.DashboardInitializeNavigationPaneModelsLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.DashboardRenameDatasetEventName="PBI.Dashboard.RenameDataset",t.DashboardRenameDataset=n,j[t.DashboardRenameDatasetEventName]=function(r){return e.telemetryEventFactory(t.DashboardRenameDatasetEventName,r,t.DashboardRenameDatasetLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.DashboardUpdateModelQnaFeaturesEventName="PBI.Dashboard.UpdateModelQnaFeatures",t.DashboardUpdateModelQnaFeatures=s,j[t.DashboardUpdateModelQnaFeaturesEventName]=function(r){return e.telemetryEventFactory(t.DashboardUpdateModelQnaFeaturesEventName,r,t.DashboardUpdateModelQnaFeaturesLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.DashboardUpdateFeaturedQuestionsEventName="PBI.Dashboard.UpdateFeaturedQuestions",t.DashboardUpdateFeaturedQuestions=c,j[t.DashboardUpdateFeaturedQuestionsEventName]=function(r){return e.telemetryEventFactory(t.DashboardUpdateFeaturedQuestionsEventName,r,t.DashboardUpdateFeaturedQuestionsLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.DashboardDeleteDatasetEventName="PBI.Dashboard.DeleteDataset",t.DashboardDeleteDataset=d,j[t.DashboardDeleteDatasetEventName]=function(r){return e.telemetryEventFactory(t.DashboardDeleteDatasetEventName,r,t.DashboardDeleteDatasetLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.DashboardAddUpdateDashboardEventName="PBI.Dashboard.AddUpdateDashboard",t.DashboardAddUpdateDashboard=l,j[t.DashboardAddUpdateDashboardEventName]=function(r){return e.telemetryEventFactory(t.DashboardAddUpdateDashboardEventName,r,t.DashboardAddUpdateDashboardLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.DashboardSharingNewUnseenDashboardsEventName="PBI.Dashboard.SharingNewUnseenDashboards",t.DashboardSharingNewUnseenDashboards=u,j[t.DashboardSharingNewUnseenDashboardsEventName]=function(r){return e.telemetryEventFactory(t.DashboardSharingNewUnseenDashboardsEventName,r,t.DashboardSharingNewUnseenDashboardsLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.DashboardInitializeNavigationPaneWorkbooksEventName="PBI.Dashboard.InitializeNavigationPaneWorkbooks",t.DashboardInitializeNavigationPaneWorkbooks=p,j[t.DashboardInitializeNavigationPaneWorkbooksEventName]=function(r){return e.telemetryEventFactory(t.DashboardInitializeNavigationPaneWorkbooksEventName,r,t.DashboardInitializeNavigationPaneWorkbooksLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.DashboardUpdateLocalWorkbookNeverShowExplanationEventName="PBI.Dashboard.UpdateLocalWorkbookNeverShowExplanation",t.DashboardUpdateLocalWorkbookNeverShowExplanation=h,j[t.DashboardUpdateLocalWorkbookNeverShowExplanationEventName]=function(r){return e.telemetryEventFactory(t.DashboardUpdateLocalWorkbookNeverShowExplanationEventName,r,t.DashboardUpdateLocalWorkbookNeverShowExplanationLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.DashboardRenameWorkbookEventName="PBI.Dashboard.RenameWorkbook",t.DashboardRenameWorkbook=v,j[t.DashboardRenameWorkbookEventName]=function(r){return e.telemetryEventFactory(t.DashboardRenameWorkbookEventName,r,t.DashboardRenameWorkbookLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.DashboardRemoveWorkbookEventName="PBI.Dashboard.RemoveWorkbook",t.DashboardRemoveWorkbook=f,j[t.DashboardRemoveWorkbookEventName]=function(r){return e.telemetryEventFactory(t.DashboardRemoveWorkbookEventName,r,t.DashboardRemoveWorkbookLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.DashboardGetWorkbookWopiAccessInformationEventName="PBI.Dashboard.GetWorkbookWopiAccessInformation",t.DashboardGetWorkbookWopiAccessInformation=m,j[t.DashboardGetWorkbookWopiAccessInformationEventName]=function(r){return e.telemetryEventFactory(t.DashboardGetWorkbookWopiAccessInformationEventName,r,t.DashboardGetWorkbookWopiAccessInformationLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.DashboardWorkbookEmbeddingExternalSuccessEventName="PBI.Dashboard.WorkbookEmbeddingExternalSuccess",t.DashboardWorkbookEmbeddingExternalSuccess=g,j[t.DashboardWorkbookEmbeddingExternalSuccessEventName]=function(r){return e.telemetryEventFactory(t.DashboardWorkbookEmbeddingExternalSuccessEventName,r,t.DashboardWorkbookEmbeddingExternalSuccessLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.DashboardWorkbookEmbeddingExternalFailureEventName="PBI.Dashboard.WorkbookEmbeddingExternalFailure",t.DashboardWorkbookEmbeddingExternalFailure=b,j[t.DashboardWorkbookEmbeddingExternalFailureEventName]=function(r){return e.telemetryEventFactory(t.DashboardWorkbookEmbeddingExternalFailureEventName,r,t.DashboardWorkbookEmbeddingExternalFailureLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},t.DashboardImportResourcePackagesOnLoadEventName="PBI.Dashboard.ImportResourcePackagesOnLoad",t.DashboardImportResourcePackagesOnLoad=y,j[t.DashboardImportResourcePackagesOnLoadEventName]=function(r){return e.telemetryEventFactory(t.DashboardImportResourcePackagesOnLoadEventName,r,t.DashboardImportResourcePackagesOnLoadLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.DashboardGetNavigationPanePackageEventName="PBI.Dashboard.GetNavigationPanePackage",t.DashboardGetNavigationPanePackage=S,j[t.DashboardGetNavigationPanePackageEventName]=function(r){return e.telemetryEventFactory(t.DashboardGetNavigationPanePackageEventName,r,t.DashboardGetNavigationPanePackageLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.PermissionsObjectNotFoundEventName="PBI.Permissions.ObjectNotFound",t.PermissionsObjectNotFound=D,j[t.PermissionsObjectNotFoundEventName]=function(r){return e.telemetryEventFactory(t.PermissionsObjectNotFoundEventName,r,t.PermissionsObjectNotFoundLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},t.AppsGetAppEventName="PBI.Apps.GetApp",t.AppsGetApp=k,j[t.AppsGetAppEventName]=function(r){return e.telemetryEventFactory(t.AppsGetAppEventName,r,t.AppsGetAppLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.AppsUninstallAppEventName="PBI.Apps.UninstallApp",t.AppsUninstallApp=E,j[t.AppsUninstallAppEventName]=function(r){return e.telemetryEventFactory(t.AppsUninstallAppEventName,r,t.AppsUninstallAppLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.TileConfigUpgradeTileConfigEventName="PBI.TileConfig.UpgradeTileConfig",t.TileConfigUpgradeTileConfig=I,j[t.TileConfigUpgradeTileConfigEventName]=function(r){return e.telemetryEventFactory(t.TileConfigUpgradeTileConfigEventName,r,t.TileConfigUpgradeTileConfigLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.AppServiceGetOrgAppsMetadataEventName="PBI.AppService.GetOrgAppsMetadata",t.AppServiceGetOrgAppsMetadata=C,j[t.AppServiceGetOrgAppsMetadataEventName]=function(r){return e.telemetryEventFactory(t.AppServiceGetOrgAppsMetadataEventName,r,t.AppServiceGetOrgAppsMetadataLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.EmailSubscriptionsRequestEventName="PBI.EmailSubscriptions.Request",t.EmailSubscriptionsRequest=w,j[t.EmailSubscriptionsRequestEventName]=function(r){return e.telemetryEventFactory(t.EmailSubscriptionsRequestEventName,r,t.EmailSubscriptionsRequestLoggers,void 0,void 0,void 0,void 0,void 0,null)},t.InstantEmailRequestEventName="PBI.InstantEmail.Request",t.InstantEmailRequest=P,j[t.InstantEmailRequestEventName]=function(r){return e.telemetryEventFactory(t.InstantEmailRequestEventName,r,t.InstantEmailRequestLoggers,void 0,void 0,void 0,void 0,void 0,null)},t.MobileAuthoringDashboardOpenedFromFlyoutEventName="PBI.MobileAuthoring.DashboardOpenedFromFlyout",t.MobileAuthoringDashboardOpenedFromFlyout=T,j[t.MobileAuthoringDashboardOpenedFromFlyoutEventName]=function(r){return e.telemetryEventFactory(t.MobileAuthoringDashboardOpenedFromFlyoutEventName,r,t.MobileAuthoringDashboardOpenedFromFlyoutLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.PermissionsUpdateArtifactVisibilityEventName="PBI.Permissions.UpdateArtifactVisibility",t.PermissionsUpdateArtifactVisibility=M,j[t.PermissionsUpdateArtifactVisibilityEventName]=function(r){return e.telemetryEventFactory(t.PermissionsUpdateArtifactVisibilityEventName,r,t.PermissionsUpdateArtifactVisibilityLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.BaseDatapoolEventEventName="BaseDatapoolEvent",t.BaseDatapoolEvent=A,j[t.BaseDatapoolEventEventName]=function(r){return e.telemetryEventFactory(void 0,r,void 0,t.CustomerActionEventName,void 0,void 0,void 0,void 0,null)},t.DatapoolDeleteDatapoolEventName="PBI.Datapool.DeleteDatapool",t.DatapoolDeleteDatapool=F,j[t.DatapoolDeleteDatapoolEventName]=function(r){return e.telemetryEventFactory(t.DatapoolDeleteDatapoolEventName,r,t.DatapoolDeleteDatapoolLoggers,t.BaseDatapoolEventEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.DatapoolUpdatePropertiesEventName="PBI.Datapool.UpdateProperties",t.DatapoolUpdateProperties=R,j[t.DatapoolUpdatePropertiesEventName]=function(r){return e.telemetryEventFactory(t.DatapoolUpdatePropertiesEventName,r,t.DatapoolUpdatePropertiesLoggers,t.BaseDatapoolEventEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.DatasetOnDemandSmartAlertsEventName="PBI.Dataset.OnDemandSmartAlerts",t.DatasetOnDemandSmartAlerts=N,j[t.DatasetOnDemandSmartAlertsEventName]=function(r){return e.telemetryEventFactory(t.DatasetOnDemandSmartAlertsEventName,r,t.DatasetOnDemandSmartAlertsLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.HttpRequestThrottledEventName="PBI.Http.RequestThrottled",t.HttpRequestThrottled=_,j[t.HttpRequestThrottledEventName]=function(r){return e.telemetryEventFactory(t.HttpRequestThrottledEventName,r,t.HttpRequestThrottledLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.DatasetGetSharedDatasetsEventName="PBI.Dataset.GetSharedDatasets",t.DatasetGetSharedDatasets=U,j[t.DatasetGetSharedDatasetsEventName]=function(r){return e.telemetryEventFactory(t.DatasetGetSharedDatasetsEventName,r,t.DatasetGetSharedDatasetsLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.UserInfoPreviousTenantIdEventName="PBI.UserInfo.PreviousTenantId",t.UserInfoPreviousTenantId=O,j[t.UserInfoPreviousTenantIdEventName]=function(r){return e.telemetryEventFactory(t.UserInfoPreviousTenantIdEventName,r,t.UserInfoPreviousTenantIdLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)}})(t=e.telemetry||(e.telemetry={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){function t(e){var t=i.tryParseJSON(e.layoutConfig),r=o.extendWithId(t.layouts).withId(0);e.col=r.position.x,e.row=r.position.y,e.colSpan=r.position.width,e.rowSpan=r.position.height}function r(e){for(var t=0,r=e;t<r.length;t++){var a=r[t],n=i.tryParseJSON(a.layoutConfig),s=o.extendWithId(n.layouts).withId(0);a.col=s.position.x,a.row=s.position.y,a.colSpan=s.position.width,a.rowSpan=s.position.height}}var o=jsCommon.ArrayExtensions,i=jsCommon.JsonExtensions;e.conformOutgoingTile=t,e.conformOutgoingTileLayoutDescriptors=r})(t=e.compatibility||(e.compatibility={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){function t(e){return new r(e)}e.createSmartAlertsHttpService=t;var r=(function(){function e(e){this.httpService=e,this.endpoint="metadata/smartalerts"}return e.prototype.onDemandSmartAlerts=function(e,t){var r=this.httpService.powerbiRequestOptions(t,"onDemandSmartAlerts");return this.httpService.post(this.endpoint,JSON.stringify(e),r)},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r){return new n(e,t,r)}var o=jsCommon.StringExtensions,i="EmailSubscriptionLicensingCheckFailed",a="EmailSubscriptionDisabledByTenantAdmin";t.createSubscriptionsHttpService=r;var n=(function(){function t(e,t,r){this.httpService=e,this.promiseFactory=t,this.telemetryService=r,this.endpoint="metadata/emailsubscriptions"}return t.prototype.createSubscription=function(t,r){var o=this,i=this.promiseFactory.defer(),a=this.telemetryService.startChildEvent(r,e.telemetry.EmailSubscriptionsRequest,"Create");return this.httpService.post(this.endpoint,t,this.httpService.powerbiRequestOptions()).then((function(e){a.resolve(),i.resolve(e.data)}),(function(r){var n=e.errorDetailsHelper.getTelemetryErrorDetails(r.error);a.reject(n);var s=e.errorDetailsHelper.getErrorCode(r),c=o.getPBIErrorDetails(r);i.reject({ErrorCode:s,RequestId:r.requestId,PBIErrorDetails:c,SubscriptionObjectId:t.objectId})})),i.promise},t.prototype.runSubscription=function(t,r){return __awaiter(this,void 0,e.Promise,(function(){var o,i,a,n,s,c,d,l;return __generator(this,(function(u){switch(u.label){case 0:o=this.promiseFactory.defer(),i=this.telemetryService.startChildEvent(r,e.telemetry.InstantEmailRequest),a=this.endpoint+"/instant",u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.httpService.post(a,t,this.httpService.powerbiRequestOptions())];case 2:return n=u.sent(),i.resolve(),o.resolve(n.data),[3,4];case 3:return s=u.sent(),c=e.errorDetailsHelper.getTelemetryErrorDetails(s.error),i.reject(c),d=e.errorDetailsHelper.getErrorCode(s),l=this.getPBIErrorDetails(s),o.reject({ErrorCode:d,RequestId:s.requestId,PBIErrorDetails:l}),[3,4];case 4:return[2,o.promise]}}))}))},t.prototype.getAllSubscriptions=function(t){var r=this,o=this.promiseFactory.defer(),i=this.telemetryService.startChildEvent(t,e.telemetry.EmailSubscriptionsRequest,"Get");return this.httpService.get(this.endpoint,this.httpService.powerbiRequestOptions()).then((function(e){i.resolve(),o.resolve(e.data)}),(function(t){var a=e.errorDetailsHelper.getTelemetryErrorDetails(t.error);i.reject(a);var n=e.errorDetailsHelper.getErrorCode(t),s=r.getPBIErrorDetails(t);o.reject({ErrorCode:n,RequestId:t.requestId,PBIErrorDetails:s})})),o.promise},t.prototype.updateSubscription=function(t,r){var o=this,i=this.promiseFactory.defer(),a=this.telemetryService.startChildEvent(r,e.telemetry.EmailSubscriptionsRequest,"Update");return this.httpService.put(this.endpoint,t,this.httpService.powerbiRequestOptions()).then((function(e){a.resolve(),i.resolve(e.data)}),(function(r){var n=e.errorDetailsHelper.getTelemetryErrorDetails(r.error);a.reject(n);var s=e.errorDetailsHelper.getErrorCode(r),c=o.getPBIErrorDetails(r);i.reject({ErrorCode:s,RequestId:r.requestId,PBIErrorDetails:c,SubscriptionObjectId:t.objectId})})),i.promise},t.prototype.deleteSubscription=function(t,r){var i=this,a=this.promiseFactory.defer(),n=this.telemetryService.startChildEvent(r,e.telemetry.EmailSubscriptionsRequest,"Delete"),s=this.endpoint+"/{0}";return this.httpService.delete(o.format(s,t.toString()),this.httpService.powerbiRequestOptions()).then((function(e){
n.resolve(),a.resolve(e.data)}),(function(r){var o=e.errorDetailsHelper.getTelemetryErrorDetails(r.error);n.reject(o);var s=e.errorDetailsHelper.getErrorCode(r),c=i.getPBIErrorDetails(r);a.reject({ErrorCode:s,RequestId:r.requestId,PBIErrorDetails:c,SubscriptionObjectId:t.toString()})})),a.promise},t.prototype.getReportSubscriptionHelper=function(t,r,i){var a=this,n=this.promiseFactory.defer(),s=this.telemetryService.startChildEvent(i,e.telemetry.EmailSubscriptionsRequest,"Get");return this.httpService.get(o.format(t,r.toString()),this.httpService.powerbiRequestOptions()).then((function(e){s.resolve(),n.resolve(e.data)}),(function(t){var r=e.errorDetailsHelper.getTelemetryErrorDetails(t.error);s.reject(r);var o=e.errorDetailsHelper.getErrorCode(t),i=a.getPBIErrorDetails(t);n.reject({ErrorCode:o,RequestId:t.requestId,PBIErrorDetails:i})})),n.promise},t.prototype.getReportSubscription=function(e,t){return this.getReportSubscriptionHelper("metadata/emailsubscriptions/report/{0}",e,t)},t.prototype.getRdlReportSubscription=function(e,t){return this.getReportSubscriptionHelper("metadata/emailsubscriptions/paginatedReport/{0}",e,t)},t.prototype.getDashboardSubscription=function(t,r){return __awaiter(this,void 0,e.Promise,(function(){var i,a,n,s,c,d,l,u;return __generator(this,(function(p){switch(p.label){case 0:i=this.promiseFactory.defer(),a="metadata/emailsubscriptions/dashboard/{0}",n=this.telemetryService.startChildEvent(r,e.telemetry.EmailSubscriptionsRequest,"Get"),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this.httpService.get(o.format(a,t.toString()),this.httpService.powerbiRequestOptions())];case 2:return s=p.sent(),n.resolve(),i.resolve(s.data),[3,4];case 3:return c=p.sent(),d=e.errorDetailsHelper.getTelemetryErrorDetails(c.error),n.reject(d),l=e.errorDetailsHelper.getErrorCode(c),u=this.getPBIErrorDetails(c),i.reject({ErrorCode:l,RequestId:c.requestId,PBIErrorDetails:u}),[3,4];case 4:return[2,i.promise]}}))}))},t.prototype.getPBIErrorDetails=function(e){var t="";if(e&&e.error){var r=e.error.code;r!==i&&r!==a||(t=e.error["pbi.error"].details[0].detail.value)}return t},t})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(){return new i}var o=e.common.contracts.ContentProviderCategory;t.createAppCollectionService=r;var i=(function(){function e(){this.apps=[]}return e.prototype.findServiceContentProvider=function(e){return _.find(this.apps,(function(t){return t.providerId===e&&(t.category===o.ServiceApp||t.category===o.Services)}))},e.prototype.findOrganizationalContentProvider=function(e){return _.find(this.apps,(function(t){return t.providerId===e&&(t.category===o.Organizational||t.category===o.OrganizationalApp||t.category===o.OrganizationalTemplate||t.category===o.OrganizationalTemplateApp)}))},e.prototype.findContentProviderByKey=function(e){if(null!=e)return _.find(this.apps,(function(t){return t.providerKey===e}))},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,o,i,a,n,s,d,l,u,p,h){return new c(e,t,r,o,i,a,n,s,d,l,u,p,h)}function o(e){return new d(e)}var i=e.common.contracts.ContentProviderCategory,a=e.common.dialog.MessageDialogBuilder,n=e.common.NotifyCollection,s=e.common.contracts.PackageType;t.createAppService=r;var c=(function(){function e(e,t,r,o,i,s,c,d,l,u,p,h,v){this.appMetadataService=e,this.dashboardDataService=t,this.appCollectionService=r,this.modelService=o,this.reportService=i,this.workbookService=s,this.promiseFactory=c,this.dataServiceModelConverter=d,this.modalDialogService=l,this.localizationService=u,this.appStore=p,this.dataServiceModelMerger=h,this.groupStore=v,this.apps=[],this.instances=new n,this.packageIdToAppMap={},this.messageDialogBuilder=new a(this.modalDialogService),this.appsAfterFolderSwitchDeferred=this.promiseFactory.defer()}return Object.defineProperty(e.prototype,"apps",{get:function(){return this.appCollectionService.apps},set:function(e){this.appCollectionService.apps=e},enumerable:!0,configurable:!0}),e.prototype.ensureAppsInitialization=function(){return null!=this.appsInitializationDeferred?this.appsInitializationDeferred.promise:this.getOrgAppsMetadata().promise},e.prototype.appsAfterFolderSwitchPromise=function(){return this.appsAfterFolderSwitchDeferred.promise},e.prototype.getAppByGUID=function(e){var t=_.find(this.appInstances,(function(t){return t.objectId===e}));return t&&t.providerContract},Object.defineProperty(e.prototype,"appInstances",{get:function(){return this.instances.items},enumerable:!0,configurable:!0}),e.prototype.onInstanceAdded=function(e){var t=this,r=this.promiseFactory;if(e.packageType!==s.AppInstance)return r.reject();var o=this.getAppInstance(e.id);return null!=o?r.resolve(o):this.appStore.loadMetadata(e.contentProviderRefId,e.id).then((function(e){return r.resolve(t.onAppAdded(e.App,_.find(e.packages,(function(e){return e.packageType===s.AppInstance}))))}))},e.prototype.onInstanceDeleted=function(e){var t=this.instances.deleteItems((function(t){return t.packageId===e}));if(!_.isEmpty(t)){this.appStore.remove(e);var r=this.getAppInstancesForApp(t[0].objectId);_.isEmpty(r)&&_.pull(this.apps,t[0].providerContract)}},e.prototype.deleteInstance=function(e){var t=this,r=this.getAppInstanceInternal(e);null==r||r.appPush||this.messageDialogBuilder.show("UninstallAppDialog",{titleText:this.localizationService.get("AppModel_UninstallAppTitle"),messageText:this.localizationService.get("AppModel_UninstallAppMessage"),okButtonText:this.localizationService.get("Delete"),cancelButtonText:this.localizationService.get("ModalDialogButtonText_Cancel")}).then((function(e){0===e&&t.deleteInstanceInternal(r)}))},e.prototype.getAppInstance=function(e){return this.getAppInstanceInternal(e)},e.prototype.getAppArtifact=function(e,t){var r=e.packageId;if(t.dashboardOriginalGUID){var o=t.dashboardOriginalGUID;return _.find(this.dashboardDataService.dashboards,(function(e){return e.contract.originalDashboardObjectId===o&&e.contract.originalPackageId===r}))}if(t.reportOriginalGUID){var i=t.reportOriginalGUID;return _.find(this.reportService.reports,(function(e){return e.contract.originalReportObjectId===i&&e.packageId===r}))}if(t.workbookID){var a=t.workbookID;return _.find(this.workbookService.workbooks,(function(e){return e.uniqueId===a&&e.packageId===r}))}},e.prototype.subscribeToInstanceEvents=function(e){this.appInstancesCollectionChangedHandlers||(this.appInstancesCollectionChangedHandlers=[],this.setupAppInstanceListener()),this.appInstancesCollectionChangedHandlers.push(e)},e.prototype.unsubscribeToInstanceEvents=function(e){this.appInstancesCollectionChangedHandlers&&(_.pull(this.appInstancesCollectionChangedHandlers,e),_.isEmpty(this.appInstancesCollectionChangedHandlers)&&(this.appInstancesCollectionChangedHandlers=null,this.instances.unsubscribe(this.appInstanceListener)))},e.prototype.getAppInstancesForApp=function(e){return _.filter(this.appInstances,(function(t){return t.providerContract.providerKey===e}))},e.prototype.getAppInstanceInternal=function(e){return _.find(this.instances.items,(function(t){return t.packageId===e}))},e.prototype.setupAppInstanceListener=function(){var e=this;this.appInstanceListener||(this.appInstanceListener={onAdded:function(t){return e.notifyListeners((function(e){return e.onInstanceInstalled&&e.onInstanceInstalled(t)}))},onDeleted:function(t){return e.notifyListeners((function(e){return e.onInstanceUninstalled&&e.onInstanceUninstalled(t)}))},onReset:function(){return e.notifyListeners((function(e){return e.onInstancesReset&&e.onInstancesReset()}))}}),this.instances.subscribe(this.appInstanceListener)},e.prototype.getOrgAppsMetadata=function(){var e=this;if(null!=this.appsInitializationDeferred)return this.appsInitializationDeferred;this.appsInitializationDeferred=this.promiseFactory.defer();var t=this.appMetadataService.getOrgAppsMetadata?this.appMetadataService.getOrgAppsMetadata():this.appMetadataService.getAppMetadata();return this.promiseFactory.all([t,this.modelService.modelsPromise,this.dashboardDataService.getDashboards(),this.reportService.ensureReportsInitialization(),this.workbookService.ensureWorkbookInitialization()]).then((function(t){var r=t[0],o=e.appStore;o.initializeApps(r),e.groupStore.selectedFolderId$.subscribe((function(){e.appsAfterFolderSwitchDeferred.resolve(),e.appsAfterFolderSwitchDeferred=e.promiseFactory.defer()})),o.installedApps.subscribe((function(t){e.onAppsUpdated(t.apps,t.packages),e.appsInitializationDeferred.resolve(e),e.appsAfterFolderSwitchDeferred.resolve()}))}),(function(){e.appsInitializationDeferred.reject()})),this.appsInitializationDeferred},e.prototype.onAppsUpdated=function(e,t){var r=this;this.apps=_.filter(e,(function(e){return r.isAppContentProvider(e)}))||[];for(var o=[],i=this.packageIdToAppMap,a=this.dataServiceModelMerger,n=this.dataServiceModelConverter,s=0;s<e.length;s++){var c=e[s],d=t[s],l=i[d.id];l?l.providerContract!==c&&a.mergeInstalledAppModel(l,c,d):l=n.convertInstalledAppModel(c,d),o.push(l)}this.instances.setItems(o),this.packageIdToAppMap=_.keyBy(o,(function(e){return e.packageId}))},e.prototype.onAppAdded=function(e,t){var r=this.packageIdToAppMap[t.id];if(r)return r;var o=this.dataServiceModelConverter.convertInstalledAppModel(e,t);return this.instances.addItem(o),this.packageIdToAppMap[t.id]=o,o},e.prototype.notifyListeners=function(e){var t=this.appInstancesCollectionChangedHandlers;if(!_.isEmpty(t)&&e)for(var r=t.length-1;r>=0;r--)e(t[r])},e.prototype.deleteInstanceInternal=function(e){var t=e.providerContract.providerKey,r=e.packageId,o=e.category===i.OrganizationalApp;this.appStore.delete(r,t,o)},e.prototype.isAppCategory=function(e){return this.appStore.isAppCategory(e)},e.prototype.isAppContentProvider=function(e){return!!e&&this.isAppCategory(e.category)},e})();t.createMockAppService=o;var d=(function(){function e(e){this.promiseFactory=e}return Object.defineProperty(e.prototype,"apps",{get:function(){return[]},set:function(e){},enumerable:!0,configurable:!0}),e.prototype.ensureAppsInitialization=function(){return this.promiseFactory.reject()},e.prototype.appsAfterFolderSwitchPromise=function(){return this.promiseFactory.resolve()},e.prototype.getAppByGUID=function(e){return null},e.prototype.isAppCategory=function(e){return!1},e.prototype.onInstanceAdded=function(e){return this.promiseFactory.reject(null)},e.prototype.onInstanceDeleted=function(e){},e.prototype.deleteInstance=function(e){return null},e.prototype.getAppInstance=function(e){return null},e.prototype.getAppArtifact=function(e,t){return null},e.prototype.subscribeToInstanceEvents=function(e){},e.prototype.unsubscribeToInstanceEvents=function(e){},e.prototype.getAppInstancesForApp=function(e){},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,i){return new o(e,t,r,i)}t.createPermissionRefreshService=r;var o=(function(){function t(e,t,r,o){this.userInfo=e,this.dashboardSyncService=t,this.dashboardDataService=r,this.promiseFactory=o,this.inFlightSyncRequests={}}return t.prototype.refreshDashboardTilePermissionsUponLoad=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e,r,o,i,a,n,s,c,d,l,u,p,h=this;return __generator(this,(function(v){switch(v.label){case 0:return e=this.promiseFactory.resolve(null),r=t.contract&&t.contract.tiles,_.isEmpty(r)?[2,e]:(o=this.userInfo,i=this.dashboardDataService,a=t.id,(n=this.inFlightSyncRequests[t.id])?[2,n.promise]:(s=20,o.isUserMetadataRefreshed||!_.some(r,(function(e){return e.errorCode===s}))||i.dropDashboardfromMemoryIfNotActive(a)?[2,e]:(n=this.inFlightSyncRequests[t.id]=this.promiseFactory.defer(),c=function(){return delete h.inFlightSyncRequests[t.id],n.resolve(null),n.promise},[4,this.userInfo.userMetadataPromise])));case 1:for(v.sent(),d=[],l=0,u=r;l<u.length;l++)p=u[l],p.errorCode===s&&d.push(p.id);return _.isEmpty(d)||i.dropDashboardfromMemoryIfNotActive(a)?[2,c()]:[4,this.dashboardSyncService.onTilesAddedOrUpdated(a,d)];case 2:return v.sent(),[2,c()]}}))}))},t.prototype.refreshDashboardTiles=function(e){for(var t=[],r=this.dashboardDataService,o=this.dashboardSyncService,i=0,a=e;i<a.length;i++){var n=a[i];r.dropDashboardfromMemoryIfNotActive(n)||t.push(o.addOrDeepEditDashboard(n))}return this.promiseFactory.allSettled(t)},t})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(){return new i}var o=e.common.NotifyCollection;t.createDashboardCollectionService=r;var i=(function(){function e(){this.listeners=[],this.collection=new o,this.map={}}return Object.defineProperty(e.prototype,"dashboards",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e),this.map=_.keyBy(e,(function(e){return e.objectId}))},enumerable:!0,configurable:!0}),e.prototype.getDashboardContracts=function(){return _.map(this.dashboards,(function(e){return e.contract}))},e.prototype.findDashboardContract=function(e){var t=this.getDashboardContracts();return _.find(t,(function(t){return t.id===e}))},e.prototype.findDashboardByObjectId=function(e){return this.map[e]},e.prototype.onAdded=function(e){for(var t=this.listeners,r=0,o=t;r<o.length;r++){var i=o[r];i.onDashboardAdded&&i.onDashboardAdded(e)}},e.prototype.onDeleted=function(e){for(var t=this.listeners,r=0,o=t;r<o.length;r++){var i=o[r];i.onDashboardDeleted&&i.onDashboardDeleted(e)}},e.prototype.onReset=function(){for(var e=this.listeners,t=0,r=e;t<r.length;t++){var o=r[t];o.onDashboardsReset&&o.onDashboardsReset()}},e.prototype.addDashboard=function(e){this.collection.addItem(e),this.map[e.objectId]=e},e.prototype.removeDashboard=function(e){var t=this.collection.deleteItems((function(t){return t.id===e}));0!==t.length&&delete this.map[_.first(t).objectId]},e.prototype.replaceDashboard=function(e){var t=_.findIndex(this.collection.items,(function(t){return t.objectId===e.objectId}));t!==-1&&(this.collection.items.splice(t,1,e),this.map[e.objectId]=e)},e.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},e.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,o,a,n,s,c,d,l,u,p,h,v,f,m){return new i(e,t,r,o,a,n,s,c,d,l,u,p,h,v,f,m)}t.createDashboardDataService=r;var o=3e3,i=(function(){function r(e,t,r,o,i,a,n,s,c,d,l,u,p,h,v,f){var m=this;this.dashboardHttpService=e,this.groupStore=t,this.promiseFactory=r,this.featureSwitchService=o,this.modelConverter=i,this.modelMerger=a,this.modelService=n,this.dashboardCollectionService=s,this.$timeout=c,this.dashboardStore=d,this.appMetadataService=l,this.permissionService=u,this.reportService=p,this.datasetRefreshListener=h,this.notificationToast=v,this.workbookService=f,this.refreshStateListeners=[],this.InEditMobileLayoutMode=!1,this.dashboardCollectionService=s,this.dashboardsDeferred=r.defer(),this.isQnaEnabled=!1,this.datasetRefreshListener.addModelUpdateListener(this),this.refreshState=0,this.appMetadataService.getAppMetadata().then((function(){m.dashboardStore.selectedDashboard.subscribe((function(e){m.activeDashboardId=e?e.id:m.activeDashboardId,m.activeDashboardObjectId=e?e.objectId:m.activeDashboardObjectId,m.updateActiveDashboardModelsInternal(e)}))})),this.dashboardsAfterFolderSwitchDeferred=this.promiseFactory.defer(),this.appMetadataService.getAppMetadata().then((function(){m.groupStore.selectedFolderId$.subscribe((function(){m.dashboardsAfterFolderSwitchDeferred.resolve(),m.dashboardsAfterFolderSwitchDeferred=m.promiseFactory.defer()})),p.ensureReportsInitialization().then((function(){m.dashboardStore.dashboards.subscribe((function(e){var t,r,o,i=_.keyBy(m.dashboards,(function(e){return e&&e.objectId}));m.dashboards=e.map((function(e){var a=i[e.objectId];return a?(m.modelMerger.mergeDashboardShallow(a,e),a):(_.isEmpty(t)&&(t=_.map(n.models,(function(e){return e.contract})),r=_.map(p.reports,(function(e){return e.contract})),o=_.map(f.workbooks,(function(e){return e.contract}))),m.modelConverter.convertDashboard(e,t,r,o))})),m.dashboardsAfterFolderSwitchDeferred.resolve(),m.dashboardsDeferred.resolve(m)}))}))}),(function(){m.dashboardsDeferred.reject(),m.dashboardsAfterFolderSwitchDeferred.reject()}))}return r.prototype.registerRefreshStateListener=function(e){_.includes(this.refreshStateListeners,e)||this.refreshStateListeners.push(e)},r.prototype.unregisterRefreshStateListener=function(e){_.remove(this.refreshStateListeners,e)},r.prototype.onDashboardTileRefreshStarted=function(e){this.activeDashboardId===e&&0===this.refreshState&&this.notify(1,e)},r.prototype.onDashboardTileRefreshFinished=function(e){var t=this;this.activeDashboardId===e&&1===this.refreshState&&(this.notify(2,e),this.$timeout((function(){return t.notify(0,e)}),o))},r.prototype.notify=function(e,t){this.refreshState=e;for(var r=0,o=this.refreshStateListeners;r<o.length;r++){o[r].onStateChange(this.refreshState,t)}},Object.defineProperty(r.prototype,"dashboards",{get:function(){return this.dashboardCollectionService.dashboards},set:function(e){this.dashboardCollectionService.dashboards=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"visibleDashboards",{get:function(){return _.filter(this.dashboardCollectionService.dashboards,(function(e){return!e.isHidden}))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"activeDashboard",{get:function(){return this.activeDashboardObjectId?this.findDashboardByGUID(this.activeDashboardObjectId):null},set:function(e){e?(this.activeDashboardId=e.id,this.activeDashboardObjectId=e.objectId):(this.activeDashboardId=-1,this.activeDashboardObjectId=null),this.dashboardStore.select(e?e.contract:null),this.refreshState=0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"activeDashboardContainsQnaSupportedModel",{get:function(){return!_.isEmpty(this.activeDashboardQnaModels)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"displayName",{get:function(){return this.activeDashboard?this.activeDashboard.displayName:""},enumerable:!0,configurable:!0}),r.prototype.addDashboard=function(e){if(e){this.findDashboardByGUID(e.objectId)||this.dashboardCollectionService.addDashboard(e)}},r.prototype.addOrReplaceDashboard=function(e){this.findDashboardByGUID(e.objectId)?this.dashboardCollectionService.replaceDashboard(e):this.dashboardCollectionService.addDashboard(e)},r.prototype.deleteDashboard=function(e){this.removeDashboard(e)},r.prototype.deleteTile=function(e,t){var r=this,o=this.promiseFactory.defer(),i=this.findDashboard(e);return i?this.tryUpdateTile(i,t,(function(e,t){if(e>=0&&t>=0){var a=i.contract.tiles[e];i.contract.tiles.splice(e,1),i.tiles.splice(t,1),r.updateQnAEnabledWhenNoTilesOnDashboard(i),i.hasModel(a.modelId)||r.dashboardHttpService.addDashboardRequestToBatch(r.promiseFactory,i.id,!1,0).done((function(e){r.modelMerger.mergeDashboardShallow(i,e.dashboards[0]),r.updateActiveDashboardModels(),o.resolve(null)})).fail((function(){o.reject()}))}else o.resolve(null)})):o.resolve(null),o.promise},r.prototype.dropDashboardfromMemoryIfNotActive=function(e){var t=this.activeDashboard;if(!t||t.id!==e){return this.findDashboard(e)&&this.dashboardStore.unloadDashboardTiles(e),!0}return!1},r.prototype.findDashboard=function(e){return _.find(this.dashboards,(function(t){return t.id===e}))},r.prototype.findDashboardByGUID=function(e){return this.dashboardCollectionService.findDashboardByObjectId(e)},r.prototype.findDashboardsByPackageId=function(e){var t=this.dashboards;if(t)return _.filter(t,(function(t){return!(!t.contract||!t.contract.originalPackageId)&&t.contract.originalPackageId===e}))},r.prototype.retrieveDashboardForApp=function(e,t){return _.find(this.dashboards,(function(r){return r.getUniquePackageId()===e&&r.contract.originalDashboardObjectId===t}))},r.prototype.getDashboardIndex=function(e){return _.findIndex(this.dashboards,(function(t){return t.id===e}))},r.prototype.registerDashboards=function(e){this.dashboards=e},r.prototype.tryUpdateTile=function(e,t,r){if(e){var o=e.getTileContractIndex(t),i=e.getTileIndex(t);r(o,i),e.scheduleDelayedLayout(this.activeDashboard!==e)}},r.prototype.updateActiveDashboardModels=function(){var e=this.activeDashboard&&this.activeDashboard.contract;this.updateActiveDashboardModelsInternal(e)},r.prototype.updateActiveDashboardModelsInternal=function(r){return __awaiter(this,void 0,e.Promise,(function(){var e=this;return __generator(this,(function(o){switch(o.label){case 0:return r||(r=this.activeDashboard&&this.activeDashboard.contract),[4,this.modelService.modelsPromise];case 1:return o.sent(),this.activeDashboardModels=t.DashboardUtils.getDashboardModels(r,this.modelService.getModelContracts()),this.activeDashboardQnaModels=_.filter(this.activeDashboardModels,(function(r){return t.DashboardUtils.isQnaSupportedModel(r,e.permissionService,e.featureSwitchService)})),this.updateIsQnaEnabled(),[2]}}))}))},r.prototype.isActiveDashboardModelRefreshDisabled=function(){var e=this.activeDashboardModels;if(_.isEmpty(e))return!1;for(var t=this.modelService,r=0,o=e;r<o.length;r++){var i=o[r],a=t.findModel(i.id,i.packageId);if(a&&a.isRefreshDisabledDueToInactivity())return!0}return!1},r.prototype.activeDashboardHasRlsModel=function(){var e=this.activeDashboardModels;if(_.isEmpty(e))return!1;for(var t=this.modelService,r=0,o=e;r<o.length;r++){var i=o[r],a=t.findModel(i.id,i.packageId);if(a&&(a.cloudRlsEnabled||a.contract.onPremModelConnectionString))return!0}return!1},r.prototype.updateIsQnaEnabled=function(){this.activeDashboard?"undefined"!=typeof this.activeDashboard.qnaEnabled?this.isQnaEnabled=this.activeDashboard.qnaEnabled:this.isQnaEnabled=this.activeDashboardContainsQnaSupportedModel:this.isQnaEnabled=!1},r.prototype.onModelUpdated=function(e,t){this.modelService.findModel(e,t)&&this.updateActiveDashboardModels()},r.prototype.getDashboards=function(){var e=this;return this.dashboardsDeferred.promise.then((function(){return e.dashboards}))},r.prototype.removeDashboard=function(e){this.dashboardCollectionService.removeDashboard(e)},r.prototype.setQnaEnabled=function(e,t){var r=this.findDashboard(e);r&&(r.qnaEnabled=t,this.updateIsQnaEnabled())},r.prototype.subscribe=function(e){this.dashboardCollectionService.subscribe(e)},r.prototype.unsubscribe=function(e){this.dashboardCollectionService.unsubscribe(e)},r.prototype.onDeleted=function(e){this.dashboardCollectionService.onDeleted(e)},r.prototype.dashboardsAfterFolderSwitchPromise=function(){return this.dashboardsAfterFolderSwitchDeferred.promise},r.prototype.updateQnAEnabledWhenNoTilesOnDashboard=function(e){_.isEmpty(e.tiles)&&(e.qnaEnabled=!1)},r})();t.DashboardDataService=i})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,i,a,n,s,c,d,l,u,p,h,v,f,m){return new o(e,t,r,i,a,n,s,c,d,l,u,p,h,v,f,m)}t.createDashboarSyncService=r;var o=(function(){function r(t,r,o,i,a,n,s,c,d,l,u,p,h,v,f,m){var g=this;this.rootScope=t,this.dashboardDataService=r,this.dashboardHttpService=o,this.modelConverter=i,this.modelMerger=a,this.modelService=n,this.promiseFactory=s,this.reportService=c,this.resourcePackageListenerService=d,this.resourcePackagesService=l,this.telemetryService=u,this.tutorialDataStore=p,this.workbookService=h,this.dashboardStore=v,this.globalEventBridge=f,this.globalEventBridge.createChannelSubscriptionManager().subscribe(e.dataServices.events.syncServiceDashboardEditedEvent,(function(e,t){return g.onDashboardShallowEdit(t)})).subscribe(e.dataServices.events.syncServiceDashboardDeepEditedEvent,(function(e,t){return g.onDashboardDeepEdit(t)})).subscribe(e.dataServices.events.syncServiceTilesAddedOrUpdated,(function(e,t){return g.addOrUpdateActiveDashboardTiles(t.dashboardId,t.tileIds,t.isDataChange)})).subscribe(e.dataServices.events.syncServiceTileDeleted,(function(e,t){return g.dashboardDataService.deleteTile(t.dashboardId,t.tileId)}));var b={ensureFetched:function(e){return g.ensureFetched(e)}};m.addFetchEntityHandler(1,b)}return r.prototype.onTilesAddedOrUpdated=function(e,t){var r=this.promiseFactory;return this.customTilesUpdate?(this.customTilesUpdate(e,t),r.resolve(null)):this.dashboardDataService.dropDashboardfromMemoryIfNotActive(e)?r.resolve(null):void this.addOrUpdateActiveDashboardTiles(e,t)},r.prototype.addOrDeepEditDashboard=function(r){var o=this,i=this.telemetryService.startEvent(e.telemetry.DashboardAddUpdateDashboard),a=this.promiseFactory.defer();return this.dashboardHttpService.addDashboardRequestToBatch(this.promiseFactory,r,!1,0).done((function(e){o.addOrUpdateDashboard(e),o.rootScope.$emit(t.constants.updateDashboardContainerEventName,[e]),o.dashboardDataService.onDashboardTileRefreshFinished(r),i.resolve(),a.resolve(null)})).fail((function(){i.reject(),a.reject(null)})),a.promise},r.prototype.onDashboardShallowEdit=function(e){var r=e.dashboards[0],o=this.dashboardDataService.findDashboard(r.id);o&&(this.modelMerger.mergeDashboardShallow(o,r),this.rootScope.$emit(t.constants.onDashboardShallowEditEventName,o,r))},r.prototype.onDashboardDeepEdit=function(e){this.rootScope.$emit(t.constants.addOrUpdateDashboardEventName,e),this.rootScope.$emit(t.constants.updateDashboardContainerEventName,[e]),this.dashboardDataService.onDashboardTileRefreshFinished(e.dashboards[0].id)},r.prototype.ensureFetched=function(e){var t=e.id;return this.dashboardDataService.findDashboard(t)?this.promiseFactory.resolve(null):this.addOrDeepEditDashboard(t)},r.prototype.addOrUpdateCustomVisualTile=function(e,t,r){var o=this;this.isResourcePackageInCache(e)?this.addOrUpdateTile(t,r,this.modelService.getModelContracts()):this.resourcePackageListenerService.getAndLoadVisualPlugin(e).then((function(){o.addOrUpdateTile(t,r,o.modelService.getModelContracts())}))},r.prototype.addOrUpdateDashboard=function(e){var r=e.dashboards[0];this.dashboardStore.addOrUpdate(r),this.rootScope.$emit(t.constants.addOrUpdateDashboardEventName,e);var o=this.modelConverter.convertDashboard(r,e.models,e.reports);this.dashboardDataService.onDashboardTileRefreshFinished(o.id)},r.prototype.addOrUpdateTile=function(e,t,r){var o=this;e&&(r=r||[],this.updateModelsIfRequired(e,t),this.dashboardDataService.tryUpdateTile(e,t.id,(function(i,a){var n=o.reportService.findReport(t.reportId),s=null;i>=0?(e.contract.tiles[i]=t,a>=0&&(s=e.tiles[a],o.modelMerger.mergeTile(s,t,r,null,o.workbookService.getWorkbookContracts(),o.reportService.reports))):(s=o.modelConverter.convertTile(t,r,null,o.workbookService.getWorkbookContracts()),e.contract.tiles.push(t),e.tiles.push(s)),s&&(s.invalidateLayout(),n&&(s.report=n))})))},r.prototype.clearSeenDashboards=function(){var r=this.telemetryService.startEvent(e.telemetry.DashboardSharingNewUnseenDashboards,0,0,0);this.tutorialDataStore.setKey(t.constants.seenDashboardsStorageKey,{},r)},r.prototype.registerAndUpdateTile=function(e,t){var r=this.dashboardDataService.findDashboard(e);if(t.resourcePackageIds&&t.resourcePackageIds.length>0)for(var o=t.resourcePackageIds.length,i=0;i<o;++i)this.addOrUpdateCustomVisualTile(t.resourcePackageIds[i],r,t);else this.addOrUpdateTile(r,t,this.modelService.getModelContracts())},r.prototype.addOrUpdateActiveDashboardTiles=function(e,t,r){var o=this;if(this.dashboardDataService.selectedDashboardTile){0===t.length&&(t=this.dashboardDataService.activeDashboard.tiles.map((function(e){return e.id})));var i=t.indexOf(this.dashboardDataService.selectedDashboardTile.tileModel.id);if(i>=0&&(t.splice(i,1),0===t.length))return this.promiseFactory.resolve(null)}return this.dashboardHttpService.batchGetTiles(e,t,void 0,!0).then((function(t){var i=t.data;if(!_.isEmpty(i))for(var a=0,n=i.length;a<n;++a)o.registerAndUpdateTile(e,i[a]);r&&o.dashboardDataService.onDashboardTileRefreshFinished(e)}))},r.prototype.updateModelsIfRequired=function(e,r){var o=this,i=e.getTileContractIndex(r.id),a=i!==-1&&2===r.publishState&&1===e.contract.tiles[i].publishState;!a&&e.hasModel(r.modelId)||this.dashboardHttpService.addDashboardRequestToBatch(this.promiseFactory,e.id,!1,0).done((function(r){a&&(o.modelMerger.mergeDashboardTiles(e,r),o.rootScope.$emit(t.constants.mergeDashboardContainerModelsReportsAndPackagesEventName,r),o.modelMerger.mergeModelContentProviderId(r.models,r.packages)),o.modelMerger.mergeDashboardShallow(e,r.dashboards[0]),o.dashboardDataService.updateActiveDashboardModels()}))},r.prototype.isResourcePackageInCache=function(e){var t=this.resourcePackagesService.getAllPackages();return _.some(t,(function(t){return t.id===e}))},r})();t.DashboardSyncService=o})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.folderService=e}return e.prototype.getProgressDelayStringForGivenFileSize=function(e){var t=this.getDurationInSecondsForGivenFileSizeInMB(e);return this.getDelayDurationStringForProgressBarAnimation(t)},e.prototype.getEstimatedLoadingTimeForGivenFileSize=function(e){return this.getDurationInSecondsForGivenFileSizeInMB(e)},e.prototype.getProgressBarDetailsForGivenFileSize=function(e){var t,r=this.getEstimatedLoadingTimeForGivenFileSize(e);return t={estimatedLoadingTimeInMinutes:Math.floor(r/60),delayDurationString:this.getDelayDurationStringForProgressBarAnimation(r)}},e.prototype.isLargeModelNotInPremium=function(e){return!(this.folderService&&this.folderService.activeFolder&&null!=this.folderService.activeFolder.capacity)&&e>1024},e.prototype.getDurationInSecondsForGivenFileSizeInMB=function(e){var t=1024;return e>0&&e<t?0:30*Math.floor(e/t)},e.prototype.getDelayDurationStringForProgressBarAnimation=function(e){var t=0,r=e+t;return t+"s, "+r+"s, "+2*r+"s, "+3*r+"s"},e})();e.DatasetSizeService=t})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,o,a,n,s){return new i(e,t,r,o,a,n,s)}var o=window;t.createHostAppMetadataService=r;var i=(function(){function t(e,t,r,o,i,a,n){this.promiseFactory=e,this.telemetryService=t,this.eventFactory=r,this.editableFeatureSwitchService=o,this.httpService=i,this.errorCallback=a,this.getAppMetadataDeferred=this.promiseFactory.defer(),this.requestAppMetadata(o,n)}return t.prototype.getAppMetadata=function(){return this.getAppMetadataDeferred.promise},t.prototype.requestAppMetadata=function(r,i){var a=this,n=this.telemetryService.startEvent(this.eventFactory),s=this.httpService.powerbiRequestOptions(n.event,"DashboardHostGetAppMetadata",{isAdminRequest:i});s.params={preferReadOnlySession:"true"},this.httpService.get("powerbi/metadata/app",s).then((function(e){var t=e.data;o.initialDashboardContainer=t,a.editableFeatureSwitchService.registerFeatureSwitches(t.featureSwitches),a.getAppMetadataDeferred.resolve(t),n.resolve()}),(function(r){a.getAppMetadataDeferred.reject(null),n.reject(e.errorDetailsHelper.getTelemetryErrorDetails(r.error,r.status)),a.errorCallback&&a.errorCallback(t.pageRefreshErrorMessage)}))},t.pageRefreshErrorMessage="GetAppMetadataRequestFailed",t})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,o){return new c(e,t,r,o)}var o={title:"PinTile_Success",message:"PinTile_EditMobileAuthoringMessage",actionButtons:[{displayText:"EditMobileAuthoring_Button",action:void 0}]},i={title:"PinTile_Success",message:"PinTile_CreateMobileAuthoringMessage",actionButtons:[{displayText:"ToastNotification_GoToDashboard",action:void 0}]},a={title:"AddedTileMobileAuthoringTitle",message:"AddedTileEditMobileAuthoringMessage",actionButtons:[{displayText:"EditMobileAuthoring_Button",action:void 0}]},n={title:"AddedTileMobileAuthoringTitle",message:"AddedTileCreateMobileAuthoringMessage",actionButtons:[{displayText:"CreateMobileAuthoring_Button",action:void 0}]},s={title:"RemovedTileMobileAuthoringTitle",message:"RemovedTileMobileAuthoringMessage",actionButtons:[{displayText:"DeleteMobileAuthoring_Button",
action:void 0}]};t.createMobileAuthoringService=r;var c=(function(){function t(e,t,r,o){this.localizationService=e,this.navigationService=t,this.notificationToastService=r,this.telemetryService=o,this.unpinTileFromMobileListeners=[]}return t.prototype.onUnpinTileFromMobileSimulator=function(){for(var e=0,t=this.unpinTileFromMobileListeners;e<t.length;e++){t[e].onTileUnpined()}},t.prototype.registerUnpinTileFromMobileListener=function(e){_.includes(this.unpinTileFromMobileListeners,e)||this.unpinTileFromMobileListeners.push(e)},t.prototype.unregisterUnpinTileFromMobileListener=function(e){_.remove(this.unpinTileFromMobileListeners,e)},t.prototype.showMobileIndicationMessage=function(t,r,o,i,a,n){var s=this,c=this.getOperationType(r),d=[],l=a?function(){s.telemetryService.logEvent(e.telemetry.MobileAuthoringDashboardOpenedFromFlyout,c,!1),s.navigationService.navigateToDashboardByGUID(t)}:function(){i?n():(s.telemetryService.logEvent(e.telemetry.MobileAuthoringDashboardOpenedFromFlyout,c,!0),s.navigationService.navigateToDashboardMobileAuthoringByGUID(t))};a&&d.push({displayText:this.localizationService.get("CreateMobileAuthoring_Button"),action:n});var u=this.getIndicationMessage(r);return d.push({displayText:this.localizationService.get(u.actionButtons[0].displayText),action:l}),this.notificationToastService.notify({title:this.localizationService.get(u.title),message:this.localizationService.get(u.message),actionButtons:d,notificationType:o})},t.prototype.switchLayoutStrategy=function(e,t,r){e.gridLayoutService.strategy=t,e.gridLayoutService.displayLayout=r,this.updateDashboardTilesWithDisplayLayout(e,r)},t.prototype.updateDashboardTilesWithDisplayLayout=function(e,t){if(e&&e.tiles)for(var r=0,o=e.tiles;r<o.length;r++){var i=o[r];i.gridLayoutContext&&(i.gridLayoutContext.setActiveLayout(t),i.invalidateLayout())}},t.prototype.getIndicationMessage=function(e){switch(e){case 0:return n;case 1:return a;case 2:return i;case 3:return o;case 4:return s}},t.prototype.getOperationType=function(e){switch(e){case 0:case 1:return"Add";case 2:case 3:return"Pin";case 4:return"Remove"}},t})();t.MobileAuthoringService=c})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(){return new i}var o=e.common.NotifyCollection;t.createPackageCollectionService=r;var i=(function(){function e(){this.collection=new o,this.listeners=[],this.packages=[]}return Object.defineProperty(e.prototype,"packages",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e),this.idToPackageMap=_.keyBy(e,(function(e){return e.id}))},enumerable:!0,configurable:!0}),e.prototype.findPackage=function(e){return this.idToPackageMap[e]},e.prototype.findPackageContract=function(e){var t=this.findPackage(e);return t?t.contract:void 0},e.prototype.addPackage=function(e){this.idToPackageMap[e.id]||(this.idToPackageMap[e.id]=e,this.collection.addItem(e))},e.prototype.removePackage=function(e){this.collection.deleteItems((function(t){return t.id===e.id}));delete this.idToPackageMap[e.id]},e.prototype.subscribe=function(e){_.isEmpty(this.listeners)&&this.subscribeToCollectionEvents(),this.listeners.push(e)},e.prototype.unsubscribe=function(e){_.remove(this.listeners,e),_.isEmpty(this.listeners)&&this.unsubscribeToCollectionEvents()},e.prototype.subscribeToCollectionEvents=function(){var e=this;this.collectionListener={onAdded:function(t){return e.notifyListeners((function(e){return e.onPackageAdded(t)}))},onDeleted:function(t){return e.notifyListeners((function(e){return e.onPackageDeleted(t)}))},onReset:function(){return e.notifyListeners((function(e){return e.onPackagesReset()}))}},this.collection.subscribe(this.collectionListener)},e.prototype.unsubscribeToCollectionEvents=function(){this.collection.unsubscribe(this.collectionListener),this.collectionListener=null},e.prototype.notifyListeners=function(e){var t=this.listeners;if(!_.isEmpty(t)&&e)for(var r=t.length-1;r>=0;r--)e(t[r])},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,o,i,a,n,c,d,l){return new s(e,t,r,o,i,a,n,c,d,l)}var o=t.models.ContentPackItems,i=e.common.contracts.ContentProviderCategory,a=jsCommon.EnumExtensions,n=e.common.contracts.PackageType;t.createPackageService=r;var s=(function(){function r(e,t,r,o,i,a,n,s,c,d){var l=this;if(this.rootScope=e,this.telemetryService=t,this.modelMerger=r,this.modelConverter=o,this.syncService=i,this.packageCollectionService=a,this.promiseFactory=n,this.asyncFeatureSwitchService=s,this.packageStore=c,this.fetchEntityService=d,this.initPackages(),!this.asyncFeatureSwitchService.featureSwitches.modernPackageRefreshListener){var u={init:function(){},onPackageDeleted:function(e){return l.legacyDeletePackage(e)},onPackagePublishEdit:function(e,t){return l.legacyOnPackagePublishEdit(e,t)},onPackagePublishRefreshCompleted:function(e,t){return l.onPackagePublishRefreshCompleted(e,t)}};this.syncService.addPackageRefreshListener(u)}var p={ensureFetched:function(e){return l.ensureFetched(e)}};this.fetchEntityService.addFetchEntityHandler(0,p)}return r.prototype.legacyDeletePackage=function(e){this.packageStore.delete(e)},r.prototype.ensurePackagesInitialization=function(){return this.packagesInitializationDeferred.promise},Object.defineProperty(r.prototype,"packages",{get:function(){return this.packageCollectionService.packages},enumerable:!0,configurable:!0}),r.prototype.findPackage=function(e){return this.packageCollectionService.findPackage(e)},r.prototype.getWorkbookStorageProvider=function(e){var t=this.findPackage(e);return t&&t.contract?t.contract.storageProviderType:null},r.prototype.getWorkbookContentProvider=function(e){var t=this.findPackage(e);return t?t.contentProviderId:null},r.prototype.getInstalledOrgPackage=function(e){return _.find(this.packages,(function(t){return t.contract&&t.contract.contentProviderRefId&&t.contract.contentProviderRefId===e&&t.packageType===n.AppInstance}))},r.prototype.isLocalWorkbook=function(e){var t=this.findPackage(e);return t&&t.contract&&0===t.contract.storageProviderType},r.prototype.getPackagesByProviderId=function(e,t){switch(t){case i.BuiltIn:return _.filter(this.packages,(function(t){return t.contract.contentProviderId===e}));case i.Organizational:case i.OrganizationalApp:case i.OrganizationalTemplate:case i.OrganizationalTemplateApp:return _.filter(this.packages,(function(t){return t.contract.contentProviderRefId===e}));case i.ServiceApp:case i.Services:return _.filter(this.packages,(function(t){return t.contract.serviceContentProviderId===e}))}},r.prototype.getPackagesByProviderIdAndPackageType=function(e,t,r){switch(t){case i.BuiltIn:return _.filter(this.packages,(function(t){return t.contract.contentProviderId===e&&t.packageType===r}));case i.Organizational:case i.OrganizationalApp:case i.OrganizationalTemplate:case i.OrganizationalTemplateApp:return _.filter(this.packages,(function(t){return t.contract.contentProviderRefId===e&&t.packageType===r}));case i.ServiceApp:case i.Services:return _.filter(this.packages,(function(t){return t.contract.serviceContentProviderId===e&&t.packageType===r}))}},r.prototype.getAllAppPackagesByType=function(e){return _.filter(this.packages,(function(t){return t.packageType===e}))},r.prototype.isRefreshNowEnabledForWorkbook=function(e){if(this.asyncFeatureSwitchService.featureSwitches.disallowWorkbookRefresh)return!1;if(!e)return!1;if(!a.hasFlag(e.getPermissions(),2))return!1;var t=this.findPackage(e.packageId);return!(!t||!t.contract)},r.prototype.isScheduleRefreshEnabledForWorkbook=function(e){return!(!e||!e.contract)&&(!!this.isRefreshNowEnabledForWorkbook(e)&&(void 0!==e.modelId&&!!e.contract.isPowerPivotVersionSupportsRefresh))},r.prototype.initPackages=function(){var e=this;this.packagesInitializationDeferred=this.promiseFactory.defer(),this.packageStore.packages.subscribe((function(t){var r=t.map((function(t){var r=_.find(e.packages,(function(e){return e.id===t.id}));return r?(r.contract!==t&&e.modelMerger.mergePackage(r,t),r):e.modelConverter.convertPackage(t)}));e.packageCollectionService.packages=r})),this.packagesInitializationDeferred.resolve(this)},r.prototype.updatePackageCollection=function(e){var t=this,r=_.map(e,(function(e){return t.modelConverter.convertPackage(e)}));this.packageCollectionService.packages=r},r.prototype.mergePackageCollection=function(e){this.packageStore.addMany(e)},r.prototype.onPackagePublishRefreshCompleted=function(t,r){var o=this;if(this.packageStore.findById(t))return this.promiseFactory.resolve(null);var i=this.telemetryService.startEvent(e.telemetry.DashboardGetNavigationPanePackage),a=this.promiseFactory.defer(),n=!!r&&!this.syncService.isImportContentRequestIdInWhitelist(r);return this.packageStore.addOrUpdate(t,i,a,n),a.promise.then((function(){var r=o.packageStore.findById(t);r&&0===r.publishOrRefreshStatus&&(o.asyncFeatureSwitchService.featureSwitches.modernPackageRefreshListener?o.packageStore.publishSuccess(r.id):o.rootScope.$emit(e.dataServices.constants.packagePublishedSuccessfullyEventName,r.id))}))},r.prototype.legacyOnPackagePublishEdit=function(r,i){var a=this,n=this.telemetryService,s=n.startEvent(e.telemetry.DashboardGetNavigationPanePackage),c=!!i&&!this.syncService.isImportContentRequestIdInWhitelist(i),d=this.packageStore.addOrUpdate(r,s,null,c);s.promise.then((function(){var i=a.packageStore.findById(r);d&&0===d.publishOrRefreshStatus||0!==i.publishOrRefreshStatus||a.rootScope.$emit(e.dataServices.constants.packagePublishedSuccessfullyEventName,i.id);for(var n=function(e){var r=a.modelConverter.convertReport(_.find(d.reports,(function(t){return t.id===e.id})));if(r&&r.packageVersion!==e.packageVersion&&r.isUsedByContentPack)return a.rootScope.$emit(t.constants.contentPackDirtyShowNotification,e.id,o.Report),{value:void 0}},s=0,c=i.reports;s<c.length;s++){var l=c[s],u=n(l);if("object"==typeof u)return u.value}}))},r.prototype.ensureFetched=function(e){return this.onPackagePublishRefreshCompleted(e.id)},r})();t.PackageService=s})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,o,i,n,s){return new a(e,t,r,o,i,n,s)}var o=jsCommon.EnumExtensions,i=e.common.contracts.PackageType;t.createPermissionService=r;var a=(function(){function r(e,t,r,o,i,a,n){this.activeFolderIdService=e,this.impersonationService=t,this.packageCollectionService=r,this.modelCollectionService=o,this.reportCollectionService=i,this.dashboardCollectionService=a,this.telemetryService=n,this.errorsLogged={}}return Object.defineProperty(r.prototype,"activeWorkSpacePermission",{get:function(){var e=this.activeFolderIdService;return e.folderPermission?e.folderPermission:e.isReadOnly?1:7},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isActiveWorkspaceIsReadOnly",{get:function(){var e=this.activeWorkSpacePermission,t=o.hasFlag(e,2)||o.hasFlag(e,8);return this.impersonationService.impersonating||!t},enumerable:!0,configurable:!0}),r.prototype.isGroupWorkspaceReadOnly=function(e,t){var r=e&&!t?1:7;return!o.hasFlag(r,2)},r.prototype.getReportEffectivePermissions=function(e){var r=e&&e.permissions;return null==r?this.logErrorIfItemNotFoundForType("report",e.id):e&&e.packageId&&(t.PermissionsUtils.markDashboardAndReportsAsCopyableIfPartOfTemplateInstance(null,[e.id],null,e.packageId,this.modelCollectionService,this.reportCollectionService,this.dashboardCollectionService,this.packageCollectionService),r=e&&e.permissions),r},r.prototype.getModelEffectivePermissions=function(e){var t=e&&e.permissions;return t=this.calculateDerivedPermissionsFromPackage(t,e.packageId),null==t&&this.logErrorIfItemNotFoundForType("model",e.id,e.packageId),t},r.prototype.getDashboardEffectivePermissions=function(e){var r=e&&e.permissions;return null==r?this.logErrorIfItemNotFoundForType("dashboard",e.id):e&&e.originalPackageId&&(t.PermissionsUtils.markDashboardAndReportsAsCopyableIfPartOfTemplateInstance([e.id],null,null,e.originalPackageId,this.modelCollectionService,this.reportCollectionService,this.dashboardCollectionService,this.packageCollectionService),r=e&&e.permissions),r},r.prototype.getWorkbookEffectivePermissions=function(e){var t=e&&e.permissions;return t=this.calculateDerivedPermissionsFromPackage(t,e.packageId),null==t&&this.logErrorIfItemNotFoundForType("workbook",e.id),t},r.prototype.getPackageEffectivePermissions=function(e){var t=e&&e.permissions;return null==t&&this.logErrorIfItemNotFoundForType("package",e.id,e.id),t},r.prototype.isOriginalWorkbook=function(e){var t=this.packageCollectionService.findPackageContract(e.packageId);return!!t&&!t.contentProviderRefId},r.prototype.isOwnedOriginalModel=function(e){var t=e.getPermissions();if(!o.hasFlag(t,7))return!1;if(o.hasFlag(t,17))return!1;var r=this.packageCollectionService.findPackageContract(e.packageId);return!!r&&!r.contentProviderRefId&&r.packageType!==i.AppInstance},r.prototype.isOwnedOriginalModelContract=function(e){var t=this.getModelEffectivePermissions(e);if(!o.hasFlag(t,7))return!1;if(o.hasFlag(t,17))return!1;var r=this.packageCollectionService.findPackageContract(e.packageId);return!!r&&!r.contentProviderRefId&&r.packageType!==i.AppInstance},r.prototype.isExplorableModelContract=function(e){return this.isExplorableModelPermission(this.getModelEffectivePermissions(e))},r.prototype.isExplorableModel=function(e){return this.isExplorableModelPermission(e.getPermissions())},r.prototype.isExplorableModelPermission=function(e){return 2===(2&e)||8===(8&e)},r.prototype.calculateDerivedPermissionsFromPackage=function(e,t){var r=16,o=this.packageCollectionService.findPackageContract(t),i=!!o&&o.permissions;if(!i)return e;var a=0;return a|=e&~r,a|=i&r},r.prototype.logErrorIfItemNotFoundForType=function(t,r,o){this.errorsLogged[t]||(this.errorsLogged[t]=!0,this.telemetryService.logEvent(e.telemetry.PermissionsObjectNotFound,r,o,t))},r})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,o){return new i(e,t,r,o)}var o=e.visualHost.utils.ResourcePackageUtils;t.createResourcePackageListenerService=r;var i=(function(){function e(e,t,r,o){this.httpService=e,this.resourcePackageService=t,this.promiseFactory=r,this.visualPluginService=o}return e.prototype.getResourcePackageByResourceId=function(e){var t=this,r=this.promiseFactory.defer(),o=this.resourcePackageService.getPackageById(e);if(o)return r.resolve([o]),r.promise;var i=this.httpService.powerbiRequestOptions(null,"GetResourcePackageByResourceId");return this.httpService.post("/powerbi/metadata/resourcePackage",[e],i).then((function(o){var i=t.resourcePackageService.getPackageById(e);return i?void r.resolve([i]):(t.resourcePackageService.registerPackages(o.data),void r.resolve(o.data))}),(function(e){r.reject()})),r.promise},e.prototype.loadVisualPlugin=function(e){var t=this.promiseFactory.defer();return this.resourcePackageService.registerPackages(e),this.visualPluginService.ensurePlugins(e).then((function(){return t.resolve(e)}),(function(){return t.reject()})),t.promise},e.prototype.getAndLoadVisualPlugin=function(e){var t=this,r=this.promiseFactory.defer();return this.getResourcePackageByResourceId(e).then((function(e){t.visualPluginService.ensurePlugins(e).then((function(){return r.resolve(e)}),(function(){return r.reject()}))}),(function(){return r.reject()})),r.promise},e.prototype.getAndLoadVisualPluginsForDashboard=function(e){var t=this,r=this.getAllRequiredResourcePackageIds(e);return this.loadRequiredResourcePackagesAndVisualPlugins(r).then((function(e){var r=_.chain(e).filter((function(e){return 0===e.type})).map((function(e){return t.getCustomVisualTypesFromResourcePackages(e.value)})).flatten(!1).uniq().value();return t.promiseFactory.resolve(r)}))},e.prototype.getCustomVisualTypesFromResourcePackages=function(e){return o.getCustomVisualTypes(e)},e.prototype.getLoadedCustomVisualTypesForDashboard=function(e){var t=[];if(e&&e.tiles)for(var r=0,i=e.tiles;r<i.length;r++){var a=i[r],n=a.contract.resourcePackageIds;if(n)for(var s=0,c=n;s<c.length;s++){var d=c[s],l=this.resourcePackageService.getPackageById(d);o.isCustomVisualResourcePackage(l)&&t.push(l.name)}}return _.uniq(t)},e.prototype.getAllRequiredResourcePackageIds=function(e){var t=[];if(e&&e.tiles)for(var r=0,o=e.tiles;r<o.length;r++){var i=o[r],a=i.contract.resourcePackageIds;if(a)for(var n=0,s=a;n<s.length;n++){var c=s[n];t.push(c)}}return _(t).uniq().value()},e.prototype.loadRequiredResourcePackagesAndVisualPlugins=function(e){for(var t=[],r=0,o=e;r<o.length;r++){var i=o[r];t.push(this.getAndLoadVisualPlugin(i))}return this.promiseFactory.allSettled(t)},e})();t.ResourcePackageListenerService=i})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,o){return new i(e,t,r,o)}var o=e.errorDetailsHelper;t.createSmartAlertsService=r;var i=(function(){function t(e,t,r,o){this.telemetryService=e,this.errorService=t,this.localizationService=r,this.smartAlertsHttpService=o}return t.prototype.onDemandSmartAlerts=function(t){var r=this,i={modelId:t.id,databaseName:t.dbName,virtualServerName:t.vsName},a=this.telemetryService.startEvent(e.telemetry.DatasetOnDemandSmartAlerts);this.smartAlertsHttpService.onDemandSmartAlerts(i,a.event).then((function(){a.resolve()}),(function(e){a.reject(o.getTelemetryErrorDetails(e.error,e.status)),r.errorService.error(r.localizationService.get("SmartAlerts_FailToGenerateSmartAlerts"),"SmartAlerts_FailToGenerateSmartAlerts",{requestId:e.requestId,statusCode:e.status.toString()})}))},t})();t.SmartAlertsService=i})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,o,i,n,s,c,d,l,u){return new a(e,t,r,o,i,n,s,c,d,l,u)}var o=e.common.contracts.ArtifactType,i=jsCommon.EnumExtensions;t.createReportService=r;var a=(function(){function r(e,t,r,o,i,a,n,s,c,d,l){var u=this;this.telemetryService=e,this.modelMerger=t,this.modelConverter=r,this.appMetadataService=o,this.promiseFactory=i,this.reportCollectionService=a,this.permissionService=n,this.reportStore=s,this.userInfo=c,this.fetchEntityService=d,this.groupStore=l,this.reportsDeferred=this.promiseFactory.defer(),this.reportsAfterFolderSwitchDeferred=this.promiseFactory.defer();var p={ensureFetched:function(e){return u.ensureFetched(e)}};this.fetchEntityService.addFetchEntityHandler(2,p),this.subscribeReports()}return r.prototype.subscribeReports=function(){var e=this;this.appMetadataService.getAppMetadata().then((function(){e.groupStore.selectedFolderId$.subscribe((function(){e.reportsAfterFolderSwitchDeferred.resolve(),e.reportsAfterFolderSwitchDeferred=e.promiseFactory.defer()})),e.reportStore.reports.subscribe((function(t){e.reportCollectionService.reports=t.map((function(t){var r=_.find(e.reportCollectionService.reports,(function(e){return e.objectId===t.objectId}));return r?(e.modelMerger.mergeReport(r,t),r):e.modelConverter.convertReport(t)})),e.reportsDeferred.resolve(e),e.reportsAfterFolderSwitchDeferred.resolve()})),e.reportStore.selectedReport.subscribe((function(t){e.currentActiveReport=t?{id:t.id,displayName:t.displayName,guid:t.objectId,modelId:t.modelId}:null}))}))},r.prototype.ensureReportsInitialization=function(){return this.reportsDeferred.promise},r.prototype.reportsAfterFolderSwitchPromise=function(){return this.reportsAfterFolderSwitchDeferred.promise},Object.defineProperty(r.prototype,"reports",{get:function(){return this.reportCollectionService.reports},set:function(e){this.reportCollectionService.reports=e},enumerable:!0,configurable:!0}),r.prototype.getReports=function(){return this.reportsDeferred.promise.then((function(e){return e.reports}))},r.prototype.updateCurrentActiveReport=function(e){this.reportStore.select(e)},r.prototype.onReportAdded=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(r){return e=this.promiseFactory.defer(),this.reportStore.addFromSyncService(t,e),[2,e.promise]}))}))},r.prototype.onReportDeleted=function(e){var t=this.findReport(e);t&&(this.reportStore.delete(t.contract,!0),this.reportCollectionService.onDeleted(t))},r.prototype.ensureFetched=function(e){var t=e.id;return this.findReport(t)?this.promiseFactory.resolve(null):this.onReportAdded(t)},r.prototype.retrieveReportForApp=function(e,t){if(null!=e&&!_.isEmpty(t))return _.find(this.reports,(function(r){return r.packageId===e&&r.contract.originalReportObjectId===t}))},r.prototype.getReportContracts=function(){return this.reports.map((function(e){return e.contract}))},Object.defineProperty(r.prototype,"copyAndEditReports",{get:function(){var e=this.permissionService;return _.filter(this.reports,(function(t){var r=e.getReportEffectivePermissions(t.contract);return i.hasFlag(r,2)||i.hasFlag(r,17)}))},enumerable:!0,configurable:!0}),r.prototype.addContractReport=function(e){if(e&&e.id&&!this.findReport(e.id)){e.isNew=!0;var t=this.modelConverter.convertReport(e);return this.addReport(t),t}},r.prototype.addReport=function(e){this.reportCollectionService.addReport(e),this.reportStore.ensure(e.contract)},r.prototype.deleteReport=function(r){var o=this.findReportByGUID(r),i=this.telemetryService.startEvent(e.telemetry.DashboardDeleteReport,o?t.ContractUtils.reportTypeToString(o.reportType):"",o?o.id:-1,o?o.objectId:void 0);this.reportStore.delete(o,!1,i),this.reportCollectionService.onDeleted(o)},r.prototype.updateReportVisibility=function(t,r){var i=this.findReportByGUID(t),a=this.telemetryService.startEvent(e.telemetry.PermissionsUpdateArtifactVisibility,i.id,o.Report,r);this.reportStore.updateVisibility(i.contract,r,a)},r.prototype.findReport=function(e){return null!=e?_.find(this.reports,(function(t){return t.id===e})):null},r.prototype.findReportByGUID=function(e){return null!=e?_.find(this.reports,(function(t){return t.objectId===e})):null},r.prototype.findReportByOriginalGUID=function(e){return e?_.find(this.reports,(function(t){return t.contract.originalReportObjectId&&t.contract.originalReportObjectId===e})):null},r.prototype.findReportsByPackageId=function(e){return _.filter(this.reports,(function(t){return t.packageId===e}))},r.prototype.renameReport=function(r,o){if(!_.isEmpty(r.trim())){var i=this.findReport(o),a=this.telemetryService.startEvent(e.telemetry.DashboardRenameReport,i?t.ContractUtils.reportTypeToString(i.reportType):"");this.reportStore.rename(i.contract,r,a)}},r.prototype.reportsOwnersMergedPromise=function(){return this.reportsOwnersMergedDeferred||(this.reportsOwnersMergedDeferred=this.promiseFactory.defer(),this.mergeReportOwnerInfoOnPageLoad()),this.reportsOwnersMergedDeferred.promise},r.prototype.mergeReportOwnerInfoOnPageLoad=function(){var e=this;this.userInfo.userMetadataPromise.then((function(t){t?e.reportsOwnersMergedDeferred.resolve(null):e.reportsOwnersMergedDeferred.reject()}),(function(){e.reportsOwnersMergedDeferred.reject()}))},r.prototype.subscribe=function(e){this.reportCollectionService.subscribe(e)},r.prototype.unsubscribe=function(e){this.reportCollectionService.unsubscribe(e)},r})();t.ReportService=a})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(){return new i}var o=e.common.NotifyCollection;t.createReportCollectionService=r;var i=(function(){function e(){this.listeners=[],this.collection=new o}return Object.defineProperty(e.prototype,"reports",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e)},enumerable:!0,configurable:!0}),e.prototype.findReportContract=function(e){return _.find(this.reports,(function(t){return t.id===e})).contract},e.prototype.onAdded=function(e){for(var t=this.listeners,r=0,o=t;r<o.length;r++){var i=o[r];i.onReportAdded&&i.onReportAdded(e)}},e.prototype.onDeleted=function(e){for(var t=this.listeners,r=0,o=t;r<o.length;r++){var i=o[r];i.onReportDeleted&&i.onReportDeleted(e)}},e.prototype.onReset=function(){for(var e=this.listeners,t=0,r=e;t<r.length;t++){var o=r[t];o.onReportsReset&&o.onReportsReset()}},e.prototype.addReport=function(e){this.collection.addItem(e)},e.prototype.removeReport=function(e){this.collection.deleteItems((function(t){return t.id===e}))},e.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},e.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var r=e.common.models.ReportPermissions,o=e.common.helpers.UserInfoHelper,i=(function(){function t(e){this.userInfo=e}return t.prototype.mapReportOwnerFullnames=function(e,t,r,o){this.mapResourceOwnerFullnames(e,t,r,o,"reportIds")},t.prototype.mapWorkbookOwnerFullnames=function(e,t,r,o){this.mapResourceOwnerFullnames(e,t,r,o,"workbookIds")},t.prototype.mapResourceOwnerFullnames=function(e,t,r,o,i){for(var a=0,n=e;a<n.length;a++){var s=n[a];s.ownerFullname||(s.ownerFullname=this.getOwnerFullname(s.getPermissions(),s.packageId,i,s.id,t,r,o))}},t.prototype.getOwnerFullnameFromUserInfo=function(){var e=this.userInfo;return e?o.getFullName(e.givenName,e.surname):""},t.prototype.hasPermission=function(e,t){return(e&t)===t},t.prototype.getOwnerFromGroupOrUser=function(t,r){return t===e.common.constants.myWorkspaceFolderId?this.getOwnerFullnameFromUserInfo():r},t.prototype.getOwnerFromUserInfo=function(e,t,o){return this.hasPermission(e,r.Personalized)?this.getOwnerFromGroupOrUser(t,o):""},t.prototype.getOwnerFromDashboard=function(e){return e&&e.ownerFullname||""},t.prototype.getOwnerFullname=function(e,t,r,o,i,a,n){for(var s,c,d,l=0,u=i;l<u.length;l++){var p=u[l],h=p.contract;if(t){if(h.originalPackageId===t){s=p;break}!c&&h.packageIds&&_.includes(h.packageIds,t)&&(c=p)}!d&&h[r]&&_.includes(h[r],o)&&(d=p)}var v=s||c||d;return v?this.getOwnerFromDashboard(v):17===e?"":this.getOwnerFromUserInfo(e,a,n)},t})();t.ResourceOwnershipService=i})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(){return new a}var o=e.common.models.Model,i=e.common.NotifyCollection;t.createModelCollectionService=r;var a=(function(){function e(){this.listeners=[],this.collection=new i,this.modelsMap={}}return Object.defineProperty(e.prototype,"models",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e),this.modelsMap={};for(var t=0,r=e;t<r.length;t++){var o=r[t];this.modelsMap[o.uniqueId]=o}},enumerable:!0,configurable:!0}),e.prototype.getModelContracts=function(){return _.map(this.models,(function(e){return e.contract}))},e.prototype.onAdded=function(e){for(var t=this.listeners,r=0,o=t;r<o.length;r++){var i=o[r];i.onModelAdded&&i.onModelAdded(e)}},e.prototype.onDeleted=function(e){for(var t=this.listeners,r=0,o=t;r<o.length;r++){var i=o[r];i.onModelDeleted&&i.onModelDeleted(e)}},e.prototype.onReset=function(){for(var e=this.listeners,t=0,r=e;t<r.length;t++){var o=r[t];o.onModelsReset&&o.onModelsReset()}},e.prototype.findModel=function(e,t){return this.modelsMap[o.getUniqueId(e,t)]},e.prototype.addModel=function(e){this.collection.addItem(e),this.modelsMap[e.uniqueId]=e},e.prototype.removeModel=function(e,t){var r;return r=t?function(r){return r.id===e&&r.packageId===t}:function(t){return t.id===e},!_.isEmpty(this.removeModels(r))},e.prototype.removeModels=function(e){var t=this.collection.deleteItems(e);if(!_.isEmpty(t))for(var r=this.modelsMap,o=0,i=t;o<i.length;o++){var a=i[o];delete r[a.uniqueId]}return t},e.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},e.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,o,a,n,s,c,d,l,u,p){return new i(e,t,r,o,a,n,s,c,d,l,u,p)}var o=jsCommon.EnumExtensions;t.createModelService=r;var i=(function(){function r(e,t,r,o,i,a,n,s,c,d,l,u){var p=this;this.telemetryService=e,this.modelMerger=t,this.modelConverter=r,this.modelHttpService=o,this.appMetadataService=i,this.promiseFactory=a,this.modelCollectionService=n,this.permissionService=s,this.asyncFeatureSwitchService=c,this.datasetStore=d,this.fetchEntityService=l,this.datasetRefreshListener=u,this.explorableDatasets=[],this.completeUsableModelList=[];var h={ensureFetched:function(e){return p.ensureFetched(e)}};this.fetchEntityService.addFetchEntityHandler(4,h),this._modelsDeferred=this.promiseFactory.defer(),this.asyncFeatureSwitchService.getFeatureSwitches().then((function(e){p.isInsightAppEnabled=e.insightApps,p.sharedDatasetDiscoveryEnabled=e.sharedDatasetDiscovery,p.subscribeDataset(),p.sharedDatasetDiscoveryEnabled&&p.subscribeExplorableDatasets()}))}return Object.defineProperty(r.prototype,"models",{get:function(){return this.modelCollectionService.models},set:function(e){this.modelCollectionService.models=e},enumerable:!0,configurable:!0}),r.prototype.pushModel=function(e){this.modelCollectionService.addModel(e)},r.prototype.ensureFetched=function(e){return this.datasetRefreshListener.onModelAdded(e.id,void 0)},Object.defineProperty(r.prototype,"modelsPromise",{get:function(){return this._modelsDeferred.promise},enumerable:!0,configurable:!0}),r.prototype.updateDatasetCollection=function(e){var t=[];if(!_.isEmpty(e))for(var r=0,o=e.length;r<o;++r)t.push(this.modelConverter.convertModel(e[r]));this.modelCollectionService.models=t},r.prototype.mergeDatasetCollection=function(e){if(!_.isEmpty(e))for(var t=_.keyBy(this.models,"id"),r=0,o=e;r<o.length;r++){var i=o[r];t[i.id]?this.updateContractModel(i):this.pushModel(this.modelConverter.convertModel(i))}},r.prototype.getModelContracts=function(){return this.modelCollectionService.getModelContracts()},r.prototype.updateContractModel=function(e){if(e){var t=this.findModel(e.id,e.packageId);t&&(this.modelMerger.mergeModel(t,e),this.datasetRefreshListener.applyModelUpdated(t.id,t.packageId))}},r.prototype.addContractModel=function(e){if(e||!this.modelExists(e.id,e.packageId)){e.isNew=!0;var t=this.modelConverter.convertModel(e);this.addModel(t)}},r.prototype.addModel=function(e){e&&!this.modelExists(e.id,e.packageId)&&this.modelCollectionService.addModel(e)},r.prototype.deleteModel=function(t,r){var o=this.findModels(t,r);if(!_.isEmpty(o))for(var i=0,a=o;i<a.length;i++){var n=a[i],s=this.telemetryService.startEvent(e.telemetry.DashboardDeleteDataset);this.modelExists(t,n.packageId)?this.datasetStore.delete(n.contract,!1,s):s.resolve()}},r.prototype.modelExists=function(e,t){return _.findIndex(this.models,(function(r){return r.id===e&&r.packageId===t}))>-1},r.prototype.getModelRefreshSchedule=function(e,t){return this.findModel(e,t).contract.refreshSchedule},r.prototype.findModel=function(e,t,r){var i=this.findModels(e);if(!_.isEmpty(i)){if(1===i.length)return i[0];var a;return null!=t&&(a=this.getModelByPackageId(i,t),a||!r)?a:(a=_.find(i,(function(e){return o.hasFlag(e.getPermissions(),7)})),a||i[0])}},r.prototype.findModels=function(e,t){var r=this.userExplorableModels;return t?_.filter(r,(function(r){return r.id===e&&r.packageId===t})):_.filter(r,(function(t){return t.id===e}))},r.prototype.findModelByDBName=function(e,t){var r,o=this.userExplorableModels;return r=t?_.find(o,(function(r){return r.dbName===e&&r.packageId===t})):this.findFirstOwnedModelByDBName(e),r||t||(r=_.find(o,(function(t){return t.dbName===e}))),r},r.prototype.findFirstOwnedModelByDBName=function(e){return _.find(this.userExplorableModels,(function(t){return t.dbName===e&&7===(7&t.getPermissions())}))},r.prototype.findFirstExplorableModelByDBName=function(e){var t=this;return _.find(this.userExplorableModels,(function(r){return r.dbName===e&&t.permissionService.isExplorableModel(r)}))},r.prototype.findModelByPackageId=function(e){return this.getModelByPackageId(this.userExplorableModels,e)},r.prototype.findModelsByPackageId=function(e){
return this.getModelsByPackageId(this.userExplorableModels,e)},Object.defineProperty(r.prototype,"editableModels",{get:function(){var e=this;return _.filter(this.models,(function(t){return e.editableModel(t)}))},enumerable:!0,configurable:!0}),r.prototype.canReshare=function(e){var t=this.findModel(e);return this.editableModel(t)},r.prototype.editableModel=function(e){return null!=e&&!e.contract.isHidden&&(t.PermissionsUtils.canReshare(e.getPermissions(),4)&&null==e.contract.originalModelId)},r.prototype.isExplorableNonLegacySampleModel=function(e){var r=e.getPermissions();return e.contentProviderId!==t.constants.samplesContentProviderId&&(this.permissionService.isExplorableModel(e)||o.hasFlag(r,17))},r.prototype.isActionAllowed=function(e,t){return!(this.isInsightAppEnabled&&o.hasFlag(e.deniedActions,t))},r.prototype.areExploreOperationsAuthorized=function(e){var t=e.permissions;return 2===(2&t)||8===(8&t)},Object.defineProperty(r.prototype,"copyAndEditModels",{get:function(){var e=this;return _.filter(this.models,(function(t){return e.isExplorableNonLegacySampleModel(t)}))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"streamingModels",{get:function(){var e=this;return _.filter(this.models,(function(t){return e.isExplorableNonLegacySampleModel(t)&&!!t.realTimeMode}))},enumerable:!0,configurable:!0}),r.prototype.renameModel=function(t,r,o){if(!_.isEmpty(t.trim())){var i=this.findModel(r,o);if(i){if(i.contract.displayName!==t){var a=this.telemetryService.startEvent(e.telemetry.DashboardRenameDataset);this.datasetStore.rename(i.contract,t,a)}}}},r.prototype.updateModelQnaFeatures=function(t,r){var o=this.promiseFactory.defer(),i=this.telemetryService.startEvent(e.telemetry.DashboardUpdateModelQnaFeatures,r.cortanaEnabled,r.powerBIQnaEnabled);return this.modelHttpService.updateModelQnaFeatures(t,r,i.event).then((function(){i.resolve(),o.resolve({})}),(function(){i.reject(),o.reject()})),o.promise},r.prototype.updateFeaturedQuestions=function(t,r){var o=this.promiseFactory.defer(),i=this.telemetryService.startEvent(e.telemetry.DashboardUpdateFeaturedQuestions,r.length);return this.modelHttpService.updateFeaturedQuestions(t,r,i.event).then((function(){i.resolve(),o.resolve({})}),(function(){i.reject(),o.reject()})),o.promise},r.prototype.removeModels=function(e){this.modelCollectionService.removeModels((function(t){return _.includes(e,t.id)}))},Object.defineProperty(r.prototype,"userExplorableModels",{get:function(){return this.sharedDatasetDiscoveryEnabled?this.completeUsableModelList:this.models},enumerable:!0,configurable:!0}),r.prototype.getModelByPackageId=function(e,t){return _.find(e,(function(e){return e.packageId===t}))},r.prototype.getModelsByPackageId=function(e,t){return _.filter(e,(function(e){return e.packageId===t}))},r.prototype.subscribe=function(e){this.modelCollectionService.subscribe(e)},r.prototype.unsubscribe=function(e){this.modelCollectionService.unsubscribe(e)},r.prototype.subscribeDataset=function(){var e=this;this.appMetadataService.getAppMetadata().then((function(){e.datasetStore.datasets.subscribe((function(t){var r=e.modelCollectionService;r.models=t.map((function(t){var o=t.dataset,i=r.findModel(o.id,o.packageId);return i?i.contract!==o&&e.modelMerger.mergeModel(i,o):i=e.modelConverter.convertModel(o),i.categories=t.categories,i})),e.completeUsableModelList=_.concat(e.models,e.explorableDatasets),e._modelsDeferred.resolve(e.modelCollectionService.models)}))}))},r.prototype.subscribeExplorableDatasets=function(){var e=this;this.datasetStore.explorableDatasets.subscribe((function(t){var r=_.keyBy(e.explorableDatasets,(function(e){return e.id}));e.explorableDatasets=_.map(t,(function(t){var o=r[t.id];return o?o.contract!==t&&e.modelMerger.mergeModel(o,t):o=e.modelConverter.convertModel(t),o})),e.completeUsableModelList=_.concat(e.models,e.explorableDatasets)}))},r.prototype.populateSharedModelInfo=function(){if(!this.sharedDatasetDiscoveryEnabled)return this.promiseFactory.reject();var e=this.promiseFactory.defer();return this.datasetStore.loadShared(e),e.promise},r.prototype.isLinked=function(e,t){if(!e)return!1;var r=e.folderId;if(null!=r&&r===t)return!1;if(null==r&&null!=t)return!0;if(r&&t)return r!==t;var i=e.permissions;return(null!=r||!o.hasFlag(i,2))&&o.hasFlag(i,8)},r})();t.ModelService=i})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(){return new i(new o)}var o=e.common.NotifyCollection;t.createCdsaModelCollectionService=r;var i=(function(){function e(e){this.collection=e,this.listeners=[]}return Object.defineProperty(e.prototype,"cdsaModels",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e)},enumerable:!0,configurable:!0}),e.prototype.onAdded=function(e){for(var t=this.listeners,r=0,o=t;r<o.length;r++){var i=o[r];i.onCdsaModelAdded&&i.onCdsaModelAdded(e)}},e.prototype.onDeleted=function(e){for(var t=this.listeners,r=0,o=t;r<o.length;r++){var i=o[r];i.onCdsaModelDeleted&&i.onCdsaModelDeleted(e)}},e.prototype.onReset=function(){for(var e=this.listeners,t=0,r=e;t<r.length;t++){var o=r[t];o.onCdsaModelsReset&&o.onCdsaModelsReset()}},e.prototype.subscribe=function(e){_.isEmpty(this.listeners)&&this.collection.subscribe(this),this.listeners.push(e)},e.prototype.unsubscribe=function(e){_.pull(this.listeners,e),_.isEmpty(this.listeners)&&this.collection.unsubscribe(this)},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,o,i,n,s,c,d,l,u,p){return new a(e,t,r,o,i,n,s,c,d,l,u,p)}var o=jsCommon.StringExtensions;t.createCdsaModelService=r;var i=".json",a=(function(){function t(e,t,r,o,i,a,n,s,c,d,l,u){this.appMetadataService=e,this.telemetryService=t,this.cdsaModelCollectionService=r,this.cdsaModelHttpService=o,this.cdsaModelStore=i,this.errorService=a,this.fileSaver=n,this.localizationService=s,this.modelConverter=c,this.modelMerger=d,this.notificationToast=l,this.promiseFactory=u,this.cdsaModelsDeferred=this.promiseFactory.defer(),this.subscribeCdsaModels()}return Object.defineProperty(t.prototype,"cdsaModels",{get:function(){return this.cdsaModelCollectionService.cdsaModels},set:function(e){this.cdsaModelCollectionService.cdsaModels=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cdsaModelsPromise",{get:function(){return this.cdsaModelsDeferred.promise},enumerable:!0,configurable:!0}),t.prototype.deleteCdsaModel=function(t){var r=this.findCdsaModelById(t);if(r){var o=this.telemetryService.startEvent(e.telemetry.DatapoolDeleteDatapool,r.objectId);this.cdsaModelStore.delete(t,!1,o)}},t.prototype.downloadDplx=function(t,r){return __awaiter(this,void 0,e.Promise,(function(){var e,a,n,s;return __generator(this,(function(c){switch(c.label){case 0:e=this.showDownloadNotification(0),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.cdsaModelHttpService.downloadCdsaModel(t)];case 2:return a=c.sent(),n=JSON.stringify(a.data),this.notificationToast.hide(e),this.fileSaver.saveAs(n,o.normalizeFileName(r+i)),this.showDownloadNotification(1,r),[3,4];case 3:return s=c.sent(),this.notificationToast.hide(e),[3,4];case 4:return[2]}}))}))},t.prototype.findCdsaModelByObjectId=function(e){return _.find(this.cdsaModels,(function(t){return t.contract.objectId===e}))},t.prototype.subscribe=function(e){this.cdsaModelCollectionService.subscribe(e)},t.prototype.unsubscribe=function(e){this.cdsaModelCollectionService.unsubscribe(e)},t.prototype.refreshNow=function(t){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.cdsaModelHttpService.refreshCdsaModel(t.contract.id)];case 1:return e.sent(),this.cdsaModelStore.updateCurrentRefreshStatus(t.id,4),this.notificationToast.notify({title:this.localizationService.get("RefreshingData"),notificationType:3}),[2]}}))}))},t.prototype.cancelRefresh=function(t){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.cdsaModelHttpService.cancelModelRefresh(t.contract.id)];case 1:return e.sent(),this.cdsaModelStore.updateCurrentRefreshStatus(t.id,15),this.notificationToast.hideCurrentNotification(),this.notificationToast.notify({title:this.localizationService.get("CancelingRefresh"),notificationType:3}),[2]}}))}))},t.prototype.validateDataflowRename=function(e,t){var r=_.filter(this.cdsaModels,(function(r){return!!r.displayName&&(r.id!==t&&_.isEqual(_.trim(r.displayName.toLowerCase()),_.trim(e.toLowerCase())))}));return _.isEmpty(r)},t.prototype.updateProperties=function(t,r,o){return __awaiter(this,void 0,e.Promise,(function(){var i,a;return __generator(this,(function(n){if(i=this.findCdsaModelById(t),!i)return[2];try{if(!this.validateDataflowRename(r,t))return i.displayName=i.contract.displayName,i.description=i.contract.description,this.errorService.infoCustom(this.localizationService.get("CdsaModel_CantRenameTitle"),this.localizationService.get("CdsaModel_NameAlreadyExistsMessage")),[2];a=this.telemetryService.startEvent(e.telemetry.DatapoolUpdateProperties,i.objectId),this.cdsaModelStore.updateProperties(t,r,o,a)}catch(e){i.displayName=i.contract.displayName,i.description=i.contract.description,this.errorService.error(this.localizationService.get("CdsaModel_FailToUpdatePropertiesMessage"),"FailToUpdateProperties",{requestId:e.requestId,statusCode:e.status.toString()}),a.reject()}return[2]}))}))},t.prototype.subscribeCdsaModels=function(){var e=this;this.appMetadataService.getAppMetadata().then((function(){e.cdsaModelStore.cdsaModels.subscribe((function(t){e.cdsaModelCollectionService.cdsaModels=t.map((function(t){var r=_.find(e.cdsaModelCollectionService.cdsaModels,(function(e){return e.id===t.id}));return r?(e.modelMerger.mergeCdsaModel(r,t),r):e.modelConverter.convertCdsaModel(t)})),e.cdsaModelsDeferred.resolve(e.cdsaModelCollectionService.cdsaModels)}))}))},t.prototype.findCdsaModelById=function(e){return _.find(this.cdsaModels,(function(t){return t.contract.id===e}))},t.prototype.showDownloadNotification=function(e,t){var r=this.localizationService;switch(e){case 0:return this.notificationToast.notify({title:r.get("ExportingDatapool"),message:r.get("ExportingDatapool_Subtitle"),notificationType:3,sticky:!0});case 1:return this.notificationToast.notify({title:this.localizationService.get("ExportingDatapool_Succeeded"),message:this.localizationService.format("ExportingDatapool_Succeeded_Subtitle",[t]),notificationType:4});default:return}},t})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,o,i,a,s,c,d,l,u,p,h,v,f,m,g){return new n(e,t,r,o,i,a,s,c,d,l,u,p,h,v,f,m,g)}var o,i=e.common.constants;!(function(e){e[e.NamedRange=0]="NamedRange",e[e.Parameter=1]="Parameter",e[e.Table=2]="Table",e[e.PivotTable=3]="PivotTable",e[e.Chart=4]="Chart",e[e.WebExtension=5]="WebExtension"})(o=t.EwaNamedItemType||(t.EwaNamedItemType={})),t.createWorkbookService=r;var a=".xlsx,.xlsm",n=(function(){function t(e,t,r,o,i,a,n,s,c,d,l,u,p,h,v,f,m){var g=this;this.asyncFeatureSwitchService=s,this.workbookStore=f,this.fetchEntityService=m,this.workbookCollectionService=h,this.telemetryService=t,this.rootScope=e,this.errorService=r,this.modelMerger=o,this.modelConverter=i,this.workbookHttpService=a,this.localizationService=n,this.appMetadataService=c,this.promiseFactory=d,this.tutorialDataStore=l,this.compile=u,this.localFileService=p,this.permissionService=v,this.wopiDataTTL=new Array,this.deferredWopiData=Array(),this.workbooksDeferred=d.defer();var b={ensureFetched:function(e){return g.ensureFetched(e)}};this.fetchEntityService.addFetchEntityHandler(16,b),this.replaceWorkbookScope=this.rootScope.$new(),this.replaceWorkbookScope.shouldReplaceLocalWorkbook=!1,this.subscribeWorkbooks()}return Object.defineProperty(t.prototype,"workbooks",{get:function(){return this.workbookCollectionService.workbooks},set:function(e){this.workbookCollectionService.workbooks=e},enumerable:!0,configurable:!0}),t.prototype.postUploadWorkbookErrorMessage=function(e){this.postErrorForWorkbook(e,"UploadExcel_FailedToUploadWorkbook_Title","UploadExcel_FailedToUploadWorkbook_Message")},t.prototype.postReplaceWorkbookErrorMessage=function(e){this.postErrorForWorkbook(e,"UploadExcel_FailedToReplaceWorkbook_Title","UploadExcel_FailedToReplaceWorkbook_Message")},t.prototype.postErrorForWorkbook=function(t,r,o){var a=t.headers(e.common.PowerBIErrorHeader),n=o;if(a){var s=e.common.KnownContentProviderErrors[i.excelContentProviderId],c=s&&s[a];c&&c.messageId&&(n=c.messageId)}this.errorService.error(e.common.localize.get(n),n,{requestId:t.requestId,statusCode:t.status.toString(),title:e.common.localize.get(r)})},t.prototype.replaceLocalWorkbook=function(e){var t=this,r=this.findWorkbookByUniqueId(e);this.replaceWorkbookScope.workbookToUpdate=r;var o,i=this.promiseFactory.defer();o=function(){t.localFileService.chooseLocalFile(i,a)},i.promise.then((function(e){t.getUserConsentToReplace(o,e)})),o=function(){t.replaceWorkbook()},this.localFileService.chooseLocalFile(i,a)},t.prototype.showReplaceWorkbookTutorialIfNeeded=function(e){var r=this;return this.neverShowUpdateExplanation=this.tutorialDataStore.hasKey(t.UpdateLocalWorkbookExplanation),this.neverShowUpdateExplanation?void e():void this.showInputDialog("ReplaceLocalWorkbook_Title","ReplaceLocalWorkbook_Message","ReplaceLocalWorkbook_ReplaceFile","UploadReplace_CancelButton",e,"ToastNotification_DontShowThisAgain",(function(){r.neverShowUpdateExplanation=!r.neverShowUpdateExplanation}))},t.prototype.getUserConsentToReplace=function(e,t){if(t){this.replaceWorkbookScope.localWorkbookToUpload=t;var r=t.name;this.replaceWorkbookScope.workbookToUpdate&&this.replaceWorkbookScope.workbookToUpdate.displayNameWithExtension.toLowerCase()!==r.toLowerCase()?this.showInputDialog("ReplaceLocalWorkbook_DifferentName_Title","ReplaceLocalWorkbook_DifferentName_Message","ReplaceLocalWorkbook_ReplaceFile","UploadReplace_CancelButton",e):this.showReplaceWorkbookTutorialIfNeeded(e)}},t.prototype.showInputDialog=function(e,t,r,o,i,a,n){var s,c=this,d=this.errorService.control(),l=[new InJs.ModalDialogAction(this.localizationService.get(r),function(){d.hideDialog(),c.dismissExplanationPermanentlyIfNeeded(),i()}),new InJs.ModalDialogAction(this.localizationService.get(o),function(){d.hideDialog()})];a&&(s=new InJs.ModalDialogAction(this.localizationService.get(a),function(){n()}));var u=this.localizationService.get(e),p=this.localizationService.get(t);d.showCustomDialog(u,angular.element("<div/>").text(p),l,(function(e){e.parent().find('input[value="'+c.localizationService.get(r)+'"]').focus()}),!1,null,null,null,null,null,null,null,null,null,s)},t.prototype.dismissExplanationPermanentlyIfNeeded=function(){if(this.neverShowUpdateExplanation){var r=this.telemetryService.startEvent(e.telemetry.DashboardUpdateLocalWorkbookNeverShowExplanation);this.tutorialDataStore.setKey(t.UpdateLocalWorkbookExplanation,!0,r)}},t.prototype.replaceWorkbook=function(){this.replaceWorkbookScope.shouldReplaceLocalWorkbook=!0,this.updateLocalWorkbookElement||(this.updateLocalWorkbookTemplate=angular.element(t.HtmlTemplateUpdate),this.updateLocalWorkbookElement=this.compile(this.updateLocalWorkbookTemplate)(this.replaceWorkbookScope),$("body").append(this.updateLocalWorkbookElement)),this.replaceWorkbookScope.$applyAsync()},t.prototype.finishReplacingLocalWorkbook=function(){this.replaceWorkbookScope.shouldReplaceLocalWorkbook=!1},t.prototype.onWorkbookAdded=function(t,r){return __awaiter(this,void 0,e.Promise,(function(){var e,o;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.workbookStore.findById(t,r)];case 1:return(e=i.sent())?[3,3]:(o=this.promiseFactory.defer(),this.workbookStore.add(t,r,o),[4,o.promise]);case 2:i.sent(),i.label=3;case 3:return[2]}}))}))},t.prototype.onWorkbookDeleted=function(t,r){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.workbookStore.findById(t,r)];case 1:return e=o.sent(),this.workbookStore.delete(e,!0),[2]}}))}))},t.prototype.ensureFetched=function(e){return this.onWorkbookAdded(e.id,void 0)},t.prototype.getWorkbookContracts=function(){return this.workbookCollectionService.getWorkbookContracts()},Object.defineProperty(t.prototype,"copyAndEditWorkbooks",{get:function(){var e=this.permissionService;return _.filter(this.workbooks,(function(t){var r=e.getWorkbookEffectivePermissions(t.contract);return 2===(2&r)||17===(17&r)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editAndReShareWorkbooks",{get:function(){var e=this.permissionService;return _.filter(this.workbooks,(function(t){var r=e.getWorkbookEffectivePermissions(t.contract);return 2===(2&r)&&4===(4&r)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastUpdatedTimestamp",{get:function(){return this._lastUpdatedTimestamp},enumerable:!0,configurable:!0}),t.prototype.ensureWorkbookInitialization=function(){return this.workbooksDeferred.promise},t.prototype.updateTimestamp=function(){this._lastUpdatedTimestamp=(new Date).getTime()},t.prototype.findWorkbook=function(e,t){return t?_.find(this.workbooks,(function(r){return r.id===e&&r.packageId===t})):_.find(this.workbooks,(function(t){return t.id===e&&t.isOwner()}))},t.prototype.findWorkbookByEtagHash=function(e){return _.find(this.workbooks,(function(t){return t.contract.etagHash===e}))},t.prototype.findWorkbookByUniqueId=function(e){return _.find(this.workbooks,(function(t){return t.uniqueId===e}))},t.prototype.getWorkbookUniqueId=function(e){return e.uniqueId},t.prototype.subscribeWorkbooks=function(){var e=this;this.appMetadataService.getAppMetadata().then((function(){e.workbookStore.workbooks.subscribe((function(t){e.workbookCollectionService.workbooks=t.map((function(t){var r=_.find(e.workbookCollectionService.workbooks,(function(e){return e.id===t.id&&e.packageId===t.packageId}));return r?(e.modelMerger.mergeWorkbook(r,t),r):e.modelConverter.convertWorkbook(t)})),e.updateTimestamp(),e.workbooksDeferred.resolve(e)}))}))},Object.defineProperty(t.prototype,"originalWorkbooks",{get:function(){var e=this.permissionService;return _.filter(this.workbooks,(function(t){return t.isOwner()&&e.isOriginalWorkbook(t)}))},enumerable:!0,configurable:!0}),t.prototype.renameWorkbook=function(t,r,o){if(!_.isEmpty(t.trim())){var i=this.findWorkbook(r,o);if(i){var a=this.telemetryService.startEvent(e.telemetry.DashboardRenameWorkbook);this.workbookStore.rename(i.contract,t,a)}}},t.prototype.removeWorkbook=function(t,r,o,i){return __awaiter(this,void 0,e.Promise,(function(){var a,n;return __generator(this,(function(s){switch(s.label){case 0:return a=this.telemetryService.startEvent(e.telemetry.DashboardRemoveWorkbook,o,i),[4,this.workbookStore.findById(t,r)];case 1:return n=s.sent(),this.workbookStore.delete(n,!1,a),[2]}}))}))},t.prototype.haveWorkbookEmbedAccessData=function(e){var t=this.deferredWopiData[e],r=this.wopiDataTTL[e];return!(!t||r&&!(r>(new Date).getTime()))},t.prototype.getWorkbookEmbedAccessData=function(t,r,o){var i=this;if(o)var a=this.telemetryService.startChildEvent(o,e.telemetry.DashboardGetWorkbookWopiAccessInformation);else var a=this.telemetryService.startEvent(e.telemetry.DashboardGetWorkbookWopiAccessInformation);if(this.haveWorkbookEmbedAccessData(t))return a.resolve(),this.deferredWopiData[t].promise;var n=this.promiseFactory.defer();this.deferredWopiData[t]=n,this.wopiDataTTL[t]=null;var s=!1;return this.workbookHttpService.getWorkbookWopiData(t,a.event).then((function(e){if(!e.data||!e.data.accessToken||!e.data.url)return void(s=!0);var r=e.data;i.wopiDataTTL[t]=r.accessTokenTtl,i.deferredWopiData[t].resolve(r),a.resolve()}),(function(){s=!0})).finally((function(){s&&(i.deferredWopiData[t].reject(),i.deferredWopiData[t]=null,a.reject())})),n.promise},t.prototype.createExcelWebAppEmbedUrlParams=function(e,t){var r=[{key:"dsdiv",value:e},{key:"dswp",value:"1"},{key:"dsts",value:"None"},{key:"dsat",value:"1"},{key:"dspti",value:"1"},{key:"dsfl",value:"1"},{key:"dsacs",value:this.asyncFeatureSwitchService.featureSwitches.ffxlChartSelectionEnabled?"1":"0"},{key:"dsrc",value:"pplr"}];return t&&r.push({key:"dssc",value:t}),r.map((function(e){return"&"+e.key+"="+e.value})).join("")},t.prototype.embedWorkbook=function(t,r,o,i,a,n,s,c,d,l){var u=this;if(null!==r&&null!==o){var p=this.promiseFactory.defer(),h=this.promiseFactory.defer(),v=d?"&wdPublishedInPbiHint=true":"";return h.promise.then((function(){var d=u.createExcelWebAppEmbedUrlParams(r.targetDiv,l),h=o+"&access_token="+i+"&access_token_ttl="+a+d+v,f=u.promiseFactory.defer();f.promise.then((function(o){o.getSucceeded()?(u.telemetryService.logEvent(e.telemetry.DashboardWorkbookEmbeddingExternalSuccess,t,o.getCorrelationId(),n,c,s),p.resolve({ewaControl:o.getReturnValue(),window:r})):(u.telemetryService.logEvent(e.telemetry.DashboardWorkbookEmbeddingExternalFailure,t,o.getCode(),o.getDescription(),o.getCorrelationId(),n,c,s),p.reject())}),(function(){u.telemetryService.logEvent(e.telemetry.DashboardWorkbookEmbeddingExternalFailure,t,-1,null,null,n,c,s),p.reject()})),r.loadEwaScripts(h,f)})),r.loadEvent=h,r.loaded&&h.resolve(null),p.promise}},t.prototype.getDefaultTileTitle=function(e,t){var r=t,o=e.sheetName;if(o)r+=", "+o.replace(/\''/g,"'");else{var i=e.item.split("!");i.length>1&&(r+=", "+i[0].substr(1,i[0].length-2))}return r},t.prototype.getDefaultTileSubtitle=function(e){var t=e.split("!");return t.length>1?t[1]:e},t.prototype.getTileSelectionQuery=function(e,t,r,i){var a="";return r===o.Chart&&i&&(a="Sheets('"+i+"')/"),a+=this.getNamedItemTypeAsString(r)+"('",e?a+=e:t&&(a+=t),encodeURIComponent(a+"')")},t.prototype.encodeImageTileQueryString=function(e){var t=encodeURI(e);return t=t.replace(/\'/g,"%27"),t=t.replace(/\(/g,"%28"),t=t.replace(/\)/g,"%29")},t.prototype.getNamedItemTypeAsString=function(e){switch(e){case o.NamedRange:return"Ranges";case o.Parameter:return"Parameters";case o.Table:return"Tables";case o.PivotTable:return"PivotTables";case o.Chart:return"Charts"}return"Ranges"},t.prototype.getWorkbookTilePreviewImageUrl=function(e){var t=this,r=this.promiseFactory.defer();return this.getWorkbookEmbedAccessData(e.workbookId,e.packageId).then((function(o){if(e.$config.workbookTile){var i=o.url.replace(/ExcelJs.ashx/i,"/XlRestInternal.aspx");i+="&framemode=proxy&wdRestQuery=$format=image&wdRestPart=Model/"+t.encodeImageTileQueryString(t.getTileSelectionQuery(e.$config.workbookTile.item,e.$config.workbookTile.activeSelection,e.$config.workbookTile.itemType,e.$config.workbookTile.sheetName))+"&access_token="+o.accessToken+"&access_token_ttl="+o.accessTokenTtl,r.resolve(i)}else r.reject()}),(function(){r.reject()})),r.promise},t.prototype.getWorkbookTileBestImageUrl=function(t){if(t.hasImages()){var r=t.images,o=-1,i=-1,a=t.tileModel.layoutPosition,n=e.common.GridLayoutConstants.getDefaultGridItemViewport({colSpan:a.width,rowSpan:a.height}),s=Number.MAX_VALUE,c=Number.MIN_VALUE,d=window.devicePixelRatio;if(n.width=n.width*d,n.height=n.height*d,t.keepOriginalContentSize)return jsCommon.Utility.getAbsoluteUri(r[0].imageUrl);for(var l=0;l<r.length;l++){r[l].width>c&&(c=r[l].width,i=l);var u=r[l].width-n.width,p=r[l].height-n.height,h=Math.max(u,p);h>=0&&h<s&&(s=h,o=l)}return o===-1&&(o=i),jsCommon.Utility.getAbsoluteUri(r[o].imageUrl)}return t.image?"data:image/png;base64,"+t.image:""},t.prototype.setModelDynamicImageUrl=function(e){e.dynamicImageUrl=this.getWorkbookTileBestImageUrl(e),e.dynamicImageUrl||(e.dynamicImageUrl=e.previewImageUrl)},t.prototype.getWorkbooks=function(){return this.workbooksDeferred.promise.then((function(e){return e.workbooks}))},t.prototype.subscribe=function(e){this.workbookCollectionService.subscribe(e)},t.prototype.unsubscribe=function(e){this.workbookCollectionService.unsubscribe(e)},t.HtmlTemplateUpdate="<content-provider-local-file selected-file='localWorkbookToUpload' is-update-from-element-flow='true' ng-if='shouldReplaceLocalWorkbook' element-to-update='workbookToUpdate'></content-provider-local-file>",t.UpdateLocalWorkbookExplanation="updateLocalWorkbookExplanation",t})();t.WorkbookService=n})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(){return new i}var o=e.common.NotifyCollection;t.createWorkbookCollectionService=r;var i=(function(){function e(){this.listeners=[],this.collection=new o}return Object.defineProperty(e.prototype,"workbooks",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e)},enumerable:!0,configurable:!0}),e.prototype.getWorkbookContracts=function(){return _.map(this.workbooks,(function(e){return e.contract}))},e.prototype.addWorkbook=function(e){this.collection.addItem(e)},e.prototype.removeWorkbook=function(e,t){var r=this.collection.deleteItems((function(r){return r.id===e&&r.packageId===t}));return _.head(r)},e.prototype.onAdded=function(e){for(var t=this.listeners,r=0,o=t;r<o.length;r++){var i=o[r];i.onWorkbookAdded&&i.onWorkbookAdded(e)}},e.prototype.onDeleted=function(e){for(var t=this.listeners,r=0,o=t;r<o.length;r++){var i=o[r];i.onWorkbookDeleted&&i.onWorkbookDeleted(e)}},e.prototype.onReset=function(){for(var e=this.listeners,t=0,r=e;t<r.length;t++){var o=r[t];o.onWorkbooksReset&&o.onWorkbooksReset()}},e.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},e.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(t){function r(e,t,r){return new i(e,t,r)}var o=jsCommon.Version;t.createTileConfigUpgraderService=r;var i=(function(){function r(e,r,o){this.upgraders=[t.v0_1.createVersionUpgrader(),t.v1_1.createVersionUpgrader(e,r),t.v1_2.createVersionUpgrader(e,o),t.v1_3.createVersionUpgrader(),t.v1_4.createVersionUpgrader(),t.v1_5.createVersionUpgrader()]}return r.prototype.upgrade=function(t,r,i){if(r){var a=e.ContractUtils.convertToSemanticQueryWithDataShapeBinding(i);r&&(r.version||(r.version=o.ZeroStr));for(var n=0,s=this.upgraders;n<s.length;n++){var c=s[n];o.lt(r.version,c.version)&&c.upgrade(t,r,a)}}},r})();t.TileConfigUpgraderService=i})(t=e.upgrader||(e.upgrader={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var r;!(function(t){var r;!(function(t){function r(){return new o}t.createVersionUpgrader=r;var o=(function(){function t(){this.version="0.1"}return t.prototype.upgrade=function(t,r,o){if(r.version=this.version,o&&o.defn&&!o.defn.Version&&r.visual&&!_.isEmpty(r.visual.elements)&&r.visual.visual===e.visuals.plugins.scatterChart.name){var i=r.visual.elements;if(i[0].DataRoles){for(var a=i[0].DataRoles,n=!1,s=!1,c=!1,d=void 0,l=0,u=a;l<u.length;l++){var p=u[l];"Category"===p.Name&&(n=!0,d=p.Projection),s=s||"Series"===p.Name,c=c||"Size"===p.Name}c&&n&&!s&&a.push({Name:"Series",Projection:d})}}},t})()})(r=t.v0_1||(t.v0_1={}))})(r=t.upgrader||(t.upgrader={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var r;!(function(r){var o;!(function(r){function o(e,t){return new s(e,t)}var i=e.explore.services.upgrade.ExplorationVersions,a=e.explore.util.ThemeUtils,n=t.constants.upgrader;r.createVersionUpgrader=o;var s=(function(){function t(e,t){this.pluginService=e,this.telemetryService=t,this.version="1.1"}return t.prototype.upgrade=function(t,r,o){r.version=this.version;var s=r.visual||r.realTimeVisual;if(s){s.visual||this.telemetryService.logEvent(e.telemetry.TileConfigUpgradeTileConfig,n.NoVisualType);var c={visualType:s.visual};s.stylePresetName&&(c.vcObjects={stylePreset:[{properties:{name:e.data.SQExprBuilder.text(s.stylePresetName)}}]}),c.columnProperties=s.columnProperties;var d=this.pluginService.getPlugin(s.visual),l=d&&d.capabilities.objects,u=e.data.services.DataViewObjectSerializer.deserializeObjects(s.objects,l);u&&(c.objects=u);var p={name:"tile"+t,config:{singleVisual:c}};if(o&&o.defn){var h=e.data.services.SemanticQuerySerializer.tryDeserializeQuery(o.defn);if(h){var v=h.select(),f={};s.elements||(s.elements=[]);for(var m=0,g=e.VisualElement.getDataRolesFromVisualElements(s.elements);m<g.length;m++){var b=g[m],y=v[b.Projection];if(y){var S=b.Name,D=f[S];D||(f[S]=D=new e.data.QueryProjectionCollection([])),D.all().push({queryRef:y.name}),b.isActive&&D.addActiveQueryReference(y.name)}}p.filters=e.explore.FilterUtils.deriveFromSQFilters(h.from(),h.where(),s.queryMetadata),c.query=new e.explore.contracts.VisualQuery(h.where([],new e.data.SQFrom),f,[])}}else delete s.transform;var k={$visualContainer:p,dataWindow:r.realTimeVisual&&r.realTimeVisual.dataWindow,elements:s.elements,heading1:s.heading1,heading2:s.heading2,heading3:s.heading3,layoutType:s.layoutType,queryMetadata:s.queryMetadata,transform:s.transform,$modelExtensions:s.$modelExtensions,themeCollection:s.themeCollection||{},dataSourceVariables:s.dataSourceVariables};s.themeName&&!k.themeCollection.customTheme&&(k.themeCollection.customTheme=a.getThemeMetadata(s.themeName,1,i.v3_18)),s.baseThemeName&&!k.themeCollection.baseTheme&&(k.themeCollection.baseTheme=a.getThemeMetadata(s.baseThemeName,2,i.v3_18)),k=_.omitBy(k,(function(e){return void 0===e})),r.realTimeVisual?r.realTimeVisual=k:r.visualContainer=k}},t})()})(o=r.v1_1||(r.v1_1={}))})(r=t.upgrader||(t.upgrader={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var r;!(function(t){var r;!(function(t){function r(e,t){return new d(e,t)}var o=e.data.DataViewObjectDefinitions,i=e.data.services.DataViewTransformActionsSerializer,a=e.explore.services.upgrade.v3_19,n=e.explore.services.upgrade.v3_20,s=jsCommon.JsonExtensions,c=e.data.SQExprBuilder;t.createVersionUpgrader=r;var d=(function(){function t(e,t){this.pluginService=e,this.featureSwitchService=t,this.version="1.2"}return t.prototype.upgrade=function(e,r,o){r.version=this.version;var i=r.visualContainer||r.realTimeVisual;if(i){var s=i.$visualContainer.config&&i.$visualContainer.config.singleVisual;if(s){var c=s.visualType,d=this.pluginService.capabilities(c),l=(d&&d.objects,_.includes(t.responsiveCartesians,c)),u=a.needsToUpgradeDefaultCategoryColor(c);l&&this.upgradeSingleVisual(s),(l||u)&&i.transform&&this.upgradeSerializedTransform(i,d,l,u),u&&a.upgradeDefaultCategoryColorToFill(s.objects),this.featureSwitchService.featureSwitches.cartesianConditionalFormatting&&n.upgradeGradientOnObjectDef(s.objects,s.query,c)}}},t.prototype.upgradeSingleVisual=function(e){e.objects||(e.objects={}),this.applyResponsiveLegacy(e.objects)},t.prototype.upgradeSerializedTransform=function(e,t,r,o){var n=this.deserializeTransform(e.transform,t);n&&(n.objects||(n.objects={}),r&&this.applyResponsiveLegacy(n.objects),o&&a.upgradeDefaultCategoryColorToFill(n.objects),e.transform=i.serializeTransformActions(i.serializeDataViewTransformActions(n,t&&t.objects)))},t.prototype.deserializeTransform=function(e,t){var r=s.tryParseJSON(e);if(r)return i.deserializeDataViewTransformActions(r,t)},t.prototype.applyResponsiveLegacy=function(e){o.ensure(e,"general",void 0).properties.responsiveLegacy=c.boolean(!0)},t.responsiveCartesians=[e.visuals.plugins.barChart.name,e.visuals.plugins.clusteredBarChart.name,e.visuals.plugins.clusteredColumnChart.name,e.visuals.plugins.columnChart.name,e.visuals.plugins.dataDotClusteredColumnComboChart.name,e.visuals.plugins.dataDotStackedColumnComboChart.name,e.visuals.plugins.hundredPercentStackedBarChart.name,e.visuals.plugins.hundredPercentStackedColumnChart.name,e.visuals.plugins.lineChart.name,e.visuals.plugins.areaChart.name,e.visuals.plugins.stackedAreaChart.name,e.visuals.plugins.lineClusteredColumnComboChart.name,e.visuals.plugins.lineStackedColumnComboChart.name,e.visuals.plugins.scatterChart.name,e.visuals.plugins.waterfallChart.name,e.visuals.plugins.realTimeLineChart.name,e.visuals.plugins.ribbonChart.name],
t})()})(r=t.v1_2||(t.v1_2={}))})(r=t.upgrader||(t.upgrader={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var r;!(function(t){var r;!(function(t){function r(){return new n}var o=e.explore.contracts.VisualContainer.CommonObjectDescriptors,i=e.data.DataViewObjectDefinitions,a=e.data.services.DataViewObjectSerializer;t.createVersionUpgrader=r;var n=(function(){function e(){this.version="1.3"}return e.prototype.upgrade=function(e,t,r){t.version=this.version;var n=t.visual||t.realTimeVisual;if(n&&n.vcObjects){var s=t.visualContainer.$visualContainer.config.singleVisual,c=a.deserializeObjects(n.vcObjects,o);s.vcObjects?i.extend(s.vcObjects,c):s.vcObjects=c}},e})()})(r=t.v1_3||(t.v1_3={}))})(r=t.upgrader||(t.upgrader={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var r;!(function(t){var r;!(function(t){function r(){return new i}var o=e.explore.services.upgrade.UpgradeUtils;t.createVersionUpgrader=r;var i=(function(){function e(){this.version="1.4"}return e.prototype.upgrade=function(e,t,r){t.version=this.version;var i=t.visualContainer||t.realTimeVisual;if(i){var a=i.$visualContainer.config&&i.$visualContainer.config.singleVisual;a&&o.updateSingleVisualConfigPxToPt(a)}},e})()})(r=t.v1_4||(t.v1_4={}))})(r=t.upgrader||(t.upgrader={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var r;!(function(t){var r;!(function(t){function r(){return new i}var o=e.explore.services.upgrade.UpgradeUtils;t.createVersionUpgrader=r;var i=(function(){function e(){this.version="1.5"}return e.prototype.upgrade=function(e,t,r){t.version=this.version;var i=t.visualContainer||t.realTimeVisual;if(i){var a=i.$visualContainer.config&&i.$visualContainer.config.singleVisual;a&&o.updateSingleVisualConfigTextboxPxToPt(a)}},e})()})(r=t.v1_5||(t.v1_5={}))})(r=t.upgrader||(t.upgrader={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t,r,o,i,a,n,s,d,l,u,p,h){return new c(e,t,r,o,i,a,n,s,d,l,u,p,h)}var o=e.dataServices.ContractUtils,i=e.explore.QueryProjectionBuilderCoreUtils,a=e.data.services.SemanticQuerySerializer,n=e.dataServices.contracts.TileType;t.createExportDataService=r;var s="sobe_onpremisevirtualserver",c=(function(){function r(e,t,r,o,i,a,n,s,c,d,l,u,p){this.promiseFactory=e,this.notificationToastService=t,this.localizationService=r,this.conceptualSchemaProxy=o,this.visualPluginService=i,this.visualPluginOps=a,this.featureSwitchService=n,this.displayNameService=s,this.aggrOps=c,this.fileSaver=d,this.lazyScoped=l,this.modelService=u,this.drillToDetails=p}return r.prototype.exportTileDataToCsv=function(r){var n=this,s=r.composite,c=r.contract,d=r.config,l=t.TileUtils.getVisualType(d),u=this.getDataSources(r),p=this.promiseFactory.defer(),h=this.localizationService,v=this.notificationToastService,f=v.notify({title:h.get("ExportData_LoadingTitle"),message:h.get("ExportData_LoadingMessage"),notificationType:3});return this.conceptualSchemaProxy.get(u).then((function(t){v.hide(f);var r=o.convertToSemanticQueryWithDataShapeBinding(c.query),h=a.deserializeQuery(r.defn),m=d.visualContainer.elements,g=m&&m.length>0?m[0].DataRoles:null,b=n.visualPluginService.getPlugin(l),y=i.createProjectionBuilderFromDataRoles(b,g,h,t);if(n.visualPluginService.capabilities(l)){var S=d.visualContainer.$visualContainer.config.singleVisual.objects,D={objects:S,visualType:l,query:new e.explore.contracts.VisualQuery(h,y.build(r.shape),[])};n.exportVisualDataToCsv(d.visualContainer.heading1,{data:s.visual.data,dataTransforms:s.visual.dataTransforms},u,D,null).then((function(e){p.resolve(e)}),(function(e){p.reject(e)}))}}),(function(){v.hide(f)})),p.promise},r.prototype.exportVisualDataToCsv=function(e,t,r,o,i){var a=this.localizationService,n=this.notificationToastService,s=n.notify({title:a.get("ExportData_LoadingTitle"),message:a.get("ExportData_LoadingMessage"),notificationType:3,sticky:!0}),c=this.lazyScoped("exportVisualData").then((function(a){return a.exportToCsv(e,t,r,o,i)}));return this.handleExportDataResult(c,s)},r.prototype.exportVisualDataToExcel=function(t,r,o,i,a,n,s){var c=this,d=this.localizationService,l=this.notificationToastService,u=this.promiseFactory.defer(),p=l.notify({title:d.get("ExportData_LoadingTitle"),message:d.get("ExportData_LoadingMessage"),notificationType:3,sticky:!0});return this.conceptualSchemaProxy.get(r).then((function(d){var l=o;if(a){var p=c.drillToDetails.generateDetailsTable(o,d,n,!0);if(!p)return void u.reject({blob:null,errorDetails:{errorType:4}});l=p}c.promiseFactory.resolve(e.dataServices.utils.generateFiltersDescription(d,i,l,c.visualPluginService,c.displayNameService,c.localizationService)).then((function(e){c.lazyScoped("exportVisualData").then((function(o){return o.exportToExcel(t,r,l,i,e,a,s)})).then((function(e){u.resolve(e)}),(function(e){u.reject(e)}))}),(function(){u.reject({blob:null,errorDetails:{errorType:5}})}))}),(function(){u.reject({blob:null,errorDetails:{errorType:3}})})),this.handleExportDataResult(u.promise,p)},r.prototype.canExportTileData=function(t){if(!this.featureSwitchService.featureSwitches.exportDataEnabled)return!1;if(t.type!==n.composite)return!1;var r=t.composite&&t.composite.visual&&t.composite.visual.type;if(!this.visualPluginService.getPlugin(r))return!1;if(!t.composite.tileData)return!1;if(!this.visualPluginOps.isQueryVisual(r))return!1;try{var i=t&&t.contract&&t.contract.query,a=o.convertToSemanticQueryWithDataShapeBinding(i),s=a.defn;if(!s||!s.Version||s.Version<e.data.SemanticQueryVersions.Version2)return!1}catch(e){return!1}return!0},r.prototype.getExportDataToExcelUnsupportedType=function(e,t){var r=e.objects,o=e.visualType;return r&&r.forecast?3:r&&r.clustering?2:this.visualPluginService.isScriptVisual(o)?4:this.modelService.isActionAllowed(t.contract,8)?0:5},r.prototype.areExploreOperationsAuthorized=function(e){return!!e&&this.modelService.areExploreOperationsAuthorized(e.contract)},r.prototype.isDataModelASOnPremises=function(e){return e&&e.vsName&&e.vsName===s},r.prototype.getDataSources=function(t){var r=t.contract,o=e.explore.contracts.createDataSourceArray(),i={type:"dsr",id:r.modelId,name:r.modelName,dsr:{schemaName:r.modelName,vsName:t.vsName,dbName:t.dbName,modelId:r.modelId}};o.push(i);var a=e.explore.constants.ExplorationSchemaName,n={type:e.explore.dataReaderPlugins.ExplorationDataReaderType,id:r.id,name:a,extends:r.modelName,exploration:{schemaName:a,extends:r.modelName,getModelExtensions:function(){return t.config.visualContainer.$modelExtensions},getDataSourceVariables:function(){return t.config.visualContainer.dataSourceVariables}}};return o.push(n),o},r.prototype.saveResult=function(e){switch(e.format){case 0:this.fileSaver.saveAs(e.blob,e.fileName,{type:"text/csv;charset=utf-8;"});break;case 1:this.fileSaver.saveAs(e.blob,e.fileName,{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;"})}},r.prototype.handleExportDataResult=function(e,t){var r=this,o=this.promiseFactory.defer(),i=this.localizationService,a=this.notificationToastService;return e.then((function(e){null!=e.errorDetails?(a.notify({title:i.get("ExportData_FailureTitle"),message:i.get("ExportData_FailureMessage"),notificationType:2}),o.reject(e)):(e.isPartialResult?a.notify({title:i.get("ExportData_PartialDataTitle"),message:i.get("ExportData_PartialDataMessage"),notificationType:5}):a.notify({title:i.get("ExportData_Success_Header"),message:i.get("ExportData_Success"),notificationType:4,duration:8e3}),r.saveResult(e),o.resolve(e))}),(function(e){var t="ExportData_FailureMessage";6===e.errorDetails.errorType&&(t="ExportData_EmptyColumnName"),a.notify({title:i.get("ExportData_FailureTitle"),message:i.get(t),notificationType:2}),o.reject(e)})).finally((function(){return a.hide(t)})),o.promise},r})();t.ExportDataService=c})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){angular.module("powerbi.dataServices",[]);var r=["powerbi.common","powerbi.visualHost"];angular.module("powerbi.dataServices",r).factory("appCollection",[function(){return e.dataServices.createAppCollectionService()}]).factory("dashboardCollection",[function(){return e.dataServices.createDashboardCollectionService()}]).factory("modelCollection",[function(){return e.dataServices.createModelCollectionService()}]).factory("cdsaModelCollection",[function(){return e.dataServices.createCdsaModelCollectionService()}]).factory("packageCollection",[function(){return e.dataServices.createPackageCollectionService()}]).factory("reportCollection",[function(){return e.dataServices.createReportCollectionService()}]).factory("workbookCollection",[function(){return e.dataServices.createWorkbookCollectionService()}]).factory("appCollection",[function(){return e.dataServices.createAppCollectionService()}]).factory("permissionService",["activeFolderId","impersonationService","packageCollection","modelCollection","reportCollection","dashboardCollection","telemetryService",function(t,r,o,i,a,n,s){return e.dataServices.createPermissionService(t,r,o,i,a,n,s)}]).factory("reportService",["telemetryService","dataServiceModelMerger","dataServiceModelConverter","appMetadataService","promiseFactory","reportCollection","permissionService","reportStore","userInfo","fetchEntityService","groupStore",function(t,r,o,i,a,n,s,c,d,l,u){return e.dataServices.createReportService(t,r,o,i,a,n,s,c,d,l,u)}]).factory("workbookService",["$rootScope","telemetryService","errorService","dataServiceModelMerger","dataServiceModelConverter","workbookHttpService","localizationService","asyncFeatureSwitchService","appMetadataService","promiseFactory","tutorialDataStore","$compile","localFileService","workbookCollection","permissionService","workbookStore","fetchEntityService",function(t,r,o,i,a,n,s,c,d,l,u,p,h,v,f,m,g){return e.dataServices.createWorkbookService(t,r,o,i,a,n,s,c,d,l,u,p,h,v,f,m,g)}]).factory("modelService",["telemetryService","dataServiceModelMerger","dataServiceModelConverter","modelHttpService","appMetadataService","promiseFactory","modelCollection","permissionService","asyncFeatureSwitchService","datasetStore","fetchEntityService","datasetRefreshListener",function(t,r,o,i,a,n,s,c,d,l,u,p){return e.dataServices.createModelService(t,r,o,i,a,n,s,c,d,l,u,p)}]).factory("cdsaModelService",["appMetadataService","telemetryService","cdsaModelCollection","cdsaModelHttpService","cdsaModelStore","errorService","fileSaver","localizationService","dataServiceModelConverter","dataServiceModelMerger","notificationToast","promiseFactory",function(t,r,o,i,a,n,s,c,d,l,u,p){return e.dataServices.createCdsaModelService(t,r,o,i,a,n,s,c,d,l,u,p)}]).factory("dashboardDataService",["dashboardHttpService","groupStore","promiseFactory","asyncFeatureSwitchService","dataServiceModelConverter","dataServiceModelMerger","modelService","dashboardCollection","$timeout","dashboardStore","appMetadataService","permissionService","reportService","datasetRefreshListener","notificationToast","workbookService",function(t,r,o,i,a,n,s,c,d,l,u,p,h,v,f,m){return e.dataServices.createDashboardDataService(t,r,o,i,a,n,s,c,d,l,u,p,h,v,f,m)}]).factory("dashboardSyncService",["$rootScope","dashboardDataService","dashboardHttpService","dataServiceModelConverter","dataServiceModelMerger","modelService","promiseFactory","reportService","resourcePackageListenerService","resourcePackagesService","telemetryService","tutorialDataStore","workbookService","dashboardStore","globalEventBridge","fetchEntityService",function(t,r,o,i,a,n,s,c,d,l,u,p,h,v,f,m){return e.dataServices.createDashboarSyncService(t,r,o,i,a,n,s,c,d,l,u,p,h,v,f,m)}]).factory("tileConfigUpgraderService",["visualPlugin","telemetryService","featureSwitchService",function(e,r,o){return t.upgrader.createTileConfigUpgraderService(e,r,o)}]).factory("dataServiceModelConverter",["geolocationService","geocoder","promiseFactory","moduleLoader","telemetryService","visualPlugin","featureSwitchService","permissionService","tileConfigUpgraderService","localizationService","explorationSerializer","themeService","customVisualsAuthentication",function(t,r,o,i,a,n,s,c,d,l,u,p,h){return e.dataServices.models.createDataServiceModelConverter(t,a,n,e.explore.services.createVisualPluginOps(n,s),s,r,o,i,c,d,l,u,p,h)}]).factory("dataServiceModelMerger",["dataServiceModelConverter","permissionService",function(t,r){var o=e.dataServices.models.createDataServiceModelMerger(t,r);return t.setModelMerger(o),o}]).factory("packageService",["$rootScope","telemetryService","dataServiceModelMerger","dataServiceModelConverter","syncService","packageCollection","promiseFactory","asyncFeatureSwitchService","packageStore","fetchEntityService",function(t,r,o,i,a,n,s,c,d,l){return e.dataServices.createPackageService(t,r,o,i,a,n,s,c,d,l)}]).factory("appService",["appMetadataService","dashboardDataService","appCollection","modelService","reportService","workbookService","promiseFactory","dataServiceModelConverter","modalDialogService","localizationService","appStore","dataServiceModelMerger","groupStore",function(e,r,o,i,a,n,s,c,d,l,u,p,h){return t.createAppService(e,r,o,i,a,n,s,c,d,l,u,p,h)}]).factory("subscriptionsHttp",["httpService","promiseFactory","telemetryService",function(e,r,o){return t.createSubscriptionsHttpService(e,r,o)}]).factory("datasetSizeService",["folderService",function(e){return new t.DatasetSizeService(e)}]).service("resourceOwnershipService",["userInfo",e.dataServices.ResourceOwnershipService]).factory("permissionRefresh",["userInfo","dashboardSyncService","dashboardDataService","promiseFactory",function(e,r,o,i){return t.createPermissionRefreshService(e,r,o,i)}]).factory("smartAlertsHttpService",["httpService",function(t){return e.dataServices.createSmartAlertsHttpService(t)}]).factory("smartAlertsService",["telemetryService","errorService","localizationService","smartAlertsHttpService",function(t,r,o,i){return e.dataServices.createSmartAlertsService(t,r,o,i)}]).factory("fetchEntityService",["promiseFactory",function(t){return e.dataServices.createFetchEntityService(t)}]).factory("rdlReportService",["httpService","promiseFactory",function(t,r){return e.dataServices.createRdlReportsService(r,t)}]).factory("legacySyncListenerService",["featureSwitchService","cdsaModelRefreshListener","contentProviderListener","dashboardRefreshListener","delayedQueryResultResolver","packageRefreshListener","schemaRefresh","reportRefreshListener","workbookRefreshListener","datasetRefreshListener",function(t,r,o,i,a,n,s,c,d,l){return e.dataServices.createLegacySyncListenerService(t,r,o,i,a,n,s,c,d,l)}]).run(["scopedProvider",function(e){e.register("exportData",{services:["promiseFactory","notificationToast","localizationService","conceptualSchemaProxy","featureSwitchService","visualPlugin","displayNameService","aggrOps","fileSaver","modelService"],scopedServices:["lazyScoped","drillToDetails","visualPluginOps"],fn:function(e,r,o,i,a,n,s,c,d,l,u,p,h){return t.createExportDataService(e,r,o,i,n,h,a,s,c,d,u,l,p)}})}])})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){function t(e,t,o,i,a,n,s){return new r(e,t,o,i,a,n,s)}e.createAppInstanceService=t;var r=(function(){function e(e,t,r,o,i,a,n){this.app=e,this.dashboardDataService=t,this.modelService=r,this.reportService=o,this.workbookService=i,this.appStore=a,this.promiseFactory=n}return e.prototype.subscribe=function(e){var t=this;this.unsubscribe(),this.appStore.select(this.app.providerContract.providerKey,this.app.packageId),this.changeHandler=e;var r=this.promiseFactory.defer();return this.subscription=this.appStore.selectedApp.subscribe((function(e){if(t.appSyncModel)e&&t.updateAppSyncModel(t.appSyncModel,e);else{var o=t.appSyncModel=t.getInitialAppSyncModel(t.app,e);r.resolve(o)}})),r.promise},e.prototype.unsubscribe=function(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.appSyncModel=null,this.changeHandler=null},e.prototype.getInitialAppSyncModel=function(e,t){var r=this.dashboardDataService,o=this.reportService,i=this.workbookService,a=this.modelService,n=_.extend({},e,{dashboards:_(t.dashboards).map((function(e){return r.findDashboardByGUID(e.objectId)})).compact().value(),reports:_(t.reports).map((function(e){return o.findReportByGUID(e.objectId)})).compact().value(),workbooks:_(t.workbooks).map((function(e){return i.findWorkbook(e.id,e.packageId)})).compact().value(),models:_(t.models).map((function(e){return a.findModel(e.id,e.packageId)})).compact().value()});return n.dashboardIds=_.map(n.dashboards,(function(e){return e.id})),n.reportIds=_.map(n.reports,(function(e){return e.id})),n.modelIds=_.map(n.models,(function(e){return e.id})),n.workbookIds=_.map(n.workbooks,(function(e){return e.id})),n},e.prototype.updateAppSyncModel=function(e,t){var r=this.dashboardDataService,o=this.reportService,i=this.workbookService,a=this.modelService,n=_(t.dashboards).map((function(e){return r.findDashboardByGUID(e.objectId)})).compact().value();this.onArtifactsReset(n,e.dashboardIds,e.dashboards);var s=_(t.reports).map((function(e){return o.findReportByGUID(e.objectId)})).compact().value();this.onArtifactsReset(s,e.reportIds,e.reports);var c=_(t.workbooks).map((function(e){return i.findWorkbook(e.id,e.packageId)})).compact().value();this.onArtifactsReset(c,e.workbookIds,e.workbooks);var d=_(t.models).map((function(e){return a.findModel(e.id,e.packageId)})).compact().value();this.onArtifactsReset(d,e.modelIds,e.models)},e.prototype.onArtifactAdded=function(e,t,r){_.includes(t,e.id)||(t.push(e.id),r.push(e),this.changeHandler&&this.changeHandler(e,0))},e.prototype.onArtifactDeleted=function(e,t,r){_.includes(t,e.id)&&(_.pull(t,e.id),_.pull(r,e),this.changeHandler&&this.changeHandler(e,1))},e.prototype.onArtifactsReset=function(e,t,r){for(var o=[],i={},a=0,n=e;a<n.length;a++){var s=n[a],c=s.id;o.push(c),i[c]=s}for(var d=_.difference(t,o),l=_.difference(o,t),u=function(e){var o=_.find(r,(function(t){return t.id===e}));p.onArtifactDeleted(o,t,r)},p=this,h=0,v=d;h<v.length;h++){var c=v[h];u(c)}for(var f=0,m=l;f<m.length;f++){var c=m[f];this.onArtifactAdded(i[c],t,r)}},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e){return new o(e)}var o=(function(){function t(e){this.promiseFactory=e,this.fetchEntityHandlers={}}return t.prototype.addFetchEntityHandler=function(t,r){e.contract.checkValue(t,"pre-condition: addFetchEntityHandler() entityType"),e.contract.checkValue(r,"pre-condition: addFetchEntityHandler() handler");var o=this.fetchEntityHandlers[t];o?o.push(r):this.fetchEntityHandlers[t]=[r]},t.prototype.ensureFetched=function(e){if(_.isEmpty(e))return this.promiseFactory.resolve(null);for(var t=[],r=0,o=e;r<o.length;r++){var i=o[r],a=this.fetchEntityHandlers[i.type];if(_.isEmpty(a))break;for(var n=0,s=a;n<s.length;n++){var c=s[n],d=c.ensureFetched(i);d&&t.push(d)}}return this.promiseFactory.all(t)},t})();t.FetchEntityService=o,t.createFetchEntityService=r})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){function t(e,t,o,i,a,n,s,c,d,l){return new r(e,t,o,i,a,n,s,c,d,l)}e.createLegacySyncListenerService=t;var r=(function(){function e(e,t,r,o,i,a,n,s,c,d){this.asyncFeatureSwitchService=e,this.cdsaModelRefreshListener=t,this.contentProviderListener=r,this.dashboardRefreshListener=o,this.delayedQueryResultResolver=i,this.packageRefreshListener=a,this.schemaRefresh=n,this.reportRefreshListener=s,this.workbookRefreshListener=c,this.datasetRefreshListener=d,t.init(),r.init(),o.init(),i.init(),e.featureSwitches.modernPackageRefreshListener&&a.init(),n.init(),s.init(),c.init(),d.init()}return e})();e.LegacySyncListenerService=r})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(e,t){return new o(e,t)}t.createRdlReportsService=r;var o=(function(){function t(e,t){this.httpService=t,this.promiseFactory=e}return t.prototype.discoverDataSources=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(r){return e=this.promiseFactory.defer(),this.httpService.get("metadata/rdl/"+t+"/datasources/monikers",this.httpService.powerbiRequestOptions()).then((function(t){e.resolve(t.data)}),(function(t){e.reject(t)})),[2,e.promise]}))}))},t.prototype.getRdlReportDataSources=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(r){return e=this.promiseFactory.defer(),this.httpService.get("metadata/rdl/"+t+"/datasources",this.httpService.powerbiRequestOptions()).then((function(t){e.resolve(t.data)}),(function(t){e.reject(t)})),[2,e.promise]}))}))},t.prototype.bindRdlToGateway=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(r){return e=this.promiseFactory.defer(),this.httpService.post("metadata/rdl/datasources/monikers/bind",t,this.httpService.powerbiRequestOptions()),[2,e.promise]}))}))},t.prototype.takeoverDatasource=function(e){var t=this.promiseFactory.defer();return this.httpService.post("metadata/rdl/"+e+"/datasources/takeover",null,this.httpService.powerbiRequestOptions()).then((function(e){t.resolve(e)}),(function(e){t.reject(e)})),t.promise},t})();t.RdlReportsService=o})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t,r,o,i,a){var n={filtersNamesAndRestatements:[]};if(!t||_.isEmpty(t.dataFiltersUnmerged))return n;for(var s=o.capabilities(r.visualType),c=0,d=t.dataFiltersUnmerged;c<d.length;c++){var l=d[c];if(!l.isHidden){var u=i.getFilterRestatementForOverlay(l,e,s,null,r);if(!_.isEmpty(u))for(var p=0,h=u;p<h.length;p++){var v=h[p];n.filtersNamesAndRestatements.push({displayName:v.fieldName,qualifiedDisplayName:v.fieldNameToolTip,restatement:v.restatements.join(a.get("ListJoin_Separator"))})}}}return n}e.generateFiltersDescription=t})(t=e.utils||(e.utils={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));;"use strict";var __awaiter=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))(function(r,n){function s(e){try{l(o.next(e))}catch(e){n(e)}}function a(e){try{l(o.throw(e))}catch(e){n(e)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(s,a)}l((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return o([e,t])}}function o(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,n=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,n,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},__decorate=this&&this.__decorate||function(e,t,i,o){var r,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(n<3?r(s):n>3?r(t,i,s):r(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s},powerbi;!(function(e){var t;!(function(t){function i(i,o,r,n,a,c,p,u,d,h,v,g,m,f,b,y){var w=t.CustomerAction(r,n,a,c,p,u,d,h,v,g,m,f,b,y),S=l(w.info,{action:i,booleanValue:o});return{name:t.ExplorationAppBarActionEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:s(),formatted:function(){return e.extendFormatted({action:S.action,booleanValue:S.booleanValue},null,w.formatted())},info:S,loggers:t.ExplorationAppBarActionLoggers}}function o(i,o,r){var n={errorCode:i,errorSource:o,message:r};return{name:t.FailureDuringModelLoadEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:s(),formatted:function(){return e.extendFormatted({errorCode:n.errorCode,errorSource:n.errorSource,message:n.message},null)},info:n,loggers:t.FailureDuringModelLoadLoggers}}function r(i,o,r,n,a,c,p,u,d,h,v,g,m,f,b){var y=t.CustomerAction(o,r,n,a,c,p,u,d,h,v,g,m,f,b),w=l(y.info,{optedIn:i});return{name:t.FilterMigrationPhaseTwoServiceActionEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:s(),formatted:function(){return e.extendFormatted({optedIn:w.optedIn},null,y.formatted())},info:w,loggers:t.FilterMigrationPhaseTwoServiceActionLoggers}}function n(i,o){var r=t.ErrorWithStackTrace(i,o),n=l(r.info,{});return{name:t.InitializeExplorationErrorEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:s(),formatted:function(){return e.extendFormatted(null,null,r.formatted())},info:n,loggers:t.InitializeExplorationErrorLoggers}}var s,a=jsCommon.Utility,l=jsCommon.UnionExtensions.mergeUnionType,c=e.telemetry.EventFactories;s=a?a.generateGuid:Function.prototype,t.ExplorationAppBarActionEventName="PBI.ExplorationAppBar.Action",t.ExplorationAppBarAction=i,c[t.ExplorationAppBarActionEventName]=function(i){return e.telemetryEventFactory(t.ExplorationAppBarActionEventName,i,t.ExplorationAppBarActionLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.FailureDuringModelLoadEventName="PBI.FailureDuringModelLoad",t.FailureDuringModelLoad=o,c[t.FailureDuringModelLoadEventName]=function(i){return e.telemetryEventFactory(t.FailureDuringModelLoadEventName,i,t.FailureDuringModelLoadLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},t.FilterMigrationPhaseTwoServiceActionEventName="PBI.FilterMigrationPhaseTwoServiceAction",t.FilterMigrationPhaseTwoServiceAction=r,c[t.FilterMigrationPhaseTwoServiceActionEventName]=function(i){return e.telemetryEventFactory(t.FilterMigrationPhaseTwoServiceActionEventName,i,t.FilterMigrationPhaseTwoServiceActionLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.InitializeExplorationErrorEventName="PBI.InitializeExplorationError",t.InitializeExplorationError=n,c[t.InitializeExplorationErrorEventName]=function(i){return e.telemetryEventFactory(t.InitializeExplorationErrorEventName,i,t.InitializeExplorationErrorLoggers,t.ErrorWithStackTraceEventName,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)}})(t=e.telemetry||(e.telemetry={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){function i(t){var i=[{name:"AppBarFlyoutMenu",blockType:2,consumerHostFlags:8554},{name:"ExplorationAppBar",blockType:2,consumerHostFlags:8554},{name:"ExplorationContainerLegacy",blockType:2,consumerHostFlags:8522}];o.registerBuildingBlocksForHost(t,i,{componentsTarget:"powerbi.explore.components",componentsMap:e.explore.components,directivesTarget:"powerbi.explore.directives",directivesMap:e.explore.directives})}var o=e.common;angular.module("powerbi.explore").run(["scopedProvider",function(e){e.register("explorationContainerMixins",{services:[],scopedServices:["mixinScoped"],fn:function(e){return e.get("explorationContainer")}}).register("explorationAppBarMixins",{services:[],scopedServices:["mixinScoped"],fn:function(e){return e.get("explorationAppBar")}})}]),t.registerBuildingBlocksForHost=i})(i=t.exploration||(t.exploration={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e.serverErrorPrefix="ServerError_",e.configureScheduledRefreshLink="https://go.microsoft.com/fwlink/?linkid=844603"})(t=e.constants||(e.constants={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t="Flyout",i=(function(){function e(e,t){this.services=t}return e.createOptions=function(){return{additionalServices:["dropdown","overlayService"]}},e.prototype.$onDestroy=function(){this.services.dropdown.hideAll()},e.prototype.openFlyout=function(e){var i=this,o=this.menuOverlayName+t,r=this.services.overlayService.getOverlayElement(o);if(_.isEmpty(r.length)){var n={menuOverlayName:o,menuItemClass:this.menuItemClass,glyphSmall:this.glyphSmall,themeable:!0,menuActionSelected:function(e){return i.menuActionSelected({$item:e})},getMenuActions:function(){return i.flyoutItem.flyoutActions},getMode:function(){return i.getMode()}},s={anchorElement:$(e.currentTarget),blurNeeded:!1,disableAnimation:!0,preferLeft:!1,horizontal:!0};this.services.dropdown.showMenu(n,"appBarMenu.html",s)}},e})();e.AppBarFlyoutMenuController=i})(t=e.controllers||(e.controllers={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){i.AppBarFlyoutMenu={templateUrl:"components/appBarFlyoutMenu/appBarFlyoutMenu.html",controller:e.common.createController(t.controllers.AppBarFlyoutMenuController),bindings:{flyoutItem:"<",menuOverlayName:"<",menuItemClass:"<",glyphSmall:"<",getMode:"&",menuActionSelected:"&"}}})(i=t.components||(t.components={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t,i=jsCommon.EnumExtensions;!(function(e){e[e.Rectangle=0]="Rectangle",e[e.Oval=1]="Oval",e[e.Line=2]="Line",e[e.Triangle=3]="Triangle",e[e.Arrow=4]="Arrow"})(t=e.Shape||(e.Shape={}));var o;!(function(e){function o(e,t,i,o,n,s,a){void 0===a&&(a=!0);var l=[{text:e.get("ReportAppBar_ViewFitToPage"),action:"FitToPage",itemClass:"pbi-glyph-fittopage2",type:DropDownMenuItemType.Item,disabled:!1,checked:1===n,tooltip:e.get("ReportAppBar_ViewFitToPageDescription")},{text:e.get("FitToWidth"),action:"FitToWidth",itemClass:"pbi-glyph-fittowidth",type:DropDownMenuItemType.Item,disabled:!1,checked:2===n,tooltip:e.get("ReportAppBar_ViewFitToWidthDescription")},{text:e.get("ReportAppBar_ViewActualSize"),action:"ActualSize",itemClass:"pbi-glyph-actualsize",type:DropDownMenuItemType.Item,disabled:!1,checked:3===n,tooltip:e.get("ReportAppBar_ViewActualSizeDescription")},{action:null,type:DropDownMenuItemType.Separator},r(e,s)];return o&&(l.push({type:DropDownMenuItemType.Separator}),i.featureSwitches.redlineAlignment&&l.push({text:e.get("ReportAppBar_ShowSmartGuides"),action:"ShowSmartGuides",itemClass:"pbi-glyph-smartguides",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:t.getShowSmartGuides(),tooltip:e.get("ReportAppBar_ShowSmartGuidesDescription")}),l.push({text:e.get("ReportAppBar_ShowGrid"),action:"ShowGrid",itemClass:"pbi-glyph-showgrid",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:t.getShowGridlines(),tooltip:e.get("ReportAppBar_ShowGridDescription")}),l.push({text:e.get("ReportAppBar_SnapToGrid"),action:"SnapToGrid",itemClass:"pbi-glyph-snaptogrid",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:t.getSnapToGrid(),tooltip:e.get("ReportAppBar_SnapToGridDescription")}),l.push({text:e.get("ReportAppBar_LockObjects"),action:"LockObjects",itemClass:"pbi-glyph-lock",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1})),l.push({type:DropDownMenuItemType.Separator}),l.push({text:e.get("ReportAppBar_Selection"),action:"ShowCanvasItems",itemClass:"pbi-glyph-show",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_Selection")}),a&&l.push({text:e.get("ReportAppBar_Bookmarks"),action:"ShowBookmarks",itemClass:"pbi-glyph-bookmark",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_Bookmarks")}),o&&i.featureSwitches.slicerSyncing&&l.push({text:e.get("ReportAppBar_SyncGroupPane"),action:"ShowSyncGroupPane",itemClass:"pbi-glyph-filtersync",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_SyncGroupPane")}),l}function r(e,t){var i=[{text:e.get("None"),action:"HighContrastNone",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:null==t},{text:e.get("HighContrastMode_1"),action:"HighContrast1",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:"HighContrast1"===t},{text:e.get("HighContrastMode_2"),action:"HighContrast2",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:"HighContrast2"===t},{text:e.get("HighContrastMode_Black"),action:"HighContrastBlack",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:"HighContrastBlack"===t},{text:e.get("HighContrastMode_White"),action:"HighContrastWhite",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:"HighContrastWhite"===t}];return{text:e.get("HighContrastMode"),itemClass:"pbi-glyph-blankflyout",type:DropDownMenuItemType.Flyout,flyoutActions:i}}function n(e,t){return[{text:e.get("ReportAppBar_EditReportInWebApp"),description:e.get("ReportAppBar_EditReportInWebAppDescription"),action:"EditInWebApp",itemClass:"pbi-glyph-powerbi-service",type:DropDownMenuItemType.Item,tooltip:e.get("ReportAppBar_EditReportInWebAppDescription")},{text:e.get("ReportAppBar_EditReportInDesktop"),description:e.get("ReportAppBar_EditReportInDesktopDescription"),action:"EditInDesktop",itemClass:"pbi-glyph-powerbi",type:DropDownMenuItemType.Item,disabled:!t,tooltip:t?e.get("ReportAppBar_EditReportInDesktopDescription"):e.get("ReportAppBar_DisabledEditReportInDesktopTooltip")}]}function s(){return[{type:DropDownMenuItemType.CustomComponent,lazyModulePath:"@powerbi/SharedViews/shared-views.module#SharedViewsModule",lazyComponentId:"WebBookmarksComponentId"}]}function a(e,t){var i=e.localizationService,o=[];if(e.showSave&&o.push({text:i.get("ReportAppBar_SaveToDashboard"),description:i.get("ReportAppBar_SaveToDashboardDescription"),action:"SaveToDashboard",itemClass:"pbi-glyph-save",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_SaveToDashboardDescription")}),e.showSaveAs&&o.push({text:i.get("SaveAs"),description:i.get("ReportAppBar_SaveAsDescription"),action:"SaveAs",itemClass:"pbi-glyph-saveas",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_SaveAsDescription")}),e.showPrint&&o.push({text:i.get("ReportAppBar_Print"),description:i.get("ReportAppBar_PrintDescription"),action:"Print",itemClass:"pbi-glyph-print",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_PrintDescription")}),e.showSecurePublishToWeb&&o.push({text:i.get("Embed"),description:i.get("PublishToWebSecure_Description"),action:"SecurePublishToWeb",itemClass:"pbi-glyph-publishtoweb",type:DropDownMenuItemType.Item,tooltip:i.get("PublishToWebSecure_Description")}),e.showSharepointEmbed&&o.push({text:i.get("ReportAppBar_SharePointEmbed"),description:i.get("ReportAppBar_SharePointEmbedDescription"),action:"EmbedSharepoint",itemClass:"pbi-glyph-sharepoint",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_SharePointEmbedDescription")}),e.showEmbed){var r=t?i.get("ReportAppBar_SnapshotEmbedDescription_Disabled_RelativeTimeFilterExists"):i.get("ReportAppBar_SnapshotEmbedDescription");o.push({text:i.get("ReportAppBar_SnapshotEmbed"),description:i.get("ReportAppBar_SnapshotEmbedDescription"),action:"EmbedSnapshot",itemClass:"pbi-glyph-publishtoweb",type:DropDownMenuItemType.Item,tooltip:r,disabled:t})}if(e.showDiagnostics&&o.push({text:i.get("ReportAppBar_Diagnostics"),description:i.get("ReportAppBar_DiagnosticsDescription"),action:"ShowDiagnosticInfo",itemClass:"pbi-glyph-code",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_DiagnosticsDescription")}),e.showPowerPoint&&o.push({text:i.get("ReportAppBar_PowerPoint"),description:i.get("ReportAppBar_PowerPointDescription"),action:"ExportPowerPoint",itemClass:"pbi-glyph-powerpoint",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_PowerPointDescription"),disabled:e.isExportToPowerpointDisabled}),e.showPdf&&o.push({text:i.get("ReportAppBar_Pdf"),description:i.get("ReportAppBar_PdfDescription"),action:"ExportPdf",itemClass:"pbi-glyph-pdf",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_PdfDescription"),disabled:e.isExportToPDFDisabled}),e.showDownloadReport){var n=!e.canDownloadReport||e.downloadReportDenied;o.push({text:i.get("ReportAppBar_DownloadReport"),description:i.get("ReportAppBar_DownloadReportDescription"),action:"DownloadReport",itemClass:"pbi-glyph-download2",type:DropDownMenuItemType.Item,disabled:n,tooltip:i.get(e.downloadReportTooltip)})}return o}function l(e,t){return[{text:e.get("VisualTable_Show"),action:"SeeData",itemClass:"pbi-glyph-seedata",type:DropDownMenuItemType.Item,disabled:!0,checkbox:!0,tooltip:t.isSeeDataMode?e.get("Ribbon_Tooltip_VisualTable_Disable"):e.get("Ribbon_Tooltip_VisualTable")},{type:DropDownMenuItemType.Separator},{text:e.get("DrillDownLevel"),action:"ExpandVisual",itemClass:"pbi-glyph-expand",type:DropDownMenuItemType.Item,disabled:!0,checked:!1,tooltip:e.get("DrillDownLevel_ToolTip")},{text:e.get("DrillDownLevelGrouped"),action:"ExpandVisualGrouped",itemClass:"pbi-glyph-inline-drill",type:DropDownMenuItemType.Item,disabled:!0,checked:!1,tooltip:e.get("DrillDownLevelGrouped_ToolTip")},{text:e.get("DrillUp"),action:"DrillUp",itemClass:"pbi-glyph-drillup",type:DropDownMenuItemType.Item,disabled:!0,checked:!1,tooltip:e.get("DrillUp_ToolTip")},{type:DropDownMenuItemType.Separator},{text:e.get("DrillDown"),action:"DrillDown",itemClass:"pbi-glyph-drilldowndisabled",type:DropDownMenuItemType.Item,checkbox:!0,disabled:!0,tooltip:t.isDrillDownMode?e.get("DrillMode_ToolTip"):e.get("DrillDown_ToolTip")},{text:e.get("Drillthrough"),action:"Drillthrough",itemClass:"pbi-glyph-drillthrough",type:DropDownMenuItemType.Item,checkbox:!0,disabled:!0,tooltip:t.isDrillthroughMode?e.get("DrillthroughMode_ToolTip"):e.get("Drillthrough_ToolTip")},{text:e.get("DataPointTable_Show"),action:"SeeRecords",itemClass:"pbi-glyph-drilltodetail",type:DropDownMenuItemType.Item,checkbox:!0,disabled:!0,tooltip:t.isDrillToDetailsMode?e.get("Ribbon_Tooltip_DataPointTable_On"):e.get("Ribbon_Tooltip_DataPointTable")}]}function c(e){return[d(e.get("ReportAppBar_ShapeRectangle"),e.get("ReportAppBar_ShapeRectangleDescription"),"shapeRectangle",t.Rectangle,"InsertShape"),d(e.get("ReportAppBar_ShapeOval"),e.get("ReportAppBar_ShapeOvalDescription"),"shapeOval",t.Oval,"InsertShape"),d(e.get("ReportAppBar_ShapeLine"),e.get("ReportAppBar_ShapeLineDescription"),"shapeLine",t.Line,"InsertShape"),d(e.get("ReportAppBar_ShapeTriangle"),e.get("ReportAppBar_ShapeTriangleDescription"),"shapeTriangle",t.Triangle,"InsertShape"),d(e.get("ReportAppBar_ShapeArrow"),e.get("ReportAppBar_ShapeArrowDescription"),"shapeArrow",t.Arrow,"InsertShape")]}function p(e){for(var t=new Array,i=[{name:"ReportAppBar_LeftArrow",glyphClass:"back",param:"leftArrow"},{name:"ReportAppBar_RightArrow",glyphClass:"rightarrow",param:"rightArrow"},{name:"Reset",glyphClass:"reload",param:"reset"},{name:"Generic_Back",glyphClass:"backarrow",param:"back"},{name:"ReportAppBar_InfoIcon",glyphClass:"info",param:"information"},{name:"Generic_Help",glyphClass:"help",param:"help"},{name:"Generic_Qna",glyphClass:"qna",param:"qna"},{name:"Generic_Bookmark",glyphClass:"bookmark",param:"bookmarks"},{name:"ReportAppBar_Blank",glyphClass:"blank",param:"blank"}],o=0,r=i;o<r.length;o++){var n=r[o];t.push({text:e.get(n.name),action:"InsertActionButton",itemClass:"pbi-glyph-"+n.glyphClass,type:DropDownMenuItemType.Item,param:n.param})}return t}function u(e,t){var i=[{text:e.get("ReportAppBar_EditVisualInteractions"),action:"EditVisualInteractionsMode",itemClass:"pbi-glyph-visualinteraction",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_EditVisualInteractionsDescription")}];return i.push({text:e.get("ReportAppBar_DrillFilterOtherVisuals"),action:"DrillFilterOtherVisuals",itemClass:"pbi-glyph-drillFilterOtherVisuals",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_DrillFilterOtherVisualsDescription")}),i}function d(e,o,r,n,s){return{text:e,description:o,action:s,itemClass:"displayOption "+r,type:DropDownMenuItemType.Item,param:i.toString(t,n).toLowerCase()}}function h(e){return[{text:e.get("ReportAppBar_Left"),description:e.get("Align_Left"),action:"AlignLeft",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("ReportAppBar_Center"),description:e.get("Align_Center"),action:"AlignCenter",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("ReportAppBar_Right"),description:e.get("Align_Right"),action:"AlignRight",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("Top"),description:e.get("Align_Top"),action:"AlignTop",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("Middle"),description:e.get("Align_Middle"),action:"AlignMiddle",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("Bottom"),description:e.get("Align_Bottom"),action:"AlignBottom",itemClass:"alignAction",type:DropDownMenuItemType.Item}]}function v(e){return[{text:e.get("ReportAppBar_Horizontal"),description:e.get("ReportAppBar_HorizontalDescription"),action:"DistributeHorizontal",itemClass:"distributeAction",type:DropDownMenuItemType.Item},{text:e.get("ReportAppBar_Vertical"),description:e.get("ReportAppBar_VerticalDescription"),action:"DistributeVertical",itemClass:"distributeAction",type:DropDownMenuItemType.Item}]}function g(e,t,i,o,r,n){var s=[];if(o&&s.push({text:e.get("Report_GenerateQRCode"),action:"GenerateQR",tooltip:e.get("Report_GenerateQRCode"),type:DropDownMenuItemType.Item}),t){var a=e.get("ReportAppBar_AnalyzeInExcelMenuItem_Text");r?n||(a=e.format("Permission_ExploreRequiredForFeature",[e.get("ReportAppBar_AnalyzeInExcelMenuItem_Text")])):a=e.get("AnalyzeInExcelDenied_Tooltip"),s.push({text:e.get("ReportAppBar_AnalyzeInExcelMenuItem_Text"),action:"AnalyzeInExcel",tooltip:a,disabled:!r||!n,type:DropDownMenuItemType.Item})}return i.featureSwitches.staticExportReportEnabled&&s.push({text:e.get("ReportAppBar_ExportAsImage"),action:"ExportStaticReport",tooltip:e.get("ReportAppBar_ExportAsImage"),type:DropDownMenuItemType.Item}),s}e.createViewMenuActions=o,e.createEditReportMenuActions=n,e.createBookmarksMenuActions=s,e.createFileMenuActions=a,e.createExploreMenuActions=l,e.createShapeMenuActions=c,e.createActionButtonMenuActions=p,e.createVisualInteractionsActions=u,e.createAlignmentMenuActions=h,e.createDistributeMenuActions=v,e.createReportMoreOptionsMenuItems=g})(o=e.ExplorationAppBarViewModelFactory||(e.ExplorationAppBarViewModelFactory={}))})(t=e.models||(e.models={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var o=t.services,r=o.events,n=e.telemetry.ExplorationAppBarAction,s=t.models.ExplorationAppBarViewModelFactory,a=o.selectionUtils,l=jsCommon.StringExtensions,c=e.common.angularInjectorController,p=e.data.RelativeDateFilterPattern,u=(function(){function i(e,t){this.scope=e,this.services=t,this.extensions={},this.viewModeState=this.services.viewModeState}return i.createOptions=function(){return{additionalServices:["applicationOptions","activeFolderId","highContrastCssGenerationService","dropdown","localizationService","modalDialogService","explorationAppBarNotificationsService","explorationSerializer","featureSwitchService","errorService","checkUnsavedService","telemetryService","$window","powerBIDesktopLauncher","overlayService","downloadReport","userInfo","settingsService","conceptualSchemaProxy","reportService","appService","modelService","$element","permissionService","appSettings","explorationProxy"],scopedDependencies:["eventBridge","bubblingEventBridge","viewModeState","explorationNavigation","explorationCapabilities","explorationAppBarMixins","visibility","drill","selection","visualAuthoring","lazyScoped","dataSources","formFactor","filterGenerator"]}},i.prototype.$onInit=function(){var t=this;this.shapeMenuActions=s.createShapeMenuActions(this.services.localizationService),this.alignActions=s.createAlignmentMenuActions(this.services.localizationService),this.distributeActions=s.createDistributeMenuActions(this.services.localizationService),this.actionButtonMenuActions=s.createActionButtonMenuActions(this.services.localizationService);var i=this.services.featureSwitchService.featureSwitches;this.isFileMenuOpen=!1,this.isViewMenuOpen=!1,this.isExploreMenuOpen=!1,this.isButtonsMenuOpen=!1,this.isVisualInteractionMenuOpen=!1,this.isMoreOptionsMenuOpen=!1,this._isBookmarksMenuOpen=!1,i.pauseQueriesEnabled&&(this.canPause=!0);var o=this;this.services.explorationAppBarMixins.update(new(function(){function e(){}return Object.defineProperty(e.prototype,"viewModel",{get:function(){return o.viewModel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return o.extensions},enumerable:!0,configurable:!0}),e}())),this.scope.$watch((function(){return t.services.viewModeState.getMode()}),(function(e){t.onViewModeChanged(e)})),this.subscriptionManager=this.services.eventBridge.createChannelSubscriptionManager().subscribe(r.visibilityChanged,(function(){t.isPopOutMode=!!t.services.visibility.get()})).subscribe(r.canvasChanged,(function(){var e=t.services.explorationNavigation.getCurrentSection();t.isTransientPage=e.transient})).subscribe(r.onReportChanged,(function(e,i){var o=t.extensions.pinReportPage;o&&o.getPinnedToReportPage()&&(o.pinReportPage(),o.setPinnedToReportPage(!1))}));var n=this.extensions&&this.extensions.appConsumptionAppBarOperations;n&&(this.appConsumptionLazyLoadPath=n.getAppConsumptionModulePath(),this.appConsumptionNavPaneToggleLazyComponentId=n.getAppNavigationPaneToggleComponentId(),this.isAppNavToggleEnabledSubscription=n.getSelectedApp().subscribe((function(i){return __awaiter(t,void 0,e.Promise,(function(){var e=this;return __generator(this,(function(t){switch(t.label){case 0:return i?[3,1]:(this.isAppNavToggleEnabled=!1,this.shouldDisplayAppNavToggleSubscription&&(this.shouldDisplayAppNavToggleSubscription.unsubscribe(),this.shouldDisplayAppNavToggleSubscription=null),[3,3]);case 1:return this.shouldDisplayAppNavToggleSubscription?[3,3]:[4,n.init()];case 2:t.sent(),this.shouldDisplayAppNavToggleSubscription=n.shouldDisplayAppNavToggleInAppBar().subscribe((function(t){e.isAppNavToggleEnabled=t})),t.label=3;case 3:return[2]}}))}))})));var a=this.extensions&&this.extensions.usageMetricsAppBarOperations;a&&a.getNewUsageMetricsSetting().then((function(e){t.newUsageMetricsEnabled=e})),this.initializeHighContrastRules()},i.prototype.$onDestroy=function(){this.subscriptionManager&&this.subscriptionManager.unsubscribeAll(),this.services.explorationAppBarMixins.destroy(),this.isAppNavToggleEnabledSubscription&&this.isAppNavToggleEnabledSubscription.unsubscribe(),this.shouldDisplayAppNavToggleSubscription&&this.shouldDisplayAppNavToggleSubscription.unsubscribe()},i.prototype.hasRelativeTimeFilters=function(){return __awaiter(this,void 0,e.Promise,(function(){var e,t,i,o,r,n,s,a,l,c,u;return __generator(this,(function(d){switch(d.label){case 0:return[4,this.services.conceptualSchemaProxy.get(this.services.dataSources.get())];case 1:return e=d.sent(),t=this.services.explorationNavigation.getCurrentExploration(),t&&t.report&&t.report.id?[4,this.services.explorationProxy.get({id:t.report.id})]:[2,!1];case 2:if(i=d.sent(),o=i.exploration,o&&o.sections)for(r=0,n=o.sections;r<n.length;r++)if(s=n[r],s.visualContainers)for(a=0,l=s.visualContainers;a<l.length;a++)if(c=l[a],u=this.services.filterGenerator.calculateVisualContainerFilter(o,s,c,e),u.dataFilter&&p.anyRelativeTimeFilter(u.dataFilter))return[2,!0];return[2,!1]}}))}))},i.prototype.initializeHighContrastRules=function(){this.services.highContrastCssGenerationService.addRule(".themeableElement .inner-toggle-wrapper input[type=checkbox]~.toggleBox .toggleHandle","{ background-color: @buttonForegroundColor !important }"),this.services.highContrastCssGenerationService.addRule(".themeableElement .inner-toggle-wrapper > input","{ opacity: 0 !important }")},i.prototype.resetUserState=function(){var e=this.extensions.persistentState;e.resetUserState()},i.prototype.isResetUserStateVisible=function(){var e=this.extensions.persistentState;return e&&e.isResetUserStateVisible()},i.prototype.isResetUserStateDisabled=function(){var e=this.extensions.persistentState;return e&&e.isResetUserStateDisabled()},i.prototype.getUserStateTooltip=function(){var e=this.extensions.persistentState;return e&&e.getUserStateTooltip()},i.prototype.unreadAnnotationsCount=function(){return this.extensions.annotations&&this.extensions.annotations.unreadAnnotationsCount()},i.prototype.isCommentVisible=function(){return(this.isCommentingEnabled()||this.isCommentDisabledByAuthor())&&0===this.viewModeState.getMode()},i.prototype.isCommentingEnabled=function(){return!(!this.extensions.annotations||!this.extensions.annotations.isEnabled())},i.prototype.getCommentingTooltip=function(){return this.isCommentingEnabled()?"Comments_Pane_Expand":"Comments_Disabled_Report"},i.prototype.expandCommentingPane=function(){this.extensions.annotations;this.extensions.annotations.togglePane()},i.prototype.onViewModeChanged=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e,i,o,r,n,s,a;return __generator(this,(function(l){switch(l.label){case 0:return(e=1===t)?(this.scope.$emit("EditMode"),this.services.featureSwitchService.featureSwitches.qnaAngularMigration?[4,this.services.lazyScoped("qnaLaunchService")]:[3,3]):[3,8];case 1:return i=l.sent(),o=this,[4,i.supportsQna({allowInViewMode:!1},{DatabaseName:this.viewModel.datasetModel.dbName,VirtualServerName:this.viewModel.datasetModel.vsName})];case 2:return o.isQnaEnabled=l.sent(),[3,7];case 3:return[4,this.services.lazyScoped("qnaExplore")];case 4:return r=l.sent(),[4,this.services.conceptualSchemaProxy.get(this.services.dataSources.get())];case 5:return n=l.sent(),s=this.services.explorationCapabilities.getCapabilities(),a=this,[4,r.isSupported(n,!e,!1,s&&s.qna,{DatabaseName:this.viewModel.datasetModel.dbName,VirtualServerName:this.viewModel.datasetModel.vsName})];case 6:a.isQnaEnabled=l.sent(),l.label=7;case 7:return[3,9];case 8:e||(this.scope.$emit("ViewMode"),this.isQnaEnabled=!1,this.viewModeState.updateConfig((function(e){e.showRelationships&&(e.showRelationships=!1)}))),l.label=9;case 9:return[2]}}))}))},i.prototype.getMoreOptionsMenuActions=function(){var e=this.extensions.analyzeInExcel,t=e&&e.canAnalyzeInExcel(),i=e&&e.canExploreModel(),o=e&&e.isAnalyzeInExcelSupported();return s.createReportMoreOptionsMenuItems(this.services.localizationService,o,this.services.featureSwitchService,this.canGenerateQR(),t,i)},i.prototype.canEmbed=function(){var e=this.canReShareReport(),t=!this.isUsageMetricsReport()&&e&&this.extensions.embed&&this.extensions.embed.canEmbed();if(this.services.featureSwitchService.featureSwitches.sharedDatasetDiscovery){var i=this.extensions.sharedDataset&&this.viewModel.datasetModel&&this.extensions.sharedDataset.isLinked(this.viewModel.datasetModel.contract);return t&&!i}return t},i.prototype.canSecurePublishToWeb=function(){return!this.isUsageMetricsReport()&&this.extensions.embed&&this.extensions.embed.canSecurePublishToWeb()},i.prototype.canSharePointEmbed=function(){return!this.isUsageMetricsReport()&&this.extensions.embed&&this.extensions.embed.canSharePointEmbed()},i.prototype.canExportToPowerPoint=function(){return!this.isUsageMetricsReport()&&this.isNonExternalUser()&&this.extensions.exportToFile&&this.extensions.exportToFile.canExportToFile(1)},i.prototype.canExportToPdf=function(){return!this.isUsageMetricsReport()&&this.isNonExternalUser()&&this.extensions.exportToFile&&this.extensions.exportToFile.canExportToFile(0)},i.prototype.isExportToPdfDisabled=function(){var e=this.extensions.exportToFile;return e&&e.isExportDisabled(0)},i.prototype.isExportToPowerPointDisabled=function(){var e=this.extensions.exportToFile;return e&&e.isExportDisabled(1)},i.prototype.canDuplicatePage=function(){return this.canSaveReport()&&!this.isPopOutMode&&!this.isTransientPage},i.prototype.canSaveReport=function(){var e=this.viewModeState.getMode(),t=this.viewModel.canEdit;return!this.services.explorationCapabilities.getCapabilities().disableSave&&1===e&&t},i.prototype.canPinPage=function(){var e=this.viewModel,t=this.viewModel.canEdit,i=this.services.featureSwitchService.featureSwitches.pinReadable?this.canPin():t;return e&&i&&e.exploration&&e.exploration.contract.reportId&&!this.isTransientPage},i.prototype.pinPageDisabled=function(){var e=this.viewModel;return this.services.featureSwitchService.featureSwitches.pinReadable?e&&!this.canPin():e&&!e.canCopy&&!e.canEdit},i.prototype.showPinPage=function(){return!this.services.explorationCapabilities.getCapabilities().disablePin},i.prototype.canGenerateQR=function(){return!this.isUsageMetricsReport()&&this.extensions.qrCode&&this.extensions.qrCode.canGenerateQRCode()},i.prototype.getFileMenuActions=function(e){var t=this.createFileMenuActions(e),i=_.find(t,(function(e){return"SaveAs"===e.action})),o=this.viewModel.datasetModel,r=o&&o.contract&&o.contract.contentProviderId;if(!r||!i)return t;if(this.isUsageMetricsReport()){var n=this.services.localizationService,s="ReportAppBar_SaveAsDescriptionForUsageMetrics";103===r?i.description=n.format(s,[n.get("ReportAppBar_DashboardsKeyword")]):i.description=n.format(s,[n.get("ReportAppBar_ReportsKeyword")])}return t},i.prototype.onEmbed=function(){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return e=this.extensions.embed,this.services.telemetryService.logEvent(n,"EmbedSnapshot",void 0),[4,e.embed()];case 1:return t.sent(),[2]}}))}))},i.prototype.onSecurePublishToWeb=function(){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(t){
switch(t.label){case 0:return e=this.extensions.embed,this.services.telemetryService.logEvent(n,"SecurePublishToWeb",void 0),[4,e.securePublishToWeb()];case 1:return t.sent(),[2]}}))}))},i.prototype.onSharepointEmbed=function(){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return e=this.extensions.embed,this.services.telemetryService.logEvent(n,"EmbedSharepoint",void 0),[4,e.sharePointEmbed()];case 1:return t.sent(),[2]}}))}))},i.prototype.addQnaContainer=function(){this.services.eventBridge.publishToChannel(r.addQnaContainer,{creationSource:8})},i.prototype.showQnaPopout=function(){this.services.eventBridge.publishToChannel(r.showQnaPopout)},i.prototype.insertTextbox=function(){this.services.eventBridge.publishToChannel(r.createTextbox)},i.prototype.showSwitchMode=function(){return!this.services.explorationCapabilities.getCapabilities().disableSwitchMode},i.prototype.showReportMoreOptionsMenu=function(){return!this.services.explorationCapabilities.getCapabilities().disableMoreOptions&&!!this.viewModel.reportPermission&&this.getMoreOptionsMenuActions().length>0},i.prototype.fileMenuActionSelected=function(e){if(!e.disabled)switch(e.action){case"SaveToDashboard":this.save(0);break;case"SaveAs":this.saveAs();break;case"EmbedSnapshot":this.onEmbed();break;case"EmbedSharepoint":this.onSharepointEmbed();break;case"Print":this.print();break;case"ShowDiagnosticInfo":this.showDiagnosticInfo();break;case"ExportPowerPoint":this.exportToPowerPoint();break;case"ExportPdf":this.exportToPdf();break;case"DownloadReport":this.downloadReport();break;case"SecurePublishToWeb":this.onSecurePublishToWeb()}},i.prototype.createFileMenuActions=function(e){var t=this.viewModeState.getMode(),i=this.services.explorationCapabilities.getCapabilities(),o={localizationService:this.services.localizationService,showSave:!i.disableSave&&1===t,showSaveAs:this.canSaveAs(),showPrint:this.canPrint(),showEmbed:this.canEmbed(),showSecurePublishToWeb:this.canSecurePublishToWeb(),showSharepointEmbed:this.canSharePointEmbed(),showPowerPoint:this.canExportToPowerPoint(),showPdf:this.canExportToPdf(),showDiagnostics:this.services.applicationOptions.diagnostics,showDownloadReport:this.showDownloadReport(),canDownloadReport:this.canDownloadReport(),downloadReportDenied:this.downloadReportDenied(),downloadReportTooltip:this.getDownloadReportTooltip(),isExportToPDFDisabled:this.isExportToPdfDisabled(),isExportToPowerpointDisabled:this.isExportToPowerPointDisabled()};return s.createFileMenuActions(o,e)},i.prototype.showDiagnosticInfo=function(){if(this.viewModel.exploration&&this.viewModel.exploration.contract){var e=this.services.rootScope.$new(),t=this.services.explorationSerializer.serializeExploration(this.viewModel.exploration.contract),i=l.stringifyAsPrettyJSON(t),o={dialogName:"",isDismissable:!0,scope:e,template:"<custom-modal-dialog></custom-modal-dialog>",dialogCssClass:"monotype",notificationText:i};this.services.modalDialogService.showLegacyWebModalDialog(o)}},i.prototype.alignActionSelected=function(e){switch(e.action){case"AlignLeft":this.align(0);break;case"AlignCenter":this.align(1);break;case"AlignRight":this.align(2);break;case"AlignTop":this.align(3);break;case"AlignMiddle":this.align(4);break;case"AlignBottom":this.align(5)}},i.prototype.distributeActionSelected=function(e){switch(e.action){case"DistributeHorizontal":this.align(6);break;case"DistributeVertical":this.align(7)}},i.prototype.align=function(e){var t={alignmentType:e};this.services.eventBridge.publishToChannel(r.align,t)},i.prototype.canPrint=function(){return this.extensions.fileOperations&&this.extensions.fileOperations.canPrintPage()},i.prototype.print=function(){var e=this.extensions.fileOperations;e.printPage()},i.prototype.saveFromButton=function(){this.save(1)},i.prototype.save=function(e){var t={overrideSaveRouting:this.services.explorationCapabilities.getCapabilities().overrideSaveRouting,source:e};this.services.bubblingEventBridge.publishBubbling(this.scope,r.saveExploration,t)},i.prototype.canSaveAs=function(){return this.extensions.fileOperations&&this.extensions.fileOperations.canSaveAs()},i.prototype.saveAs=function(){var e=this.extensions.fileOperations;e.saveAs()},i.prototype.refresh=function(){var e=this.extensions.fileOperations;e.refresh()},i.prototype.edit=function(){var e=this.extensions.fileOperations;if(this.services.featureSwitchService.featureSwitches.enableNewFilterOnAllReports){var t=this.services.explorationNavigation.getCurrentExploration();this.services.explorationAppBarNotificationsService.showFilterPaneMigrationBanner(t,this.services.eventBridge)}e.edit()},i.prototype.stopEditing=function(){this.setFormFactor(0),this.services.eventBridge.publishToChannel(r.requestViewModeChange,0)},i.prototype.navigateBack=function(){this.services.$window.history.back()},i.prototype.exportToPowerPoint=function(){var e=this.extensions.exportToFile;e.exportToFile(1)},i.prototype.exportToPdf=function(){var e=this.extensions.exportToFile;e.exportToFile(0)},i.prototype.viewMenuActionSelected=function(e){if(null!=e.action)if("ShowGrid"===e.action){var t=e.checked=!this.services.settingsService.getShowGridlines(),i=this.services.telemetryService.startEvent(n,e.action,t);this.services.settingsService.setShowGridlines(t,i)}else if("ShowSmartGuides"===e.action){var t=e.checked=!this.services.settingsService.getShowSmartGuides(),o=this.services.telemetryService.startEvent(n,e.action,t);this.services.settingsService.setShowSmartGuides(t,o)}else if("SnapToGrid"===e.action){var t=e.checked=!this.services.settingsService.getSnapToGrid(),s=this.services.telemetryService.startEvent(n,e.action,t);this.services.settingsService.setSnapToGrid(t,s)}else if("ShowBookmarks"===e.action)this.viewModel.bookmarksPane.isPaneVisible=e.checked=!this.viewModel.bookmarksPane.isPaneVisible,this.services.telemetryService.logEvent(n,e.action,e.checked);else if("ShowCanvasItems"===e.action)this.viewModel.canvasItemsPane.isPaneVisible=e.checked=!this.viewModel.canvasItemsPane.isPaneVisible,this.services.telemetryService.logEvent(n,e.action,e.checked);else if("LockObjects"===e.action){var t=e.checked=!this.services.settingsService.getLockObjects();this.services.telemetryService.logEvent(n,e.action,t),this.services.settingsService.setLockObjects(t)}else if("ShowSyncGroupPane"===e.action)this.viewModel.syncGroupPane.isPaneVisible=e.checked=!this.viewModel.syncGroupPane.isPaneVisible,this.services.telemetryService.logEvent(n,e.action,e.checked);else if("HighContrast1"===e.action||"HighContrast2"===e.action||"HighContrastBlack"===e.action||"HighContrastWhite"===e.action||"HighContrastNone"===e.action){var a=void 0;switch(e.action){case"HighContrast1":a="HighContrast1";break;case"HighContrast2":a="HighContrast2";break;case"HighContrastBlack":a="HighContrastBlack";break;case"HighContrastWhite":a="HighContrastWhite";break;case"HighContrastNone":default:a="None"}this.services.eventBridge.publishToChannel(r.highContrastModeChanged,a),this.services.telemetryService.logEvent(n,e.action,void 0)}else{var l=void 0;switch(e.action){case"Dynamic":l=0;break;case"ActualSize":l=3;break;case"FitToWidth":l=2;break;case"FitToPage":l=1}this.services.eventBridge.publishToChannel(r.canvasDisplayChanged,l),this.services.telemetryService.logEvent(n,e.action,void 0)}},i.prototype.visualInteractionsMenuActionSelected=function(e){null!=e.action&&("EditVisualInteractionsMode"===e.action?(this.toggleEditVisualInteractionsMode(),e.checked=this.viewModeState.getConfig().showRelationships,this.services.telemetryService.logEvent(n,e.action,e.checked)):"DrillFilterOtherVisuals"===e.action&&(this.toggleSelectedVisualDrillFilterOtherVisuals(),e.checked=this.getDrillFilterOtherVisualsSetting(),this.services.telemetryService.logEvent(n,e.action,e.checked)))},i.prototype.getDrillFilterOtherVisualsSetting=function(){var e=a.getSelectedVisual(this.services.selection);return e&&e.drillFilterOtherVisuals},i.prototype.editReportMenuActionSelected=function(e){if(this.services.overlayService.hideAllDropdowns(),!e.disabled)switch(e.action){case"EditInWebApp":this.edit();break;case"EditInDesktop":var t=this.services.activeFolderId.activeFolderObjectId,i=this.viewModel&&this.viewModel.exploration&&this.viewModel.exploration.contract&&this.viewModel.exploration.contract.report&&this.viewModel.exploration.contract.report.objectId;t&&i&&this.services.powerBIDesktopLauncher(i,t)}},i.prototype.isEditInDesktopEnabled=function(){return this.services.featureSwitchService.featureSwitches.editInDesktopEnabled},i.prototype.shapeMenuActionSelected=function(e){this.services.eventBridge.publishToChannel(r.createBasicShape,{shapeType:e.param})},i.prototype.actionButtonMenuActionSelected=function(e){this.services.eventBridge.publishToChannel(r.createActionButton,{shapeType:e.param})},i.prototype.togglePlayPause=function(){this.services.eventBridge.publishToChannel(r.pauseQueriesChanged)},i.prototype.showRelatedContentPane=function(){var e=this.extensions.relatedContent;e.viewRelatedContent()},i.prototype.showSendInstantEmailPane=function(){var e=this.extensions.email;e.showSendInstantEmailPane()},i.prototype.showSubscriptionPane=function(){var e=this.extensions.email;e.showSubscriptionPane()},i.prototype.isReportFavoritesEnabled=function(){return 1!==this.viewModeState.getMode()&&!this.isUsageMetricsReport()&&this.isNonExternalUser()&&this.isReportLoaded()},i.prototype.isEmailSubscriptionEnabled=function(){return!this.isUsageMetricsReport()&&this.isNonExternalUser()&&this.isReportLoaded()&&this.extensions.email&&this.extensions.email.isEmailSubscriptionEnabled()},i.prototype.shouldDisableEmailSubscriptions=function(){return this.extensions.email.shouldDisableEmailSubscriptions()},i.prototype.getToolTipBasedOnEnableSubscription=function(){return this.extensions.email.getToolTipBasedOnEnableSubscription()},i.prototype.canShareReport=function(){return!this.isUsageMetricsReport()&&this.isNonExternalUser()&&this.isReportLoaded()&&this.extensions.share&&this.extensions.share.canShare()},i.prototype.showShareSlider=function(){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return e=this.extensions.share,[4,e.share()];case 1:return t.sent(),[2]}}))}))},i.prototype.isViewRelatedContentEnabled=function(){return!this.isUsageMetricsReport()&&this.isReportLoaded()&&this.extensions.relatedContent&&this.extensions.relatedContent.canViewRelatedContent()},i.prototype.canOpenEditReport=function(){return!this.isUsageMetricsReport()&&this.extensions.fileOperations&&this.extensions.fileOperations.canEdit()},i.prototype.showEditReportDisabled=function(){return 0===this.viewModeState.getMode()&&(this.viewModel.canEdit===!1||this.viewModel.canCopy)&&!this.isUsageMetricsReport()},i.prototype.showViewMenu=function(){return!(this.isPopOutMode||0!==this.getCanvasLayout())},i.prototype.showReadingViewButton=function(){return this.showSwitchMode()&&1===this.viewModeState.getMode()&&this.viewModel.canEdit},i.prototype.showEditDropdownMenu=function(){return 0===this.viewModeState.getMode()&&this.viewModel.canEdit&&this.isEditInDesktopEnabled()},i.prototype.showWebLayoutButton=function(){return 0!==this.getCanvasLayout()&&this.showReadingViewButton()},i.prototype.showPhoneLayoutButton=function(){return 0===this.getCanvasLayout()&&this.showReadingViewButton()},i.prototype.showAppBarRight=function(){return 0===this.services.formFactor.getCurrentLayout()},i.prototype.canOpenUsageMetricsReport=function(){var e=this.viewModel&&this.viewModel.canEdit,t=this.viewModel.exploration,i=t&&t.contract&&_.isNumber(t.contract.id),o=this.extensions&&this.extensions.usageMetricsAppBarOperations&&this.extensions.usageMetricsAppBarOperations.canShowUsageMetrics();return!!e&&i&&!this.isUsageMetricsReport()&&0===this.viewModeState.getMode()&&o},i.prototype.openUsageMetricsReport=function(){var e=this.viewModel&&this.viewModel.exploration&&this.viewModel.exploration.contract&&this.viewModel.exploration.contract.report;this.extensions.usageMetricsAppBarOperations.open(e)},i.prototype.getReportModel=function(){var e=this.viewModel.exploration,t=e&&e.contract&&e.contract.reportId;if(t)return this.services.reportService.findReport(t)},i.prototype.showPinReportPageDialog=function(){var e=this.extensions.pinReportPage;e.showPinReportPageDialog()},i.prototype.setFormFactor=function(e){this.services.formFactor.changeFormFactor(e,this.viewModel)},i.prototype.getCanvasLayout=function(){return this.services.formFactor.getCurrentLayout()},i.prototype.setPhonePortraitFormFactor=function(){this.setFormFactor(1)},i.prototype.setMasterFormFactor=function(){this.setFormFactor(0)},i.prototype.duplicateReportPage=function(){var e=this.services.explorationNavigation.getCurrentSection(),i=t.SectionUtils.findSectionIndexForSection(this.viewModel.exploration.contract,e);this.services.eventBridge.publishToChannel(r.duplicateSection,i)},i.prototype.showDatasetErrorDetails=function(){if(this.viewModel.datasetModel){var e=this.services.localizationService;this.services.errorService.error(e.get("InternalSystemErrorMessage"),"ExplorationAppBar_DatasetError",{title:e.get("InternalSystemErrorTitle")})}},i.prototype.toggleEditVisualInteractionsMode=function(){this.services.eventBridge.publishToChannel(r.visualRelationshipsModeChanged)},i.prototype.toggleSelectedVisualDrillFilterOtherVisuals=function(){this.services.visualAuthoring.toggleDrillFilterOtherVisualsSetting()},i.prototype.reportMoreOptionsMenuSelected=function(e){switch(e.action){case"AnalyzeInExcel":this.analyzeInExcel();break;case"GenerateQR":this.generateQRCode();break;case"ExportStaticReport":this.services.eventBridge.publishToChannel(r.exportAsImage)}},i.prototype.exploreMenuActionSelected=function(e,t){if(!e.disabled)switch(e.action){case"SeeData":this.toggleSeeDataMode();break;case"ExpandVisual":this.drillDownLevel(3);break;case"ExpandVisualGrouped":this.drillDownLevel(2);break;case"DrillUp":this.drillUp();break;case"DrillDown":this.setDrillMode(1,t);break;case"Drillthrough":this.setDrillMode(3,t);break;case"SeeRecords":this.setDrillMode(2,t)}},i.prototype.isUsageMetricsReport=function(){return this.viewModel.options&&this.viewModel.options.isUsageMetricsReport},i.prototype.getExploreMenuActions=function(){for(var e=this.getSelectedVisual(),t=this.services.explorationCapabilities.getCapabilities().disableExploreActions,i=this.services.visibility.get(),o=i&&this.services.visibility.isSeeDataMode(i.visibility),r=this.services.drill.isDrillModeEnabled(e,1),n=this.services.drill.isDrillModeEnabled(e,3),a=this.services.drill.isDrillModeEnabled(e,2),l={isSeeDataMode:o,isDrillDownMode:r,isDrillthroughMode:n,isDrillToDetailsMode:a},c=s.createExploreMenuActions(this.services.localizationService,l),p=0,u=c;p<u.length;p++){var d=u[p];switch(d.action){case"SeeData":d.checked=o,d.disabled=t||!this.services.drill.canSeeData(e);break;case"ExpandVisual":d.disabled=t||!this.services.drill.canDrillByDirection(e,4);break;case"ExpandVisualGrouped":d.disabled=t||!this.services.drill.canDrillByDirection(e,2);break;case"DrillDown":d.checked=r;var h=this.services.drill.canDrillByDirection(e,4),v=this.services.drill.canDrillByDirection(e,1);d.disabled=t||!h&&!v;break;case"Drillthrough":d.checked=n,d.disabled=t||!this.services.drill.canDrillthrough(e);break;case"DrillUp":d.disabled=t||!this.services.drill.canDrillByDirection(e,1);break;case"SeeRecords":d.checked=a,d.disabled=t||!this.services.drill.canDrillToDetails(e)}}return c},i.prototype.toggleSeeDataMode=function(){var e=this.services.visibility.get()||this.getSelectedVisual();if(e){var t=e.visibility;2===t||8===t?this.services.visibility.clear():this.services.visibility.set(e,2)}},i.prototype.drillUp=function(){this.services.visualAuthoring.drillUp(null,this.getSelectedVisual())},i.prototype.drillDownLevel=function(e){this.services.visualAuthoring.drillDownLevel(null,this.getSelectedVisual(),e)},i.prototype.setDrillMode=function(e,t){var i=this.getSelectedVisual();if(i){var o=i.drillMode,r=o===e?0:e;this.services.drill.setDrillMode(i,r);for(var n=0,s=t;n<s.length;n++){var a=s[n];"DrillDown"===a.action?a.checked=this.services.drill.isDrillModeEnabled(i,1):"Drillthrough"===a.action?a.checked=this.services.drill.isDrillModeEnabled(i,3):"SeeRecords"===a.action&&(a.checked=this.services.drill.isDrillModeEnabled(i,2))}}},i.prototype.getFileMenuPropertiesGetter=function(){return __awaiter(this,void 0,e.Promise,(function(){var e,t=this;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.hasRelativeTimeFilters()];case 1:return e=i.sent(),[2,function(i){return{menuName:"fileMenu",displayOptions:{anchorElement:i,blurNeeded:!1,disableAnimation:!0,preferLeft:!1},menuActions:t.getFileMenuActions(e),menuActionSelected:function(e){return t.fileMenuActionSelected(e)}}}]}}))}))},i.prototype.getViewMenuProperties=function(e){var t=this;return{menuName:"viewMenu",menuItemClass:"view-menu",glyphSmall:!0,displayOptions:{anchorElement:e,blurNeeded:!1,disableAnimation:!0,preferLeft:!1},menuActions:this.getViewMenuActions(),menuActionSelected:function(e){return t.viewMenuActionSelected(e)}}},i.prototype.getBookmarksMenuProperties=function(e){return this.extensions.bookmark.getBookmarksMenuProperties(e,this.viewMenuActionSelected,!1)},i.prototype.getActionButtonMenuProperties=function(e){var t=this;return{menuName:"actionButtonMenu",menuItemClass:"actionButton-menu",glyphSmall:!0,displayOptions:{anchorElement:e,blurNeeded:!1,disableAnimation:!0,preferLeft:!1},menuActions:this.actionButtonMenuActions,menuActionSelected:function(e){return t.actionButtonMenuActionSelected(e)}}},i.prototype.getEditReportMenuProperties=function(e){var t=this;return{menuName:"editReportMenu",displayOptions:{anchorElement:e,blurNeeded:!1,disableAnimation:!0,preferLeft:!1},menuActions:this.getEditReportMenuActions(),menuActionSelected:function(e){return t.editReportMenuActionSelected(e)}}},i.prototype.getExploreMenuProperties=function(e){var t=this,i=this.getExploreMenuActions();return{menuName:"exploreMenu",menuItemClass:"explore",glyphSmall:!0,displayOptions:{anchorElement:e,blurNeeded:!1,disableAnimation:!0,preferLeft:!1},menuActions:i,menuActionSelected:function(e){return t.exploreMenuActionSelected(e,i)}}},i.prototype.getVisualInteractionsMenuProperties=function(e){var t=this;return{menuName:"visualInteractionsMenu",menuItemClass:"visualInteractions-menu",glyphSmall:!0,displayOptions:{anchorElement:e,blurNeeded:!1,disableAnimation:!0,preferLeft:!1},menuActions:this.getVisualInteractionsMenuActions(),menuActionSelected:function(e){return t.visualInteractionsMenuActionSelected(e)}}},i.prototype.getMoreOptionsMenuProperties=function(e){var t=this;return{menuName:"reportMoreOptionsMenu",menuItemClass:"moreOptions",displayOptions:{anchorElement:e,blurNeeded:!1,preferLeft:!0},menuActions:this.getMoreOptionsMenuActions(),menuActionSelected:function(e){return t.reportMoreOptionsMenuSelected(e)}}},i.prototype.isMenuDisabled=function(e){return _.every(e.menuActions,(function(e){return e.disabled||!e.action}))},Object.defineProperty(i.prototype,"isBookmarksMenuOpen",{get:function(){return this._isBookmarksMenuOpen},enumerable:!0,configurable:!0}),i.prototype.showBookmarksMenu=function(e){var t=this;this._isBookmarksMenuOpen||(this._isBookmarksMenuOpen=!0,this.extensions.dropdownMenu.showMenu(e,(function(e){return t.getBookmarksMenuProperties(e)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(c),(function(){return setTimeout((function(){return t._isBookmarksMenuOpen=!1}),100)})))},i.prototype.showFileMenu=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e,i=this;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.getFileMenuPropertiesGetter()];case 1:return e=o.sent(),this.isFileMenuOpen||(this.isFileMenuOpen=!0,this.extensions.dropdownMenu.showMenu(t,(function(t){return e(t)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(c),(function(){return setTimeout((function(){return i.isFileMenuOpen=!1}),100)}))),[2]}}))}))},i.prototype.showViewDropdown=function(e){var t=this;this.isViewMenuOpen||(this.isViewMenuOpen=!0,this.extensions.dropdownMenu.showMenu(e,(function(e){return t.getViewMenuProperties(e)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(c),(function(){return setTimeout((function(){return t.isViewMenuOpen=!1}),100)})))},i.prototype.showEditMenu=function(e){var t=this;this.extensions.dropdownMenu.showMenu(e,(function(e){return t.getEditReportMenuProperties(e)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(c))},i.prototype.showExploreMenu=function(e){var t=this;this.isExploreMenuOpen||(this.isExploreMenuOpen=!0,this.extensions.dropdownMenu.showMenu(e,(function(e){return t.getExploreMenuProperties(e)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(c),(function(){return setTimeout((function(){return t.isExploreMenuOpen=!1}),100)})))},i.prototype.showActionMenu=function(e){var t=this;this.isButtonsMenuOpen||(this.isButtonsMenuOpen=!0,this.extensions.dropdownMenu.showMenu(e,(function(e){return t.getActionButtonMenuProperties(e)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(c),(function(){return setTimeout((function(){return t.isButtonsMenuOpen=!1}),100)})))},i.prototype.showVisualInteractionMenu=function(e){var t=this;this.isVisualInteractionMenuOpen||(this.isVisualInteractionMenuOpen=!0,this.extensions.dropdownMenu.showMenu(e,(function(e){return t.getVisualInteractionsMenuProperties(e)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(c),(function(){return setTimeout((function(){return t.isVisualInteractionMenuOpen=!1}),100)})))},i.prototype.showMoreOptionsMenu=function(e){var t=this;this.isMoreOptionsMenuOpen||(this.isMoreOptionsMenuOpen=!0,this.extensions.dropdownMenu.showMenu(e,(function(e){return t.getMoreOptionsMenuProperties(e)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(c),(function(){return setTimeout((function(){return t.isMoreOptionsMenuOpen=!1}),100)})))},i.prototype.getSelectedVisual=function(){return a.getSelectedVisual(this.services.selection)},i.prototype.getDisplayOption=function(){return this.viewModel&&this.viewModel.exploration&&this.viewModel.exploration.exploreCanvas&&this.viewModel.exploration.exploreCanvas.contract&&this.viewModel.exploration.exploreCanvas.contract.size&&this.viewModel.exploration.exploreCanvas.contract.size.displayOption},i.prototype.getViewMenuActions=function(){for(var e=this.getDisplayOption(),t=this.services.explorationCapabilities.getCapabilities(),i=this.services.explorationNavigation.getCurrentExploration(),o=i&&i.themeCollection.highContrastTheme,r=s.createViewMenuActions(this.services.localizationService,this.services.settingsService,this.services.featureSwitchService,1===this.viewModeState.getMode(),this.getDisplayOption(),o&&o.name,!t.disableBookmarksPane),n=0,a=r;n<a.length;n++){var l=a[n];"Dynamic"===l.action?l.checked=0===e:"FitToPage"===l.action?l.checked=1===e:"FitToWidth"===l.action?l.checked=2===e:"ActualSize"===l.action?l.checked=3===e:"ShowGrid"===l.action?l.checked=this.services.settingsService.getShowGridlines():"ShowSmartGuides"===l.action?l.checked=this.services.settingsService.getShowSmartGuides():"SnapToGrid"===l.action?l.checked=this.services.settingsService.getSnapToGrid():"ShowBookmarks"===l.action?l.checked=this.viewModel.bookmarksPane.isPaneVisible:"ShowCanvasItems"===l.action?l.checked=this.viewModel.canvasItemsPane.isPaneVisible:"LockObjects"===l.action?l.checked=this.services.settingsService.getLockObjects():"ShowSyncGroupPane"===l.action&&(l.checked=this.viewModel.syncGroupPane.isPaneVisible)}return r},i.prototype.getEditReportMenuActions=function(){return s.createEditReportMenuActions(this.services.localizationService,this.viewModel&&this.viewModel.isReportFromPbix)},i.prototype.getVisualInteractionsMenuActions=function(){for(var e=s.createVisualInteractionsActions(this.services.localizationService,this.services.featureSwitchService),t=0,i=e;t<i.length;t++){var o=i[t];"EditVisualInteractionsMode"===o.action&&(o.checked=this.viewModeState.getConfig().showRelationships),"DrillFilterOtherVisuals"===o.action&&(o.checked=this.getDrillFilterOtherVisualsSetting(),o.disabled=!this.getSelectedVisual())}return e},i.prototype.isNonExternalUser=function(){return _.isEmpty(this.services.appSettings.externalTenantId)},i.prototype.isReportLoaded=function(){if(!this.viewModel)return!1;var e=this.viewModel.exploration;return null!=(e&&e.contract&&e.contract.report)},i.prototype.canPin=function(){return this.isReportLoaded()&&this.extensions.pinReportPage&&this.extensions.pinReportPage.canPinReportPage()},i.prototype.isCommentDisabledByAuthor=function(){return this.extensions.annotations&&this.extensions.annotations.isCommentDisabledByAuthor()},i.prototype.canCopyAppReport=function(){var e=this.viewModel.exploration,t=e&&e.contract&&e.contract.report&&e.contract.report.packageId,i=this.services.appService.getAppInstance(t),o=i&&i.allowCopyContent,r=this.viewModel.datasetModel&&this.services.permissionService.isExplorableModel(this.viewModel.datasetModel);return this.services.featureSwitchService.featureSwitches.allowExploreDatasetOfApp&&o&&r},i.prototype.showNewUsageMetricsToggle=function(){var e=this.viewModel.exploration,t=e&&e.contract&&e.contract.report;return this.isUsageMetricsReport()&&this.extensions&&this.extensions.usageMetricsAppBarOperations&&this.extensions.usageMetricsAppBarOperations.isNewUsageMetricsEnabled(t)},i.prototype.onNewUsageMetricsToggleChange=function(){return this.extensions&&this.extensions.usageMetricsAppBarOperations&&this.extensions.usageMetricsAppBarOperations.updateNewUsageMetricsSettingAndRedirect(this.newUsageMetricsEnabled)},i.prototype.canReShareReport=function(){return 4===(4&this.viewModel.reportPermission)},i.prototype.analyzeInExcel=function(){var e=this.extensions.analyzeInExcel;e.analyzeInExcel()},i.prototype.showDownloadReport=function(){return this.extensions.downloadReport&&this.extensions.downloadReport.showDownloadReport()},i.prototype.canDownloadReport=function(){return this.extensions.downloadReport&&this.extensions.downloadReport.canDownloadReport()},i.prototype.downloadReportDenied=function(){return this.extensions.downloadReport&&this.extensions.downloadReport.downloadReportDenied()},i.prototype.downloadReport=function(){var e=this.extensions.downloadReport;e.downloadReport()},i.prototype.getDownloadReportTooltip=function(){return this.extensions.downloadReport?this.extensions.downloadReport.getDownloadReportTooltip():""},i.prototype.generateQRCode=function(){var e=this.extensions.qrCode;e.generateQRCode()},i})();i.ExplorationAppBarController=u})(i=t.controllers||(t.controllers={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){i.ExplorationAppBar={bindings:{viewModel:"<"},templateUrl:"components/explorationAppBar/explorationAppBar.html",controller:e.common.createController(t.controllers.ExplorationAppBarController)}})(i=t.components||(t.components={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i;!(function(t){function i(e){return!_.isEmpty(e)&&!_.isEmpty(e.filterInfo)}function o(e,t,o,n,s){return!!i(n)&&(0===n.filterApplyScope&&r(e,t,o,n,s))}function r(e,t,i,o,r){var a=n(t,o,r);if(_.isEmpty(a))return!1;for(var l={activeSection:void 0,sections:{}},c={skipUnmatchedDrillthroughFilters:!0,filterMatchingBehavior:o.filterMatchingBehavior},p=0,u=i.sections;p<u.length;p++){var d=u[p];if(1!==d.type){var h=s.getFiltersState(d,c,a);l.sections[d.name]={filters:h}}}if(_.isEmpty(l.sections))return!1;var v={clearUnmatchedData:!1,suppressActiveSection:!0};return e.apply(l,t,v),!0}function n(e,t,i){var o=_.cloneDeep(t.filterInfo);return a.rewriteVariationTargetEntities(o,e),_.remove(o,(function(t){if(null==t||null==t.filter)return!0;var o=t.filter.validate(e,i);return!_.isEmpty(o)})),o}var s=e.explore.DrillthroughUtils,a=e.explore.VariationUtils;t.hasDrillthroughFilters=i,t.applyDrillthroughFilters=o})(i=t.ExplorationContainerDrillthroughApplier||(t.ExplorationContainerDrillthroughApplier={}))})(i=t.helpers||(t.helpers={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e){return{errorCode:r(e),errorSource:o(e)}}function o(e){var i=e&&e.clientError,o=r(e);return _.includes(t.UserErrors,o)?"User":_.includes(t.ExternalErrors,o)?"External":i&&null!=i.source?i.source:"PowerBI"}function r(t){var i=t&&t.serviceError&&t.serviceError.errorCode,o=t&&t.clientError&&t.clientError.code;return i||o||e.ModelFailednoErrorInfo}t.UserErrors=[e.DM_GWPipeline_Gateway_CancellationError,e.DM_GWPipeline_Gateway_CancellationOrTimeoutError,e.DM_GWPipeline_Gateway_ImpersonationError,e.DM_GWPipeline_Gateway_InvalidConnectionCredentials,e.DM_GWPipeline_Gateway_TimeoutError,e.DMTS_DatasourceHasNoCredentialError,e.DMTS_NoGatewayWithAllDatasourcesToBindError,e.DMTS_MultipleGatewaysWithAllDatasourcesToBindError,e.DMTS_OAuthTokenRefreshFailedError,e.DMTS_UserNotFoundInADGraphError,e.DMTS_UserLostPermissionToDatasourceError,e.PowerBINotAuthorizedException,e.ModelSizeExceedsSharedCapacityLimit,e.TokenExpired,e.UserNotLicensed,e.RS_AccessDenied,e.RS_AccessDeniedDueToRLSGroup,e.RS_ErrorOpeningConnection,"HttpStatusCode = -1","HttpStatusCode = 401",e.IgnorableClientError.Code],t.ExternalErrors=[e.DM_GWPipeline_Gateway_ConnectionBrokenException,e.DM_GWPipeline_Client_GatewayUnreachable,e.DM_GWPipeline_Gateway_DataSourceAccessError,e.DM_GWPipeline_Gateway_AdomdConnectError,e.DM_GWPipeline_Gateway_UnprocessedStructureError,e.DM_GWPipeline_Gateway_MashupDataAccessError],t.getTelemetryErrorDetails=i,t.getErrorSource=o,t.getErrorCode=r})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t=2e3,i=(function(){function e(e,t){this.newQueryResultUpdates=[],this.explorationId=e,this.explorationProxy=t}return e.prototype.onNewQueryCacheResultAvailable=function(e){var i=this,o=_.find(this.newQueryResultUpdates,(function(t){return t.visualContainerId===e.visualContainerId}));return o?(o.query=e.query,void(o.dataTransforms=e.dataTransforms)):(this.newQueryResultUpdates.push(e),void(1===this.newQueryResultUpdates.length&&setTimeout((function(){var e={visualQueryResults:_.map(i.newQueryResultUpdates,(function(e){return{visualContainerId:e.visualContainerId,query:e.query,dataTransforms:e.dataTransforms}}))};i.explorationProxy.saveVisualContainerQueries(i.explorationId,e),i.newQueryResultUpdates=[]}),t)))},e})();e.VisualContainerQueryUpdater=i})(t=e.helpers||(e.helpers={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){function o(e){var t=e.sections;if(_.isEmpty(t))return!1;for(var i=0,o=t;i<o.length;i++){var r=o[i],n=r.visualContainers;if(!_.isEmpty(n))for(var s=0,a=n;s<a.length;s++){var l=a[s],c=l.config.singleVisual.visualType;if("table"===c||"matrix"===c)return!0}}return!1}var r=e.common.contracts.DataCacheModeType,n=t.constants.DefaultDrillFilterOtherVisuals,s=e.telemetry.EXOpenExplorationEventName,a=e.errorDetailsHelper,l=e.explore.helpers.ExplorationContainerDrillthroughApplier,c=e.explore.util.ExplorationTelemetryUtil,p=t.util.ExplorationTrustedVisualUtil,u=e.explore.util.ExplorationUtil,d=e.MonitorWith,h=e.PbiPromise,v=e.contracts.ResourcePackageItemType,g=e.explore.util.ScriptVisualsUtil,m=e.explore.SectionUtils,f=e.visualHost.ThemeUtils,b=e.explore.services.undoRedoStrategy.UndoRedoStack,y=e.explore.viewModels.ViewModelFactory,w=e.explore.viewModels,S=e.explore.contracts.VisualContainer,x=t.util.VisualContainerUtils,M=e.common.constants,C=e.common.events,E=jsCommon.CssConstants.createClassAndSelector,D=e.common.constants.dsrDataReaderType,P=e.explore.services.events,A=e.explore.util.ThemeUtils.getCurrentBaseThemeMetadata,T=e.visualHost.CustomVisualsUtils.isOrganizationalCustomVisual,R=(function(){
function e(e,t){this.core=new I(e,t),e.C=this.core}return Object.defineProperty(e.prototype,"viewModel",{set:function(e){this.core.viewModel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvasOptions",{set:function(e){this.core.canvasOptions=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"explorationContainerOptions",{set:function(e){this.core.explorationContainerOptions=e},enumerable:!0,configurable:!0}),e.createOptions=function(){return{additionalServices:["$element","checkUnsavedService","conceptualSchemaProxy","highContrastCssGenerationService","dataProxy","datasetSizeService","displayNameService","errorService","explorationProxy","explorationSerializer","featureSwitchService","globalEventBridge","modelService","localizationService","modalDialogService","moduleLoader","notificationBarService","overlayService","packageService","pbiLazyLoad","permissionService","promiseFactory","reportService","telemetryService","lazyProviderModern","themeService","userInfo","visualStylePresetService","trustedVisual","subscription","activeFolderId","viewRelatedContentService","lazy","linguisticSchemaProxy","aggrOps","visualTimeSynchronizationService"],scopedDependencies:["cachePolicyProviderService","canvasKeyHandler","clipboard","itemPicker","customVisualLoader","dataSources","deleteVisual","drillToDetails","eventBridge","explorationCapabilities","explorationContainerMixins","explorationNavigation","explorationStateManager","filterGenerator","formFactor","layoutAuthoring","modelChangeHandler","visibility","staticResourceReferences","resourceLoader","resourceRegistration","scriptVisuals","selection","sort","undoRedo","viewModeState","visualAuthoring","visualPlugin","visualQueryGenerator","visualLifecycleService","lazyScoped","reportRefresh","visualSync","reportAutoRefresh"]}},e.prototype.$onInit=function(){this.core.$onInit()},e.prototype.$onChanges=function(e){this.core.$onChanges(e)},e.prototype.$onDestroy=function(){this.core.$onDestroy()},e})();i.ExplorationContainerLegacyController=R;var I=(function(){function i(e,t){this.$scope=e,this.services=t,this.extensions={},this.ExplorationHostSelector=E("explorationHost"),this.ExploreCanvasSelector=E("horizontalItemsContainer")}return Object.defineProperty(i.prototype,"explorationFluentNavigationModulePath",{get:function(){return"@powerbi/ExplorationFluentNavigation/exploration-fluent-navigation.module#ExplorationFluentNavigationModule"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"exploreUIShellConfig",{get:function(){return t.modules.ExploreUIShellModule},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"jQueryUIConfig",{get:function(){return e.common.modules.JQueryUIModule},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"exploreUIAuthoringModulePath",{get:function(){return"@powerbi/ExploreUIAuthoring/explore-ui-authoring.module#ExploreUIAuthoringModule"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"exploreUIExportModulePath",{get:function(){return"@powerbi/ExploreUIExport/module#ExploreUIExportModule"},enumerable:!0,configurable:!0}),i.prototype.$onInit=function(){var e=this;this.featureSwitchService=this.services.featureSwitchService,this.viewModeState=this.services.viewModeState,this.services.explorationNavigation.registerExplorationViewModel((function(){return e.viewModel})),this.useModernFooter=this.services.featureSwitchService.featureSwitches.useModernFooter,this.initializeViewModel();var t=w.createFieldListViewModelFactory(w.createFieldListMenuItemFactory(this.services.localizationService,this.services.featureSwitchService),w.createFieldListPropertyTemplateGenerator(),this.services.localizationService,this.services.featureSwitchService);this.fieldListConfig={viewModelFactory:t,alwaysHasActiveItem:!0,isVisualizationPaneVisible:function(){return e.viewModel.visualizationPane.isPaneExpanded}},this.globalChannelSubscriptionManager=this.services.globalEventBridge.createChannelSubscriptionManager().subscribe(C.loadPowerViewReport,(function(t,i){return e.onLoadPowerViewReport(i)})).subscribe(P.ShowVisuals,(function(){return e.viewModel.hideVisuals=!1})),this.channelSubscriptionManager=this.services.eventBridge.createChannelSubscriptionManager().subscribe(P.sectionChanged,(function(t,i){return e.onSectionChange(i)})).subscribe(P.requestViewModeChange,(function(t,i){return e.onRequestViewModeChange(i)})).subscribe(P.saveKeyPressedEvent,(function(t){return e.saveOnKeypress(t)})).subscribe(P.deleteSectionInitiated,(function(t,i){return e.onDeleteSection(i)})).subscribe(P.deleteVisual,(function(t,i){return e.deleteVisual(i)})).subscribe(P.addVisualContainer,(function(t,i){return e.onAddVisualContainer(t,i)})).subscribe(P.addCustomVisualToCanvas,(function(t,i){return e.onAddCustomVisualToCanvas(i)})).subscribe(P.addInsightContainer,(function(t,i){return e.onAddInsightContainer(t,i)})).subscribe(P.addQnaContainer,(function(t,i){return e.onAddQnaContainer(t,i)})).subscribe(P.showQnaPopout,(function(t,i){return e.onShowQnaPopout(t,i)})).subscribe(P.visualRelationshipsModeChanged,(function(t){e.services.viewModeState.updateConfig((function(e){e.showRelationships=!e.showRelationships}))})).subscribe(P.pauseQueriesChanged,(function(t){return e.pauseQueriesChanged(t)})).subscribe(P.visibilityChanged,(function(){var t=!!e.services.visibility.get();!!e.isPopOutMode===t||e.isActiveSectionTransient?e.isPopOutMode=t:(e.isPopOutMode=t,e.updateNavigationPaneVisibility())})).subscribe(P.createBasicShape,(function(t,i){return e.onCreateBasicShape(t,i)})).subscribe(P.createActionButton,(function(t,i){return e.onCreateActionButton(t,i)})).subscribe(P.createTextbox,(function(t){return e.onCreateTextbox(t)})).subscribe(P.refreshExploration,(function(t){return e.refresh(t)})).subscribe(P.newQueryCacheResultAvailable,(function(t,i){return e.onNewQueryCacheResultAvailable(t,i)})).subscribe(P.visualDrillFilterOtherVisualsSettingChanged,(function(t,i){return e.onVisualDrillFilterOtherVisualsSettingChanged(i)})).subscribe(P.visualPluginsChanged,(function(t,i){return e.updateCapabilitiesFromSettings(e.services.explorationNavigation.getCurrentExploration())})).subscribe(P.highContrastModeChanged,(function(t,i){return e.setHighContrastMode(i)})).subscribe(P.explorationObjectsChanged,(function(t,i){return e.evaluateExplorationObjects()})).subscribe(P.explorationLoaded,(function(t,i){return e.evaluateExplorationObjects()})).subscribe(P.formFactorChanged,(function(t,i){return e.updateCapabilitiesFromSettings(e.exploration)})).subscribe(P.exploreCanvasVisualRendered,(function(){e.services.featureSwitchService.featureSwitches.telemetryV2&&e.currentZone?e.currentZone.run((function(){return e.finishOpenExploration()}),e):e.finishOpenExploration()})).subscribe(P.onReportChanged,(function(t,i){return e.services.globalEventBridge.publishToChannel(P.onReportChangedGlobal,i)})).subscribe(P.reportVisualError,(function(t,i){return e.services.globalEventBridge.publishToChannel(P.reportVisualErrorGlobal,i)}));var i=this;this.services.explorationContainerMixins.update(new(function(){function e(){}return Object.defineProperty(e.prototype,"reportId",{get:function(){return i.reportId},set:function(e){i.reportId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"packageId",{get:function(){return i.model&&i.model.packageId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"model",{get:function(){return i.model},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewModel",{get:function(){return i.viewModel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return i.extensions},enumerable:!0,configurable:!0}),e.prototype.addNotification=function(e){i.addNotification(e)},e.prototype.hideNotifications=function(){i.hideAllExplorationWarnings()},e.prototype.clearExploration=function(){i.clearExploration()},e.prototype.refresh=function(e){i.refresh(e)},e}())),this.annotationsModulePath=this.extensions.annotations&&this.extensions.annotations.getModulePath()},i.prototype.$onChanges=function(e){e.viewModel&&this.initializeViewModel()},i.prototype.$onDestroy=function(){this.removeKeyHandler(),this.clearExploration(),this.removeHighContrastStyle(),this.unregisterViewModelWatch&&this.unregisterViewModelWatch(),this.channelSubscriptionManager.unsubscribeAll(),this.globalChannelSubscriptionManager.unsubscribeAll(),this.services.explorationContainerMixins.destroy()},i.prototype.inAppArtifactView=function(){return this.extensions.navigation&&this.extensions.navigation.inAppArtifactView()},i.prototype.isMobileVisualizationPaneVisible=function(){return this.services.viewModeState.getConfig().displayOptions.showMobilePane},i.prototype.isExportDataPaneVisible=function(){return this.services.viewModeState.getConfig().displayOptions.showExportDataPane},i.prototype.isTaskPaneVisible=function(){var e=this.services.viewModeState.getMode();return(1===e||2===e)&&0===this.services.formFactor.getCurrentLayout()},i.prototype.isFooterVisible=function(){var e=this.viewModel;return!(!e||!e.options)&&(!this.isFluentSectionVisible()&&((e.options.showNavContentPane||null!=this.services.viewModeState.getViewState().bookmarkView)&&!this.services.viewModeState.getConfig().displayOptions.hideNavigationPane))},i.prototype.isFluentAppBarVisible=function(){var e=this.services.viewModeState.getMode();return this.isFluentDesignEnabled()&&(0===e||void 0===e)},i.prototype.isFluentSectionVisible=function(){var e=this.viewModel;return!!(e&&e.options&&this.isFluentAppBarVisible())&&!(!e.options.showNavContentPane||null!=this.services.viewModeState.getViewState().bookmarkView||this.services.viewModeState.getConfig().displayOptions.hideNavigationPane)},i.prototype.showFullScreenComponent=function(){return this.inFullScreenMode()&&this.isFluentDesignEnabled()&&(!this.inAppArtifactView()||this.extensions.appConsumptionOperations&&this.extensions.appConsumptionOperations.isInAppViewWithNavigationDisabled())},i.prototype.isVisualizationPaneVisible=function(){var e=this.viewModel;if(!e||!e.options)return!1;var t=!this.exploration;(this.exploration&&this.exploration.settings&&this.exploration.settings.useNewFilterPaneExperience||this.isFluentDesignEnabled()||this.isForceMigrationLive())&&(t=0===this.services.viewModeState.getMode());return!t&&e.options.showVisualizationPane&&!this.services.viewModeState.getConfig().displayOptions.hideVisualizationPane&&!this.isMobileVisualizationPaneVisible()},i.prototype.isBookmarksPaneVisible=function(){var e=this.viewModel;return!!e&&(e.bookmarksPane.isPaneVisible&&this.isInMasterLayout())},i.prototype.isSyncGroupPaneVisible=function(){var e=this.viewModel;return!!e&&(e.syncGroupPane.isPaneVisible&&this.isInMasterLayout())},i.prototype.isCanvasItemsPaneVisible=function(){var e=this.viewModel;return!!e&&(e.canvasItemsPane.isPaneVisible&&this.isInMasterLayout())},i.prototype.isAnnotationsPaneVisible=function(){var e=this.extensions.annotations;return e&&e.isEnabled()},i.prototype.useMobileFooter=function(){return this.viewModeState.getConfig().displayOptions.useMobileExplorationFooter},i.prototype.useMobileBookmarks=function(){return 2===this.viewModeState.getConfig().displayOptions.mobileBookmarksMenuDisplay},i.prototype.inFullScreenMode=function(){return this.extensions.fullScreenOperation&&this.extensions.fullScreenOperation.inFullScreenMode()},i.prototype.isInMasterLayout=function(){return 0===this.services.formFactor.getCurrentLayout()},i.prototype.setViewModelExploration=function(e,t,i){var o=null!==i&&void 0!==i?i:this.services.formFactor.getCurrentLayout();this.viewModel.exploration=y.convertExploration(e,o,t),this.exploration=e},i.prototype.onDeleteSection=function(e){var t=this;if(e.supportMinervaDialog){var i=e.sectionIndex,o=this.services.rootScope.$new(),r=this.viewModel,n=this.services.errorService.control(),s=[new InJs.ModalDialogAction(this.services.localizationService.get("Delete"),function(e,o){n.hideDialog();var r={targetSectionIndex:i,addToUndoRedoStack:!0};t.services.eventBridge.publishToChannel(P.deleteSection,r)}),new InJs.ModalDialogAction(this.services.localizationService.get("PBI_Button_Label_Cancel"),function(e,t){n.hideDialog()})];o.message=this.services.localizationService.get("ExplorationNavigationTab_DeleteWarningMessage");var a={dialogName:this.services.localizationService.get("ExplorationNavigationTab_DeleteWarningTitle"),isDismissable:!0,scope:o,template:"<custom-modal-dialog></custom-modal-dialog>",dialogCssClass:"customModalDialog",dialogActions:s},l=r&&r.exploration&&r.exploration.sections&&r.exploration.sections[i]&&r.exploration.sections[i].contract?r.exploration.sections[i].contract.id:void 0;this.extensions.customizeDeleteSectionOptions&&this.extensions.customizeDeleteSectionOptions(a,l),this.services.modalDialogService.showLegacyWebModalDialog(a)}},i.prototype.onNewQueryCacheResultAvailable=function(e,i){var o=this.viewModel.exploration,r=this.services.explorationCapabilities.getCapabilities();o&&!r.disableCacheUpdates&&(this.visualContainerQueryUpdater||(this.visualContainerQueryUpdater=new t.helpers.VisualContainerQueryUpdater(o.contract.id,this.services.explorationProxy)),this.visualContainerQueryUpdater.onNewQueryCacheResultAvailable(i)),e.stopPropagation&&e.stopPropagation()},i.prototype.onVisualDrillFilterOtherVisualsSettingChanged=function(e){if(e.visualContainer){var t=this.services.explorationNavigation.getCurrentSection();this.services.filterGenerator.updateCrossFilterOnDrill(t,e.visualContainer)}},i.prototype.initializeViewModel=function(){this.explorationContainerOptions&&this.services.explorationCapabilities.setCapabilities(this.explorationContainerOptions);var e=this.viewModel;if(e){e.showSpinner=!0,e.options||(e.options=this.services.explorationCapabilities.getCapabilities());var t=e.options;this.explorationNotificationIds=[];var i=this.services.featureSwitchService.featureSwitches;this.services.viewModeState.updateConfig((function(e){e.supportsPinning=!t.visualContainerOptions.disablePin,e.supportsDeletion=!0,e.supportsExportData=!t.disableExport&&(i.exportDataEnabled||i.GranularSettingsExportToExcel&&i.isExportToExcelSeparatedFromExportDataEnabled&&i.exportToExcelSettingEnabled)})),e.shouldHideFilterPane&&(t.showVisualizationPane=!1),t.showAppBar=!e.shouldHideAppBar&&t.showAppBar&&(!this.extensions.fullScreenOperation||!this.extensions.fullScreenOperation.inFullScreenMode()),this.isPopOutMode&&this.services.visibility.clear(),this.updateNavigationPaneVisibility(),this.exploration&&this.removeHighContrastStyle(),e.shouldHideTileMenu&&(t.visualContainerOptions.hideHeader=!0),t.overrideSectionSize=e.overrideSectionSize||t.overrideSectionSize,t.disableViewRelatedContent=this.services.viewRelatedContentService.disableViewRelated}},i.prototype.markExportDataDeniedIfNeeded=function(e){var t=this.viewModel.options;e&&e.contract&&e.contract.deniedActions&&!this.services.modelService.isActionAllowed(e.contract,2)&&(t.visualContainerOptions.exportDataDenied=!0)},i.prototype.notifyIfModelRefreshDisabledBySelectiveRefresh=function(){var e=this.services,i=this.viewModel.datasetModel;if(i&&i.isRefreshDisabledDueToInactivity()){var o={notificationName:"inactiveModelRefreshDisabled",notificationId:e.notificationBarService.notify({message:e.localizationService.get("Notification_InactiveModelRefreshDisabled"),notificationType:3,secondaryLink:{displayText:e.localizationService.get("LearnMore"),urlString:t.constants.configureScheduledRefreshLink}})};this.addNotification(o)}},i.prototype.deleteVisual=function(e){var t=this.services.rootScope.$new(),i=this.viewModel.exploration.contract;t.deleteVisualService=this.services.deleteVisual,t.errorService=this.services.errorService,t.explorationContract=i,t.customVisuals=[e.visual],t.deleteVisualButtonText=this.services.localizationService.get("Delete");var o=x.getVisualContainerCount(this.exploration,e.visual);o>0?t.deleteVisualWarningText=this.services.localizationService.format("DeleteVisual_CustomVisualUsedMessage",[o]):t.deleteVisualWarningText=this.services.localizationService.format("DeleteVisual_CustomVisualNotUsedMessage",[o]);var r={dialogName:this.services.localizationService.get("DeleteVisual_DialogHeader"),isDismissable:!0,scope:t,template:"<delete-visual-warning-dialog></delete-visual-warning-dialog>",dialogCssClass:"deleteVisualWarning"};this.services.modalDialogService.showLegacyWebModalDialog(r)},i.prototype.onCreateTextbox=function(e){this.onAddVisualContainer(e,{visualType:"textbox",telemetrySource:4})},i.prototype.onCreateBasicShape=function(e,t){this.services.visualAuthoring.addVisualContainerShapeVisual(this.exploreCanvas,t.shapeType,0)},i.prototype.onCreateActionButton=function(e,t){this.services.visualAuthoring.addVisualContainerShapeVisual(this.exploreCanvas,t.shapeType,1)},i.prototype.onAddVisualContainer=function(t,i){e.explore.util.CanvasVisualsUtility.addVisualContainerToCanvas(i,this.exploreCanvas,this.services.dataSources.get(),this.services.visualAuthoring,this.services.telemetryService),t.stopPropagation&&t.stopPropagation(),i.actionAfterAddition&&i.actionAfterAddition()},i.prototype.onAddCustomVisualToCanvas=function(e){var t=this.viewModel.exploration;if(t&&t.contract){var i=e.visualType;if(!_.find(t.contract.resourcePackages,(function(e){return e.name===i}))){var o={id:e.resourcePackageId,name:e.visualType,type:T(e.visualType)?3:0,items:[]};this.viewModel.exploration.contract.resourcePackages.push(o)}}},i.prototype.onAddInsightContainer=function(e,t){e.stopPropagation&&e.stopPropagation(),this.services.visualAuthoring.addVisualContainerFromConfig(t.visualContainer.config,t.visualContainer.filters,this.exploreCanvas)},i.prototype.onAddQnaContainer=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var t,o,t;return __generator(this,(function(r){switch(r.label){case 0:return this.services.featureSwitchService.featureSwitches.qnaAngularMigration?[4,this.services.lazyScoped("qnaLaunchService")]:[3,4];case 1:return t=r.sent(),[4,t.supportsQna(void 0,{DatabaseName:this.viewModel.datasetModel.dbName,VirtualServerName:this.viewModel.datasetModel.vsName})];case 2:return o=r.sent(),o?[4,t.tryAddQnaContainerToCanvas(this.exploreCanvas,i)]:[2];case 3:return r.sent(),[3,8];case 4:return[4,this.services.pbiLazyLoad.load(e.infonav.modules.QnaCoreModule)];case 5:return r.sent(),[4,this.services.lazyScoped("qnaLaunch")];case 6:return t=r.sent(),[4,t.tryAddQnaContainerToCanvas(this.$scope,this.exploreCanvas,i,this.services,{DatabaseName:this.viewModel.datasetModel.dbName,VirtualServerName:this.viewModel.datasetModel.vsName})];case 7:r.sent(),r.label=8;case 8:return[2]}}))}))},i.prototype.onShowQnaPopout=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var t,o,r,n,s,a,t,o,r,n,s,a;return __generator(this,(function(l){switch(l.label){case 0:return[4,this.services.pbiLazyLoad.load(e.infonav.modules.QnaCoreModule)];case 1:return l.sent(),[4,this.services.pbiLazyLoad.load(e.infonav.modules.QnaWebModule)];case 2:return l.sent(),this.services.featureSwitchService.featureSwitches.qnaAngularMigration?[4,this.services.lazyScoped("qnaLaunchService")]:[3,8];case 3:return t=l.sent(),o=this.viewModel.datasetModel,[4,t.supportsQna({allowInViewMode:!0},{DatabaseName:o.dbName,VirtualServerName:o.vsName})];case 4:return r=l.sent(),r?[4,this.services.lazyScoped("qnaPopoutBuilder")]:[3,6];case 5:return n=l.sent(),s=this.services.$element.find(this.ExplorationHostSelector.selector),a=s.find(this.ExploreCanvasSelector.selector),n.show({parentScope:this.$scope,anchorElement:a,container:s,visualLink:i&&i.visualLink,creationSource:3,sourceFilters:i&&i.sourceFilters}),[3,7];case 6:this.services.errorService.infoCustom(this.services.localizationService.get("Qna_NotSupported_Title"),this.services.localizationService.get("Qna_NotSupported_MessageService")),l.label=7;case 7:return[3,13];case 8:return[4,this.services.lazyScoped("qnaLaunch")];case 9:return t=l.sent(),o=this.viewModel.datasetModel,[4,t.supportsQna(this.services,{DatabaseName:o.dbName,VirtualServerName:o.vsName},!0)];case 10:return r=l.sent(),r?[4,this.services.lazyScoped("qnaPopoutBuilder")]:[3,12];case 11:return n=l.sent(),s=this.services.$element.find(this.ExplorationHostSelector.selector),a=s.find(this.ExploreCanvasSelector.selector),n.show({parentScope:this.$scope,anchorElement:a,container:s,visualLink:i&&i.visualLink,creationSource:3,sourceFilters:i&&i.sourceFilters}),[3,13];case 12:this.services.errorService.infoCustom(this.services.localizationService.get("Qna_NotSupported_Title"),this.services.localizationService.get("Qna_NotSupported_MessageService")),l.label=13;case 13:return[2]}}))}))},Object.defineProperty(i.prototype,"exploreCanvas",{get:function(){return this.viewModel&&this.viewModel.exploration&&this.viewModel.exploration.exploreCanvas},enumerable:!0,configurable:!0}),i.prototype.removeKeyHandler=function(){this.currentKeyHandler&&($(window).off("keydown",this.currentKeyHandler),this.currentKeyHandler=void 0)},i.prototype.addKeyHandler=function(){var e=this;this.currentKeyHandler||(this.currentKeyHandler=function(t){if(e.viewModel&&e.viewModel.exploration&&!$(t.target).is(jsCommon.DOMConstants.EditableTextElements)&&!$(t.target).is(jsCommon.DOMConstants.EditableNumericElements))return e.services.canvasKeyHandler.onKeyDown(t,e.exploreCanvas)},$(window).on("keydown",this.currentKeyHandler))},i.prototype.onSectionChange=function(e){var t,i=this.viewModel,o=i.exploration.contract,r=this.services.featureSwitchService.featureSwitches;r&&r.trackUserInfo&&!r.usageMetricsTrackUserLevelInfoEnabled&&(t=!0);var n={exploration:o,section:e.name,reportGUID:this.exploration&&this.exploration.report&&this.exploration.report.objectId,reportPermissions:i.reportPermission,groupObjectId:this.services.activeFolderId.activeFolderObjectId,isReadonlyGroup:this.services.permissionService.isActiveWorkspaceIsReadOnly,scrubUserInfo:t,newReport:e.newReport};this.services.explorationNavigation.updateExplorationActiveSectionIndex(n);var s=this.services.explorationNavigation.getCurrentSection(),a=s&&s.transient;!!this.isActiveSectionTransient==!!a||this.isPopOutMode?this.isActiveSectionTransient=a:(this.isActiveSectionTransient=a,this.updateNavigationPaneVisibility()),s&&this.services.filterGenerator.updateCrossDrillOfSectionOperation(s)},i.prototype.logRTelemetry=function(e,t){this.viewModel.options.disableLogRTelemetry||this.services.telemetryService.logEvent(e,t.totalVisualsCount,t.info.length,JSON.stringify(t.info),this.services.userInfo.userLicense())},i.prototype.onRequestViewModeChange=function(e){return __awaiter(this,void 0,h,(function(){var t,i,o;return __generator(this,(function(r){switch(r.label){case 0:return t=1===e,t&&!this.viewModel.canEdit?[2]:this.extensions.saveExploration?[4,this.extensions.saveExploration.handleUnsavedIfAny()]:[3,2];case 1:if(i=r.sent(),2===i)return[2];r.label=2;case 2:return o=this.viewModel.exploration.contract,this.changeToEditMode(o,t),[2]}}))}))},i.prototype.changeToEditMode=function(t,i){var r=this.viewModel,n=i?1:0,s=this.services.viewModeState,a=s.getMode();s.setMode(n),i?(r.taskPane.isPaneExpanded=!0,r.visualizationPane.isPaneExpanded=!0,this.services.featureSwitchService.featureSwitches.pivotTableVisualEnabled&&o(t)&&this.extensions.tutorial&&this.extensions.tutorial.showConvertTableTutorial()):0!==a&&0!==this.services.formFactor.getCurrentLayout()&&this.services.formFactor.changeFormFactor(0,this.viewModel),this.services.customVisualLoader.setState(i),this.services.customVisualLoader.ensureCustomVisualResources(t);var l=g.getVisualStatsInExploration(this.exploration,this.services.scriptVisuals);i||this.logRTelemetry(e.telemetry.EXLoadReportWithScriptVis,l),r.isNavPaneCollapsed=!i,this.updateCapabilitiesFromSettings(this.exploration),this.services.eventBridge.publishToChannel(P.changeViewMode,{targetViewMode:n,startViewMode:a})},i.prototype.hideAllExplorationWarnings=function(){for(var e=this.explorationNotificationIds;e.length>0;)this.services.notificationBarService.hide(e.pop().notificationId);this.explorationNotificationIds=[]},i.prototype.hideExplorationWarning=function(e){for(var t=this.explorationNotificationIds,i=0,o=t;i<o.length;i++){var r=o[i];if(e&&r.notificationName===e){this.services.notificationBarService.hide(r.notificationId),t.splice(t.indexOf(r),1);break}}this.explorationNotificationIds=t},i.prototype.isNotificationShown=function(e){for(var t=this.explorationNotificationIds,i=0,o=t;i<o.length;i++){var r=o[i];if(e&&r.notificationName===e)return r.notificationId}},i.prototype.addNotification=function(e){e&&(this.isNotificationShown(e.notificationName)&&this.hideExplorationWarning(e.notificationName),this.explorationNotificationIds.push(e))},i.prototype.updateNavigationPaneVisibility=function(e){if(void 0===e&&(e=!0),e)if(this.isPopOutMode||this.isActiveSectionTransient)this.oldNavPaneOptions=_.cloneDeep(this.viewModel.options);else if(this.oldNavPaneOptions){var t=this.services.explorationCapabilities.getCapabilities();t.showNavContentPane=this.oldNavPaneOptions.showNavContentPane,this.oldNavPaneOptions=null}var i=!this.isPopOutMode&&!this.isActiveSectionTransient&&this.services.explorationCapabilities.getCapabilities().showNavContentPane;this.viewModel.options.showNavContentPane=!this.viewModel.shouldHideSlideBar&&i},i.prototype.saveOnKeypress=function(e){if(this.viewModel.canEdit&&this.extensions.saveExploration){var t=this.viewModel.options,i={overrideSaveRouting:t.overrideSaveRouting,source:2};0!==this.services.viewModeState.getMode()||t.disableSaveOnKeyPress?this.extensions.saveExploration.save(e,i):this.extensions.saveExploration.saveAs(e,i)}},i.prototype.refresh=function(t){this.services.visualTimeSynchronizationService.setAnchorTimeToNow();var i={result:{changes:[],hasQueryImpact:!0}};this.services.modelChangeHandler.applyChange({change:this.services.promiseFactory.resolve(i),leaveUndo:!0,cacheResponseOnServer:!this.services.checkUnsavedService.userHasUnsavedWork}),this.hideExplorationWarning("lastErrorNotifyId"),t&&t.stopPropagation&&t.stopPropagation();var o=g.getVisualStatsInExploration(this.exploration,this.services.scriptVisuals);this.logRTelemetry(e.telemetry.EXExplorationRefresh,o)},i.prototype.loadModelAndNotifyIfFailed=function(){var i=this,o=this.generateProgressBarNotificationAndGetId(),r=this.services.dataSources.get();this.services.conceptualSchemaProxy.get(r).then((function(){o&&i.services.notificationBarService.hide(o)})).catch((function(r){var n,s=t.getTelemetryErrorDetails(r);if(i.services.telemetryService.logEvent(e.telemetry.FailureDuringModelLoad,s.errorCode,s.errorSource),o&&i.services.notificationBarService.hide(o),r&&r.serviceError&&t.helpers.ReportUtility.shouldDisplayErrorAsNotificationBar(r.serviceError.errorCode)){var a={error:{code:r.serviceError.errorCode,"pbi.error":{code:r.serviceError.errorCode,parameters:[],details:r.serviceError.errorDetails}},showNotification:!0,model:i.viewModel.datasetModel,refreshFunction:function(){return i.refresh()}};i.services.eventBridge.publishToChannel(P.reportVisualError,a)}else{n="ExplorationContainer_FailedToLoadModel";var l=t.util.handleConceptualSchemaError(r,i.services.errorService,i.services.localizationService.get(n),"ExplorationContainer_FailedToLoadModel_DefaultDetails",i.services.localizationService,i.model);s.errorMessage=l||n}i.finishOpenExploration(s)})).finally((function(){i.viewModel.showSpinner=!1}))},i.prototype.loadLinguisticSchemaAndNotifyIfFailed=function(e){var t=this;this.services.linguisticSchemaProxy.init(e.reportId,e.reportHasLinguisticSchema).catch((function(e){return t.showError(e,t.services.localizationService.get("ExplorationContainer_FailedToLoadReport"),"ExplorationContainer_FailedToLoadReport_DefaultDetails")}))},i.prototype.evaluateExplorationObjects=function(){var e=this.services.explorationNavigation.getCurrentExploration();t.util.ThemeUtils.evaluateObjects(e,this.services.themeService,this.services.featureSwitchService.featureSwitches),this.services.eventBridge.publishToChannel(P.explorationObjectsLoaded,e)},i.prototype.setHighContrastMode=function(i,o,r){return void 0===o&&(o=!1),__awaiter(this,void 0,e.Promise,(function(){var n,s,a;return __generator(this,(function(l){switch(l.label){case 0:return n=r?r:this.services.explorationNavigation.getCurrentExploration(),s=n.themeCollection,a=s.highContrastTheme||t.util.ThemeUtils.getThemeMetadata("None",2),a.name===i?[2]:"None"===i?[3,2]:(this.services.resourceRegistration.add(i,2,v.HighContrastTheme),[4,f.loadHighContrastTheme(this.services.promiseFactory,this.services.resourceLoader,this.services.themeService,n.resourcePackages,i)]);case 1:return l.sent(),a.name=i,this.services.highContrastCssGenerationService.applyHighContrastStyle(a),s.highContrastTheme=a,[3,3];case 2:this.services.highContrastCssGenerationService.removeHighContrastStyle(),delete s.highContrastTheme,l.label=3;case 3:return o||this.services.eventBridge.publishToChannel(e.events.visualThemeChanged),[2]}}))}))},i.prototype.removeHighContrastStyle=function(){this.exploration&&this.exploration.themeCollection&&this.exploration.themeCollection.highContrastTheme&&this.services.highContrastCssGenerationService.removeHighContrastStyle()},i.prototype.initializeExploration=function(e,t,i,o,r,n,s,a,l,c,p,u,d,v){return __awaiter(this,void 0,h,(function(){return __generator(this,(function(h){return this.services.customVisualLoader.reset(),this.services.customVisualLoader.setState(r),this.services.visualPlugin.removeAllCustomVisuals&&this.services.visualPlugin.removeAllCustomVisuals(),this.services.visualTimeSynchronizationService.setAnchorTimeToNow(),o?[2,this.initializeExplorationForNewReport(r,n,s,l,c,p,u)]:[2,this.initializeExplorationForExistingReport(e,t,i,r,n,s,a,l,c,p,u,d,v)]}))}))},i.prototype.initializeExplorationForNewReport=function(i,o,s,a,l,p,u){return __awaiter(this,void 0,e.Promise,(function(){var i,d,h,g,f;return __generator(this,(function(b){switch(b.label){case 0:return i=[],d=[],h=t.contracts.createDefaultExploration(void 0,i,this.services.featureSwitchService),h.defaultDrillFilterOtherVisuals=n,m.fillDefaultSectionDisplayNames(h,this.services.localizationService),this.extensions.explorationResolver&&this.extensions.explorationResolver.init(s),[4,this.addODataFilterFromQuery(h,a)];case 1:return b.sent(),this.setDataSource(h,o),[4,this.tryAddJsonFilters(h,l)];case 2:return b.sent(),this.viewModel.exploration=y.convertExploration(h,this.services.formFactor.getCurrentLayout()),this.services.telemetryService.logEvent(e.telemetry.EXInitExploration,p,o&&o.directQueryMode===!0,o&&!_.isEmpty(o.onPremModelConnectionString),o&&r[o.dataCacheMode]),this.updateCapabilitiesFromSettings(h),this.setSectionStatus(0),this.services.explorationNavigation.loadExploration(h),this.services.explorationNavigation.startExplorationSession(u),g=this.services.resourceRegistration,f=A(this.services.featureSwitchService),g.add(f.name,2,v.BaseTheme),[4,this.initializeThemes(h)];case 3:return b.sent(),this.evaluateExplorationObjects(),this.setVisualThemeDataColors(h.themeCollection),jsCommon.BrowserUtils.isInternetExplorerOrEdge()&&this.registerHighContrastMediaQuery(),this.viewModel.options.disableLinguisticSchemaInitialization||this.loadLinguisticSchemaAndNotifyIfFailed(h),this.services.eventBridge.publishToChannel(P.explorationContainerReady),this.services.eventBridge.publishToChannel(P.preparePersonalVisuals),this.loadModelAndNotifyIfFailed(),this.services.explorationNavigation.updateActiveSection({targetSectionIndex:0,forceUpdate:!0,suppressHistory:!0,newReport:!0}),this.openExplorationTelemetryEvent&&c.addExplorationInfoToEvent(this.openExplorationTelemetryEvent.event,this.services.explorationNavigation),this.resolveOpenExplorationTelemetryEventWhenNoVisualContainers(),this.setViewModelExploration(h,0),[2]}}))}))},i.prototype.initializeExplorationForExistingReport=function(t,i,o,r,n,s,l,c,p,u,d,v,g){return __awaiter(this,void 0,h,(function(){var h,m,f=this;return __generator(this,(function(b){switch(b.label){
case 0:return this.viewModel.showSpinner=!0,s?[4,this.resolveExploration({wireContractJSON:l,exploration:s},i,o,r,n,c,p,u,d,v,g)]:[3,2];case 1:return b.sent(),[3,3];case 2:h=this.services.telemetryService.startEvent(e.telemetry.EXFetchExploration,u),m={id:t,model:n},this.services.explorationProxy.get(m).then((function(t){return __awaiter(f,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.exploration=t.exploration,[4,this.resolveExploration(t,i,o,r,n,c,p,u,d,v,g)];case 1:return e.sent(),h.resolve(),[2]}}))}))}),(function(e){f.showError(e,f.services.localizationService.get("ExplorationContainer_FailedToLoadReport"),"ExplorationContainer_FailedToLoadReport_DefaultDetails"),f.viewModel.showSpinner=!1,f.services.globalEventBridge.publishToChannel(P.openReportFinished,{reason:e&&e.error?e.error.message:"",isError:!0}),h.reject(),f.finishOpenExploration(a.getTelemetryErrorDetails(e&&e.error))})),b.label=3;case 3:return[2]}}))}))},i.prototype.resolveExploration=function(t,i,o,n,s,a,l,u,d,v,g){return __awaiter(this,void 0,h,(function(){var h,f,b,y,w,S,x,M,C,E,D,A,T=this;return __generator(this,(function(R){switch(R.label){case 0:for(h=t.exploration,this.extensions.explorationResolver&&this.extensions.explorationResolver.init(h),f=this.extensions.appConsumptionOperations,f&&f.isEnabled()&&f.init(this.services.explorationNavigation,this.services.explorationCapabilities),b=this.viewModel.options,b.disableLinguisticSchemaInitialization||this.loadLinguisticSchemaAndNotifyIfFailed(h),y=0,w=h.sections;y<w.length;y++)S=w[y],x=b.overrideSectionSize,x&&_.isNumber(x.displayOption)?S.size={displayOption:x.displayOption,width:x.width||S.size.width,height:x.height||S.size.height}:null!=b.defaultDisplayOption&&0===S.size.displayOption&&(S.size.displayOption=b.defaultDisplayOption);return M=this.getActiveSectionIndex(h,i,o),h.activeSectionIndex=M,m.fillDefaultSectionDisplayNames(h,this.services.localizationService),[4,this.addODataFilterFromQuery(h,a)];case 1:return R.sent(),this.setDataSource(h,s),this.updateCapabilitiesFromSettings(h),this.setSectionStatus(M),this.extensions.saveExploration&&this.extensions.saveExploration.setOriginalExploration(t),this.services.explorationNavigation.loadExploration(h,this.currentZone),this.services.explorationNavigation.startExplorationSession(d),[4,this.initializeThemes(h)];case 2:return R.sent(),this.evaluateExplorationObjects(),this.setVisualThemeDataColors(h.themeCollection),jsCommon.BrowserUtils.isInternetExplorerOrEdge()&&this.registerHighContrastMediaQuery(),this.services.telemetryService.logEvent(e.telemetry.EXInitExploration,u,s&&s.directQueryMode===!0,s&&!_.isEmpty(s.onPremModelConnectionString),s&&r[s.dataCacheMode]),this.loadModelAndNotifyIfFailed(),p.acquireTrustedVisuals(h,this.services.trustedVisual).then((function(e){return T.reloadTrustedVisuals(e)})),[4,this.applyArtifactsToExploration(h,M,l,i,g)];case 3:return M=R.sent(),this.setViewModelExploration(h,M,v),this.afterViewModelInit(h,M,n),this.trackVisualsInInitialLoad(h,M),this.services.eventBridge.publishToChannel(P.explorationContainerReady),this.openExplorationTelemetryEvent&&c.addExplorationInfoToEvent(this.openExplorationTelemetryEvent.event,this.services.explorationNavigation),this.resolveOpenExplorationTelemetryEventWhenNoVisualContainers(),this.services.globalEventBridge.publishToChannel(P.openReportFinished,{isError:!1}),this.extensions.navigation&&!this.featureSwitchService.featureSwitches.modernWebReportLoad&&this.extensions.navigation.inReportSubscriptionView()&&(C=this.services.explorationNavigation.getCurrentSection(),E=m.getVisibleSections(h.sections),this.services.subscription.expandPaneForReportSubscription({currentSection:m.isSectionHidden(C)?E[0]:C,report:this.services.explorationNavigation.getCurrentExploration().report,modelId:this.services.explorationNavigation.getCurrentExploration().dataSources[0].id,sections:E},this.extensions.navigation.currentSubscriptionGUID())),D=this.extensions.explorationSnapshotOperations,A=this.services.explorationCapabilities.getCapabilities(),D&&D.isEnabled()&&D.init(),!this.services.featureSwitchService.featureSwitches.realTimeRefresh||A.disableRealTimeRefresh||this.services.featureSwitchService.featureSwitches.realTimeRefreshDisabled||this.services.reportRefresh.init(),this.services.featureSwitchService.featureSwitches.changeDetection&&this.services.reportAutoRefresh.init(),[2]}}))}))},i.prototype.trackVisualsInInitialLoad=function(e,t){var i=e.sections[t];if(i)for(var o=0,r=i.visualContainers;o<r.length;o++){var n=r[o],s=n.config&&n.config.singleVisual&&!S.isHidden(n.config.singleVisual);s&&this.services.visualLifecycleService.add(n.id)}},i.prototype.getActiveSectionIndex=function(e,t,i){var o;return t?o=m.findSectionIndexForSectionName(e,t):i?o=m.findSectionIndexForSectionName(e,i):_.isNumber(e.activeSectionIndex)&&(o=e.activeSectionIndex),null!=o&&_.inRange(o,0,e.sections.length)||(o=0),o},i.prototype.applyArtifactsToExploration=function(e,t,i,o,r){return __awaiter(this,void 0,h,(function(){var n,s,a,l,c,p,u,d;return __generator(this,(function(h){switch(h.label){case 0:if(!_.isEmpty(e.sections))for(n=0,s=e.sections;n<s.length;n++)a=s[n],this.services.filterGenerator.updateCrossDrillOfSectionOperation(a);return l=this.extensions.persistentState,l?[4,l.init(e)]:[3,2];case 1:h.sent(),h.label=2;case 2:return(c=this.extensions.bookmark)?(this.services.dataProxy.stopCommunication(D),[4,c.init(e,o)]):[3,4];case 3:p=h.sent(),p&&p.activeSection&&(t=e.activeSectionIndex,this.setSectionStatus(t)),h.label=4;case 4:return[4,this.tryAddJsonFilters(e,i)];case 5:return h.sent(),[4,this.applyDrillthroughFilters(e,r)];case 6:return u=h.sent(),(d=this.extensions.slicers)?(this.services.dataProxy.stopCommunication(D),[4,d.init(e)]):[3,8];case 7:h.sent(),h.label=8;case 8:return u&&this.services.eventBridge.publishToChannel(P.onReportChanged,{explorationContentChanged:!0}),[2,t]}}))}))},i.prototype.afterViewModelInit=function(e,t,i){var o=!0,r=!0,n=this.extensions.bookmark;if(n){var s=n.afterInit(e);o=!(s&&s.visibility),r=!(s&&s.pendingHighlights)}this.services.dataProxy.resumeCommunication(D),this.services.explorationNavigation.updateActiveSection({targetSectionIndex:t,forceUpdate:!0,suppressHistory:!0,navigationAction:void 0,canvasLayout:void 0,clearSelection:o,clearCrossFilter:r,currentZone:this.currentZone}),this.changeToEditMode(e,i)},i.prototype.pauseQueriesChanged=function(e){var t=!this.services.viewModeState.getConfig().pauseQueryExecution;this.services.viewModeState.updateConfig((function(e){e.pauseQueryExecution=t})),t?this.services.dataProxy.stopCommunication(M.dsrDataReaderType):this.services.dataProxy.resumeCommunication(M.dsrDataReaderType),e.stopPropagation()},i.prototype.tryAddJsonFilters=function(e,t){return __awaiter(this,void 0,h,(function(){var i,o,r,n,s,a,l,c,p,u,d;return __generator(this,(function(h){switch(h.label){case 0:return t&&_.isArray(t)?(i=this.services.dataSources.get(),[4,this.services.conceptualSchemaProxy.get(i)]):[2];case 1:return o=h.sent(),[4,this.getJsonFilterParser()];case 2:if(r=h.sent(),!r)return[2];n=[],s=0,a=t,h.label=3;case 3:return s<a.length?(l=a[s],[4,r.tryCreateFilterContainer(e,o,l)]):[3,6];case 4:if(c=h.sent(),!c)return[2];c.howCreated=1,l.requireSingleSelection&&this.services.visualAuthoring.setRequireSingleSelection(c,{container:this.exploration,scopeType:2},l.requireSingleSelection),n.push(c),h.label=5;case 5:return s++,[3,3];case 6:if(_.isEmpty(n))return[2];for(e.filters=e.filters||[],p=0,u=n;p<u.length;p++)d=u[p],e.filters.push(d);return this.services.eventBridge.publishToChannel(P.explorationFiltersContainerChanged,{container:e}),this.updateExplorationCacheCapabilities(!0,!1),[2]}}))}))},i.prototype.applyDrillthroughFilters=function(e,t){return __awaiter(this,void 0,h,(function(){var i,o;return __generator(this,(function(r){switch(r.label){case 0:return l.hasDrillthroughFilters(t)?[4,this.services.conceptualSchemaProxy.get(this.services.dataSources.get())]:[2];case 1:return i=r.sent(),o=l.applyDrillthroughFilters(this.services.explorationStateManager,i,e,t,this.services.aggrOps),this.updateExplorationCacheCapabilities(!0,void 0),[2,o]}}))}))},i.prototype.addODataFilterFromQuery=function(e,t){return __awaiter(this,void 0,h,(function(){var i,o,r,n,s;return __generator(this,(function(a){switch(a.label){case 0:return t?[4,this.services.lazy("odataFilterParserService")]:[3,2];case 1:if(i=a.sent(),o=i.tryGetFilters(t),_.isEmpty(o))return[2];for(e.filters||(e.filters=[]),r=0,n=o;r<n.length;r++)s=n[r],e.filters.push(s);this.updateExplorationCacheCapabilities(!0,!1),a.label=2;case 2:return[2]}}))}))},i.prototype.updateExplorationCacheCapabilities=function(e,t){var i=this.services.explorationCapabilities,o=i.getCapabilities();o.visualContainerOptions.disableQueryCacheUpdates=e,void 0!==t&&(o.persistentUserStateEnabled=t),i.setCapabilities(o)},i.prototype.updateCapabilitiesFromSettings=function(e){if(e){var t=e.settings,i=this.services.viewModeState,o=this.services.explorationCapabilities,r=o.getCapabilities();t&&t.isPersistentUserStateDisabled&&(r.persistentUserStateEnabled=!1),r.visualContainerOptions.useStylableHeader=t&&t.useStylableVisualContainerHeader,r.annotationsEnabled=u.isReportAnnotationsEnabled(t)&&r.annotationsEnabled,r.visualContainerOptions.hideHeader=i&&0===i.getMode()&&t&&t.hideVisualContainerHeader,o.setCapabilities(r)}},i.prototype.setSectionStatus=function(e){this.viewModel.sectionStatus.currentSectionNumber=e},i.prototype.setVisualThemeDataColors=function(e){var t=this.services.themeService;this.services.itemPicker.setThemeItems(t.getDataColors(e),t.getIcons(e),t.getIconSets(e))},i.prototype.initializeThemes=function(e){return __awaiter(this,void 0,h,(function(){var t;return __generator(this,(function(i){switch(i.label){case 0:return[4,f.loadThemeAndBaseTheme(this.services.promiseFactory,this.services.resourceLoader,this.services.themeService,e.resourcePackages,e.themeCollection)];case 1:return i.sent(),t=this.extensions.theme,t?[4,t.init(e)]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2,e]}}))}))},i.prototype.registerHighContrastMediaQuery=function(){for(var t=this,i=[window.matchMedia("(-ms-high-contrast:active)"),window.matchMedia("(-ms-high-contrast:white-on-black)"),window.matchMedia("(-ms-high-contrast:black-on-white)")],o=function(o,r){return __awaiter(t,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return i[0].matches?i[1].matches?[4,this.setHighContrastMode("HighContrastBlack",r)]:[3,2]:[3,7];case 1:return e.sent(),[3,6];case 2:return i[2].matches?[4,this.setHighContrastMode("HighContrastWhite",r)]:[3,4];case 3:return e.sent(),[3,6];case 4:return[4,this.setHighContrastMode("HighContrast1",r)];case 5:e.sent(),e.label=6;case 6:return[3,9];case 7:return[4,this.setHighContrastMode("None",r)];case 8:e.sent(),e.label=9;case 9:return[2]}}))}))},r=0,n=i;r<n.length;r++){n[r].addListener(o)}o(null,!0)},i.prototype.setDataSource=function(e,i){this.model=i;var o=e.dataSources;if(!o.withId(i.id)){o.push(t.contracts.dataSourceForModel(i));var r=t.constants.DefaultSchemaName;if(null!=e.id){var n=t.constants.ExplorationSchemaName;o.push({type:t.dataReaderPlugins.ExplorationDataReaderType,id:e.id,name:n,extends:r,exploration:{schemaName:n,extends:r,getModelExtensions:function(){return e.modelExtensions},getDataSourceVariables:function(){return e.dataSourceVariables}}})}}this.services.dataSources.set(o)},i.prototype.showError=function(e,t,i){this.services.errorService.error(t,i,{requestId:e?e.requestId:void 0,statusCode:e&&e.httpStatusCode?e.httpStatusCode.toString():void 0},null,"PowerBI")},i.prototype.clearExploration=function(){this.finishOpenExploration({errorSource:"User",errorMessage:"cancelled by user",isCancelled:!0,errorCode:"cancelled"}),this.extensions.saveExploration&&this.extensions.saveExploration.setOriginalExploration(null),this.extensions.explorationResolver&&this.extensions.explorationResolver.init(null),this.extensions.appConsumptionOperations&&this.extensions.appConsumptionOperations.clear(),this.viewModel&&(this.viewModel.exploration=null),this.setSectionStatus(-1),this.services.dataSources.set(null),this.services.eventBridge.publishToChannel(P.explorationUnloaded),this.services.reportAutoRefresh.destroy()},i.prototype.canWrite=function(e){return!this.services.permissionService.isActiveWorkspaceIsReadOnly&&e&&e.canWrite},i.prototype.canExplore=function(e,t){return!this.services.permissionService.isActiveWorkspaceIsReadOnly&&e&&e.contract&&(e.canExplore||this.canWrite(e))&&this.canExploreData(t)&&this.canEditSharedDataset(t)},i.prototype.canEditSharedDataset=function(e){return!this.extensions.sharedDataset||this.services.featureSwitchService.featureSwitches.useDatasetsAcrossWorkspacesEnabled||!this.extensions.sharedDataset.isLinked(e.contract)},i.prototype.canExploreData=function(e){return this.services.permissionService.isExplorableModel(e)},i.prototype.canCopy=function(e){return!this.services.permissionService.isActiveWorkspaceIsReadOnly&&e&&e.canCopy},i.prototype.isReportFromPbix=function(e){return e&&e.contract&&e.contract.isFromPbix},i.prototype.reloadTrustedVisuals=function(t){t&&t.length>0&&(this.services.visualPlugin.ensureTrustedVisualPlugins(t),this.services.eventBridge.publishToChannel(e.explore.services.events.visualPluginsChanged),this.services.globalEventBridge.publishToChannel(e.events.reloadEmptyVisuals,{visualTypes:t.map((function(e){return e.name}))}))},i.prototype.resolveOpenExplorationTelemetryEventWhenNoVisualContainers=function(){this.exploreCanvas&&!_.isEmpty(this.exploreCanvas.visualContainers)||this.finishOpenExploration()},i.prototype.resolveOpenExplorationTelemetryEvent=function(){var i=this.services.explorationNavigation;if(this.openExplorationTelemetryEvent){var o=this.openExplorationTelemetryEvent.event,r=o.info,n=this.viewModel.exploration&&this.viewModel.exploration.contract;if(this.exploration&&this.exploration.tags&&(r.tags=JSON.stringify(this.exploration.tags).substr(0,300)),n){var a=x.getImprovedFilterExperienceTelemetry(n,this.services.viewModeState.getMode());r.improvedFilterExperienceState=JSON.stringify(a)}this.openExplorationTelemetryEvent.resolve(),this.openExplorationTelemetryEvent=null}if(this.services.featureSwitchService.featureSwitches.telemetryV2&&this.currentZone){var l=this.viewModel.exploration&&this.viewModel.exploration.contract;if(l){var c=i.getCurrentSection(),p=i.getExplorationTelemetryData(),a=l&&x.getImprovedFilterExperienceTelemetry(l,this.services.viewModeState.getMode());e.fillTelemetryEvent(s,{tags:this.exploration&&this.exploration.tags&&JSON.stringify(this.exploration.tags).substr(0,300),visualTypesAndCounts:c&&JSON.stringify(t.util.VisualContainerUtils.getVisualTypesAndCountsFromSection(c)),modelId:p&&p.modelId,reportGuid:p&&p.reportGuid,dataCacheMode:p&&p.dataCacheMode,datasetHost:p&&p.datasetHost,dbName:p&&p.dbName,enterpriseCapacitySkuTier:p&&p.enterpriseCapacitySkuTier,isDirectQuery:p&&p.isDirectQuery,isOnPrem:p&&p.isOnPrem,improvedFilterExperienceState:a&&JSON.stringify(a),exid:p&&p.exid})}}},i.prototype.rejectOpenExplorationTelemetryEvent=function(e){this.openExplorationTelemetryEvent&&(this.openExplorationTelemetryEvent.reject(e),this.openExplorationTelemetryEvent=null)},i.prototype.finishOpenExploration=function(e){e?this.rejectOpenExplorationTelemetryEvent(e):this.resolveOpenExplorationTelemetryEvent(),this.services.featureSwitchService.featureSwitches.telemetryV2&&this.currentZone&&this.finishOpenExplorationInternal(e)},i.prototype.finishOpenExplorationInternal=function(e){if(e)throw e;this.currentZone=null},i.prototype.setOpenExplorationTelemetryEvent=function(e){this.finishOpenExploration(),this.openExplorationTelemetryEvent=e,this.services.featureSwitchService.featureSwitches.telemetryV2&&(this.currentZone=Zone.current)},i.prototype.onLoadPowerViewReport=function(t){return __awaiter(this,void 0,h,(function(){var i;return __generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.doLoadPowerViewReport(t)];case 1:return o.sent(),[3,3];case 2:return i=o.sent(),jsCommon.ExceptionHelper.handleErrorAndLogTelemetry(this.services.telemetryService,e.telemetry.InitializeExplorationError,i,this.openExplorationTelemetryEvent),[3,3];case 3:return[2]}}))}))},i.prototype.doLoadPowerViewReport=function(t){return __awaiter(this,void 0,h,(function(){var i,o,r,n,s,a,l,c,p,u,d,h,v=this;return __generator(this,(function(g){switch(g.label){case 0:return[4,this.services.activeFolderId.initialFolderIdReadyPromise];case 1:return g.sent(),this.viewModel.hideVisuals=!!t.hideVisuals,this.extensions.persistentState?[4,this.extensions.persistentState.registerHandler((function(e,t,i){if(v.extensions.saveExploration)return v.extensions.saveExploration.showSavePrompt(i,e,t)}))]:[3,3];case 2:g.sent(),g.label=3;case 3:return this.services.eventBridge.publishToChannel(P.onReportChanged,{explorationContentChanged:!1}),i=3!==t.instantiationMode,t.report.objectId&&(o=this.services.activeFolderId.activeFolderObjectId,r=t.report.contract.originalReportObjectId,i=!1,n=!1,this.services.reportService.findReportByGUID&&(s=this.services.reportService.findReportByGUID(t.report.objectId),n=s&&this.extensions.usageMetricsOperations&&this.extensions.usageMetricsOperations.isUsageMetricsArtifact(s)),!n&&this.extensions.updateMRU&&this.extensions.updateMRU(1,t.report.objectId,t.report.displayName,t.report.getPermissions(),o,r,t.report.packageId)),this.clearExploration(),this.addKeyHandler(),a=3!==t.instantiationMode,this.reportId=i?void 0:t.report.id,this.extensions.saveExploration&&this.extensions.saveExploration.init(t.report),this.model=t.model.contract,this.viewModel.displayName=i?void 0:t.report.contract.displayName,this.viewModel.canEdit=this.canExplore(t.report,t.model),this.viewModel.canCopy=this.canCopy(t.report),this.viewModel.canWrite=this.canWrite(t.report),this.pinEnabled=!!this.extensions.enablePin&&this.extensions.enablePin(t.report),!this.services.featureSwitchService.featureSwitches.pinReadable&&t.model&&17===t.model.getPermissions()&&(this.viewModel.options.visualContainerOptions.showPin=!1),this.services.viewModeState.setMode(a?1:0),this.viewModel.taskPane.isPaneExpanded=a,this.viewModel.visualizationPane.isPaneExpanded=a,this.viewModel.isNavPaneCollapsed=!a,this.viewModel.datasetModel=t.model,this.viewModel.reportPermission=t.report.getPermissions(),this.viewModel.isReportFromPbix=this.isReportFromPbix(t.report),l=this.viewModel.datasetModel,c=this.model&&this.model.packageId,p=this.services.packageService.findPackage(c),p&&(l.packagePublishStatus=p.publishOrRefreshStatus,l.contract.isPackageRefreshEnabled=p.contract.IsRefreshEnabled),u=this.viewModel.options,u.visualContainerOptions.disablePin=!this.pinEnabled,this.services.viewModeState.updateConfig((function(e){var t=v.services.featureSwitchService;e.supportsExportData=!u.disableExport&&(t.featureSwitches.exportDataEnabled||t.featureSwitches.GranularSettingsExportToExcel&&t.featureSwitches.isExportToExcelSeparatedFromExportDataEnabled&&t.featureSwitches.exportToExcelSettingEnabled)})),this.markExportDataDeniedIfNeeded(t.model),this.setOpenExplorationTelemetryEvent(t.openExplorationTelemetryEvent),[4,this.initializeExploration(t.report.id,t.reportPage,t.report.activeSlideId,i,a,t.report.model,t.exploration,t.wireContractJSON,t.additionalODataFilter,t.additionalJsonFilters,t.report.objectId,t.explorationTelemetryData,t.canvasLayout,t.drillthroughContext)];case 4:return g.sent(),d=e.explore.util.ExploreUndoRedoHandlerUtility.createUndoRedoHandler(this.viewModel,this.services.timeout,this.services.selection,this.services.filterGenerator,this.services.featureSwitchService,this.services.drillToDetails,this.services.formFactor,this.services.explorationSerializer,this.services.explorationNavigation,this.services.linguisticSchemaProxy,this.services.eventBridge,this.services.visualPlugin,this.services.staticResourceReferences),h=new b(d,this.services.staticResourceReferences),this.services.undoRedo.setStrategy(h),this.services.clipboard.setHandler(e.explore.util.ExploreClipboardHandlerUtility.createClipboardHandler(this.viewModel,this.services.explorationSerializer,this.services.localizationService,this.services.modalDialogService,this.services.conceptualSchemaProxy,this.services.dataSources,this.services.selection,this.services.visualAuthoring,this.services.visualPlugin,this.services.filterGenerator,this.services.formFactor,this.services.telemetryService,this.services.featureSwitchService,this.services.visualSync,this.services.featureSwitchService.featureSwitches.slicerSyncing)),this.notifyIfModelRefreshDisabledBySelectiveRefresh(),this.checkAndRegisterQesCachePolicy(),[2]}}))}))},i.prototype.generateProgressBarNotificationAndGetId=function(){var e,t=1024,i=this.viewModel.datasetModel&&this.viewModel.datasetModel.contract;i&&(e=i.sizeInMBs);var o=this.services,r=o.localizationService;if(!e||e<t){if(!o.featureSwitchService.featureSwitches.reportLoadIndicator)return;return o.notificationBarService.notify({message:r.get("DataLoaderSpinner_LoadingMessage1"),hideOnStateChange:!0,notificationType:4})}var n=o.datasetSizeService,s=n.getProgressBarDetailsForGivenFileSize(e);return o.notificationBarService.notify({message:r.format("DataLoaderSpinner_EstimatedTimeInMinutes",[s.estimatedLoadingTimeInMinutes]),hideOnStateChange:!0,notificationType:4,progressBarInfo:{progressDelays:s.delayDurationString}})},i.prototype.getJsonFilterParser=function(){return __awaiter(this,void 0,e.Promise,(function(){var e,t;return __generator(this,(function(i){switch(i.label){case 0:return this.jsonFilterParser?[3,4]:[4,this.services.moduleLoader.require({javascript:"JSONFilter/services/jsonFilterParser"})];case 1:return e=i.sent(),this.jsonFilterParser?[3,3]:(t=this,[4,e.create(this.services.promiseFactory,this.services.moduleLoader,this.services.telemetryService,this.services.lazyProviderModern)]);case 2:t.jsonFilterParser=i.sent(),i.label=3;case 3:i.label=4;case 4:return[2,this.jsonFilterParser]}}))}))},i.prototype.checkAndRegisterQesCachePolicy=function(){this.featureSwitchService.featureSwitches.expandQueryCaching&&this.exploration&&this.exploration.report&&this.exploration.report.model&&this.services.cachePolicyProviderService.setInteractiveQueryPolicy(this.exploration.report.model.dataCacheMode)},i.prototype.isFluentDesignEnabled=function(){return this.services.explorationCapabilities.getCapabilities().showFluentDesign},i.prototype.isForceMigrationLive=function(){return!!this.services.featureSwitchService.featureSwitches.forceMigrateNewFilterPane},i.prototype.shouldSetTabIndex=function(){return this.services.explorationCapabilities.getCapabilities().shouldSetTabIndexOnExploration},__decorate([d(s,2)],i.prototype,"finishOpenExplorationInternal",null),i})();i.ExplorationContainerCore=I})(i=t.components||(t.components={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){t.ExplorationContainerLegacy={templateUrl:"components/explorationContainerLegacy/explorationContainerLegacy.html",bindings:{viewModel:"<",canvasOptions:"<",explorationContainerOptions:"<"},controller:e.common.createController(t.ExplorationContainerLegacyController)}})(i=t.components||(t.components={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={})),angular.module("powerbi.explore").run(["$templateCache",function(e){e.put("components/appBarFlyoutMenu/appBarFlyoutMenu.html",'<button class="dropdown-item {{$ctrl.menuItemClass}}" ng-click="$ctrl.openFlyout($event); $event.stopPropagation(); $event.preventDefault()" ng-disabled="$ctrl.flyoutItem.disabled" ng-class="{\'selected\': $ctrl.flyoutItem.checked}" ng-attr-data-unique-id="{{ $ctrl.flyoutItem.action ? \'appBar-\' + $ctrl.menuOverlayName + \'-\' + $ctrl.flyoutItem.action : undefined }}" role="menuitem"><div class="dropdown-content {{::$ctrl.flyoutItem.itemClass}}"><i class="glyphicon glyph {{::$ctrl.flyoutItem.itemClass}}" ng-class="::{\'glyph-small\': $ctrl.glyphSmall}" title="{{::$ctrl.flyoutItem.tooltip || $ctrl.flyoutItem.text}}"></i><span class="dropdown-label" ng-bind="::$ctrl.flyoutItem.text" title="{{::$ctrl.flyoutItem.tooltip || $ctrl.flyoutItem.text}}"></span><span ng-if="::$ctrl.flyoutItem.description" class="dropdown-description" ng-bind="::$ctrl.flyoutItem.description"></span><i class="glyphicon pbi-glyph-chevronrightmedium glyph-small" title="{{::$ctrl.flyoutItem.tooltip || $ctrl.flyoutItem.text}}"></i></div></button>'),e.put("components/explorationAppBar/explorationAppBar.html",'<div class="appBarContent trimmedTextWithEllipsis unselectable appThemable"><div class="appBarSection left" focus-nav-mode="Browser" keyboard-shortcuts="ctrl-F6"><ul><li ng-if="$ctrl.isAppNavToggleEnabled"><pbi-lazy-load-modern [module-path]="$ctrl.appConsumptionLazyLoadPath" [component-id]="$ctrl.appConsumptionNavPaneToggleLazyComponentId"></pbi-lazy-load-modern></li><li ng-if="$ctrl.viewModel.options.showBackButtonOnAppBar"> <button ng-click="$ctrl.navigateBack()" localize-tooltip="Go_Back"><i class="glyphicon pbi-glyph-pageleft glyph-small backBtn"></i></button></li><li> <button class="file-menu" localize-tooltip="File" ng-click="$ctrl.showFileMenu($event);selected=!selected" aria-haspopup="true" aria-expanded="{{$ctrl.isFileMenuOpen}}"><span localize="File"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.showViewMenu()"> <button class="pageview-menu" localize-tooltip="ItemAction_View" ng-click="$ctrl.showViewDropdown($event)" aria-haspopup="true" aria-expanded="{{$ctrl.isViewMenuOpen}}"><span localize="ItemAction_View"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.showReadingViewButton()"> <button localize-tooltip="ReportAppBar_SwitchModeButton" accessible-click="$ctrl.stopEditing()" class="switch"><span localize="ReportAppBar_SwitchModeButton"></span></button></li><li ng-if="$ctrl.canOpenEditReport()"> <button class="edit" localize-tooltip="ReportAppBar_EditReportButton" ng-click="$ctrl.edit()"><span localize="ReportAppBar_EditReportButton"></span></button></li><li ng-if="$ctrl.showEditReportDisabled()"> <button class="edit-disabled" disabled localize-tooltip="ReportAppBar_EditReportButtonSharedDisabled" localize="ReportAppBar_EditReportButton"></button></li><li ng-if="$ctrl.showEditDropdownMenu()"> <button class="editreport-menu" accessible-click="$ctrl.showEditMenu($event)" localize-tooltip="ReportAppBar_EditReportButton" role="menuitem"><span localize="ReportAppBar_EditReportButton"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.showPhoneLayoutButton()"> <button localize-tooltip="ReportAppBar_MobileLayout" class="phone-layout-button" accessible-click="$ctrl.setPhonePortraitFormFactor()"><span localize="ReportAppBar_MobileLayout"></span></button></li><li ng-if="$ctrl.showWebLayoutButton()"> <button localize-tooltip="ReportAppBar_WebLayout" class="web-layout-button" accessible-click="$ctrl.setMasterFormFactor()"><span localize="ReportAppBar_WebLayout"></span></button></li></ul></div><div class="appBarSection right" ng-show="$ctrl.showAppBarRight()"><ul><li ng-if="$ctrl.viewModeState.getMode() === 0" class="appBarDivider" role="separator"></li><li ng-if="$ctrl.viewModeState.getMode() === 0"> <button class="explore" localize-tooltip="ReportAppBar_ExploreTooltip" ng-disabled="$ctrl.isMenuDisabled($ctrl.getExploreMenuProperties())" ng-click="$ctrl.showExploreMenu($event)" aria-haspopup="true" aria-expanded="{{$ctrl.isExploreMenuOpen}}"><i class="glyphicon pbi-glyph-seedata glyph-small"></i><span localize="ReportAppBar_ExploreButton"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.viewModeState.getMode() === 0"> <button ng-click="$ctrl.refresh()" class="refresh" localize-tooltip="Refresh"><i class="glyphicon pbi-glyph-refresh glyph-mini" aria-hidden="true"></i><span localize="Refresh"></span></button></li><li ng-if="$ctrl.viewModeState.getMode() === 0 && $ctrl.showPinPage() && $ctrl.canPinPage()"> <button localize-tooltip="ReportAppBar_PinPage" class="pin-report" ng-click="$ctrl.showPinReportPageDialog()"><i class="glyphicon pbi-glyph-pinned glyph-small"></i><span localize="ReportAppBar_PinPage"></span></button></li><li ng-if="$ctrl.viewModeState.getMode() === 0" feature-switch="qnaPopoutInReportAppBar"> <button class="qna" localize-tooltip="AskAQuestion" ng-click="$ctrl.showQnaPopout()"><i class="glyphicon pbi-glyph-qna glyph-small"></i><span localize="AskAQuestion"></span></button></li><li class="rightFloatedItem"></li><li ng-if="!$ctrl.isPopOutMode && $ctrl.isQnaEnabled"> <button class="qna" localize-tooltip="AskAQuestion" ng-click="$ctrl.addQnaContainer()"><i class="glyphicon pbi-glyph-qna glyph-small"></i><span localize="AskAQuestion"></span></button></li><li ng-if="$ctrl.viewModeState.getMode() === 1"> <button class="explore" localize-tooltip="ReportAppBar_ExploreTooltip" ng-disabled="$ctrl.isMenuDisabled($ctrl.getExploreMenuProperties())" ng-click="$ctrl.showExploreMenu($event)" aria-haspopup="true" aria-expanded="{{$ctrl.isExploreMenuOpen}}"><i class="glyphicon pbi-glyph-seedata glyph-small"></i><span localize="ReportAppBar_ExploreButton"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.viewModeState.getMode() === 1 && !$ctrl.isPopOutMode"> <button class="insert-textbox" localize-tooltip="Textbox" ng-click="$ctrl.insertTextbox()"><i class="glyphicon pbi-glyph-inserttextbox glyph-small"></i><span localize="Textbox"></span></button></li><li dropdown-menu dropdown-items="$ctrl.shapeMenuActions" dropdown-class="explorationAppBarMenu" dropdown-on-item-selected="$ctrl.shapeMenuActionSelected(selected)" localize-tooltip="ReportAppBar_ShapeButton" ng-if="$ctrl.viewModeState.getMode() === 1 && $ctrl.shapeMenuActions && !$ctrl.isPopOutMode"> <button aria-haspopup="true" class="insert-shape"><i class="glyphicon pbi-glyph-shapes glyph-small"></i><span localize="ReportAppBar_ShapeButton"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.viewModeState.getMode() === 1 && $ctrl.actionButtonMenuActions && !$ctrl.isPopOutMode"> <button aria-haspopup="true" class="insert-button" localize-tooltip="ReportAppBar_Buttons" ng-click="$ctrl.showActionMenu($event)" aria-expanded="{{$ctrl.isButtonsMenuOpen}}"><i class="glyphicon pbi-glyph-buttons glyph-small"></i><span localize="ReportAppBar_Buttons"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.viewModeState.getMode() === 1 && $ctrl.toggleEditVisualInteractionsMode && !$ctrl.isPopOutMode"> <button class="visualInteractions-menu" localize-tooltip="ReportAppBar_VisualInteractionsTooltip" aria-haspopup="true" ng-click="$ctrl.showVisualInteractionMenu($event)" aria-expanded="{{$ctrl.isVisualInteractionMenuOpen}}"><i class="glyphicon pbi-glyph-visualsinteraction glyph-small"></i><span localize="ReportAppBar_VisualInteractionsButton"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.viewModeState.getMode() === 1"> <button ng-click="$ctrl.refresh()" class="refresh" localize-tooltip="Refresh"><i class="glyphicon pbi-glyph-refresh glyph-mini" aria-hidden="true"></i><span localize="Refresh"></span></button></li><li ng-if="$ctrl.canDuplicatePage()"> <button ng-click="$ctrl.duplicateReportPage()" localize-tooltip="ReportAppBar_duplicateButton_Text" class="duplicate"><i class="glyphicon pbi-glyph-chromerestore glyph-small" aria-hidden="true"></i><span localize="ReportAppBar_duplicateButton_Text"></span></button></li><li ng-if="$ctrl.canSaveReport()"> <button ng-click="$ctrl.saveFromButton()" localize-tooltip="ReportAppBar_SaveToDashboardDescription" class="save"><i class="glyphicon pbi-glyph-save glyph-small" aria-hidden="true"></i><span localize="ReportAppBar_SaveReportButton"></span></button></li><li ng-if="$ctrl.viewModeState.getMode() === 1 && $ctrl.showPinPage() && $ctrl.canPinPage()"> <button localize-tooltip="ReportAppBar_PinPage" class="pin-report" ng-click="$ctrl.showPinReportPageDialog()"><i class="glyphicon pbi-glyph-pinned glyph-small"></i><span localize="ReportAppBar_PinPage"></span></button></li><li ng-if="$ctrl.showPinPage() && $ctrl.pinPageDisabled()"> <button localize-tooltip="PinTile_NotSupportedTitle" class="pin-disabled" disabled><i class="glyphicon pbi-glyph-pinned glyph-small"></i><span localize="ReportAppBar_PinPage"></span></button></li><li ng-if="$ctrl.canPause && !$ctrl.viewModeState.getConfig().pauseQueryExecution"> <button class="pause" localize-tooltip="ReportAppBar_PauseQueries" ng-click="$ctrl.togglePlayPause()"><span localize="ReportAppBar_PauseQueries"></span></button></li><li ng-if="$ctrl.canPause && $ctrl.viewModeState.getConfig().pauseQueryExecution"> <button class="play" localize-tooltip="ReportAppBar_ResumeQueries" ng-click="$ctrl.togglePlayPause()"><span localize="ReportAppBar_ResumeQueries"></span></button></li><li ng-if="$ctrl.isResetUserStateVisible()"> <button class="resetUserState" localize-tooltip="{{$ctrl.getUserStateTooltip()}}" dynamic-tooltip-update ng-click="$ctrl.resetUserState()" ng-disabled="$ctrl.isResetUserStateDisabled()"><i class="glyphicon pbi-glyph-undo glyph-mini"></i><span localize="Reset_To_Default"></span></button></li><li ng-if="$ctrl.isCommentVisible()"><div ng-if="$ctrl.unreadAnnotationsCount()" class="badge mini-label" ng-bind="$ctrl.unreadAnnotationsCount()"></div> <button localize-tooltip="{{$ctrl.getCommentingTooltip()}}" dynamic-tooltip-update ng-click="$ctrl.expandCommentingPane()" ng-disabled="$ctrl.isCommentDisabledByAuthor()"><i class="glyphicon pbi-glyph-comment glyph-mini"></i><span localize="Comments"></span></button></li><li ng-if="$ctrl.showNewUsageMetricsToggle()"><pbi-toggle on-state-text="UsageMetrics_NewUI_On" off-state-text="UsageMetrics_NewUI_Off" class="newUsageMetricsUI newUsageMetricsToggleButtonTutorialHook" ng-change="$ctrl.onNewUsageMetricsToggleChange()" ng-model="$ctrl.newUsageMetricsEnabled"></pbi-toggle></li><li ng-if="$ctrl.viewModeState.getMode() === 0" feature-switch="personalBookmarksUI"> <button class="bookmarks-menu" localize-tooltip="ExplorationBookmarksPane_Title" ng-click="$ctrl.showBookmarksMenu($event)" aria-expanded="$ctrl.isBookmarksMenuOpen" aria-haspopup="true"><i class="glyphicon pbi-glyph-bookmark glyph-small"></i><span localize="ExplorationBookmarksPane_Title"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.canOpenUsageMetricsReport()"> <button localize-tooltip="UsageMetrics_Tooltip" ng-click="$ctrl.openUsageMetricsReport()" class="usageMetricsReport"><i class="glyphicon pbi-glyph-chart glyph-small"></i><span localize="UsageMetrics_Label"></span></button></li><li ng-if="$ctrl.isViewRelatedContentEnabled()"> <button class="related" localize-tooltip="DashboardAppBar_ViewRelated" ng-click="$ctrl.showRelatedContentPane()"><i class="glyphicon pbi-glyph-relationship glyph-small"></i><span localize="DashboardAppBar_ViewRelated"></span></button></li><li class="noMinWidth" ng-if="$ctrl.isReportFavoritesEnabled()"><favorite-menu view-model="::$ctrl.getReportModel()" show-labels="true"/></li><li ng-if="$ctrl.isEmailSubscriptionEnabled()"> <button class="subscription" ng-disabled="$ctrl.shouldDisableEmailSubscriptions()" localize-tooltip="{{::$ctrl.getToolTipBasedOnEnableSubscription()}}" ng-click="$ctrl.showSubscriptionPane()"><i class="glyphicon pbi-glyph-mail glyph-small"></i><span localize="ReportAppBar_Subscribe"></span></button></li><li ng-if="$ctrl.canShareReport()"> <button ng-click="$ctrl.showShareSlider()" class="shareReportButton" localize-tooltip="ReportAppBar_ShareButton"><i class="glyphicon pbi-glyph-share glyph-small"></i><span localize="ReportAppBar_ShareButton"></span></button></li><li class="moreOptionsItem" ng-if="$ctrl.showReportMoreOptionsMenu()"> <button class="moreOptionsDashboardButton glyphicon glyph-small pbi-glyph-more" ng-click="$ctrl.showMoreOptionsMenu($event)" localize-tooltip="Options_Menu" aria-haspopup="true" aria-expanded="{{$ctrl.isMoreOptionsMenuOpen}}"></button></li></ul></div></div>'),
e.put("components/explorationContainerLegacy/explorationContainerLegacy.html",'<div class="explorationContainer explorationWithChrome themeableElement" ng-class="{\'editing\' : (C.viewModeState.getMode() === 1 || C.viewModeState.getMode() === 2),    \'reading\': C.viewModeState.getMode() === 0,    \'newPaneColors\': C.featureSwitchService.featureSwitches.paneColorRefresh || C.isFluentDesignEnabled()}" pbi-lazy-load-contents="C.jQueryUIConfig" prevent-focus-loss="true"><section class="appBar" ng-if="C.viewModel.options.showAppBar"><exploration-app-bar view-model="C.viewModel" ng-if="!C.isFluentAppBarVisible()"></exploration-app-bar><app-bar-modern [view-model]="C.viewModel" ng-if="C.isFluentAppBarVisible()"></app-bar-modern><app-action-menu ng-if="C.inAppArtifactView()"></app-action-menu></section><notification-bar></notification-bar><div class="explorationHost" ng-class="{ \'explorationHostNoAppBar\': !C.viewModel.options.showAppBar }"><exploration-host [view-model]="C.viewModel" id="pvExplorationHost"><pbi-lazy-load-modern ng-if="C.isFluentSectionVisible()" [module-path]="C.explorationFluentNavigationModulePath" [component-id]="\'ExplorationFluentNavigationComponentId\'"></pbi-lazy-load-modern><flyout class="rightSidePane" ng-if="C.isAnnotationsPaneVisible()" [lazy-load-path]="C.annotationsModulePath" [lazy-component-id]="\'ReportPaneComponentId\'"></flyout><pbi-lazy-load-modern class="sidePane rightSidePane smallFontSize" ng-if="C.isMobileVisualizationPaneVisible()" [module-path]="C.exploreUIAuthoringModulePath" [component-id]="\'MobileVisualizationPaneComponentId\'"></pbi-lazy-load-modern><pbi-lazy-load-modern class="sidePane rightSidePane smallFontSize" ng-if="C.isExportDataPaneVisible()" [module-path]="C.exploreUIExportModulePath" [component-id]="\'ExportDataPaneComponentId\'"></pbi-lazy-load-modern><div ng-if="C.isTaskPaneVisible()" ng-show="C.viewModel.options.showTaskPane" class="taskPane sidePane rightSidePane smallFontSize" ng-class="{ isCollapsed: !C.viewModel.taskPane.isPaneExpanded }" keyboard-shortcuts="ctrl-F6" focus-nav-mode="Group" focus-priority="9" resizable resizable-containerid="pvExplorationHost .verticalItemsContainer" resizable-sibling="visualizationPane" resizable-expanded="{{C.viewModel.taskPane.isPaneExpanded}}" resizable-default-width="180" resizable-min-width="180" resizable-max-width="420" resizable-collapsed-width="32"><task-pane view-model="C.viewModel.taskPane" field-list-config="::C.fieldListConfig"></task-pane></div><mobile-bookmarks-menu class="sidePane visualizationPane rightSidePane smallFontSize hidden" ng-if="C.useMobileBookmarks()" [view-model]="C.viewModel" [is-tablet]="true"></mobile-bookmarks-menu><div ng-if="C.isVisualizationPaneVisible()" class="visualizationPane sidePane rightSidePane smallFontSize" ng-class="{ isCollapsed: !C.viewModel.visualizationPane.isPaneExpanded }" keyboard-shortcuts="ctrl-F6" focus-nav-mode="Group" focus-priority="7" resizable resizable-containerid="pvExplorationHost .verticalItemsContainer" resizable-sibling="taskPane" resizable-expanded="{{C.viewModel.visualizationPane.isPaneExpanded}}" resizable-default-width="180" resizable-min-width="180" resizable-max-width="420" resizable-collapsed-width="32"><visualization-pane view-model="C.viewModel.visualizationPane"></visualization-pane></div><div class="sidePane visualizationPane rightSidePane smallFontSize" ng-class="{ isCollapsed: !C.viewModel.bookmarksPane.isPaneExpanded }" ng-if="C.isBookmarksPaneVisible()" pbi-lazy-load-contents="C.exploreUIShellConfig" resizable resizable-containerid="pvExplorationHost .verticalItemsContainer" resizable-sibling="taskPane" resizable-expanded="{{C.viewModel.bookmarksPane.isPaneExpanded}}" resizable-default-width="{{ C.isFluentDesignEnabled() ? 280 : 180 }}" resizable-min-width="{{ C.isFluentDesignEnabled() ? 280 : 180 }}" resizable-max-width="420" resizable-collapsed-width="32"><bookmarks-pane view-model="C.viewModel.bookmarksPane" bookmarks="C.viewModel.exploration.contract.bookmarks" selected-bookmark="C.viewModel.exploration.contract.activeBookmark"></bookmarks-pane></div><div class="sidePane visualizationPane rightSidePane smallFontSize" ng-class="{ isCollapsed: !C.viewModel.syncGroupPane.isPaneExpanded }" ng-if="C.isSyncGroupPaneVisible()" pbi-lazy-load-contents="C.exploreUIShellConfig" resizable resizable-containerid="pvExplorationHost .verticalItemsContainer" resizable-sibling="taskPane" resizable-expanded="{{C.viewModel.syncGroupPane.isPaneExpanded}}" resizable-default-width="180" resizable-min-width="180" resizable-max-width="420" resizable-collapsed-width="32" feature-switch="slicerSyncing"><sync-group-pane exploration="C.viewModel.exploration" explore-canvas="C.viewModel.exploration.exploreCanvas" view-model="C.viewModel.syncGroupPane"></sync-group-pane></div><div class="sidePane visualizationPane rightSidePane smallFontSize" ng-class="{ isCollapsed: !C.viewModel.canvasItemsPane.isPaneExpanded }" ng-if="C.viewModel.canvasItemsPane.isPaneVisible" pbi-lazy-load-contents="C.exploreUIShellConfig" resizable resizable-containerid="pvExplorationHost .verticalItemsContainer" resizable-sibling="taskPane" resizable-expanded="{{C.viewModel.canvasItemsPane.isPaneExpanded}}" resizable-default-width="180" resizable-min-width="180" resizable-max-width="420" resizable-collapsed-width="32" feature-switch="canvasItemsPane"><canvas-items-pane view-model="C.viewModel.canvasItemsPane" explore-canvas="C.viewModel.exploration.exploreCanvas"></canvas-items-pane></div><div class="horizontalItemsContainer" ng-if="!(C.viewModel && C.viewModel.hideVisuals)"><exploration [view-model]="C.viewModel.exploration" ng-class="{\'exploreCanvasToBottom\': !C.isFooterVisible() && !C.showFullScreenComponent(), \'exploreCanvasWithFullScreenComponent\': C.showFullScreenComponent()}" [canvas-options]="C.canvasOptions" [should-set-focus]="C.shouldSetTabIndex()"></exploration><exploration-footer prevent-focus-loss="false" ng-if="C.isFooterVisible() && !C.useModernFooter && !C.useMobileFooter()" view-model="C.viewModel"></exploration-footer><mobile-exploration-footer ng-if="C.isFooterVisible() && C.useMobileFooter()" view-model="C.viewModel"></mobile-exploration-footer><exploration-footer-modern prevent-focus-loss="false" ng-if="C.isFooterVisible() && C.useModernFooter && C.viewModel.exploration && !C.useMobileFooter()" [view-model]="C.viewModel"></exploration-footer-modern><pbi-lazy-load-modern ng-if="C.showFullScreenComponent()" [module-path]="C.explorationFluentNavigationModulePath" [component-id]="\'ExplorationFullScreenNavigationComponentId\'"></pbi-lazy-load-modern></div></exploration-host></div><div class="explorationMask" ng-if="C.viewModel.showMask"><div class="centeredSpinner"><spinner></spinner></div></div><div class="canvasSpinnerBackground" ng-if="C.viewModel.showSpinner"><pbi-data-loader-spinner class="centered"></pbi-data-loader-spinner></div></div>'),e.put("views/dropdowns/appBarMenu.html",'<dropdown-overlay dropdown-overlay-name="{{menuOverlayName}}" on-close="onClose()"><ul class="angular-dropdown explorationAppBarMenu active appThemable" ng-class="{dark: getMode() === 0, themeableElement: themeable, fluentTheme: fluentThemeEnabled}" focus-trap role="menu"><li ng-repeat="item in getMenuActions()" ng-switch="::item.type" class="themeYellowDark"> <button ng-switch-when="0" class="dropdown-item {{menuItemClass}}" ng-click="menuActionSelected(item); $event.stopPropagation(); $event.preventDefault()" ng-disabled="item.disabled" ng-class="{\'selected\': item.checked}" ng-attr-aria-pressed="{{ item.checkbox || item.checked ? !!item.checked : undefined }}" ng-attr-data-unique-id="{{item.action ? \'appBarMenu-\' + item.action : undefined}}" role="button" title="{{::item.tooltip || item.text}}"><div class="dropdown-content {{::item.itemClass}}"><i class="glyphicon glyph {{::item.itemClass}}" ng-class="::{\'glyph-small\': glyphSmall}" title="{{::item.tooltip || item.text}}"></i><span class="dropdown-label" ng-bind="::item.text" title="{{::item.tooltip || item.text}}"></span><span ng-if="::item.description" class="dropdown-description" ng-bind="::item.description"></span><pbi-toggle ng-if="item.checkbox" ng-model="item.checked" ng-disabled="item.disabled" no-label on-state-text="ToggleSwitchOn" off-state-text="ToggleSwitchOff"></pbi-toggle></div></button><div ng-switch-when="1" ng-bind="::item.text" ng-attr-data-unique-id="{{ item.action ? \'appBarMenu-\' + item.action : undefined }}"></div><div ng-switch-when="2" class="dropdown-separator" role="separator"></div><app-bar-flyout-menu ng-switch-when="3" flyout-item="item" ng-attr-data-unique-id="{{ item.action ? \'appBarMenu-\' + item.action : undefined }}" menu-overlay-name="menuOverlayName" menu-item-class="menuItemClass" glyph-small="glyphSmall" get-mode="getMode()" menu-action-selected="menuActionSelected($item)"/><pbi-lazy-load-modern ng-switch-when="4" [module-path]="item.lazyModulePath" [component-id]=\'item.lazyComponentId\'></pbi-lazy-load-modern></li></ul></dropdown-overlay>')}]);var powerbi;!(function(e){var t;!(function(t){var i=e.explore.services.events,o=e.explore.constants;t.ErrorNotificationMixinFactory={ng:["$scope","errorService","gatewaysMetadataService","localizationService","modalDialogService","modelHttpService","moduleLoader","notificationBarService","$rootScope","selectGatewayService","navigation"],scoped:["eventBridge"],fn:function(e){return new r(e)}};var r=(function(){function t(e){var t=this;this.services=e,this.channelSubscriptionManager=this.services.eventBridge.createChannelSubscriptionManager().subscribe(i.reportVisualError,(function(e,i){i&&i.showNotification&&(!i.model&&i.error.code&&i.showNotification&&(i.model=t.explorationContainer.viewModel.datasetModel),i.refreshFunction||(i.refreshFunction=function(){return t.explorationContainer.refresh()}),t.showErrorNotification(i))}))}return t.prototype.update=function(e){this.explorationContainer=e},t.prototype.destroy=function(){this.channelSubscriptionManager.unsubscribeAll()},t.prototype.showErrorNotification=function(e){var t=this,i=e.model;i.contract.creatorUser?this.notifyError(e):this.services.modelHttpService.getModel(i.id,i.packageId,null).then((function(o){o.data.creatorUser&&(i.contract.creatorUser=o.data.creatorUser,t.notifyError(e))}))},t.prototype.notifyError=function(e){var t=this,i=e.error,o=e.model,r=e.refreshFunction;this.requiresGatewayInfo(i.code)?this.services.gatewaysMetadataService.getModelDataSources(o.id).then((function(e){var n=t.services.selectGatewayService.getSelectedGateway(e);t.notify(i,o,n,r)}),(function(e){t.notify(i,o,null,r)})):this.notify(i,o,null,r)},t.prototype.notify=function(e,t,i,o){var r=this.getErrorNotificationParameter(e,t,i,o);if(r){var n={notificationName:"lastErrorNotifyId",notificationId:this.services.notificationBarService.notify(r)};this.explorationContainer.addNotification(n)}},t.prototype.requiresGatewayInfo=function(t){return t===e.DM_GWPipeline_Client_GatewayUnreachable},t.prototype.getErrorNotificationParameter=function(t,i,r,n){var s=this,a=t.code,l=i.contract.creatorUser,c=l.emailAddress;c&&c.match(e.common.controllers.EmailValidator)||(c=l.AlternateEmailAddress);var p,u,d,h,v,g=c===e.session.UserInfoUtils.getUPN();switch(a){case e.DMTS_NoGatewayWithAllDatasourcesToBindError:var m=this.getDatabaseName(t);p=this.services.localizationService.format("ExplorationContainer_Notification_DMTS_NoGatewayWithAllDatasourcesToBindError_Message",m),d=[{displayText:m},this.createDatasetsSettingPageActionLink(m)],h=this.createErrorDialogActionLink("ExplorationContainer_Notification_DataSourceUnreachable","ExplorationContainer_Notification_DMTS_NoGatewayWithAllDatasourcesToBindError_ModalDialog",d);break;case e.DM_GWPipeline_Gateway_GatewayUpgradeRequired:p=this.services.localizationService.get("ExplorationContainer_Notification_DM_GWPipeline_Client_GatewayUpgradeRequired");break;case e.DMTS_MultipleGatewaysWithAllDatasourcesToBindError:m=this.getDatabaseName(t),p=this.services.localizationService.format("ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_NotificationBar",m),u=g?"ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_Message":"ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_NotOwner_ModalDialog",d=[{displayText:m}],g?d.push(this.createDatasetsSettingPageActionLink(m)):d.push({displayText:l.givenName,urlString:"mailto:"+c}),h=this.createErrorDialogActionLink("ExplorationContainer_Notification_DataSourceInaccessible",u,d);break;case e.DMTS_DatasourceHasNoCredentialError:m=this.getDatabaseName(t),p=this.services.localizationService.format("ExplorationContainer_Notification_CredentialsRequired_NotificationBar",m),u=g?"ExplorationContainer_Notification_CredentialsRequired_Message":"ExplorationContainer_Notification_CredentialsRequired_NotOwner_Message",d=[{displayText:m}],g?d.push(this.createDatasetsSettingPageActionLink(m)):d.push({displayText:l.givenName,urlString:"mailto:"+c}),h=this.createErrorDialogActionLink("ExplorationContainer_Notification_DataSourceCredentialsMissing",u,d);break;case e.DM_GWPipeline_Client_GatewayUnreachable:var f=r.gatewayName;m=this.getDatabaseName(t),p=this.services.localizationService.format("ExplorationContainer_Notification_DM_GWPipeline_Client_GatewayUnreachable_NotificationBar",m,f),u=g?"ExplorationContainer_Notification_DM_GWPipeline_Client_GatewayUnreachable_ModalDialog_Owner":"ExplorationContainer_Notification_DM_GWPipeline_Client_GatewayUnreachable_ModalDialog_NotOwner",d=[{displayText:m},{displayText:f}],g?d.push(this.createDatasetsSettingPageActionLink(m)):d.push({displayText:l.givenName,urlString:"mailto:"+c}),h=this.createErrorDialogActionLink("ExplorationContainer_Notification_DataGatewayUnreachable",u,d);break;case e.RS_CannotRetrieveModel:p=this.services.localizationService.get("DsrError_CanNotRetrieveModelMessage"),h=null;break;case e.RS_AccessDeniedDueToRLSGroup:p=this.services.localizationService.get("DsrError_NoPermissionDueToRLSGroupMessage_NotificationBar"),d=[{displayText:c,urlString:"mailto:"+c}],h=this.createErrorDialogActionLink("DsrError_NoPermissionToViewMessage_Title","DsrError_NoPermissionDueToRLSGroupMessage_ModalDialog",d);break;case e.RS_AccessDenied:p=this.services.localizationService.get("DsrError_NoPermissionToViewMessage"),d=[{displayText:c,urlString:"mailto:"+c}],h=this.createErrorDialogActionLink("DsrError_NoPermissionToViewMessage_Title","DsrError_NoPermissionToViewMessage_ModalDialog",d);break;case e.DMTS_UserNotFoundInADGraphError:p=this.services.localizationService.format("ExplorationContainer_Notification_DMTS_UserNotFoundInADGraphError_NotificationBar",c),m=i.dbName,d=[{displayText:c},this.createDatasetsSettingPageActionLink(m)],h=this.createErrorDialogActionLink("ExplorationContainer_Notification_DataSetOwnerNotFound","ExplorationContainer_Notification_DMTS_UserNotFoundInADGraphError_Message",d);break;case e.DMTS_UserLostPermissionToDatasourceError:case e.DM_GWPipeline_Gateway_ImpersonationError:p=g?this.services.localizationService.get("ExplorationContainer_Notification_DMTS_UserLostPermissionToDatasourceError_Message"):this.services.localizationService.format("ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_NotOwner_Message",[l.givenName]),h=g?{displayText:this.services.localizationService.get("ExplorationContainer_Notification_DMTS_UserLostPermissionToDatasourceError_ActionText"),action:function(){s.services.selectGatewayService.bindModelToGateway(i.id,(function(){s.explorationContainer.refresh()}),(function(){s.services.errorService.error(s.services.localizationService.get("ExplorationContainer_FailedToBindToGatewayMessage"),"ExplorationContainer_FailedToBindToGateway")}),(function(){}))}}:{displayText:this.services.localizationService.format("Email_Someone",[l.givenName]),urlString:"mailto:"+c};break;case e.DM_GWPipeline_Gateway_DataSourceAccessError:p=g?this.services.localizationService.get("ExplorationContainer_Notification_DMTS_DatasourceAccessError_Message"):this.services.localizationService.format("ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_NotOwner_Message",[l.givenName]),h=null;break;case e.DM_GWPipeline_Gateway_SqlTimeoutException:m=this.getDatabaseName(t),p=this.services.localizationService.format("ServerError_DM_GWPipeline_Gateway_GenericTimeoutException_NotificationBar",m),d=[{displayText:m}],h=this.createErrorDialogActionLink("ServerError_DM_GWPipeline_Gateway_GenericTimeoutException_Title",o.serverErrorPrefix+a,d);break;case e.DM_GWPipeline_Gateway_AdomdTimeoutException:m=this.getDatabaseName(t),p=this.services.localizationService.format("ServerError_DM_GWPipeline_Gateway_GenericTimeoutException_NotificationBar",m),d=[{displayText:m}],h=this.createErrorDialogActionLink("ServerError_DM_GWPipeline_Gateway_GenericTimeoutException_Title","ServerError_DM_GWPipeline_Gateway_AdomdTimeoutException",d);break;case e.DM_GWPipeline_Gateway_InvalidObjectNameException:m=this.getDatabaseName(t),p=this.services.localizationService.get("ServerError_DM_GWPipeline_Gateway_InvalidObjectNameException"),d=[{displayText:m}],h=this.createErrorDialogActionLink("ServerError_DataSourceSchemaChanged","ServerError_DM_GWPipeline_Gateway_InvalidObjectNameException_ModalDialog",d);break;case e.DM_GWPipeline_Gateway_ConnectionBrokenException:m=this.getDatabaseName(t),p=this.services.localizationService.format("ServerError_DM_GWPipeline_Gateway_ConnectionBrokenException",m),d=[{displayText:m}],h=this.createErrorDialogActionLink("ServerError_DataSourceConnectionFailed","ServerError_DM_GWPipeline_Gateway_ConnectionBrokenException_ModalDialog",d);break;case e.DM_GWPipeline_Gateway_MashupDataAccessError:m=this.getDatabaseName(t),p=this.services.localizationService.format("ServerError_DM_GWPipeline_Gateway_MashupDataAccessError",m),d=[{displayText:m},this.createDatasetsSettingPageActionLink(m)],h=this.createErrorDialogActionLink("ServerError_DataSourceConnectionFailed","ServerError_DM_GWPipeline_Gateway_MashupDataAccessError_ModalDialog",d);break;case e.DM_GWPipeline_Gateway_DatabaseConnectError:m=this.getDatabaseName(t),p=this.services.localizationService.format("ServerError_DM_GWPipeline_Gateway_DatabaseConnectError_NotificationBar",m),d=[{displayText:m}],h=this.createErrorDialogActionLink("ServerError_DM_GWPipeline_Gateway_DatabaseConnectError","ServerError_DM_GWPipeline_Gateway_DatabaseConnectError_ModalDialog",d);break;case e.DM_GWPipeline_Gateway_ServerUnreachable:m=this.getDatabaseName(t),p=this.services.localizationService.format("ServerError_DM_GWPipeline_Gateway_DatabaseConnectError_NotificationBar",m),d=[{displayText:m}],h=this.createErrorDialogActionLink("ServerError_DM_GWPipeline_Gateway_ServerUnreachable","ServerError_DM_GWPipeline_Gateway_ServerUnreachable_ModalDialog",d);break;case e.DM_GWPipeline_Client_OAuthTokenRefreshFailedError:p=this.services.localizationService.format("ExplorationContainer_Notification_DM_GWPipeline_Client_OAuthTokenRefreshFailedError_NotificationBar");break;case e.DM_GWPipeline_Gateway_InvalidMashupConnectionString:case e.DM_GWPipeline_Gateway_DatabaseLoginError:case e.DM_GWPipeline_Gateway_MemoryError:case e.DM_GWPipeline_Gateway_MissingStructureError:case e.DM_GWPipeline_Gateway_UnprocessedStructureError:case e.DM_GWPipeline_Gateway_ModelLoadError:case e.DM_GWPipeline_Gateway_CancellationError:case e.DM_GWPipeline_Gateway_QueryExecutionError:case e.DM_GWPipeline_Gateway_RecalculationRequiredError:case e.DM_GWPipeline_Gateway_AdomdConnectError:default:p=this.services.localizationService.get(o.serverErrorPrefix+a),h=null}return{message:p,notificationType:1,secondaryLink:h,embeddedMessageAction:v}},t.prototype.createErrorDialogActionLink=function(e,t,i){var o=this;return{displayText:this.services.localizationService.get("Generic_ShowDetails"),action:function(){return o.showModalDialog(e,t,i)}}},t.prototype.createDatasetsSettingPageActionLink=function(e){var t=this;return{displayText:this.services.localizationService.get("ExplorationContainer_Notification_DatasetSettingsPage"),action:function(){return t.services.navigation.showSettingsSlider("datasets",e)},dismissDialogAfterActionPerformed:!0}},t.prototype.getDatabaseName=function(e){if(e["pbi.error"]){var t=e["pbi.error"].details;if(t&&t.length>1)return t[1].detail.value}return""},t.prototype.showModalDialog=function(t,i,o){return __awaiter(this,void 0,e.Promise,(function(){var e,r;return __generator(this,(function(n){switch(n.label){case 0:return[4,this.services.moduleLoader.require({javascript:"PowerBIDialogs/components/reportServiceErrorMessageDialog/reportServiceErrorMessageDialogBuilder"})];case 1:return e=n.sent(),r=e.createReportServiceErrorMessageDialogBuilder(this.services.modalDialogService),[4,r.show(t,i,o)];case 2:return n.sent(),[2]}}))}))},t})()})(t=e.mixins||(e.mixins={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.explore.services.events,o=e.explore.dialogs.ExportDataDialogBuilder,r=e.common.dialogs.FeatureNotSupportedDialogBuilder,n=e.explore.util.VisualContainerUtils;t.ExportDataMixinFactory={ng:["auditing","featureSwitchService","licenseEnforcementService","localizationService","modalDialogService","optionsDialogBuilder","telemetryService","userInfo"],scoped:["dataSources","eventBridge","explorationCapabilities","exportData","drillToDetails"],fn:function(e){return new s(e)}};var s=(function(){function t(e){var t=this;this.services=e,this.unsubscribe=this.services.eventBridge.createChannelSubscriptionManager().subscribe(i.exportVisualData,(function(e,i){return t.exportVisualData(e,i)})).subscribe(i.exportVisualDataFromPane,(function(e,i){return t.exportVisualDataFromPane(i)}))}return t.prototype.update=function(e){this.explorationContainer=e},t.prototype.destroy=function(){this.unsubscribe.unsubscribeAll()},t.prototype.exportVisualData=function(e,t){e.stopPropagation();var i=this.services,o=i.licenseEnforcementService;if(!o.supportsExportData||o.supportsExportData(!0)){var r=i.featureSwitchService.featureSwitches,n=i.explorationCapabilities.getCapabilities();r.exportVisualToExcelEnabled&&!n.disableExportToExcel?this.isVisualInSeeRecordsMode(t.visualConfig.query)?this.showOptionsDialog(t):this.showExportDataDialogFromVisual(t):this.exportVisualDataToFile(t,0,0)}},t.prototype.showExportDataDialogFromVisual=function(e){var t,i=this,r=new o(this.services.modalDialogService,this.services.localizationService),n=this.services.exportData,s=this.explorationContainer.viewModel.datasetModel,a=n.getExportDataToExcelUnsupportedType(e.visualConfig,s);0===a&&(t=this.services.drillToDetails.getDetailsTableTargetMeasures(e.visualConfig));var l=this.explorationContainer.viewModel.exploration.contract.settings,c=l&&l.exportDataMode,p=n.areExploreOperationsAuthorized(s),u=_.some(t)&&p,d=this.services.featureSwitchService.featureSwitches,h=d.GranularSettingsExportToExcel&&d.isExportToExcelSeparatedFromExportDataEnabled?d.exportToExcelSettingEnabled:d.exportDataEnabled;r.show(d.exportDataEnabled,h,a,u,c,p,this.explorationContainer.reportId).then((function(o){o&&i.exportVisualDataToFile(e,o.format,o.dataType,t)}))},t.prototype.isVisualInSeeRecordsMode=function(e){return n.hasGroupByItems(e)},t.prototype.exportVisualDataFromPane=function(e){var t;1===e.formatType&&(t=this.services.drillToDetails.getDetailsTableTargetMeasures(e.exportVisualDataArgs.visualConfig)),this.exportVisualDataToFile(e.exportVisualDataArgs,e.formatType,e.exportDataType,t)},t.prototype.exportVisualDataToFile=function(t,i,o,r){var n,s=this.services.dataSources.get(),a=this.services,l=a.userInfo.isPremiumUser,c=a.telemetryService.startEvent(e.telemetry.EXExportVisualData,t.visualConfig.visualType,"Report",!1,i,l,this.isVisualInSeeRecordsMode(t.visualConfig.query),o),p=1===o;n=0===i?a.exportData.exportVisualDataToCsv(t.visualTitle,t.visualData,s,t.visualConfig,t.additionalFilters):a.exportData.exportVisualDataToExcel(t.visualTitle,s,t.visualConfig,t.additionalFilters,p,r,this.explorationContainer.reportId),n.then((function(e){c.event.info.isPartialResult=e.isPartialResult,c.resolve()}),(function(e){var t=e.errorDetails;c.reject({errorCode:t&&t.errorCode||t&&t.errorType.toString(),errorSource:t&&t.errorSource||"PowerBI"})})),this.services.auditing.auditEvent(this.explorationContainer.reportId,2,11)},t.prototype.showOptionsDialog=function(e){var t=this,i=[{name:this.services.localizationService.get("ModalDialog_ExportDataFormatXL"),action:function(){return 1===t.services.exportData.getExportDataToExcelUnsupportedType(e.visualConfig,t.explorationContainer.viewModel.datasetModel)?void new r(t.services.modalDialogService).show("ExlFormat_UnsupportedDatasetDialogTitle","ExlFormat_ToolTipDescription_AsOnPrem","https://go.microsoft.com/fwlink/?linkid=834313"):void t.exportVisualDataToFile(e,1,0)}},{name:this.services.localizationService.get("ModalDialog_ExportDataFormatCsv"),action:function(){t.exportVisualDataToFile(e,0,0)}}];this.services.optionsDialogBuilder.show(this.services.localizationService.get("ModalDialog_ExportDataTitle"),this.services.localizationService.get("ModalDialog_ExportDataText"),"exportDataDialog",i,this.services.localizationService.get("ModalDialogButtonText_Export"),this.services.localizationService.get("PBI_Button_Label_Cancel"))},t})()})(t=e.mixins||(e.mixins={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.explore.services.events,o=e.telemetry.ExplorationAppBarAction;t.FileOperationsAppBarMixinFactory={ng:["$scope","appService","auditing","featureSwitchService","licenseEnforcementService","permissionService","settingsService","telemetryService","modernDialogService","informationProtectionService","localizationService"],scoped:["eventBridge","bubblingEventBridge","explorationCapabilities","viewModeState"],fn:function(e){return new r(e)}};var r=(function(){function t(e){this.services=e}return t.prototype.update=function(e){this.explorationAppBar=e,this.setupExtensions()},t.prototype.setupExtensions=function(){var e=this;this.explorationAppBar.extensions.fileOperations={canPrintPage:function(){return e.canPrintPage()},printPage:function(){return e.printPage()},canSaveAs:function(){return e.canSaveAs()},saveAs:function(){return e.saveAs()},canEdit:function(){return e.canEdit()},edit:function(){return e.edit()},refresh:function(){return e.refresh()}}},t.prototype.canPrintPage=function(){return this.services.featureSwitchService.featureSwitches.printingEnabled&&!this.services.explorationCapabilities.getCapabilities().disablePrint},t.prototype.printPage=function(){return __awaiter(this,void 0,e.Promise,(function(){var t,i,o;return __generator(this,(function(r){switch(r.label){case 0:return t=this.explorationAppBar.viewModel,i=t.exploration&&t.exploration.contract&&t.exploration.contract.reportId,[4,this.promptConfirmationDialogIfNeeded(i)];case 1:return o=r.sent(),1===o&&(window.print(),this.services.telemetryService.logEvent(e.telemetry.DashboardAndReportsPrint,"Report"),this.services.auditing.auditEvent(i,2,18)),[2]}}))}))},t.prototype.canSaveAs=function(){return!this.services.explorationCapabilities.getCapabilities().disableSaveAs&&this.explorationAppBar.viewModel&&(this.explorationAppBar.viewModel.canEdit||this.canCopyAppReport())},t.prototype.saveAs=function(){var e=this.explorationAppBar.viewModel.options&&this.explorationAppBar.viewModel.options.isUsageMetricsReport,t={overrideSaveRouting:this.services.explorationCapabilities.getCapabilities().overrideSaveRouting,isUsageMetrics:e,source:0},o=this.explorationAppBar.viewModel;this.services.appService.getAppInstance(o.exploration&&o.exploration.contract&&o.exploration.contract.report&&o.exploration.contract.report.packageId)&&!this.services.licenseEnforcementService.supportsAppPersonalize(!0)||this.services.bubblingEventBridge.publishBubbling(this.services.$scope,i.saveAsExploration,t)},t.prototype.canEdit=function(){return!this.services.explorationCapabilities.getCapabilities().disableSwitchMode&&0===this.services.viewModeState.getMode()&&this.explorationAppBar.viewModel.canEdit&&!this.services.featureSwitchService.featureSwitches.editInDesktopEnabled},t.prototype.edit=function(){this.services.settingsService.setLockObjects(!1),this.services.eventBridge.publishToChannel(i.requestViewModeChange,1),this.services.telemetryService.logEvent(o,"EditInWebApp",!0)},t.prototype.refresh=function(){var t=this.explorationAppBar.viewModel;if(t.exploration&&t.exploration.contract){var o=t.exploration.contract;o.report&&this.services.telemetryService.logEvent(e.telemetry.EXRefreshReport,o.report.objectId,o.activeSectionIndex)}this.services.eventBridge.publishToChannel(i.refreshExploration)},t.prototype.canCopyAppReport=function(){var e=this.explorationAppBar.viewModel,t=e.exploration,i=t&&t.contract&&t.contract.report&&t.contract.report.packageId,o=this.services.appService.getAppInstance(i),r=o&&o.allowCopyContent,n=e.datasetModel&&this.services.permissionService.isExplorableModel(e.datasetModel);return this.services.featureSwitchService.featureSwitches.allowExploreDatasetOfApp&&r&&n},t.prototype.promptConfirmationDialogIfNeeded=function(t){return __awaiter(this,void 0,e.Promise,(function(){var i,o,r;return __generator(this,(function(n){switch(n.label){case 0:return o=this.services.featureSwitchService.featureSwitches.eimInformationProtectionUI&&this.services.featureSwitchService.featureSwitches.eimInformationProtectionViewEnabled,o?[4,this.services.informationProtectionService.isArtifactLabeled(e.common.contracts.ArtifactType.Report,t).toPromise()]:[3,2];case 1:o=n.sent(),n.label=2;case 2:return(i=o)?(r=this.services.localizationService,[2,this.services.modernDialogService.promptSimpleConfirmationDialog(r.get("EimInformationProtection_Report_Has_Sensitivity_Label"),r.get("EimInformationProtection_WarningDialog_PrintReport_Message"),r.get("ModalDialogButtonText_Continue"),_.noop,{panelClass:"sensitivityWarning"},{url:"https://aka.ms/dpfwl4",text:"Generic_LearnMore"})]):[2,e.Promise.resolve(1)]}}))}))},t})()})(t=e.mixins||(e.mixins={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){e.DropdownMenuMixinFactory={ng:["dropdown"],scoped:[],fn:function(e){return new t(e)}};var t=(function(){function e(e){this.services=e}return e.prototype.update=function(e){var t=this;e.extensions.dropdownMenu={showMenu:function(e,i,o,r,n,s){return t.showMenu(e,i,o,r,n,s)}}},e.prototype.showMenu=function(e,t,i,o,r,n){var s=this,a=this.services.dropdown,l=function(e,t){e(t),a.hideAll()},c=t.bind(this)($(e.currentTarget)),p={menuOverlayName:c.menuName,menuItemClass:c.menuItemClass,glyphSmall:c.glyphSmall,themeable:!0,menuActionSelected:function(e){return l(c.menuActionSelected.bind(s),e)},getMenuActions:function(){return c.menuActions},getMode:function(){return i},fluentThemeEnabled:o,onClose:n};a.showMenu(p,"appBarMenu.html",c.displayOptions,r)},e})()})(t=e.mixins||(e.mixins={}))})(powerbi||(powerbi={}));;"use strict";var powerbi;!(function(n){var o;!(function(n){var o;!(function(n){var o;!(function(n){n.initialize="initial",n.cancel="canceled",n.complete="complete"})(o=n.ScreenshotEngineActionsServiceOperationNames||(n.ScreenshotEngineActionsServiceOperationNames={}))})(o=n.constants||(n.constants={}))})(o=n.standaloneCommon||(n.standaloneCommon={}))})(powerbi||(powerbi={}));var powerbi;!(function(n){var o;!(function(n){function o(n){return new t(n)}var e=n.constants.ScreenshotEngineActionsServiceOperationNames;n.createScreenshotEngineCommunicator=o;var t=(function(){function n(n){this.hostService=n,this.initialize()}return n.prototype.initialize=function(){this.hostService.invokeAndForget(null,e.initialize)},n.prototype.cancel=function(){this.hostService.invokeAndForget(null,e.cancel)},n.prototype.complete=function(){this.hostService.invokeAndForget(null,e.complete)},n})()})(o=n.standaloneCommon||(n.standaloneCommon={}))})(powerbi||(powerbi={}));var powerbi;!(function(n){var o;!(function(o){var e=["powerbi.common"];angular.module("powerbi.standaloneCommon",e).factory("screenshotEngineCommunicator",["hostService",function(o){return n.standaloneCommon.createScreenshotEngineCommunicator(o)}])})(o=n.standaloneCommon||(n.standaloneCommon={}))})(powerbi||(powerbi={}));;"use strict";var __awaiter=this&&this.__awaiter||function(e,r,t,o){return new(t||(t=Promise))(function(i,a){function s(e){try{d(o.next(e))}catch(e){a(e)}}function n(e){try{d(o.throw(e))}catch(e){a(e)}}function d(e){e.done?i(e.value):new t(function(r){r(e.value)}).then(s,n)}d((o=o.apply(e,r||[])).next())})},__generator=this&&this.__generator||function(e,r){function t(e){return function(r){return o([e,r])}}function o(t){if(i)throw new TypeError("Generator is already executing.");for(;d;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return d.label++,{value:t[1],done:!1};case 5:d.label++,a=t[1],t=[0];continue;case 7:t=d.ops.pop(),d.trys.pop();continue;default:if(s=d.trys,!(s=s.length>0&&s[s.length-1])&&(6===t[0]||2===t[0])){d=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){d.label=t[1];break}if(6===t[0]&&d.label<s[1]){d.label=s[1],s=t;break}if(s&&d.label<s[2]){d.label=s[2],d.ops.push(t);break}s[2]&&d.ops.pop(),d.trys.pop();continue}t=r.call(e,d)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var i,a,s,n,d={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return n={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n},__decorate=this&&this.__decorate||function(e,r,t,o){var i,a=arguments.length,s=a<3?r:null===o?o=Object.getOwnPropertyDescriptor(r,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,r,t,o);else for(var n=e.length-1;n>=0;n--)(i=e[n])&&(s=(a<3?i(s):a>3?i(r,t,s):i(r,t))||s);return a>3&&s&&Object.defineProperty(r,t,s),s},powerbi;!(function(e){var r;!(function(r){function t(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f){var h=r.CustomerAction(s,n,d,l,c,p,u,m,v,y,g,b,E,f),S=Re(h.info,{reportId:t,embedType:o,embedUrl:i,referrer:a});return{name:r.EmbedCustomerActionEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({reportId:S.reportId,embedType:S.embedType,embedUrl:S.embedUrl,referrer:S.referrer},null,h.formatted())},info:S,loggers:r.EmbedCustomerActionLoggers}}function o(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f){var h=r.CustomerAction(s,n,d,l,c,p,u,m,v,y,g,b,E,f),S=Re(h.info,{datasetId:t,embedType:o,embedUrl:i,referrer:a});return{name:r.EmbedCustomerCreateActionEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({datasetId:S.datasetId,embedType:S.embedType,embedUrl:S.embedUrl,referrer:S.referrer},null,h.formatted())},info:S,loggers:r.EmbedCustomerCreateActionLoggers}}function i(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f){var h=r.CustomerAction(s,n,d,l,c,p,u,m,v,y,g,b,E,f),S=Re(h.info,{datasetId:t,embedType:o,embedUrl:i,referrer:a});return{name:r.EmbedCustomerQnaActionEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({datasetId:S.datasetId,embedType:S.embedType,embedUrl:S.embedUrl,referrer:S.referrer},null,h.formatted())},info:S,loggers:r.EmbedCustomerQnaActionLoggers}}function a(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f=r.CustomerAction(a,s,n,d,l,c,p,u,m,v,y,g,b,E),h=Re(f.info,{requestId:t,reportId:o,embedType:i});return{name:r.EmbedSDKCustomerActionEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:h.requestId,reportId:h.reportId,embedType:h.embedType},null,f.formatted())},info:h,loggers:r.EmbedSDKCustomerActionLoggers}}function s(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b){var E=r.CustomerAction(i,a,s,n,d,l,c,p,u,m,v,y,g,b),f=Re(E.info,{requestId:t,datasetId:o});return{name:r.EmbedSDKCustomerQnaActionEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,datasetId:f.datasetId},null,E.formatted())},info:f,loggers:r.EmbedSDKCustomerQnaActionLoggers}}function n(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h,S,C){var I={sdkSessionId:t,modelId:o,sdkVersion:i,datasetId:a,embedType:s,embedUrl:n,referrer:d,parentId:l,isError:c,errorSource:p,errorCode:u,activityName:m,activityId:v,isCancelled:y,pingLatency:g,errorMessage:b,folderId:E,activeFolderCapacityId:f,fluentUI:h,baseVersion:S,isFireAndForget:C};return{name:r.ReportEmbedCreateReportEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({sdkSessionId:I.sdkSessionId,modelId:I.modelId,sdkVersion:I.sdkVersion,datasetId:I.datasetId,embedType:I.embedType,embedUrl:I.embedUrl,referrer:I.referrer,parentId:I.parentId},{isError:I.isError,errorSource:I.errorSource,errorCode:I.errorCode,activityName:I.activityName,activityId:I.activityId,isCancelled:I.isCancelled,pingLatency:I.pingLatency,errorMessage:I.errorMessage,folderId:I.folderId,activeFolderCapacityId:I.activeFolderCapacityId,fluentUI:I.fluentUI,baseVersion:I.baseVersion,isFireAndForget:I.isFireAndForget})},info:I,loggers:r.ReportEmbedCreateReportLoggers}}function d(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h,S,C,I,F,R,T,D,P,A,M,V,w,N){var x={frontload:t,filtersCount:o,slicersCount:i,hasBookmark:a,hasPageName:s,isPhasedRender:n,viewMode:d,hasVisualSettings:l,hasODataFilters:c,sdkSessionId:p,modelId:u,capacityObjectId:m,datasetId:v,sdkVersion:y,reportId:g,embedType:b,embedUrl:E,referrer:f,parentId:h,isError:S,errorSource:C,errorCode:I,activityName:F,activityId:R,isCancelled:T,pingLatency:D,errorMessage:P,folderId:A,activeFolderCapacityId:M,fluentUI:V,baseVersion:w,isFireAndForget:N};return{name:r.ReportEmbedLoadEmbeddedReportEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({frontload:x.frontload,filtersCount:x.filtersCount,slicersCount:x.slicersCount,hasBookmark:x.hasBookmark,hasPageName:x.hasPageName,isPhasedRender:x.isPhasedRender,viewMode:x.viewMode,hasVisualSettings:x.hasVisualSettings,hasODataFilters:x.hasODataFilters,sdkSessionId:x.sdkSessionId,modelId:x.modelId,capacityObjectId:x.capacityObjectId,datasetId:x.datasetId,sdkVersion:x.sdkVersion,reportId:x.reportId,embedType:x.embedType,embedUrl:x.embedUrl,referrer:x.referrer,parentId:x.parentId},{isError:x.isError,errorSource:x.errorSource,errorCode:x.errorCode,activityName:x.activityName,activityId:x.activityId,isCancelled:x.isCancelled,pingLatency:x.pingLatency,errorMessage:x.errorMessage,folderId:x.folderId,activeFolderCapacityId:x.activeFolderCapacityId,fluentUI:x.fluentUI,baseVersion:x.baseVersion,isFireAndForget:x.isFireAndForget})},info:x,loggers:r.ReportEmbedLoadEmbeddedReportLoggers}}function l(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f){var h={reportId:t,embedType:o,embedUrl:i,referrer:a,parentId:s,isError:n,errorSource:d,errorCode:l,activityName:c,activityId:p,isCancelled:u,pingLatency:m,errorMessage:v,folderId:y,activeFolderCapacityId:g,fluentUI:b,baseVersion:E,isFireAndForget:f};return{name:r.ReportEmbedRetryLoadReportEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({reportId:h.reportId,embedType:h.embedType,embedUrl:h.embedUrl,referrer:h.referrer,parentId:h.parentId},{isError:h.isError,errorSource:h.errorSource,errorCode:h.errorCode,activityName:h.activityName,activityId:h.activityId,isCancelled:h.isCancelled,pingLatency:h.pingLatency,errorMessage:h.errorMessage,folderId:h.folderId,activeFolderCapacityId:h.activeFolderCapacityId,fluentUI:h.fluentUI,baseVersion:h.baseVersion,isFireAndForget:h.isFireAndForget})},info:h,loggers:r.ReportEmbedRetryLoadReportLoggers}}function c(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h){var S={isExplorationCopied:t,reportId:o,embedType:i,embedUrl:a,referrer:s,parentId:n,isError:d,errorSource:l,errorCode:c,activityName:p,activityId:u,isCancelled:m,pingLatency:v,errorMessage:y,folderId:g,activeFolderCapacityId:b,fluentUI:E,baseVersion:f,isFireAndForget:h};return{name:r.ReportEmbedExplorationDeepCopyEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({isExplorationCopied:S.isExplorationCopied,reportId:S.reportId,embedType:S.embedType,embedUrl:S.embedUrl,referrer:S.referrer,parentId:S.parentId},{isError:S.isError,errorSource:S.errorSource,errorCode:S.errorCode,activityName:S.activityName,activityId:S.activityId,isCancelled:S.isCancelled,pingLatency:S.pingLatency,errorMessage:S.errorMessage,folderId:S.folderId,activeFolderCapacityId:S.activeFolderCapacityId,fluentUI:S.fluentUI,baseVersion:S.baseVersion,isFireAndForget:S.isFireAndForget})},info:S,loggers:r.ReportEmbedExplorationDeepCopyLoggers}}function p(t){var o={message:t};return{name:r.ReportEmbedCapabilitiesServiceIsNullEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({message:o.message},null)},info:o,loggers:r.ReportEmbedCapabilitiesServiceIsNullLoggers}}function u(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h,S,C,I,F,R){var T={endPoint:t,clientAndServerRequestIdMatch:o,responseRequestId:i,IsResolvedDuringScriptLoad:a,frontLoadStart:s,frontLoadEnd:n,reportId:d,embedType:l,embedUrl:c,referrer:p,parentId:u,isError:m,errorSource:v,errorCode:y,activityName:g,activityId:b,isCancelled:E,pingLatency:f,errorMessage:h,folderId:S,activeFolderCapacityId:C,fluentUI:I,baseVersion:F,isFireAndForget:R};return{name:r.ReportEmbedGetExplorationAndModelEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({endPoint:T.endPoint,clientAndServerRequestIdMatch:T.clientAndServerRequestIdMatch,responseRequestId:T.responseRequestId,IsResolvedDuringScriptLoad:T.IsResolvedDuringScriptLoad,frontLoadStart:T.frontLoadStart,frontLoadEnd:T.frontLoadEnd,reportId:T.reportId,embedType:T.embedType,embedUrl:T.embedUrl,referrer:T.referrer,parentId:T.parentId},{isError:T.isError,errorSource:T.errorSource,errorCode:T.errorCode,activityName:T.activityName,activityId:T.activityId,isCancelled:T.isCancelled,pingLatency:T.pingLatency,errorMessage:T.errorMessage,folderId:T.folderId,activeFolderCapacityId:T.activeFolderCapacityId,fluentUI:T.fluentUI,baseVersion:T.baseVersion,isFireAndForget:T.isFireAndForget})},info:T,loggers:r.ReportEmbedGetExplorationAndModelLoggers}}function m(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h,S){var C=r.Verbose(d,l,c,p,u,m,v,y,g,b,E,f,h,S),I=Re(C.info,{endPoint:t,clientAndServerRequestIdMatch:o,responseRequestId:i,requestId:a,datasetIds:s,asErrorCode:n});return{name:r.ReportEmbedPrefetchConceptualSchemaEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({endPoint:I.endPoint,clientAndServerRequestIdMatch:I.clientAndServerRequestIdMatch,responseRequestId:I.responseRequestId,datasetIds:I.datasetIds,asErrorCode:I.asErrorCode},{requestId:I.requestId},C.formatted())},info:I,loggers:r.ReportEmbedPrefetchConceptualSchemaLoggers}}function v(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f){var h={reportId:t,embedType:o,embedUrl:i,referrer:a,parentId:s,isError:n,errorSource:d,errorCode:l,activityName:c,activityId:p,isCancelled:u,pingLatency:m,errorMessage:v,folderId:y,activeFolderCapacityId:g,fluentUI:b,baseVersion:E,isFireAndForget:f};return{name:r.ReportEmbedLoadingStartedEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({reportId:h.reportId,embedType:h.embedType,embedUrl:h.embedUrl,referrer:h.referrer,parentId:h.parentId},{isError:h.isError,errorSource:h.errorSource,errorCode:h.errorCode,activityName:h.activityName,activityId:h.activityId,isCancelled:h.isCancelled,pingLatency:h.pingLatency,errorMessage:h.errorMessage,folderId:h.folderId,activeFolderCapacityId:h.activeFolderCapacityId,fluentUI:h.fluentUI,baseVersion:h.baseVersion,isFireAndForget:h.isFireAndForget})},info:h,loggers:r.ReportEmbedLoadingStartedLoggers}}function y(t){var o={message:t};return{name:r.ReportEmbedLoadExplorationFailedEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({message:o.message},null)},info:o,loggers:r.ReportEmbedLoadExplorationFailedLoggers}}function g(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f){var h={reportId:t,embedType:o,embedUrl:i,referrer:a,parentId:s,isError:n,errorSource:d,errorCode:l,activityName:c,activityId:p,isCancelled:u,pingLatency:m,errorMessage:v,folderId:y,activeFolderCapacityId:g,fluentUI:b,baseVersion:E,isFireAndForget:f};return{name:r.ReportEmbedPageLoadedEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({reportId:h.reportId,embedType:h.embedType,embedUrl:h.embedUrl,referrer:h.referrer,parentId:h.parentId},{isError:h.isError,errorSource:h.errorSource,errorCode:h.errorCode,activityName:h.activityName,activityId:h.activityId,isCancelled:h.isCancelled,pingLatency:h.pingLatency,errorMessage:h.errorMessage,folderId:h.folderId,activeFolderCapacityId:h.activeFolderCapacityId,fluentUI:h.fluentUI,baseVersion:h.baseVersion,isFireAndForget:h.isFireAndForget})},info:h,loggers:r.ReportEmbedPageLoadedLoggers}}function b(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f){var h={reportId:t,embedType:o,embedUrl:i,referrer:a,parentId:s,isError:n,errorSource:d,errorCode:l,activityName:c,activityId:p,isCancelled:u,pingLatency:m,errorMessage:v,folderId:y,activeFolderCapacityId:g,fluentUI:b,baseVersion:E,isFireAndForget:f};return{name:r.ReportEmbedScriptLoadedEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({reportId:h.reportId,embedType:h.embedType,embedUrl:h.embedUrl,referrer:h.referrer,parentId:h.parentId},{isError:h.isError,errorSource:h.errorSource,errorCode:h.errorCode,activityName:h.activityName,activityId:h.activityId,isCancelled:h.isCancelled,pingLatency:h.pingLatency,errorMessage:h.errorMessage,folderId:h.folderId,activeFolderCapacityId:h.activeFolderCapacityId,fluentUI:h.fluentUI,baseVersion:h.baseVersion,isFireAndForget:h.isFireAndForget})},info:h,loggers:r.ReportEmbedScriptLoadedLoggers}}function E(t,o,i,a,s,n,d,l,c,p,u,m,v,y){var g=r.CustomerAction(t,o,i,a,s,n,d,l,c,p,u,m,v,y),b=Re(g.info,{});return{name:r.ReportEmbedEnterFullScreenEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted(null,null,g.formatted())},info:b,loggers:r.ReportEmbedEnterFullScreenLoggers}}function f(t){var o={message:t};return{name:r.ReportEmbedInvalidReportResourceKeyEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({message:o.message},null)},info:o,loggers:r.ReportEmbedInvalidReportResourceKeyLoggers}}function h(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f){void 0===o&&(o=void 0);var h=r.CustomerAction(s,n,d,l,c,p,u,m,v,y,g,b,E,f),S=Re(h.info,{IsResolvedDuringScriptLoad:t,backendUrl:o,frontLoadStart:i,frontLoadEnd:a});return{name:r.ReportEmbedClusterResolvedEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({IsResolvedDuringScriptLoad:S.IsResolvedDuringScriptLoad,frontLoadStart:S.frontLoadStart,frontLoadEnd:S.frontLoadEnd},{backendUrl:S.backendUrl},h.formatted())},info:S,loggers:r.ReportEmbedClusterResolvedLoggers}}function S(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f=r.CustomerAction(a,s,n,d,l,c,p,u,m,v,y,g,b,E),h=Re(f.info,{embedType:t,embedUrl:o,referrer:i});return{name:r.ReportEmbedSwitchPageEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({embedType:h.embedType,embedUrl:h.embedUrl,referrer:h.referrer},null,f.formatted())},info:h,loggers:r.ReportEmbedSwitchPageLoggers}}function C(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h){void 0===t&&(t=void 0);var S={platformUrl:t,reportId:o,embedType:i,embedUrl:a,referrer:s,parentId:n,isError:d,errorSource:l,errorCode:c,activityName:p,activityId:u,isCancelled:m,pingLatency:v,errorMessage:y,folderId:g,activeFolderCapacityId:b,fluentUI:E,baseVersion:f,isFireAndForget:h};return{name:r.ReportEmbedSocialSharingEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({reportId:S.reportId,embedType:S.embedType,embedUrl:S.embedUrl,referrer:S.referrer,parentId:S.parentId},{platformUrl:S.platformUrl,isError:S.isError,errorSource:S.errorSource,errorCode:S.errorCode,activityName:S.activityName,activityId:S.activityId,isCancelled:S.isCancelled,pingLatency:S.pingLatency,errorMessage:S.errorMessage,folderId:S.folderId,activeFolderCapacityId:S.activeFolderCapacityId,fluentUI:S.fluentUI,baseVersion:S.baseVersion,isFireAndForget:S.isFireAndForget})},info:S,loggers:r.ReportEmbedSocialSharingLoggers}}function I(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f){var h={reportId:t,embedType:o,embedUrl:i,referrer:a,parentId:s,isError:n,errorSource:d,errorCode:l,activityName:c,activityId:p,isCancelled:u,pingLatency:m,errorMessage:v,folderId:y,activeFolderCapacityId:g,fluentUI:b,baseVersion:E,isFireAndForget:f};return{name:r.ReportEmbedSaveExplorationEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({reportId:h.reportId,embedType:h.embedType,embedUrl:h.embedUrl,referrer:h.referrer,parentId:h.parentId},{isError:h.isError,errorSource:h.errorSource,errorCode:h.errorCode,activityName:h.activityName,activityId:h.activityId,isCancelled:h.isCancelled,pingLatency:h.pingLatency,errorMessage:h.errorMessage,folderId:h.folderId,activeFolderCapacityId:h.activeFolderCapacityId,fluentUI:h.fluentUI,baseVersion:h.baseVersion,isFireAndForget:h.isFireAndForget})},info:h,loggers:r.ReportEmbedSaveExplorationLoggers}}function F(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h){var S={customDialogUsed:t,reportId:o,embedType:i,embedUrl:a,referrer:s,parentId:n,isError:d,errorSource:l,errorCode:c,activityName:p,activityId:u,isCancelled:m,pingLatency:v,errorMessage:y,folderId:g,activeFolderCapacityId:b,fluentUI:E,baseVersion:f,isFireAndForget:h};return{name:r.ReportEmbedSaveAsExplorationEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({customDialogUsed:S.customDialogUsed,reportId:S.reportId,embedType:S.embedType,embedUrl:S.embedUrl,referrer:S.referrer,parentId:S.parentId},{isError:S.isError,errorSource:S.errorSource,errorCode:S.errorCode,activityName:S.activityName,activityId:S.activityId,isCancelled:S.isCancelled,pingLatency:S.pingLatency,errorMessage:S.errorMessage,folderId:S.folderId,activeFolderCapacityId:S.activeFolderCapacityId,fluentUI:S.fluentUI,baseVersion:S.baseVersion,isFireAndForget:S.isFireAndForget})},info:S,loggers:r.ReportEmbedSaveAsExplorationLoggers}}function R(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h,S,C){var I={qnaMode:t,sdkSessionId:o,sdkVersion:i,datasetId:a,embedType:s,embedUrl:n,referrer:d,parentId:l,isError:c,errorSource:p,errorCode:u,activityName:m,activityId:v,isCancelled:y,pingLatency:g,errorMessage:b,folderId:E,activeFolderCapacityId:f,fluentUI:h,baseVersion:S,isFireAndForget:C};return{name:r.QnaEmbedLoadQnaEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({qnaMode:I.qnaMode,sdkSessionId:I.sdkSessionId,sdkVersion:I.sdkVersion,datasetId:I.datasetId,embedType:I.embedType,embedUrl:I.embedUrl,referrer:I.referrer,parentId:I.parentId},{isError:I.isError,errorSource:I.errorSource,errorCode:I.errorCode,activityName:I.activityName,activityId:I.activityId,isCancelled:I.isCancelled,pingLatency:I.pingLatency,errorMessage:I.errorMessage,folderId:I.folderId,activeFolderCapacityId:I.activeFolderCapacityId,fluentUI:I.fluentUI,baseVersion:I.baseVersion,isFireAndForget:I.isFireAndForget})},info:I,loggers:r.QnaEmbedLoadQnaLoggers}}function T(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h){var S={hashedUtterance:t,datasetId:o,embedType:i,embedUrl:a,referrer:s,parentId:n,isError:d,errorSource:l,errorCode:c,activityName:p,activityId:u,isCancelled:m,pingLatency:v,errorMessage:y,folderId:g,activeFolderCapacityId:b,fluentUI:E,baseVersion:f,isFireAndForget:h};return{name:r.QnaEmbedInterpretUtteranceEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({hashedUtterance:S.hashedUtterance,datasetId:S.datasetId,embedType:S.embedType,embedUrl:S.embedUrl,referrer:S.referrer,parentId:S.parentId},{isError:S.isError,errorSource:S.errorSource,errorCode:S.errorCode,activityName:S.activityName,activityId:S.activityId,isCancelled:S.isCancelled,pingLatency:S.pingLatency,errorMessage:S.errorMessage,folderId:S.folderId,activeFolderCapacityId:S.activeFolderCapacityId,fluentUI:S.fluentUI,baseVersion:S.baseVersion,isFireAndForget:S.isFireAndForget})},info:S,loggers:r.QnaEmbedInterpretUtteranceLoggers}}function D(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKPrepareReportEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKPrepareReportLoggers}}function P(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKRenderReportEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKRenderReportLoggers}}function A(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKLoadReportEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKLoadReportLoggers}}function M(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKSetActivePageEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKSetActivePageLoggers}}function V(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKGetAllPagesEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKGetAllPagesLoggers}}function w(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKGetAvailableDisplayAreaEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKGetAvailableDisplayAreaLoggers}}function N(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKGetAllVisualsEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKGetAllVisualsLoggers}}function x(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h){var S={visualType:t,errorCode1:o,requestId:i,reportId:a,embedType:s,parentId:n,isError:d,errorSource:l,errorCode:c,activityName:p,activityId:u,isCancelled:m,pingLatency:v,errorMessage:y,folderId:g,activeFolderCapacityId:b,fluentUI:E,baseVersion:f,isFireAndForget:h};return{name:r.EmbedVisualApiEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({visualType:S.visualType,errorCode1:S.errorCode1,requestId:S.requestId,reportId:S.reportId,embedType:S.embedType,parentId:S.parentId},{isError:S.isError,errorSource:S.errorSource,errorCode:S.errorCode,activityName:S.activityName,activityId:S.activityId,isCancelled:S.isCancelled,pingLatency:S.pingLatency,errorMessage:S.errorMessage,folderId:S.folderId,activeFolderCapacityId:S.activeFolderCapacityId,fluentUI:S.fluentUI,baseVersion:S.baseVersion,isFireAndForget:S.isFireAndForget})},info:S,loggers:r.EmbedVisualApiLoggers}}function L(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h,S){var C={hasLayout:t,visualType:o,errorCode1:i,requestId:a,reportId:s,embedType:n,parentId:d,isError:l,errorSource:c,errorCode:p,activityName:u,activityId:m,isCancelled:v,pingLatency:y,errorMessage:g,folderId:b,activeFolderCapacityId:E,fluentUI:f,baseVersion:h,isFireAndForget:S};return{name:r.ReportEmbedSDKCreateVisualEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({hasLayout:C.hasLayout,visualType:C.visualType,errorCode1:C.errorCode1,requestId:C.requestId,reportId:C.reportId,embedType:C.embedType,parentId:C.parentId},{isError:C.isError,errorSource:C.errorSource,errorCode:C.errorCode,activityName:C.activityName,activityId:C.activityId,isCancelled:C.isCancelled,pingLatency:C.pingLatency,errorMessage:C.errorMessage,folderId:C.folderId,activeFolderCapacityId:C.activeFolderCapacityId,fluentUI:C.fluentUI,baseVersion:C.baseVersion,isFireAndForget:C.isFireAndForget})},info:C,loggers:r.ReportEmbedSDKCreateVisualLoggers}}function k(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h){var S={visualType:t,errorCode1:o,requestId:i,reportId:a,embedType:s,parentId:n,isError:d,errorSource:l,errorCode:c,activityName:p,activityId:u,isCancelled:m,pingLatency:v,errorMessage:y,folderId:g,activeFolderCapacityId:b,fluentUI:E,baseVersion:f,isFireAndForget:h};return{name:r.ReportEmbedSDKDeleteVisualEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({visualType:S.visualType,errorCode1:S.errorCode1,requestId:S.requestId,reportId:S.reportId,embedType:S.embedType,parentId:S.parentId},{isError:S.isError,errorSource:S.errorSource,errorCode:S.errorCode,activityName:S.activityName,activityId:S.activityId,isCancelled:S.isCancelled,pingLatency:S.pingLatency,errorMessage:S.errorMessage,folderId:S.folderId,activeFolderCapacityId:S.activeFolderCapacityId,fluentUI:S.fluentUI,baseVersion:S.baseVersion,isFireAndForget:S.isFireAndForget})},info:S,loggers:r.ReportEmbedSDKDeleteVisualLoggers}}function K(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h,S){var C={newVisualType:t,visualType:o,errorCode1:i,requestId:a,reportId:s,embedType:n,parentId:d,isError:l,errorSource:c,errorCode:p,activityName:u,activityId:m,isCancelled:v,pingLatency:y,errorMessage:g,folderId:b,activeFolderCapacityId:E,fluentUI:f,baseVersion:h,isFireAndForget:S};return{name:r.ReportEmbedSDKChangeVisualTypeEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({newVisualType:C.newVisualType,visualType:C.visualType,errorCode1:C.errorCode1,requestId:C.requestId,reportId:C.reportId,embedType:C.embedType,parentId:C.parentId},{isError:C.isError,errorSource:C.errorSource,errorCode:C.errorCode,activityName:C.activityName,activityId:C.activityId,isCancelled:C.isCancelled,pingLatency:C.pingLatency,errorMessage:C.errorMessage,folderId:C.folderId,activeFolderCapacityId:C.activeFolderCapacityId,fluentUI:C.fluentUI,baseVersion:C.baseVersion,isFireAndForget:C.isFireAndForget})},info:C,loggers:r.ReportEmbedSDKChangeVisualTypeLoggers}}function B(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h){var S={visualType:t,errorCode1:o,requestId:i,reportId:a,embedType:s,parentId:n,isError:d,errorSource:l,errorCode:c,activityName:p,activityId:u,isCancelled:m,pingLatency:v,errorMessage:y,folderId:g,activeFolderCapacityId:b,
fluentUI:E,baseVersion:f,isFireAndForget:h};return{name:r.ReportEmbedSDKCloneVisualEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({visualType:S.visualType,errorCode1:S.errorCode1,requestId:S.requestId,reportId:S.reportId,embedType:S.embedType,parentId:S.parentId},{isError:S.isError,errorSource:S.errorSource,errorCode:S.errorCode,activityName:S.activityName,activityId:S.activityId,isCancelled:S.isCancelled,pingLatency:S.pingLatency,errorMessage:S.errorMessage,folderId:S.folderId,activeFolderCapacityId:S.activeFolderCapacityId,fluentUI:S.fluentUI,baseVersion:S.baseVersion,isFireAndForget:S.isFireAndForget})},info:S,loggers:r.ReportEmbedSDKCloneVisualLoggers}}function _(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h){var S={visualType:t,errorCode1:o,requestId:i,reportId:a,embedType:s,parentId:n,isError:d,errorSource:l,errorCode:c,activityName:p,activityId:u,isCancelled:m,pingLatency:v,errorMessage:y,folderId:g,activeFolderCapacityId:b,fluentUI:E,baseVersion:f,isFireAndForget:h};return{name:r.ReportEmbedSDKSortVisualEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({visualType:S.visualType,errorCode1:S.errorCode1,requestId:S.requestId,reportId:S.reportId,embedType:S.embedType,parentId:S.parentId},{isError:S.isError,errorSource:S.errorSource,errorCode:S.errorCode,activityName:S.activityName,activityId:S.activityId,isCancelled:S.isCancelled,pingLatency:S.pingLatency,errorMessage:S.errorMessage,folderId:S.folderId,activeFolderCapacityId:S.activeFolderCapacityId,fluentUI:S.fluentUI,baseVersion:S.baseVersion,isFireAndForget:S.isFireAndForget})},info:S,loggers:r.ReportEmbedSDKSortVisualLoggers}}function U(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h,S){var C={fieldType:t,visualType:o,errorCode1:i,requestId:a,reportId:s,embedType:n,parentId:d,isError:l,errorSource:c,errorCode:p,activityName:u,activityId:m,isCancelled:v,pingLatency:y,errorMessage:g,folderId:b,activeFolderCapacityId:E,fluentUI:f,baseVersion:h,isFireAndForget:S};return{name:r.ReportEmbedSDKAddDataRoleFieldEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({fieldType:C.fieldType,visualType:C.visualType,errorCode1:C.errorCode1,requestId:C.requestId,reportId:C.reportId,embedType:C.embedType,parentId:C.parentId},{isError:C.isError,errorSource:C.errorSource,errorCode:C.errorCode,activityName:C.activityName,activityId:C.activityId,isCancelled:C.isCancelled,pingLatency:C.pingLatency,errorMessage:C.errorMessage,folderId:C.folderId,activeFolderCapacityId:C.activeFolderCapacityId,fluentUI:C.fluentUI,baseVersion:C.baseVersion,isFireAndForget:C.isFireAndForget})},info:C,loggers:r.ReportEmbedSDKAddDataRoleFieldLoggers}}function q(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h,S){var C={fieldType:t,visualType:o,errorCode1:i,requestId:a,reportId:s,embedType:n,parentId:d,isError:l,errorSource:c,errorCode:p,activityName:u,activityId:m,isCancelled:v,pingLatency:y,errorMessage:g,folderId:b,activeFolderCapacityId:E,fluentUI:f,baseVersion:h,isFireAndForget:S};return{name:r.ReportEmbedSDKDeleteDataRoleFieldEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({fieldType:C.fieldType,visualType:C.visualType,errorCode1:C.errorCode1,requestId:C.requestId,reportId:C.reportId,embedType:C.embedType,parentId:C.parentId},{isError:C.isError,errorSource:C.errorSource,errorCode:C.errorCode,activityName:C.activityName,activityId:C.activityId,isCancelled:C.isCancelled,pingLatency:C.pingLatency,errorMessage:C.errorMessage,folderId:C.folderId,activeFolderCapacityId:C.activeFolderCapacityId,fluentUI:C.fluentUI,baseVersion:C.baseVersion,isFireAndForget:C.isFireAndForget})},info:C,loggers:r.ReportEmbedSDKDeleteDataRoleFieldLoggers}}function O(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h){var S={visualType:t,errorCode1:o,requestId:i,reportId:a,embedType:s,parentId:n,isError:d,errorSource:l,errorCode:c,activityName:p,activityId:u,isCancelled:m,pingLatency:v,errorMessage:y,folderId:g,activeFolderCapacityId:b,fluentUI:E,baseVersion:f,isFireAndForget:h};return{name:r.ReportEmbedSDKGetDataRoleFieldsEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({visualType:S.visualType,errorCode1:S.errorCode1,requestId:S.requestId,reportId:S.reportId,embedType:S.embedType,parentId:S.parentId},{isError:S.isError,errorSource:S.errorSource,errorCode:S.errorCode,activityName:S.activityName,activityId:S.activityId,isCancelled:S.isCancelled,pingLatency:S.pingLatency,errorMessage:S.errorMessage,folderId:S.folderId,activeFolderCapacityId:S.activeFolderCapacityId,fluentUI:S.fluentUI,baseVersion:S.baseVersion,isFireAndForget:S.isFireAndForget})},info:S,loggers:r.ReportEmbedSDKGetDataRoleFieldsLoggers}}function H(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h){var S={visualType:t,errorCode1:o,requestId:i,reportId:a,embedType:s,parentId:n,isError:d,errorSource:l,errorCode:c,activityName:p,activityId:u,isCancelled:m,pingLatency:v,errorMessage:y,folderId:g,activeFolderCapacityId:b,fluentUI:E,baseVersion:f,isFireAndForget:h};return{name:r.ReportEmbedSDKGetVisualCapabilitiesEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({visualType:S.visualType,errorCode1:S.errorCode1,requestId:S.requestId,reportId:S.reportId,embedType:S.embedType,parentId:S.parentId},{isError:S.isError,errorSource:S.errorSource,errorCode:S.errorCode,activityName:S.activityName,activityId:S.activityId,isCancelled:S.isCancelled,pingLatency:S.pingLatency,errorMessage:S.errorMessage,folderId:S.folderId,activeFolderCapacityId:S.activeFolderCapacityId,fluentUI:S.fluentUI,baseVersion:S.baseVersion,isFireAndForget:S.isFireAndForget})},info:S,loggers:r.ReportEmbedSDKGetVisualCapabilitiesLoggers}}function j(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h){var S={visualType:t,errorCode1:o,requestId:i,reportId:a,embedType:s,parentId:n,isError:d,errorSource:l,errorCode:c,activityName:p,activityId:u,isCancelled:m,pingLatency:v,errorMessage:y,folderId:g,activeFolderCapacityId:b,fluentUI:E,baseVersion:f,isFireAndForget:h};return{name:r.ReportEmbedSDKGetVisualPropertyEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({visualType:S.visualType,errorCode1:S.errorCode1,requestId:S.requestId,reportId:S.reportId,embedType:S.embedType,parentId:S.parentId},{isError:S.isError,errorSource:S.errorSource,errorCode:S.errorCode,activityName:S.activityName,activityId:S.activityId,isCancelled:S.isCancelled,pingLatency:S.pingLatency,errorMessage:S.errorMessage,folderId:S.folderId,activeFolderCapacityId:S.activeFolderCapacityId,fluentUI:S.fluentUI,baseVersion:S.baseVersion,isFireAndForget:S.isFireAndForget})},info:S,loggers:r.ReportEmbedSDKGetVisualPropertyLoggers}}function G(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h){var S={visualType:t,errorCode1:o,requestId:i,reportId:a,embedType:s,parentId:n,isError:d,errorSource:l,errorCode:c,activityName:p,activityId:u,isCancelled:m,pingLatency:v,errorMessage:y,folderId:g,activeFolderCapacityId:b,fluentUI:E,baseVersion:f,isFireAndForget:h};return{name:r.ReportEmbedSDKPutVisualPropertyEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({visualType:S.visualType,errorCode1:S.errorCode1,requestId:S.requestId,reportId:S.reportId,embedType:S.embedType,parentId:S.parentId},{isError:S.isError,errorSource:S.errorSource,errorCode:S.errorCode,activityName:S.activityName,activityId:S.activityId,isCancelled:S.isCancelled,pingLatency:S.pingLatency,errorMessage:S.errorMessage,folderId:S.folderId,activeFolderCapacityId:S.activeFolderCapacityId,fluentUI:S.fluentUI,baseVersion:S.baseVersion,isFireAndForget:S.isFireAndForget})},info:S,loggers:r.ReportEmbedSDKPutVisualPropertyLoggers}}function z(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f){var h={partial:t,requestId:o,reportId:i,embedType:a,parentId:s,isError:n,errorSource:d,errorCode:l,activityName:c,activityId:p,isCancelled:u,pingLatency:m,errorMessage:v,folderId:y,activeFolderCapacityId:g,fluentUI:b,baseVersion:E,isFireAndForget:f};return{name:r.ReportEmbedSDKExportDataEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({partial:h.partial,requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:h.errorSource,errorCode:h.errorCode,activityName:h.activityName,activityId:h.activityId,isCancelled:h.isCancelled,pingLatency:h.pingLatency,errorMessage:h.errorMessage,folderId:h.folderId,activeFolderCapacityId:h.activeFolderCapacityId,fluentUI:h.fluentUI,baseVersion:h.baseVersion,isFireAndForget:h.isFireAndForget})},info:h,loggers:r.ReportEmbedSDKExportDataLoggers}}function W(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKSetReportLevelFiltersEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKSetReportLevelFiltersLoggers}}function Q(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKGetReportLevelFiltersEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKGetReportLevelFiltersLoggers}}function J(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKGetBookmarksEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKGetBookmarksLoggers}}function $(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKApplyBookmarkByNameEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKApplyBookmarkByNameLoggers}}function X(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKApplyBookmarkStateEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKApplyBookmarkStateLoggers}}function Z(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKAddBookmarkEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKAddBookmarkLoggers}}function Y(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKCaptureBookmarkEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKCaptureBookmarkLoggers}}function ee(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f){var h={playMode:t,requestId:o,reportId:i,embedType:a,parentId:s,isError:n,errorSource:d,errorCode:l,activityName:c,activityId:p,isCancelled:u,pingLatency:m,errorMessage:v,folderId:y,activeFolderCapacityId:g,fluentUI:b,baseVersion:E,isFireAndForget:f};return{name:r.ReportEmbedSDKPlayBookmarksEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({playMode:h.playMode,requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:h.errorSource,errorCode:h.errorCode,activityName:h.activityName,activityId:h.activityId,isCancelled:h.isCancelled,pingLatency:h.pingLatency,errorMessage:h.errorMessage,folderId:h.folderId,activeFolderCapacityId:h.activeFolderCapacityId,fluentUI:h.fluentUI,baseVersion:h.baseVersion,isFireAndForget:h.isFireAndForget})},info:h,loggers:r.ReportEmbedSDKPlayBookmarksLoggers}}function re(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKSetPageLevelFiltersEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKSetPageLevelFiltersLoggers}}function te(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKGetPageLevelFiltersEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKGetPageLevelFiltersLoggers}}function oe(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKSetVisualLevelFiltersEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKSetVisualLevelFiltersLoggers}}function ie(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKGetVisualLevelFiltersEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKGetVisualLevelFiltersLoggers}}function ae(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKBookmarkAppliedEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKBookmarkAppliedLoggers}}function se(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h){var S={pageSizeType:t,displayOption:o,requestId:i,reportId:a,embedType:s,parentId:n,isError:d,errorSource:l,errorCode:c,activityName:p,activityId:u,isCancelled:m,pingLatency:v,errorMessage:y,folderId:g,activeFolderCapacityId:b,fluentUI:E,baseVersion:f,isFireAndForget:h};return{name:r.ReportEmbedSDKCustomLayoutEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({pageSizeType:S.pageSizeType,displayOption:S.displayOption,requestId:S.requestId,reportId:S.reportId,embedType:S.embedType,parentId:S.parentId},{isError:S.isError,errorSource:S.errorSource,errorCode:S.errorCode,activityName:S.activityName,activityId:S.activityId,isCancelled:S.isCancelled,pingLatency:S.pingLatency,errorMessage:S.errorMessage,folderId:S.folderId,activeFolderCapacityId:S.activeFolderCapacityId,fluentUI:S.fluentUI,baseVersion:S.baseVersion,isFireAndForget:S.isFireAndForget})},info:S,loggers:r.ReportEmbedSDKCustomLayoutLoggers}}function ne(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKChangeViewModeEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKChangeViewModeLoggers}}function de(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKSaveExplorationEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKSaveExplorationLoggers}}function le(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E){var f={requestId:t,reportId:o,embedType:i,parentId:a,isError:s,errorSource:n,errorCode:d,activityName:l,activityId:c,isCancelled:p,pingLatency:u,errorMessage:m,folderId:v,activeFolderCapacityId:y,fluentUI:g,baseVersion:b,isFireAndForget:E};return{name:r.ReportEmbedSDKSaveAsExplorationEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:f.requestId,reportId:f.reportId,embedType:f.embedType,parentId:f.parentId},{isError:f.isError,errorSource:f.errorSource,errorCode:f.errorCode,activityName:f.activityName,activityId:f.activityId,isCancelled:f.isCancelled,pingLatency:f.pingLatency,errorMessage:f.errorMessage,folderId:f.folderId,activeFolderCapacityId:f.activeFolderCapacityId,fluentUI:f.fluentUI,baseVersion:f.baseVersion,isFireAndForget:f.isFireAndForget})},info:f,loggers:r.ReportEmbedSDKSaveAsExplorationLoggers}}function ce(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b){var E={requestId:t,datasetId:o,parentId:i,isError:a,errorSource:s,errorCode:n,activityName:d,activityId:l,isCancelled:c,pingLatency:p,errorMessage:u,folderId:m,activeFolderCapacityId:v,fluentUI:y,baseVersion:g,isFireAndForget:b};return{name:r.QnaEmbedSDKLoadQnaEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:E.requestId,datasetId:E.datasetId,parentId:E.parentId},{isError:E.isError,errorSource:E.errorSource,errorCode:E.errorCode,activityName:E.activityName,activityId:E.activityId,isCancelled:E.isCancelled,pingLatency:E.pingLatency,errorMessage:E.errorMessage,folderId:E.folderId,activeFolderCapacityId:E.activeFolderCapacityId,fluentUI:E.fluentUI,baseVersion:E.baseVersion,isFireAndForget:E.isFireAndForget})},info:E,loggers:r.QnaEmbedSDKLoadQnaLoggers}}function pe(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b){var E={requestId:t,datasetId:o,parentId:i,isError:a,errorSource:s,errorCode:n,activityName:d,activityId:l,isCancelled:c,pingLatency:p,errorMessage:u,folderId:m,activeFolderCapacityId:v,fluentUI:y,baseVersion:g,isFireAndForget:b};return{name:r.QnaEmbedSDKInterpretUtteranceEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:E.requestId,datasetId:E.datasetId,parentId:E.parentId},{isError:E.isError,errorSource:E.errorSource,errorCode:E.errorCode,activityName:E.activityName,activityId:E.activityId,isCancelled:E.isCancelled,pingLatency:E.pingLatency,errorMessage:E.errorMessage,folderId:E.folderId,activeFolderCapacityId:E.activeFolderCapacityId,fluentUI:E.fluentUI,baseVersion:E.baseVersion,isFireAndForget:E.isFireAndForget})},info:E,loggers:r.QnaEmbedSDKInterpretUtteranceLoggers}}function ue(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f){var h={filterType:t,requestId:o,reportId:i,embedType:a,parentId:s,isError:n,errorSource:d,errorCode:l,activityName:c,activityId:p,isCancelled:u,pingLatency:m,errorMessage:v,folderId:y,activeFolderCapacityId:g,fluentUI:b,baseVersion:E,isFireAndForget:f};return{name:r.ReportEmbedSDKUnsupportedFilterTypeEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({filterType:h.filterType,requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:h.errorSource,errorCode:h.errorCode,activityName:h.activityName,activityId:h.activityId,isCancelled:h.isCancelled,pingLatency:h.pingLatency,errorMessage:h.errorMessage,folderId:h.folderId,activeFolderCapacityId:h.activeFolderCapacityId,fluentUI:h.fluentUI,baseVersion:h.baseVersion,isFireAndForget:h.isFireAndForget})},info:h,loggers:r.ReportEmbedSDKUnsupportedFilterTypeLoggers}}function me(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g){var b=r.Verbose(o,i,a,s,n,d,l,c,p,u,m,v,y,g),E=Re(b.info,{layout:t});return{name:r.ReportEmbedSDKLoadedWithLayoutTypeEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({layout:E.layout},null,b.formatted())},info:E,loggers:r.ReportEmbedSDKLoadedWithLayoutTypeLoggers}}function ve(t,o,i,a){var s={requestId:t,reportId:o,embedType:i,message:a};return{name:r.ReportEmbedSDKErrorEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:s.requestId,reportId:s.reportId,embedType:s.embedType,message:s.message},null)},info:s,loggers:r.ReportEmbedSDKErrorLoggers}}function ye(t,o,i,a,s,n){var d={reportId:t,embedType:o,errorCode:i,detailedMessage:a,technicalDetails:s,message:n};return{name:r.ReportEmbedSDKReportedErrorEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({reportId:d.reportId,embedType:d.embedType,errorCode:d.errorCode,detailedMessage:d.detailedMessage,technicalDetails:d.technicalDetails,message:d.message},null)},info:d,loggers:r.ReportEmbedSDKReportedErrorLoggers}}function ge(t,o,i){var a={requestId:t,datasetId:o,message:i};return{name:r.QnaEmbedSDKErrorEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({requestId:a.requestId,datasetId:a.datasetId,message:a.message},null)},info:a,loggers:r.QnaEmbedSDKErrorLoggers}}function be(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h,S){var C={hasAccess:t,modelsAndExplorationSucceed:o,reportId:i,embedType:a,embedUrl:s,referrer:n,parentId:d,isError:l,errorSource:c,errorCode:p,activityName:u,activityId:m,isCancelled:v,pingLatency:y,errorMessage:g,folderId:b,activeFolderCapacityId:E,fluentUI:f,baseVersion:h,isFireAndForget:S};return{name:r.ReportEmbedPushAccessEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({hasAccess:C.hasAccess,modelsAndExplorationSucceed:C.modelsAndExplorationSucceed,reportId:C.reportId,embedType:C.embedType,embedUrl:C.embedUrl,referrer:C.referrer,parentId:C.parentId},{isError:C.isError,errorSource:C.errorSource,errorCode:C.errorCode,activityName:C.activityName,activityId:C.activityId,isCancelled:C.isCancelled,pingLatency:C.pingLatency,errorMessage:C.errorMessage,folderId:C.folderId,activeFolderCapacityId:C.activeFolderCapacityId,fluentUI:C.fluentUI,baseVersion:C.baseVersion,isFireAndForget:C.isFireAndForget})},info:C,loggers:r.ReportEmbedPushAccessLoggers}}function Ee(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h,S){var C={isSuccess:t,isOnLoad:o,message:i,requestId:a,reportId:s,embedType:n,parentId:d,isError:l,errorSource:c,errorCode:p,activityName:u,activityId:m,isCancelled:v,pingLatency:y,errorMessage:g,folderId:b,activeFolderCapacityId:E,fluentUI:f,baseVersion:h,isFireAndForget:S};return{name:r.ReportEmbedSDKSetCustomThemeEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({isSuccess:C.isSuccess,isOnLoad:C.isOnLoad,message:C.message,requestId:C.requestId,reportId:C.reportId,embedType:C.embedType,parentId:C.parentId},{isError:C.isError,errorSource:C.errorSource,errorCode:C.errorCode,activityName:C.activityName,activityId:C.activityId,isCancelled:C.isCancelled,pingLatency:C.pingLatency,errorMessage:C.errorMessage,folderId:C.folderId,activeFolderCapacityId:C.activeFolderCapacityId,fluentUI:C.fluentUI,baseVersion:C.baseVersion,isFireAndForget:C.isFireAndForget})},info:C,loggers:r.ReportEmbedSDKSetCustomThemeLoggers}}function fe(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f){var h={reportId:t,embedType:o,embedUrl:i,referrer:a,parentId:s,isError:n,errorSource:d,errorCode:l,activityName:c,activityId:p,isCancelled:u,pingLatency:m,errorMessage:v,folderId:y,activeFolderCapacityId:g,fluentUI:b,baseVersion:E,isFireAndForget:f};return{name:r.ReportEmbedCommandsSettingsEventName,
category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({reportId:h.reportId,embedType:h.embedType,embedUrl:h.embedUrl,referrer:h.referrer,parentId:h.parentId},{isError:h.isError,errorSource:h.errorSource,errorCode:h.errorCode,activityName:h.activityName,activityId:h.activityId,isCancelled:h.isCancelled,pingLatency:h.pingLatency,errorMessage:h.errorMessage,folderId:h.folderId,activeFolderCapacityId:h.activeFolderCapacityId,fluentUI:h.fluentUI,baseVersion:h.baseVersion,isFireAndForget:h.isFireAndForget})},info:h,loggers:r.ReportEmbedCommandsSettingsLoggers}}function he(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h,S){var C={showSignIn:t,showRequestAccess:o,reportId:i,embedType:a,embedUrl:s,referrer:n,parentId:d,isError:l,errorSource:c,errorCode:p,activityName:u,activityId:m,isCancelled:v,pingLatency:y,errorMessage:g,folderId:b,activeFolderCapacityId:E,fluentUI:f,baseVersion:h,isFireAndForget:S};return{name:r.ReportEmbedSecurePublishToWebEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({showSignIn:C.showSignIn,showRequestAccess:C.showRequestAccess,reportId:C.reportId,embedType:C.embedType,embedUrl:C.embedUrl,referrer:C.referrer,parentId:C.parentId},{isError:C.isError,errorSource:C.errorSource,errorCode:C.errorCode,activityName:C.activityName,activityId:C.activityId,isCancelled:C.isCancelled,pingLatency:C.pingLatency,errorMessage:C.errorMessage,folderId:C.folderId,activeFolderCapacityId:C.activeFolderCapacityId,fluentUI:C.fluentUI,baseVersion:C.baseVersion,isFireAndForget:C.isFireAndForget})},info:C,loggers:r.ReportEmbedSecurePublishToWebLoggers}}function Se(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f){var h={throttled:t,requestId:o,reportId:i,embedType:a,parentId:s,isError:n,errorSource:d,errorCode:l,activityName:c,activityId:p,isCancelled:u,pingLatency:m,errorMessage:v,folderId:y,activeFolderCapacityId:g,fluentUI:b,baseVersion:E,isFireAndForget:f};return{name:r.ReportEmbedSDKRefreshReportEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({throttled:h.throttled,requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:h.errorSource,errorCode:h.errorCode,activityName:h.activityName,activityId:h.activityId,isCancelled:h.isCancelled,pingLatency:h.pingLatency,errorMessage:h.errorMessage,folderId:h.folderId,activeFolderCapacityId:h.activeFolderCapacityId,fluentUI:h.fluentUI,baseVersion:h.baseVersion,isFireAndForget:h.isFireAndForget})},info:h,loggers:r.ReportEmbedSDKRefreshReportLoggers}}function Ce(t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h,S,C,I){var F={bookmarksChanged:t,filtersChanged:o,slicersChanged:i,viewModeChanged:a,pageNameChanged:s,requestId:n,reportId:d,embedType:l,parentId:c,isError:p,errorSource:u,errorCode:m,activityName:v,activityId:y,isCancelled:g,pingLatency:b,errorMessage:E,folderId:f,activeFolderCapacityId:h,fluentUI:S,baseVersion:C,isFireAndForget:I};return{name:r.ReportEmbedPhasedRenderConfigChangedEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:Ie(),formatted:function(){return e.extendFormatted({bookmarksChanged:F.bookmarksChanged,filtersChanged:F.filtersChanged,slicersChanged:F.slicersChanged,viewModeChanged:F.viewModeChanged,pageNameChanged:F.pageNameChanged,requestId:F.requestId,reportId:F.reportId,embedType:F.embedType,parentId:F.parentId},{isError:F.isError,errorSource:F.errorSource,errorCode:F.errorCode,activityName:F.activityName,activityId:F.activityId,isCancelled:F.isCancelled,pingLatency:F.pingLatency,errorMessage:F.errorMessage,folderId:F.folderId,activeFolderCapacityId:F.activeFolderCapacityId,fluentUI:F.fluentUI,baseVersion:F.baseVersion,isFireAndForget:F.isFireAndForget})},info:F,loggers:r.ReportEmbedPhasedRenderConfigChangedLoggers}}var Ie,Fe=jsCommon.Utility,Re=jsCommon.UnionExtensions.mergeUnionType,Te=e.telemetry.EventFactories;Ie=Fe?Fe.generateGuid:Function.prototype,r.EmbedCustomerActionEventName="EmbedCustomerAction",r.EmbedCustomerAction=t,Te[r.EmbedCustomerActionEventName]=function(t){return e.telemetryEventFactory(r.EmbedCustomerActionEventName,t,r.EmbedCustomerActionLoggers,r.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},r.EmbedCustomerCreateActionEventName="EmbedCustomerCreateAction",r.EmbedCustomerCreateAction=o,Te[r.EmbedCustomerCreateActionEventName]=function(t){return e.telemetryEventFactory(r.EmbedCustomerCreateActionEventName,t,r.EmbedCustomerCreateActionLoggers,r.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},r.EmbedCustomerQnaActionEventName="EmbedCustomerQnaAction",r.EmbedCustomerQnaAction=i,Te[r.EmbedCustomerQnaActionEventName]=function(t){return e.telemetryEventFactory(r.EmbedCustomerQnaActionEventName,t,r.EmbedCustomerQnaActionLoggers,r.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},r.EmbedSDKCustomerActionEventName="EmbedSDKCustomerAction",r.EmbedSDKCustomerAction=a,Te[r.EmbedSDKCustomerActionEventName]=function(t){return e.telemetryEventFactory(r.EmbedSDKCustomerActionEventName,t,r.EmbedSDKCustomerActionLoggers,r.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},r.EmbedSDKCustomerQnaActionEventName="EmbedSDKCustomerQnaAction",r.EmbedSDKCustomerQnaAction=s,Te[r.EmbedSDKCustomerQnaActionEventName]=function(t){return e.telemetryEventFactory(r.EmbedSDKCustomerQnaActionEventName,t,r.EmbedSDKCustomerQnaActionLoggers,r.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},r.ReportEmbedCreateReportEventName="PBI.ReportEmbed.CreateReport",r.ReportEmbedCreateReport=n,Te[r.ReportEmbedCreateReportEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedCreateReportEventName,t,r.ReportEmbedCreateReportLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedLoadEmbeddedReportEventName="PBI.ReportEmbed.LoadEmbeddedReport",r.ReportEmbedLoadEmbeddedReport=d,Te[r.ReportEmbedLoadEmbeddedReportEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedLoadEmbeddedReportEventName,t,r.ReportEmbedLoadEmbeddedReportLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedRetryLoadReportEventName="PBI.ReportEmbed.RetryLoadReport",r.ReportEmbedRetryLoadReport=l,Te[r.ReportEmbedRetryLoadReportEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedRetryLoadReportEventName,t,r.ReportEmbedRetryLoadReportLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedExplorationDeepCopyEventName="PBI.ReportEmbed.ExplorationDeepCopy",r.ReportEmbedExplorationDeepCopy=c,Te[r.ReportEmbedExplorationDeepCopyEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedExplorationDeepCopyEventName,t,r.ReportEmbedExplorationDeepCopyLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedCapabilitiesServiceIsNullEventName="PBI.ReportEmbed.CapabilitiesServiceIsNull",r.ReportEmbedCapabilitiesServiceIsNull=p,Te[r.ReportEmbedCapabilitiesServiceIsNullEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedCapabilitiesServiceIsNullEventName,t,r.ReportEmbedCapabilitiesServiceIsNullLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},r.ReportEmbedGetExplorationAndModelEventName="PBI.ReportEmbed.GetExplorationAndModel",r.ReportEmbedGetExplorationAndModel=u,Te[r.ReportEmbedGetExplorationAndModelEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedGetExplorationAndModelEventName,t,r.ReportEmbedGetExplorationAndModelLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedPrefetchConceptualSchemaEventName="PBI.ReportEmbed.PrefetchConceptualSchema",r.ReportEmbedPrefetchConceptualSchema=m,Te[r.ReportEmbedPrefetchConceptualSchemaEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedPrefetchConceptualSchemaEventName,t,r.ReportEmbedPrefetchConceptualSchemaLoggers,r.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,["requestId"])},r.ReportEmbedLoadingStartedEventName="PBI.ReportEmbed.LoadingStarted",r.ReportEmbedLoadingStarted=v,Te[r.ReportEmbedLoadingStartedEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedLoadingStartedEventName,t,r.ReportEmbedLoadingStartedLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedLoadExplorationFailedEventName="PBI.ReportEmbed.LoadExplorationFailed",r.ReportEmbedLoadExplorationFailed=y,Te[r.ReportEmbedLoadExplorationFailedEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedLoadExplorationFailedEventName,t,r.ReportEmbedLoadExplorationFailedLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},r.ReportEmbedPageLoadedEventName="PBI.ReportEmbed.PageLoaded",r.ReportEmbedPageLoaded=g,Te[r.ReportEmbedPageLoadedEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedPageLoadedEventName,t,r.ReportEmbedPageLoadedLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedScriptLoadedEventName="PBI.ReportEmbed.ScriptLoaded",r.ReportEmbedScriptLoaded=b,Te[r.ReportEmbedScriptLoadedEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedScriptLoadedEventName,t,r.ReportEmbedScriptLoadedLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedEnterFullScreenEventName="PBI.ReportEmbed.EnterFullScreen",r.ReportEmbedEnterFullScreen=E,Te[r.ReportEmbedEnterFullScreenEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedEnterFullScreenEventName,t,r.ReportEmbedEnterFullScreenLoggers,r.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},r.ReportEmbedInvalidReportResourceKeyEventName="PBI.ReportEmbed.InvalidReportResourceKey",r.ReportEmbedInvalidReportResourceKey=f,Te[r.ReportEmbedInvalidReportResourceKeyEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedInvalidReportResourceKeyEventName,t,r.ReportEmbedInvalidReportResourceKeyLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},r.ReportEmbedClusterResolvedEventName="PBI.ReportEmbed.ClusterResolved",r.ReportEmbedClusterResolved=h,Te[r.ReportEmbedClusterResolvedEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedClusterResolvedEventName,t,r.ReportEmbedClusterResolvedLoggers,r.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["backendUrl"])},r.ReportEmbedSwitchPageEventName="PBI.ReportEmbed.SwitchPage",r.ReportEmbedSwitchPage=S,Te[r.ReportEmbedSwitchPageEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSwitchPageEventName,t,r.ReportEmbedSwitchPageLoggers,r.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},r.ReportEmbedSocialSharingEventName="PBI.ReportEmbed.SocialSharing",r.ReportEmbedSocialSharing=C,Te[r.ReportEmbedSocialSharingEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSocialSharingEventName,t,r.ReportEmbedSocialSharingLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["platformUrl","isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSaveExplorationEventName="PBI.ReportEmbed.SaveExploration",r.ReportEmbedSaveExploration=I,Te[r.ReportEmbedSaveExplorationEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSaveExplorationEventName,t,r.ReportEmbedSaveExplorationLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSaveAsExplorationEventName="PBI.ReportEmbed.SaveAsExploration",r.ReportEmbedSaveAsExploration=F,Te[r.ReportEmbedSaveAsExplorationEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSaveAsExplorationEventName,t,r.ReportEmbedSaveAsExplorationLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.QnaEmbedLoadQnaEventName="PBI.QnaEmbed.LoadQna",r.QnaEmbedLoadQna=R,Te[r.QnaEmbedLoadQnaEventName]=function(t){return e.telemetryEventFactory(r.QnaEmbedLoadQnaEventName,t,r.QnaEmbedLoadQnaLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.QnaEmbedInterpretUtteranceEventName="PBI.QnaEmbed.InterpretUtterance",r.QnaEmbedInterpretUtterance=T,Te[r.QnaEmbedInterpretUtteranceEventName]=function(t){return e.telemetryEventFactory(r.QnaEmbedInterpretUtteranceEventName,t,r.QnaEmbedInterpretUtteranceLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKPrepareReportEventName="PBI.ReportEmbed.SDK.PrepareReport",r.ReportEmbedSDKPrepareReport=D,Te[r.ReportEmbedSDKPrepareReportEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKPrepareReportEventName,t,r.ReportEmbedSDKPrepareReportLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKRenderReportEventName="PBI.ReportEmbed.SDK.RenderReport",r.ReportEmbedSDKRenderReport=P,Te[r.ReportEmbedSDKRenderReportEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKRenderReportEventName,t,r.ReportEmbedSDKRenderReportLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKLoadReportEventName="PBI.ReportEmbed.SDK.LoadReport",r.ReportEmbedSDKLoadReport=A,Te[r.ReportEmbedSDKLoadReportEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKLoadReportEventName,t,r.ReportEmbedSDKLoadReportLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKSetActivePageEventName="PBI.ReportEmbed.SDK.SetActivePage",r.ReportEmbedSDKSetActivePage=M,Te[r.ReportEmbedSDKSetActivePageEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKSetActivePageEventName,t,r.ReportEmbedSDKSetActivePageLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKGetAllPagesEventName="PBI.ReportEmbed.SDK.GetAllPages",r.ReportEmbedSDKGetAllPages=V,Te[r.ReportEmbedSDKGetAllPagesEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKGetAllPagesEventName,t,r.ReportEmbedSDKGetAllPagesLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKGetAvailableDisplayAreaEventName="PBI.ReportEmbed.SDK.GetAvailableDisplayArea",r.ReportEmbedSDKGetAvailableDisplayArea=w,Te[r.ReportEmbedSDKGetAvailableDisplayAreaEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKGetAvailableDisplayAreaEventName,t,r.ReportEmbedSDKGetAvailableDisplayAreaLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKGetAllVisualsEventName="PBI.ReportEmbed.SDK.GetAllVisuals",r.ReportEmbedSDKGetAllVisuals=N,Te[r.ReportEmbedSDKGetAllVisualsEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKGetAllVisualsEventName,t,r.ReportEmbedSDKGetAllVisualsLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.EmbedVisualApiEventName="EmbedVisualApi",r.EmbedVisualApi=x,Te[r.EmbedVisualApiEventName]=function(t){return e.telemetryEventFactory(r.EmbedVisualApiEventName,t,r.EmbedVisualApiLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKCreateVisualEventName="PBI.ReportEmbed.SDK.CreateVisual",r.ReportEmbedSDKCreateVisual=L,Te[r.ReportEmbedSDKCreateVisualEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKCreateVisualEventName,t,r.ReportEmbedSDKCreateVisualLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKDeleteVisualEventName="PBI.ReportEmbed.SDK.DeleteVisual",r.ReportEmbedSDKDeleteVisual=k,Te[r.ReportEmbedSDKDeleteVisualEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKDeleteVisualEventName,t,r.ReportEmbedSDKDeleteVisualLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKChangeVisualTypeEventName="PBI.ReportEmbed.SDK.ChangeVisualType",r.ReportEmbedSDKChangeVisualType=K,Te[r.ReportEmbedSDKChangeVisualTypeEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKChangeVisualTypeEventName,t,r.ReportEmbedSDKChangeVisualTypeLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKCloneVisualEventName="PBI.ReportEmbed.SDK.CloneVisual",r.ReportEmbedSDKCloneVisual=B,Te[r.ReportEmbedSDKCloneVisualEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKCloneVisualEventName,t,r.ReportEmbedSDKCloneVisualLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKSortVisualEventName="PBI.ReportEmbed.SDK.SortVisual",r.ReportEmbedSDKSortVisual=_,Te[r.ReportEmbedSDKSortVisualEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKSortVisualEventName,t,r.ReportEmbedSDKSortVisualLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKAddDataRoleFieldEventName="PBI.ReportEmbed.SDK.AddDataRoleField",r.ReportEmbedSDKAddDataRoleField=U,Te[r.ReportEmbedSDKAddDataRoleFieldEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKAddDataRoleFieldEventName,t,r.ReportEmbedSDKAddDataRoleFieldLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKDeleteDataRoleFieldEventName="PBI.ReportEmbed.SDK.DeleteDataRoleField",r.ReportEmbedSDKDeleteDataRoleField=q,Te[r.ReportEmbedSDKDeleteDataRoleFieldEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKDeleteDataRoleFieldEventName,t,r.ReportEmbedSDKDeleteDataRoleFieldLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKGetDataRoleFieldsEventName="PBI.ReportEmbed.SDK.GetDataRoleFields",r.ReportEmbedSDKGetDataRoleFields=O,Te[r.ReportEmbedSDKGetDataRoleFieldsEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKGetDataRoleFieldsEventName,t,r.ReportEmbedSDKGetDataRoleFieldsLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKGetVisualCapabilitiesEventName="PBI.ReportEmbed.SDK.GetVisualCapabilities",r.ReportEmbedSDKGetVisualCapabilities=H,Te[r.ReportEmbedSDKGetVisualCapabilitiesEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKGetVisualCapabilitiesEventName,t,r.ReportEmbedSDKGetVisualCapabilitiesLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKGetVisualPropertyEventName="PBI.ReportEmbed.SDK.GetVisualProperty",r.ReportEmbedSDKGetVisualProperty=j,Te[r.ReportEmbedSDKGetVisualPropertyEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKGetVisualPropertyEventName,t,r.ReportEmbedSDKGetVisualPropertyLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKPutVisualPropertyEventName="PBI.ReportEmbed.SDK.PutVisualProperty",r.ReportEmbedSDKPutVisualProperty=G,Te[r.ReportEmbedSDKPutVisualPropertyEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKPutVisualPropertyEventName,t,r.ReportEmbedSDKPutVisualPropertyLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKExportDataEventName="PBI.ReportEmbed.SDK.ExportData",r.ReportEmbedSDKExportData=z,Te[r.ReportEmbedSDKExportDataEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKExportDataEventName,t,r.ReportEmbedSDKExportDataLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKSetReportLevelFiltersEventName="PBI.ReportEmbed.SDK.SetReportLevelFilters",r.ReportEmbedSDKSetReportLevelFilters=W,Te[r.ReportEmbedSDKSetReportLevelFiltersEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKSetReportLevelFiltersEventName,t,r.ReportEmbedSDKSetReportLevelFiltersLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKGetReportLevelFiltersEventName="PBI.ReportEmbed.SDK.GetReportLevelFilters",r.ReportEmbedSDKGetReportLevelFilters=Q,Te[r.ReportEmbedSDKGetReportLevelFiltersEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKGetReportLevelFiltersEventName,t,r.ReportEmbedSDKGetReportLevelFiltersLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKGetBookmarksEventName="PBI.ReportEmbed.SDK.GetBookmarks",r.ReportEmbedSDKGetBookmarks=J,Te[r.ReportEmbedSDKGetBookmarksEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKGetBookmarksEventName,t,r.ReportEmbedSDKGetBookmarksLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKApplyBookmarkByNameEventName="PBI.ReportEmbed.SDK.ApplyBookmarkByName",r.ReportEmbedSDKApplyBookmarkByName=$,Te[r.ReportEmbedSDKApplyBookmarkByNameEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKApplyBookmarkByNameEventName,t,r.ReportEmbedSDKApplyBookmarkByNameLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKApplyBookmarkStateEventName="PBI.ReportEmbed.SDK.ApplyBookmarkState",r.ReportEmbedSDKApplyBookmarkState=X,Te[r.ReportEmbedSDKApplyBookmarkStateEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKApplyBookmarkStateEventName,t,r.ReportEmbedSDKApplyBookmarkStateLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKAddBookmarkEventName="PBI.ReportEmbed.SDK.AddBookmark",r.ReportEmbedSDKAddBookmark=Z,Te[r.ReportEmbedSDKAddBookmarkEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKAddBookmarkEventName,t,r.ReportEmbedSDKAddBookmarkLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKCaptureBookmarkEventName="PBI.ReportEmbed.SDK.CaptureBookmark",r.ReportEmbedSDKCaptureBookmark=Y,Te[r.ReportEmbedSDKCaptureBookmarkEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKCaptureBookmarkEventName,t,r.ReportEmbedSDKCaptureBookmarkLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKPlayBookmarksEventName="PBI.ReportEmbed.SDK.PlayBookmarks",r.ReportEmbedSDKPlayBookmarks=ee,Te[r.ReportEmbedSDKPlayBookmarksEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKPlayBookmarksEventName,t,r.ReportEmbedSDKPlayBookmarksLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKSetPageLevelFiltersEventName="PBI.ReportEmbed.SDK.SetPageLevelFilters",r.ReportEmbedSDKSetPageLevelFilters=re,Te[r.ReportEmbedSDKSetPageLevelFiltersEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKSetPageLevelFiltersEventName,t,r.ReportEmbedSDKSetPageLevelFiltersLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKGetPageLevelFiltersEventName="PBI.ReportEmbed.SDK.GetPageLevelFilters",r.ReportEmbedSDKGetPageLevelFilters=te,Te[r.ReportEmbedSDKGetPageLevelFiltersEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKGetPageLevelFiltersEventName,t,r.ReportEmbedSDKGetPageLevelFiltersLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKSetVisualLevelFiltersEventName="PBI.ReportEmbed.SDK.SetVisualLevelFilters",r.ReportEmbedSDKSetVisualLevelFilters=oe,Te[r.ReportEmbedSDKSetVisualLevelFiltersEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKSetVisualLevelFiltersEventName,t,r.ReportEmbedSDKSetVisualLevelFiltersLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKGetVisualLevelFiltersEventName="PBI.ReportEmbed.SDK.GetVisualLevelFilters",r.ReportEmbedSDKGetVisualLevelFilters=ie,Te[r.ReportEmbedSDKGetVisualLevelFiltersEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKGetVisualLevelFiltersEventName,t,r.ReportEmbedSDKGetVisualLevelFiltersLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"]);
},r.ReportEmbedSDKBookmarkAppliedEventName="PBI.ReportEmbed.SDK.BookmarkApplied",r.ReportEmbedSDKBookmarkApplied=ae,Te[r.ReportEmbedSDKBookmarkAppliedEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKBookmarkAppliedEventName,t,r.ReportEmbedSDKBookmarkAppliedLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKCustomLayoutEventName="PBI.ReportEmbed.SDK.CustomLayout",r.ReportEmbedSDKCustomLayout=se,Te[r.ReportEmbedSDKCustomLayoutEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKCustomLayoutEventName,t,r.ReportEmbedSDKCustomLayoutLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKChangeViewModeEventName="PBI.ReportEmbed.SDK.ChangeViewMode",r.ReportEmbedSDKChangeViewMode=ne,Te[r.ReportEmbedSDKChangeViewModeEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKChangeViewModeEventName,t,r.ReportEmbedSDKChangeViewModeLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKSaveExplorationEventName="PBI.ReportEmbed.SDK.SaveExploration",r.ReportEmbedSDKSaveExploration=de,Te[r.ReportEmbedSDKSaveExplorationEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKSaveExplorationEventName,t,r.ReportEmbedSDKSaveExplorationLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKSaveAsExplorationEventName="PBI.ReportEmbed.SDK.SaveAsExploration",r.ReportEmbedSDKSaveAsExploration=le,Te[r.ReportEmbedSDKSaveAsExplorationEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKSaveAsExplorationEventName,t,r.ReportEmbedSDKSaveAsExplorationLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.QnaEmbedSDKLoadQnaEventName="PBI.QnaEmbed.SDK.LoadQna",r.QnaEmbedSDKLoadQna=ce,Te[r.QnaEmbedSDKLoadQnaEventName]=function(t){return e.telemetryEventFactory(r.QnaEmbedSDKLoadQnaEventName,t,r.QnaEmbedSDKLoadQnaLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.QnaEmbedSDKInterpretUtteranceEventName="PBI.QnaEmbed.SDK.InterpretUtterance",r.QnaEmbedSDKInterpretUtterance=pe,Te[r.QnaEmbedSDKInterpretUtteranceEventName]=function(t){return e.telemetryEventFactory(r.QnaEmbedSDKInterpretUtteranceEventName,t,r.QnaEmbedSDKInterpretUtteranceLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKUnsupportedFilterTypeEventName="PBI.ReportEmbed.SDK.UnsupportedFilterType",r.ReportEmbedSDKUnsupportedFilterType=ue,Te[r.ReportEmbedSDKUnsupportedFilterTypeEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKUnsupportedFilterTypeEventName,t,r.ReportEmbedSDKUnsupportedFilterTypeLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKLoadedWithLayoutTypeEventName="PBI.ReportEmbed.SDK.LoadedWithLayoutType",r.ReportEmbedSDKLoadedWithLayoutType=me,Te[r.ReportEmbedSDKLoadedWithLayoutTypeEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKLoadedWithLayoutTypeEventName,t,r.ReportEmbedSDKLoadedWithLayoutTypeLoggers,r.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},r.ReportEmbedSDKErrorEventName="PBI.ReportEmbed.SDK.Error";r.ReportEmbedSDKError=ve;Te[r.ReportEmbedSDKErrorEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKErrorEventName,t,r.ReportEmbedSDKErrorLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},r.ReportEmbedSDKReportedErrorEventName="PBI.ReportEmbed.SDK.ReportedError",r.ReportEmbedSDKReportedError=ye,Te[r.ReportEmbedSDKReportedErrorEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKReportedErrorEventName,t,r.ReportEmbedSDKReportedErrorLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},r.QnaEmbedSDKErrorEventName="PBI.QnaEmbed.SDK.Error",r.QnaEmbedSDKError=ge,Te[r.QnaEmbedSDKErrorEventName]=function(t){return e.telemetryEventFactory(r.QnaEmbedSDKErrorEventName,t,r.QnaEmbedSDKErrorLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},r.ReportEmbedPushAccessEventName="PBI.ReportEmbed.PushAccess",r.ReportEmbedPushAccess=be,Te[r.ReportEmbedPushAccessEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedPushAccessEventName,t,r.ReportEmbedPushAccessLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKSetCustomThemeEventName="PBI.ReportEmbed.SDK.SetCustomTheme",r.ReportEmbedSDKSetCustomTheme=Ee,Te[r.ReportEmbedSDKSetCustomThemeEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKSetCustomThemeEventName,t,r.ReportEmbedSDKSetCustomThemeLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedCommandsSettingsEventName="PBI.ReportEmbed.CommandsSettings",r.ReportEmbedCommandsSettings=fe,Te[r.ReportEmbedCommandsSettingsEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedCommandsSettingsEventName,t,r.ReportEmbedCommandsSettingsLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSecurePublishToWebEventName="PBI.ReportEmbed.SecurePublishToWeb",r.ReportEmbedSecurePublishToWeb=he,Te[r.ReportEmbedSecurePublishToWebEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSecurePublishToWebEventName,t,r.ReportEmbedSecurePublishToWebLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedSDKRefreshReportEventName="PBI.ReportEmbed.SDK.RefreshReport",r.ReportEmbedSDKRefreshReport=Se,Te[r.ReportEmbedSDKRefreshReportEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedSDKRefreshReportEventName,t,r.ReportEmbedSDKRefreshReportLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},r.ReportEmbedPhasedRenderConfigChangedEventName="PBI.ReportEmbed.PhasedRenderConfigChanged",r.ReportEmbedPhasedRenderConfigChanged=Ce,Te[r.ReportEmbedPhasedRenderConfigChangedEventName]=function(t){return e.telemetryEventFactory(r.ReportEmbedPhasedRenderConfigChangedEventName,t,r.ReportEmbedPhasedRenderConfigChangedLoggers,void 0,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])}})(r=e.telemetry||(e.telemetry={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(e){var r;!(function(e){var r;!(function(e){e.reportLoadUrl="/report/load",e.loadReport="loadReport",e.error="error",e.minimumReportDataRefreshIntervalInMinutes=1,e.defaultId="defaultId",e.PageFilterLevel="page",e.VisualFilterLevel="visual",e.reportPageLoaded="reportPageLoaded",e.modelsAndExplorationReadyEventName="modelsAndExplorationReady",e.conceptualSchemaReadyEventName="conceptualSchemaReady",e.showSocialSharingOverlayEventName="showSocialSharingOverlay",e.qnaVisualRendered="qnaVisualRendered",e.minimumRefreshTokenInterval=3e4,e.bufferTimeToCheckTokenExpiry=12e4;var r;!(function(e){e.POST="POST"})(r=e.HttpMethods||(e.HttpMethods={}));var t;!(function(e){e.anonymousEmbedFailedToInitialize="Anonymous embed error: Fail to initialize - Could not initialize report embed",e.anonymousEmbedFailedToParseObjectId="Anonymous embed error: Fail to load - Could not parse the reportObjectId from the searchBar.",e.appTokenNotSupported="This feature is not supported for App Token embed.",e.applyBookmarkByNameAndStateIsInvalid="Cannot apply a bookmark when both a name and a state are provided",e.bookmarkNotFound="Could not find bookmark",e.cancelledByUser="Failed to get access - Cancelled by user",e.changeViewModeFailed="Could not change view mode",e.changeVisualTypeFailed="Could not change visual type",e.clearAllFiltersFailed="Could not clear all filters",e.commandFailed="Handling command failed",e.failedToExtractHyperlinkClickData="Failed to extract hyperlink click event data",e.createReportFailed="Create report failed",e.createVisualFailed="Create visual failed",e.failedCloningVisual="Clone visual failed",e.failedDeletingVisual="Failed to delete visual",e.failedGettingJsonFilterParser="Failed to get json filter parser",e.failedGettingSchema="Error: Could not get schema",e.failedSortingVisual="Sort visual failed",e.failedToAddDataFieldToRole="Failed to add data field to role",e.failedToDeleteDataRoleField="Failed to delete data role field",e.failedToGetDataRoleFields="Failed to retrieve data fields.",e.failedToInitialize="Fail to initialize - Could not initialize report embed",e.failedToInitializeCreate="Fail to initialize - Could not initialize create report",e.failedToParseObjectId="Fail to load - Could not parse the reportObjectId.",e.failedToResolveCluster="Fail to initialize - Could not resolve cluster",e.failedToResolveVisualCapabilities="Failed to resolve visual capabilities.",e.failedToResolveVisualCapabilitiesForType="Failed to resolve capabilities for visual of type {0}",e.failedToValidateToken="Failed to validate token",e.filtersSerializationError="Could not serialize filters to json syntax.",e.getAllPagesFailed="Could not get all pages",e.getAllVisualsFailed="Could not get all visuals",e.getAvailableSizeFailed="Could not get available display area size",e.getAvailableVisualTypesFailed="Could not get available visual types",e.getPropertyFailed="Get visual property failed",e.getReportFailed="Get report failed",e.insufficientPermissions="Could not load Edit mode: insufficient Permissions",e.interpretUtteranceAllowedInResultViewQnaModeOnly="Please enter Result View QnA mode for sending interpret requests",e.interpretUtteranceFailed='Could not interpret "{0}"',e.interpretUtteranceNonValidDatasetCollection="Requested datasets for interpret utterance through SDK must be a valid subset of initial datasets collection",e.invalidAccessToken="Invalid access token",e.invalidBookmarkRequest="Invalid bookmark request",e.invalidBookmarkState="Invalid bookmark state",e.invalidCloneVisualRequest="Invalid clone visual request",e.invalidDataFieldIndex="Invalid data field index.",e.invalidFilter="Invalid filter definition",e.invalidIcon="Invalid control icon. only base64 image is allowed",e.invalidOrMissingDataRole="Invalid or no data role parameter",e.invalidOrderBy="Invalid orderBy",e.invalidPageName="Invalid page name",e.invalidSortVisualRequest="Invalid sort visual request",e.invalidThemeContrastCombination="Theme was not applied because a contrast mode was chosen.",e.invalidViewMode="Invalid view mode",e.invalidVisualName="Invalid visual name",e.invalidVisualPropertyRequest="Invalid visual property request",e.invalidVisualType="Invalid visual type",e.loadReportFailed="Could not load a report",e.missingDataField="Invalid or no data field parameter",e.missingOrInvalidDataFieldRequestParameters="Missing or invalid input parameters, please provide target dataRole and index.",e.missingOrInvalidDirection="Missing or invalid direction",e.missingOrderBy="Missing orderBy",e.missingVisualName="Missing visual name",e.missingVisualType="Missing visual type",e.mobileLayoutNotFound='Warning: Mobile layout was not found for current page: "{0}", loading page in default layout',e.mobileLayoutPermissionNotSupported="These permissions are not supported with mobile layout",e.notInMobileMode="Warning: Not In Mobile Mode, loading page in default layout",e.pageNotActive="Operation is allowed only on active page",e.pageNotFound='Could not find page "{0}"',e.phasedEmbedIdMismatch="Report or group ID do not match loaded configuration",e.phasedEmbedNotInitialized="Invalid operation - prepare report required prior to render",e.powerBIEntityNotFound="PowerBI entity not found",e.publishToWebNotSupported="This feature is not supported for Publish To Web.",e.qnaFailedToInitialize="Fail to initialize - Could not initialize qna embed",e.redirectToRequestAccess="Secure P2W - Failed to authorize, redirecting to request access",e.reEmbedCancelFirstEevent="cancelled",e.renderQnaVisualFailed='Could not render a qna visual for "{0}"',e.renderReportVisualFailed="{0}. Could not render a report visual titled: {1}",e.reportNotFound="Report is not found",e.reportNotReady="Report is not ready",e.routeNotFound="Not Found. Url: {0} was not found.",e.saveExplorationFailed="Could not save report",e.saveReportNotAllowedInViewMode="Save report is not allowed in view mode",e.secureP2WUnknownError="Unknown error - secure pulish to web",e.setPageFailed="Could not set a page",e.setPropertyFailed="Set visual property failed",e.setSlicerIsNotSupported="Set slicer value is not supported",e.targetDoesNotMatch="Target doesn't match visual targets",e.tooManyRefreshRequests="Report refresh limit of one request every {0} seconds reached. Please try again later.",e.unsupportedDataFields="Unsupported data fields",e.unsupportedProperty="Unsupported property",e.unsupportedType="Unsupported value type",e.unsupportedVisuals="Unsupported visuals",e.updateSettingsFailed="Error occurred while updating settings.",e.visualNotFound='Could not find visual "{0}" in page "{1}"'})(t=e.ErrorMessages||(e.ErrorMessages={}));var o;!(function(e){e.generalFailure="Export visual data has failed",e.generateDetailsTable="Error generating details table",e.generateFiltersDescription="Error handling filters",e.invalidRequest="Invalid export data request",e.noData="Visual has no data",e.notSupportedForVisual="Export data is not supported for this visual",e.queryError="Error running visual data query",e.schemaLoadingError="Error loading schema",e.columnNameCannotBeEmpty="Column name can not be empty"})(o=e.ExportDataErrorMessages||(e.ExportDataErrorMessages={}));var i;!(function(e){e.qnaVisualRendered="QnaVisualRendered",e.SwipeStart="swipeStart",e.SwipeEnd="swipeEnd",e.backgroundChangedEvent={name:"backgroundChangedEvent",type:4}})(i=e.Events||(e.Events={}));var a;!(function(e){e.addBookmarkFailed="addBookmarkFailed",e.applyBookmarkFailed="applyBookmarkFailed",e.commandFailed="CommandFailed",e.failedToExtractHyperlinkData="FailedToExtractHyperlinkData",e.createReportFailed="CreateReportFailed",e.exportDataFailed="ExportDataFailed",e.failedDeletingVisual="FailedDeletingVisual",e.failedGettingJsonFilterParser="FailedGettingJsonFilterParser",e.failedGettingSchema="FailedGettingSchema",e.failedSortingVisual="FailedSortingVisual",e.failedToAddDataField="FailedToAddDataField",e.failedToDeleteDataField="FailedToDeleteDataField",e.failedToGetDataFields="FailedToGetDataFields",e.failedToValidateDataRole="FailedToValidateDataRole",e.failedToValidateToken="FailedToValidateToken",e.featureNotSupported="NotSupported",e.filterError="filterError",e.getAllPagesFailed="getAllPagesFailed",e.getAvailableVisualTypesFailed="getAvailableVisualTypesFailed",e.getDatasetFailed="GetDatasetFailed",e.getPropertyFailed="getPropertyFailed",e.getReportFailed="GetReportFailed",e.getSlicerFiltersFailed="getSlicerFiltersFailed",e.insufficientPermissions="insufficientPermissions",e.interpretQnaUtteranceFailed="InterpretQnaUtteranceFailed",e.interpretUtteranceFailed="interpretFailure",e.invalidAccessToken="InvalidAccessToken",e.invalidAddDataFIeldRequest="InvalidAddDataFieldRequest",e.invalidChangeVisualTypeRequest="invalidChangeVisualTypeRequest",e.invalidCloneVisualRequest="invalidCloneVisualRequest",e.invalidCreateVisualRequest="invalidCreateVisualRequest",e.invalidDeleteVisualRequest="invalidDeleteVisualRequest",e.invalidFilter="InvalidFilter",e.invalidReportObjectId="InvalidReprtObjectId",e.invalidSortVisualRequest="invalidSortVisualRequest",e.invalidThemeContrastCombination="invalidThemeContrastCombination",e.invalidVisualPropertyRequest="invalidVisualPropertyRequest",e.missingAccessToken="InvalidOrNoPowerBIAccessToken",e.missingViewMode="InvalidViewMode",e.mobileLayoutError="mobileLayoutError",e.noExploration="noExploration",e.notAuthorized="NotAuthorized",e.notFound="ReportNotFound",e.notReady="ReportNotReady",e.pageNotActive="pageNotActive",e.pageNotFound="pageNotFound",e.phasedEmbedError="phasedEmbedError",e.playBookmarkFailed="playBookmarkFailed",e.powerBIEntityNotFound="PowerBIEntityNotFound",e.qnaLoadFailed="LoadQnaFailed",e.qnaRenderFailed="QnaRenderFailed",e.reportLoadFailed="LoadReportFailed",e.reportRenderFailed="ReportRenderFailed",e.saveReportFailed="SaveReportFailed",e.saveReportNotSupported="SaveReportNotSupported",e.setPageFailed="SetPageFailed",e.setPropertyFailed="setPropertyFailed",e.tokenExpired="TokenExpired",e.unsupportedProperty="unsupportedProperty",e.unsupportedType="unsupportedType",e.updateSettingsFailed="updateSettingsFailed",e.visualNotFound="VisualNotFound",e.visualizeQnaFailed="visualizeQnaFailed"})(a=e.ErrorCodes||(e.ErrorCodes={}));var s;!(function(e){e.loadReportUIDMissingWarning="Warning: Received load report message that does not contain uid in request headers. Update your load message with the uid, otherwise emitted events will not contain uid associated with that report.",e.createReportUIDMissingWarning="Warning: Received create report message that does not contain uid in request headers. Update your create message with the uid, otherwise emitted events will not contain uid associated with that dataset.",e.loadQnaUIDMissingWarning="Warning: Received load qna message that does not contain uid in request headers. Update your load message with the uid, otherwise emitted events will not contain uid associated with that dataset."})(s=e.WarningMessages||(e.WarningMessages={}));var n;!(function(e){e.OK=200,e.Accepted=202,e.BadRequest=400,e.NotFound=404,e.TooManyRequests=429,e.InternalServerError=500})(n=e.StatusCodes||(e.StatusCodes={}));var d;!(function(e){e.maxWidthMobileUI=480,e.maxHeightMobileUI=338,e.maxSizeTabletUI=768})(d=e.CssStyles||(e.CssStyles={}));var l;!(function(e){e.refreshFrequencyInSeconds=15})(l=e.ThrottlingLimits||(e.ThrottlingLimits={}));var c;!(function(e){e.maxRowsLimit=3e4})(c=e.ExportDataLimits||(e.ExportDataLimits={}));var p;!(function(e){var r;!(function(e){e.QnA={EmbedResult:"embedQnaResult",Interactive:"embedQnaInteractive"}})(r=e.States||(e.States={}))})(p=e.Embed||(e.Embed={}));var u;!(function(e){e.VisualName="http://powerbi.com/product/schema#visualSelector",e.VisualType="http://powerbi.com/product/schema#visualTypeSelector",e.SlicerTarget="http://powerbi.com/product/schema#slicerTargetSelector"})(u=e.SelectorSchemas||(e.SelectorSchemas={}));var m;!(function(e){e.Property="http://powerbi.com/product/schema#property",e.Default="http://powerbi.com/product/schema#default"})(m=e.PropertySchemas||(e.PropertySchemas={}))})(r=e.constants||(e.constants={}))})(r=e.reportembed||(e.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(r){var t=e.explore.reportembed.constants,o=(function(){function e(){}return e.InvalidOrNoReportId=function(){return{message:"InvalidOrNoReportId",detailedMessage:"Invalid or missing ReportId",level:pbiModels.TraceType.Fatal,postBackwardsCompatibilityEvent:!0}},e.refreshNotAllowed=function(){return{message:"refreshNotAllowed",detailedMessage:jsCommon.StringExtensions.format("Report refresh limit of one request every {0} seconds reached. Please try again later.",t.ThrottlingLimits.refreshFrequencyInSeconds.toString())}},e})();r.ReportEmbedErrors=o})(t=r.errors||(r.errors={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(e){var r;!(function(e){var r=(function(){function e(){}return e.getSectionByName=function(e,r){return e?_.find(e.sections,(function(e){return e.name===r})):null},e.getPageIndexByName=function(e,r){return r&&r.sections?r.sections.map((function(e){return e.name})).indexOf(e):-1},e.isPageExists=function(r,t){return e.getPageIndexByName(r,t)>=0},e.isVisualExists=function(r,t,o){var i=e.getPageIndexByName(r,o);return!(i<0)&&o.sections[i].visualContainers.map((function(e){return e.name})).indexOf(t)>=0},e.getVisualContainerByName=function(e,r){return e?_.find(e.visualContainers,(function(e){return e.name===r})):null},e.getVisualContainerViewModel=function(e,r){if(!e)return null;var t=e.exploreCanvas.visualContainers.filter((function(e){return e.contract.name===r}));return _.isEmpty(t)?null:t[0]},e})();e.ExplorationHelper=r})(r=e.reportembed||(e.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){function t(e){return new l(e)}var o=e.explore.reportembed.constants.ErrorCodes,i=e.errorDetailsHelper,a=e.explore.reportembed.constants.ErrorMessages,s=e.explore.reportembed.constants,n=jsCommon.StringExtensions,d=jsCommon.TraceType;r.getHostCommunicationHelper=t;var l=(function(){function r(e){this.windowService=e}return r.buildErrorMessage=function(e){return{event:s.error,error:e}},r.prototype.postErrorMessageToParent=function(e){var r={event:s.error,error:e};this.windowService.parent.postMessage(JSON.stringify(r),"*")},r.prototype.postReportLoadMessageToParent=function(){var e={event:s.reportPageLoaded,error:""};this.windowService.parent.postMessage(JSON.stringify(e),"*")},r.prototype.postErrorLoadReportFailed=function(){this.postErrorMessageToParent(o.reportLoadFailed)},r.prepareEmbedTelemetryErrorDetails=function(e,r,t,o,a){var s,n,d=e?e:"";return r&&(s=i.getTelemetryErrorDetailsFromHttpStatus(r,t),n=r.code),a&&d!==a&&(d+=". Message: "+a),{errorSource:s?s.errorSource:"PowerBI",errorCode:n||o,httpStatusCode:t,errorMessage:d}},r.buildPageNotFoundErrorMessage=function(e){var t=n.format(a.pageNotFound,e);return r.createError(o.pageNotFound,t,{level:d.Error})},r.buildVisualNotFoundErrorMessage=function(e,r){return{message:n.format(a.visualNotFound,e,r)}},r.buildFailedToAddDataFieldErrorMessage=function(e){return{message:o.failedToAddDataField,detailedMessage:e}},r.buildFailedToDeleteDataFieldErrorMessage=function(e){return{message:o.failedToDeleteDataField,detailedMessage:e}},r.buildFailedToValidateDataRoleErrorMessage=function(){return{message:s.ErrorCodes.failedToValidateDataRole,detailedMessage:s.ErrorMessages.invalidOrMissingDataRole}},r.buildFailedToGetDataFieldsErrorMessage=function(e){var r=n.format(a.failedToGetDataRoleFields,e);return{message:o.failedToGetDataFields,detailedMessage:r}},r.buildDataFieldsNotSupportedErrorMessage=function(){return{message:o.failedToGetDataFields,detailedMessage:a.unsupportedDataFields}},r.buildFailedToResolveVisualCapabilitiesErrorMessage=function(e){return{message:n.format(a.failedToResolveVisualCapabilitiesForType,e)}},r.buildInterpretUtteranceFailedError=function(e,r){return{message:n.format(a.interpretUtteranceFailed,e),detailedMessage:r,errorCode:o.interpretUtteranceFailed}},r.buildNotSupportedByPublishToWebMessage=function(){return r.createError(o.featureNotSupported,a.publishToWebNotSupported,{level:d.Fatal})},r.buildNotSupportedByAppTokenEmbedMessage=function(){return r.createError(o.featureNotSupported,a.appTokenNotSupported,{level:d.Fatal})},r.buildFailedSortingVisualErrorMessage=function(e){return{message:o.failedSortingVisual,detailedMessage:e}},r.buildInvalidSortVisualRequestErrorMessage=function(e){return{message:o.invalidSortVisualRequest,detailedMessage:e}},r.buildErrorObjectFromResult=function(e,t,o,i){var a=e&&e.httpStatusCode,s=e&&e.error,n=e&&e.requestId,d=s&&s.code?s.code:t,l=s&&s.message?s.message:o,c={requestId:n,statusCode:a?a.toString():void 0,level:i};return r.createError(d,l,c)},r.createError=function(e,r,t,o){return{message:e,detailedMessage:r,errorCode:t&&t.statusCode,level:t&&t.level,technicalDetails:{requestId:t&&t.requestId,errorInfo:o}}},r.buildIErrorFromConceptualSchemaError=function(t){var i;if(t&&t.serviceError)i=e.helpers.PowerBIServiceExceptionErrorHelper.GetErrorDetailsFromServiceError(t.serviceError,t.requestId);else{if(!t||!t.clientError)return r.createError(o.failedGettingSchema,a.failedGettingSchema,{level:d.Error});i=e.helpers.PowerBIServiceExceptionErrorHelper.GetErrorDetailsFromClientError(t.clientError)}var s=[];return i&&i.displayableErrorInfo&&(s=_.map(i.displayableErrorInfo,(function(e){return{key:e.errorInfoKey,value:e.errorInfoValue}}))),{message:o.failedGettingSchema,detailedMessage:i.message?i.message:a.failedGettingSchema,level:d.Error,technicalDetails:{requestId:t&&t.requestId,errorInfo:s}}},r})();r.HostCommunicationHelper=l})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t=e.explore.reportembed.constants,o=(function(){function r(){}return r.createJsonFilterParser=function(r,o,i,a){return __awaiter(this,void 0,e.Promise,(function(){var e,s,n;return __generator(this,(function(d){switch(d.label){case 0:return[4,o.require({javascript:"JSONFilter/services/jsonFilterParser"})];case 1:return e=d.sent(),[4,e.create(r,o,i,a)];case 2:if(s=d.sent(),!s)throw n={message:t.ErrorCodes.failedGettingJsonFilterParser,detailedMessage:t.ErrorMessages.failedGettingJsonFilterParser};return[2,s]}}))}))},r})();r.JsonFilterHelper=o})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t=e.explore.reportembed.constants.SelectorSchemas,o=(function(){function e(){}return e.match=function(r,t){return!t||(e.isVisualTypeSelector(t)?r.config.singleVisual.visualType===t.visualType:!!e.isVisualNameSelector(t)&&r.name===t.visualName)},e.isVisualTypeSelector=function(e){return e.$schema===t.VisualType},e.isVisualNameSelector=function(e){return!e.$schema||e.$schema===t.VisualName},e.isSlicerTargetSelector=function(e){return e.$schema===t.SlicerTarget},e})();r.SelectorsHelper=o})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(t){var o=e.common.events,i=e.common.contracts.DataCacheModeType,a=e.common.contracts.DatasetHost,s=jsCommon.EnumExtensions,n=e.explore.reportembed.constants.ErrorCodes,d=e.explore.reportembed.constants.ErrorMessages,l=e.telemetry.EXOpenExplorationEventName,c=e.explore.services.events,p=e.explore.reportembed.constants.Events,u=jsCommon.JsonExtensions,m=e.MonitorWith,v=e.telemetry.OpenExplorationSource,y=e.PbiPromise,g=e.explore.reportembed.constants,b=e.explore.reportembed.errors.ReportEmbedErrors,E=e.telemetry.ReportEmbedRetryLoadReportEventName,f=jsCommon.TraceType,h=e.explore.viewModels,S=window,C=window,I=window,F=window,R=window,T=window,D=(function(){function e(e,r){this.reportEmbedControllerCore=new P(e,r)}return e})();t.ReportEmbedController=D;var P=(function(){function t(e,t){var o=this;this.scope=e,this.services=t,this.explorationContainerReadyRetries=0,this.queryParams=jsCommon.QueryStringUtil.parseQueryString(window.location.search),this.scope.showErrorMessage=!1,this.scope.backgroundCssClass="",this.scope.isUserUnauthorized=!1,this.windowMessageHelper=r.getHostCommunicationHelper(window),this.scope.isAccessTokenExpired=!1,this.scope.keyDown=function(e){return o.onKeyDown(e)},this.scope.reportThumbnailModulePath="@powerbi/ReportThumbnail/report-thumbnail.module#ReportThumbnailModule",this.scope.optimizePublishToWeb=this.optimizePublishToWeb(),this.scope.checkForResourceKey=function(){return o.checkForResourceKey()},this.scope.reportThumbnailInputArgs={interact:function(){return o.clickToInteract()},isPublicReport:function(){return o.services.embedModeService.isAnonymousLiveEmbed()}},this.promptForLogin(),this.PowerBIModelsModule=this.services.moduleLoader.require({javascript:"powerbi-models"}),this.services.moduleLoader.require({javascript:"JSONFilter/services/jsonFilterParser"}),this.services.lazyProviderModern.get("@powerbi/JsonContracts/json-contracts.module#JsonContractsModule","jsonTargetParserService"),this.globalChannelSubscriptionManager=this.services.globalEventBridge.createChannelSubscriptionManager().subscribe(c.openReportFinished,(function(e,r){return __awaiter(o,void 0,void 0,(function(){return __generator(this,(function(e){return[2,this.onOpenReportFinished(r)]}))}))})).subscribe(p.backgroundChangedEvent,(function(e,r){o.scope.backgroundCssClass=r})),this.scope.canvasOptions={autoLayoutVisualPadding:0,scrollbarOffset:0,disableFocusOnExploreCanvas:!0},this.firstLoadReport=!0,this.services.embedTelemetry.startAppInitEvent(),this.setMessageHandlers(),this.scope.useLegacyExplorationContainer=function(){return o.services.featureSwitchService.isFeatureSwitchesRegistered&&!o.services.featureSwitchService.featureSwitches.embedUseModernExplorationContainer}}return Object.defineProperty(t.prototype,"exploration",{get:function(){return this.scope.exploreContainer&&this.scope.exploreContainer.exploration?this.scope.exploreContainer.exploration.contract:this.reportEmbedState.baseExploration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentSettings",{get:function(){return this.reportEmbedState.currentSettings},set:function(e){this.reportEmbedState.currentSettings=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"embedType",{get:function(){return this.services.embedModeService.getEmbedTypeDescription()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exploreContainer",{set:function(e){this.services.reportEmbedState.exploreContainer=this.scope.exploreContainer=e},enumerable:!0,configurable:!0}),t.prototype.ngOnDestroy=function(){this.globalChannelSubscriptionManager&&this.globalChannelSubscriptionManager.unsubscribeAll()},t.prototype.setMessageHandlers=function(){this.setupShowSignInHandler(),this.setupLoadReportHandler(),this.setupRenderReportHandler(),this.setupCreateReportHandler(),this.setupExportReportHandler(),
this.services.embedMessageProxyService.startListening()},t.prototype.setupExportReportHandler=function(){if(R.isLoadReportForExportPending){var e=this.queryParams.groupId;this.embedReportForExport(R.reportObjectId,e,R.reportLoadConfigurationBase64)}},t.prototype.setupShowSignInHandler=function(){var e=this;C.showSignIn=function(r){return e.showSignIn(r.accessToken,r.reportId)},C.showSignInParameters&&C.showSignIn(C.showSignInParameters)},t.prototype.setupLoadReportHandler=function(){var e=this;C.loadReport=function(r){return e.validateInputAndLoadReport(r)},this.services.embedModeService.isAnonymousLiveEmbed()&&this.validateInputAndLoadReport({id:"any",accessToken:"any",uid:void 0,sdkSessionId:void 0}),C.loadReportParameters&&C.loadReport(C.loadReportParameters)},t.prototype.setupRenderReportHandler=function(){var e=this;C.renderReport=function(r){return e.renderReport(r)}},t.prototype.setupCreateReportHandler=function(){var e=this;C.createReport=function(r){return e.createReport(r)},C.createReportParameters&&C.createReport(C.createReportParameters)},t.prototype.onOpenReportFinished=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(o){switch(o.label){case 0:return this.reportLoadedFired?[3,4]:(this.reportLoadedFired=!0,t.isError?(this.services.embedMessageProxyService.isEmbedMessageProxyServiceUsed()||this.windowMessageHelper.postErrorLoadReportFailed(),this.pageLoadedEvent&&(e=r.HostCommunicationHelper.prepareEmbedTelemetryErrorDetails(t.reason),this.pageLoadedEvent.reject(e)),[3,4]):[3,1]);case 1:return this.isMobile?[4,this.services.embedSettingsService.setExploreConfiguration(this.exploration,this.scope.exploreContainer,!0,!0,this.reportEmbedState.pageName)]:[3,3];case 2:o.sent(),o.label=3;case 3:this.services.embedMessageProxyService.isEmbedMessageProxyServiceUsed()||this.windowMessageHelper.postReportLoadMessageToParent(),this.pageLoadedEvent&&this.pageLoadedEvent.resolve(),o.label=4;case 4:return[2]}}))}))},t.prototype.resetScopeParams=function(){this.scope.backgroundCssClass="",this.scope.errorMessage=void 0,this.exploreContainer=h.ViewModelFactory.createExplorationContainer(),this.scope.isAccessTokenExpired=!1,this.scope.isUserUnauthorized=!1,this.scope.showErrorMessage=!1},t.prototype.promptForLogin=function(){this.scope.showPromptForLogin=!_.isEmpty(this.queryParams.autoAuth)&&(!this.isPowerBIAccessTokenValid()||this.scope.isAccessTokenExpired)},t.prototype.isPowerBIAccessTokenValid=function(){var e=this.queryParams.ctid;if(this.services.embedModeService.isSecurePublishToWeb())try{return this.services.embedTokenService.isAADTokenTenantValid(e)}catch(e){throw this.createPropagatedErrors(e,d.failedToValidateToken,n.failedToValidateToken,e.message,e)}return!_.isEmpty(S.powerBIAccessToken)},t.prototype.optimizePublishToWeb=function(){return!_.isEmpty(this.queryParams.optimizeReportLoading)},t.prototype.NotifyExportError=function(){this.services.screenshotEngineCommunicator.cancel()},t.prototype.embedReportForExport=function(e,r,t){var o,i;if(t){var a="";if(a=atob(t),i=u.tryParseJSON(a),!i)return void this.NotifyExportError();var s=i.bookmark;if(s&&i.pageName)try{var n=this.services.sdkModelsConverter.getBookmarkFromBase64State(s.state);n.explorationState.activeSection=i.pageName;o={state:this.services.sdkModelsConverter.getSdkBookmark(n).state}}catch(e){return void this.NotifyExportError()}S.powerBIEmbedToken=i.accessToken,this.loadReport({id:e,groupId:r,pageName:i&&i.pageName,bookmark:o,settings:{navContentPaneEnabled:!1,filterPaneEnabled:!1},uid:void 0,sdkSessionId:void 0,accessToken:void 0},void 0)}},t.prototype.loadReport=function(t,o){return __awaiter(this,void 0,y,(function(){var i,a,s,l,c,p,u,m,v,y,g,b,E,h,S,C,F=this;return __generator(this,(function(R){switch(R.label){case 0:return this.originalConfig=t,this.firstLoadReport||this.resetScopeParams(),this.reportEmbedState.loadReportCalled&&(I.conceptualSchemaPromise=null),this.reportEmbedState.loadReportCalled=!0,i=this,[4,this.PowerBIModelsModule];case 1:return i.PowerBIModels=R.sent(),this.services.embedSettingsService.setHideErrors(t.settings),[4,this.validateOdataFilter(t.additionalODataFilter)];case 2:if(a=R.sent(),s=this.services.embedModeService.isAnonymousLiveEmbed(),t.viewMode===this.PowerBIModels.ViewMode.Edit){if(s)throw r.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage();if(this.isMobile)throw this.services.embedMessageProxyService.postError(r.HostCommunicationHelper.createError(n.insufficientPermissions,d.mobileLayoutPermissionNotSupported,{level:f.Fatal}));if(!t.permissions)throw this.showError(),this.services.embedMessageProxyService.postError(r.HostCommunicationHelper.createError(n.insufficientPermissions,d.insufficientPermissions,{level:f.Fatal}))}c=t.datasetBinding&&t.datasetBinding.datasetId,p=!!I.modelsAndExplorationPromise,u=t.filters&&t.filters.length?t.filters.length:0,m=t.slicers&&t.slicers.length?t.slicers.length:0,v=!!t.bookmark,y=!!t.pageName,g=!!t.additionalODataFilter,b=!(!t.settings||!t.settings.visualSettings);try{s&&(t.id=this.resolveReportIdForAnonymousEmbed(o))}catch(o){throw t.id="",this.showError(),this.fireLoadReportStartUpTelemetry(t.id),l=this.services.telemetryService.startEvent(e.telemetry.ReportEmbedLoadEmbeddedReport,p,u,m,v,y,t.phasedRender,t.viewMode,b,g,t.sdkSessionId,void 0,void 0,c,T.sdkVersion,t.id,this.embedType,this.embedUrl,this.embedReferrer),E=r.HostCommunicationHelper.prepareEmbedTelemetryErrorDetails(o.message,o,null,o.code),E.errorSource="User",l.reject(E),o}return this.reportEmbedState.reportObjectId=t.id,this.reportEmbedState.groupId=t.groupId,this.fireLoadReportStartUpTelemetry(t.id),l=this.services.telemetryService.startEvent(e.telemetry.ReportEmbedLoadEmbeddedReport,p,u,m,v,y,t.phasedRender,t.viewMode,b,g,t.sdkSessionId,void 0,void 0,c,T.sdkVersion,t.id,this.embedType,this.embedUrl,this.embedReferrer),this.reportLoadedFired=!1,this.reportEmbedState.pageName=t.pageName,this.reportEmbedState.bookmark=t.bookmark,this.reportEmbedState.isEditing=t.viewMode===this.PowerBIModels.ViewMode.Edit,this.reportEmbedState.initialThemeCollection=null,this.reportEmbedState.theme=t.theme,this.reportEmbedState.slicers=t.slicers,this.reportEmbedState.contrastMode=t.contrastMode&&this.services.sdkModelsConverter.getContrastMode(t.contrastMode),this.reportEmbedState.isPhasedLoading=t.phasedRender,t.settings=t.settings||{},this.currentSettings={filterPaneEnabled:t.settings.filterPaneEnabled||!1,navContentPaneEnabled:t.settings.navContentPaneEnabled||!1,layoutType:t.settings.layoutType||0,background:t.settings.background||this.PowerBIModels.BackgroundType.Default,visualSettings:t.settings.visualSettings},[4,this.createAndSetEmbedExplorationCapabilities(t.settings,t.permissions)];case 3:return R.sent(),this.reportEmbedState.baseExploration=null,h=null,s?(this.scope.showLogoBar=!0,this.services.activeFolderIdService.activeFolderObjectId=t.groupId,h=this.loadReportForAnonymous(t.id),[3,10]):[3,4];case 4:return this.services.embedModeService.isAppTokenEmbed()?(this.scope.showLogoBar=!1,this.reportEmbedState.additionalODataFilter=a,this.reportEmbedState.additionalJsonFilters=t.filters,this.services.activeFolderIdService.activeFolderObjectId=t.groupId,h=this.loadReportForAppToken(t.id,t.permissions,t.viewMode),[3,10]):[3,5];case 5:this.reportEmbedState.additionalODataFilter=a,this.reportEmbedState.additionalJsonFilters=t.filters,R.label=6;case 6:return R.trys.push([6,8,,9]),[4,this.initClusterUri()];case 7:return R.sent(),[3,9];case 8:throw S=R.sent(),C=this.createPropagatedErrors(S,d.failedToResolveCluster,n.reportLoadFailed,d.failedToResolveCluster,S&&S.error),l.reject(C.telemetryError),this.services.embedTelemetry.resolveAppInitEvent(!0,C.telemetryError),C.hostError;case 9:this.services.activeFolderIdService.activeFolderObjectId=t.groupId,this.initializeSyncService(),h=this.loadReportForSaasPaasEmbed(t.id,d.failedToInitialize,t.permissions,t.viewMode,t.settings,t.phasedRender,t.appId,c),R.label=10;case 10:return this.firstLoadReport=!1,[2,new e.Promise(function(r,t){return __awaiter(F,void 0,e.Promise,(function(){var e;return __generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,h];case 1:return o.sent(),this.services.reportEmbedState.model&&(l.event.info.modelId=this.services.reportEmbedState.model.id,l.event.info.capacityObjectId=this.reportEmbedState.model.contract.capacityObjectId||void 0),l.resolve(),r(null),[3,3];case 2:return e=o.sent(),l.reject(e.telemetryError),t(e.hostError),[3,3];case 3:return[2]}}))}))})]}}))}))},t.prototype.initializeSyncService=function(){var e=this;this.services.syncService.startMonitoring();var r=this.services.pageVisibilityService;r&&r.pageVisibility&&r.pageVisibility.subscribe&&this.services.pageVisibilityService.pageVisibility.subscribe((function(r){r?e.services.syncService.pause():e.services.syncService.resume()}))},t.prototype.validateOdataFilter=function(e){return __awaiter(this,void 0,y,(function(){var r,t,o;return __generator(this,(function(i){switch(i.label){case 0:if(!e)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.services.lazyProviderLegacy.get("odataFilterParserService")];case 2:return r=i.sent(),t=r.tryGetFilters(e),_.isEmpty(t)&&this.services.embedMessageProxyService.postErrorInvalidFilter(),[3,4];case 3:return o=i.sent(),this.services.embedMessageProxyService.postErrorInvalidFilter(),[2,""];case 4:return[2,e]}}))}))},t.prototype.fireLoadingEventAndFlush=function(r){var t=this.services.telemetryService;t.logEvent(e.telemetry.ReportEmbedLoadingStarted,r,this.embedType,this.embedUrl,this.embedReferrer);var o=this.services.promiseFactory.defer();o.promise.then((function(){t&&t.flush()})),o.resolve(null)},t.prototype.loadReportForAnonymous=function(e){return __awaiter(this,void 0,y,(function(){var r;return __generator(this,(function(o){switch(o.label){case 0:if(jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e))throw this.createPropagatedErrors(null,d.anonymousEmbedFailedToParseObjectId,n.reportLoadFailed,n.invalidReportObjectId);return[4,this.getClusterUriIfTenantIdExists(this.reportEmbedState.targetTenantId,S.clusterUri)];case 1:return r=o.sent(),S.clusterUri=t.getAPIMHostUrl(r),[4,this.initializeReportEmbed(e,d.anonymousEmbedFailedToInitialize)];case 2:return o.sent(),[2]}}))}))},t.prototype.loadReportForAppToken=function(e,r,t){return __awaiter(this,void 0,y,(function(){var o,i;return __generator(this,(function(a){switch(a.label){case 0:if(jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e))throw this.createPropagatedErrors(null,d.failedToParseObjectId,n.reportLoadFailed,n.invalidReportObjectId);a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.initClusterUri()];case 2:return a.sent(),[3,4];case 3:throw o=a.sent(),i=this.createPropagatedErrors(o,d.failedToResolveCluster,n.reportLoadFailed,null,o&&o.error),this.services.embedTelemetry.resolveAppInitEvent(!0,i.telemetryError),i;case 4:return[4,this.initializeReportEmbed(e,d.failedToInitialize,r,t)];case 5:return a.sent(),[2]}}))}))},t.prototype.loadReportForSaasPaasEmbed=function(e,r,t,o,i,a,s,n){return __awaiter(this,void 0,y,(function(){return __generator(this,(function(d){switch(d.label){case 0:return[4,this.initializeReportEmbed(e,r,t,o,i,a,s,n)];case 1:return d.sent(),[2]}}))}))},t.prototype.resolveReportIdForAnonymousEmbed=function(r){var t,o=jsCommon.QueryStringUtil.parseQueryString(r);o.k?t=o.k:o.key&&(t=o.key);var i="",a=o.r;if(this.reportEmbedState.targetTenantId=void 0,a){var s=void 0;try{s=JSON.parse(atob(a))}catch(e){i=e}s&&(s.t&&(this.reportEmbedState.targetTenantId=s.t),s.k?t=s.k:i="Wrong format of encoded report - JSON object  doesn't contain a key")}if(this.reportEmbedState.setRefreshTime(o.refresh),jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(t))throw i=d.anonymousEmbedFailedToParseObjectId+i,this.services.telemetryService.logEvent(e.telemetry.ReportEmbedInvalidReportResourceKey,i),{message:i,code:n.invalidReportObjectId};return window.powerBIAccessToken=t,window.powerBIResourceKey=t,t},t.prototype.fireLoadReportStartUpTelemetry=function(r){if("number"==typeof F.viewLoadingStarted){var t=this.services.telemetryService.startEvent(e.telemetry.ReportEmbedScriptLoaded,r,this.embedType,this.embedUrl,this.embedReferrer);t.event.time=F.viewLoadingStarted,t.resolve(),this.pageLoadedEvent=this.services.telemetryService.startEvent(e.telemetry.ReportEmbedPageLoaded,r,this.embedType,this.embedUrl,this.embedReferrer),this.pageLoadedEvent.event.time=F.viewLoadingStarted}this.fireLoadingEventAndFlush(r)},t.prototype.createPropagatedErrors=function(e,t,o,i,a,s){void 0===s&&(s=!1);var n=e&&e.httpStatusCode,d=e&&e.error,l=r.HostCommunicationHelper.prepareEmbedTelemetryErrorDetails(t,d,n,o,i);(401===n||403===n||404===n||s)&&(l.errorSource="User");var c=r.HostCommunicationHelper.buildErrorObjectFromResult(e,o,i,f.Fatal);return this.services.embedMessageProxyService.postError(c),this.showError(a),{hostError:c,telemetryError:l}},t.prototype.initializeReportEmbed=function(t,o,i,a,s,n,l,c){return __awaiter(this,void 0,y,(function(){var p,u,m,y,g;return __generator(this,(function(b){switch(b.label){case 0:p=this.services.embedTokenService.tryParsePowerBIAccessToken(),u=JSON.stringify({embedType:this.embedType,embedUrl:this.embedUrl,embedReferrer:this.embedReferrer,appId:p&&p.appid}),this.openExplorationEvent&&(m=r.HostCommunicationHelper.prepareEmbedTelemetryErrorDetails(d.reEmbedCancelFirstEevent),m.errorSource="User",this.openExplorationEvent.reject(m)),this.openExplorationEvent=this.services.telemetryService.startActivity(this.services.legacyScopeService.rootScope(),e.telemetry.EXOpenExploration,this.reportEmbedState.reportObjectId,void 0,l,void 0,!1,void 0,v.Normal,!1,void 0,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,u,void 0,void 0,void 0),b.label=1;case 1:return b.trys.push([1,3,,4]),[4,this.startReportEmbed(t,o,i,a,s,n,l,c)];case 2:return b.sent(),[3,4];case 3:throw y=b.sent(),g=y&&y.telemetryError,this.openExplorationEvent.reject(g),this.services.embedTelemetry.resolveAppInitEvent(!0,g),y;case 4:return[2]}}))}))},t.prototype.restartReportEmbed=function(e,r,t,o,i,a,s){return __awaiter(this,void 0,y,(function(){return __generator(this,(function(n){switch(n.label){case 0:return this.fillEmbedTelemetryEvent(E,e),[4,this.startReportEmbed(e,r,t,o,i,a,s)];case 1:return n.sent(),[2]}}))}))},t.prototype.startReportEmbed=function(t,o,i,a,s,l,c,p){return __awaiter(this,void 0,y,(function(){var u,m,v,y,g,b;return __generator(this,(function(E){switch(E.label){case 0:this.services.embedModeService.isAnonymousLiveEmbed()||(this.scope.showLogoBar=!1),E.label=1;case 1:return E.trys.push([1,3,,9]),this.scope.optimizePublishToWeb?(this.services.embedModeService.isAnonymousLiveEmbed()&&this.resolveReportIdForAnonymousEmbed(window.location.search),[2]):(C.prefetchSchemaEnabled&&this.services.embedModeService.isSaasEmbed()&&this.services.embedConceptualSchemaProxy.prefetchConceptualSchema(t,p),[4,this.services.reportEmbedExplorationService.getModelsAndExploration(t,!0,p)]);case 2:return u=E.sent(),this.services.embedMwcConnectionService.checkAndRegisterDirectToMwc(u),this.services.telemetryHostService.updateHostData(this.isSaaSEmbedWithAADToken()),this.services.telemetryService.restart(),[3,9];case 3:return m=E.sent(),v=m&&m.httpStatusCode,y=m&&m.error,g=this.services.embedModeService.isSecurePublishToWeb()&&this.isPowerBIAccessTokenValid(),401!==v||!this.isSaaSEmbedWithAADToken()&&!g?[3,8]:y&&"PowerBINotAuthorizedException"===y.code?jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(c)?[4,this.pushAccess(t,o,m,i,a,s,m&&m.error)]:[3,5]:[3,7];case 4:return E.sent(),[2];case 5:return[4,this.tryInstallOrgApp(c,t,o,m,i,a,s)];case 6:return E.sent(),[2];case 7:if(this.reportEmbedState.groupId!==e.common.constants.myWorkspaceFolderId)return this.services.activeFolderIdService.activeFolderObjectId=e.common.constants.myWorkspaceFolderId,this.reportEmbedState.groupId=e.common.constants.myWorkspaceFolderId,this.restartReportEmbed(t,o,i,a,s,l),[2];E.label=8;case 8:if(404===v&&y&&y.code===n.powerBIEntityNotFound)throw this.createPropagatedErrors(m,o,n.powerBIEntityNotFound,d.powerBIEntityNotFound);if(this.services.embedModeService.isSecurePublishToWeb())return b=void 0,this.isPowerBIAccessTokenValid()?(this.redirectToRequestAccess(t),b=r.HostCommunicationHelper.prepareEmbedTelemetryErrorDetails(d.redirectToRequestAccess,y,v,n.getReportFailed)):b=r.HostCommunicationHelper.prepareEmbedTelemetryErrorDetails(d.secureP2WUnknownError,y,v,n.failedToValidateToken),b.errorSource="User",this.openExplorationEvent.reject(b),this.services.embedTelemetry.resolveAppInitEvent(!0,b),[2];throw this.createPropagatedErrors(m,o,n.reportLoadFailed,d.getReportFailed,m&&m.error);case 9:return this.services.embedModeService.isEmbedTokenEmbed()&&!this.services.featureSwitchService.featureSwitches.keyDriverPaas&&(this.scope.explorationContainerOptions.analysisVisuals=!1),[4,this.loadPowerViewReport(u,i,a,s,l)];case 10:return E.sent(),[2]}}))}))},t.prototype.redirectToRequestAccess=function(r){this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSecurePublishToWeb,null,!0,r,this.embedType,this.embedUrl,this.embedReferrer),this.scope.isUserUnauthorized=!0},t.prototype.isSaaSEmbedWithAADToken=function(){return this.services.embedModeService.isSaasEmbed()&&void 0===S.powerBIEmbedToken},t.prototype.tryInstallOrgApp=function(e,r,t,o,i,a,s){return __awaiter(this,void 0,y,(function(){var l,c,p,u,m;return __generator(this,(function(v){switch(v.label){case 0:return v.trys.push([0,4,,5]),[4,this.services.lazyProviderModern.get("@powerbi/EmbedContentProvider/embed-content-provider.module#EmbedContentProviderModule","embedContentProviderService")];case 1:return c=v.sent(),[4,c.tryInstallOrgApp(e)];case 2:return v.sent(),[4,this.services.reportEmbedExplorationService.getModelsAndExploration(r,!1)];case 3:return l=v.sent(),[3,5];case 4:throw p=v.sent(),u=p&&p.detailedMessage?p.detailedMessage:d.getReportFailed,m=p&&p.message?p.message:n.reportLoadFailed,this.createPropagatedErrors(p,t,m,u,o&&o.error);case 5:return[4,this.loadPowerViewReport(l,i,a,s)];case 6:return v.sent(),[2]}}))}))},t.prototype.pushAccess=function(t,o,i,a,s,l,c){return __awaiter(this,void 0,y,(function(){var p,u,m,v,y,g,b,E,f,h,S,C,I,h,F,R,h,T=this;return __generator(this,(function(D){switch(D.label){case 0:return p=this.services.telemetryService.startEvent(e.telemetry.ReportEmbedPushAccess,null,null,t,this.embedType,this.embedUrl,this.embedReferrer),[4,this.services.moduleLoader.require({javascript:"PowerBIDialogs/components/progressDialog/progressDialogBuilder"})];case 1:u=D.sent(),m=u.createProgressDialogBuilder(this.services.modalDialogService,this.services.promiseFactory),v=m.show("RequestAccess","RequestAccess_CheckingPermissionsTitle","RequestAccess_CheckingPermissionsMessage",!0),y=!1,v.dialogClosedPromise.then((function(e){if(y=1===e){var t=r.HostCommunicationHelper.prepareEmbedTelemetryErrorDetails(d.cancelledByUser);if(t.errorSource="User",p.reject(t),T.services.embedModeService.isSecurePublishToWeb())return void T.rejectAppInitAndOpenExplorationEvents(t);var a=i&&i.error&&c;throw T.createPropagatedErrors(i,o,n.reportLoadFailed,d.getReportFailed,a,!0)}})),D.label=2;case 2:return D.trys.push([2,5,,6]),[4,this.services.lazyProviderLegacy.get("pushAccessHttp")];case 3:return b=D.sent(),[4,b.pushReportAccess(p.event,t,!0)];case 4:return E=D.sent(),g=E&&E.data&&E.data.hasAccess,p.event.info.hasAccess=!!g,[3,6];case 5:if(f=D.sent(),h=f&&f.telemetryError,p.reject(h),m.hide(v),this.services.embedModeService.isSecurePublishToWeb())return this.rejectAppInitAndOpenExplorationEvents(h),[2];throw f&&(f.httpStatusCode=f.httpStatusCode||f.status),this.createPropagatedErrors(f,o,n.reportLoadFailed,d.getReportFailed,i&&i.error);case 6:if(y)return S=r.HostCommunicationHelper.prepareEmbedTelemetryErrorDetails(d.cancelledByUser),S.errorSource="User",p.reject(S),this.rejectAppInitAndOpenExplorationEvents(S),[2];if(m.hide(v),!g){if(C=i&&i.error&&c,I=this.createPropagatedErrors(i,o,n.reportLoadFailed,d.getReportFailed,C,!0),p.reject(I.telemetryError),h=I&&I.telemetryError,this.services.embedModeService.isSecurePublishToWeb())return this.redirectToRequestAccess(t),this.rejectAppInitAndOpenExplorationEvents(h),[2];throw I}D.label=7;case 7:return D.trys.push([7,9,,10]),[4,this.services.reportEmbedExplorationService.getModelsAndExploration(t,!1)];case 8:return F=D.sent(),p.event.info.modelsAndExplorationSucceed=!0,p.resolve(),[3,10];case 9:if(R=D.sent(),p.event.info.modelsAndExplorationSucceed=!1,h=R&&R.telemetryError,p.reject(h),this.services.embedModeService.isSecurePublishToWeb())return this.redirectToRequestAccess(t),this.rejectAppInitAndOpenExplorationEvents(h),[2];throw this.createPropagatedErrors(R,o,n.reportLoadFailed,n.getReportFailed,i&&i.error);case 10:return[4,this.loadPowerViewReport(F,a,s,l)];case 11:return D.sent(),[2]}}))}))},t.prototype.rejectAppInitAndOpenExplorationEvents=function(e){this.openExplorationEvent.reject(e),this.services.embedTelemetry.resolveAppInitEvent(!0,e)},t.prototype.loadPowerViewReport=function(e,r,t,o,i){return __awaiter(this,void 0,y,(function(){var t,i,a,s,n=this;return __generator(this,(function(d){switch(d.label){case 0:return this.exploreContainer=this.scope.exploreContainer||h.ViewModelFactory.createExplorationContainer(),this.scope.exploreContainer.options=this.scope.explorationContainerOptions,t=e.exploration,!this.services.embedModeService.isAnonymousLiveEmbed()&&t&&t.report&&t.report.objectId.toLowerCase()!==this.reportEmbedState.reportObjectId.toLowerCase()?[2]:(this.reportEmbedState.baseExploration=t,this.reportEmbedState.model=this.createModel(e.models[0]),this.reportEmbedState.report.id=this.reportEmbedState.baseExploration.reportId,this.reportEmbedState.report.objectId=this.reportEmbedState.reportObjectId,this.reportEmbedState.report.folderId=e.exploration.report.folderId,this.reportEmbedState.report.permissions=this.services.sdkModelsConverter.getPermissions(r),this.reportEmbedState.baseExploration.report&&(this.reportEmbedState.report.permissions=this.reportEmbedState.report.permissions&this.reportEmbedState.baseExploration.report.permissions),this.fillOpenExplorationEventInfo(),e.package&&this.services.packageStore.addMany([this.services.modelConverter.convertPackage(e.package)]),this.isMobile?[4,this.services.embedSettingsService.setExploreConfiguration(this.exploration,this.scope.exploreContainer,!1,!1,this.reportEmbedState.pageName)]:[3,2]);case 1:a=d.sent(),i=a===this.PowerBIModels.LayoutType.MobilePortrait?1:void 0,d.label=2;case 2:return[4,this.services.embedSettingsService.setCustomLayout(this.reportEmbedState.baseExploration,!0,o)];case 3:return d.sent(),[4,this.services.embedSettingsService.trySetVisualSettings(this.reportEmbedState.baseExploration,o)];case 4:return d.sent(),[4,this.services.embedSettingsService.setExtensions(this.reportEmbedState.baseExploration,o)];case 5:return d.sent(),[4,this.services.embedSettingsService.setCommandsSettings(this.reportEmbedState.baseExploration,o)];case 6:return d.sent(),this.setReportContainer(this.reportEmbedState.report),s=this.reportEmbedState.isEditing?1:3,setTimeout((function(){return n.emitLoadPowerViewReportEvent(s,i)}),0),[2]}}))}))},t.prototype.fillOpenExplorationEventInfo=function(){if(this.openExplorationEvent){var e=this.openExplorationEvent.event.info;if(e.permissions=this.reportEmbedState.report&&this.reportEmbedState.report.permissions,e.groupObjectId=this.reportEmbedState.groupId,this.reportEmbedState.model){var r=this.reportEmbedState.model;e.modelId=r.id,e.dbName=r.dbName,e.capacityObjectId=this.capacityObjectId;var t=this.reportEmbedState.model.contract;if(t){e.enterpriseCapacitySkuTier=t.sharedFromEnterpriseCapacitySkuTier,e.dataCacheMode=t.dataCacheMode&&i[t.dataCacheMode],e.datasetHost=t.datasetHost&&a[t.datasetHost],e.isDirectQuery=t.directQueryMode===!0,e.isOnPrem=!_.isEmpty(t.onPremModelConnectionString);var o=t.datasetHost===a.ASOnPrem;e.useMaxParallelQueryData=jsCommon.BrowserUtils.browserSupportsHttp2()&&!o,e.queryCachingState=t.queryCachingState,e.synchronous=e.useMaxParallelQueryData}}e.originalGroupObjectId=this.exploration.report.originalReportObjectId}},t.prototype.loadPowerViewForModel=function(e,r){return __awaiter(this,void 0,y,(function(){var r=this;return __generator(this,(function(t){return this.exploreContainer=this.scope.exploreContainer||h.ViewModelFactory.createExplorationContainer(),this.reportEmbedState.model=this.createModel(e,this.PowerBIModels.Permissions.Create),this.setReportContainer(this.reportEmbedState.model.contract,this.PowerBIModels.Permissions.Create),setTimeout((function(){return r.emitLoadPowerViewReportEvent(1)}),0),[2]}))}))},t.prototype.setReportContainer=function(e,r){var t=this.createReportModel(e,r);t.model=this.reportEmbedState.model.contract,this.reportEmbedState.reportContainer={report:t}},t.prototype.showError=function(e){if(!this.services.errorService.hideErrors){var r="https://go.microsoft.com/fwlink/?LinkID=722383&clcid=0x409",t="https://go.microsoft.com/fwlink/?linkid=860904",o="Content_Not_Available_Error_Message";if(e)switch(e.code){case"AppNotEnabled":o="ReportEmbed_Insufficient_Plan_Error_Message";break;case"UserNotLicensed":o="ReportEmbed_User_Not_Licensed_Error_Message";break;default:o="Content_Not_Available_Error_Message"}this.scope.errorLink=this.services.embedModeService.isAnonymousLiveEmbed()?r:t,this.scope.errorMessage=this.services.localizationService.get(o),this.scope.showErrorMessage=!0}this.hideLoadingSplash()},t.prototype.emitLoadPowerViewReportEvent=function(r,t){this.shouldLoadCachedData()||(this.reportEmbedState.loadCachedData=!1);var o;if(this.reportEmbedState.baseExploration){var i=1!==this.reportEmbedState.report.permissions,a=this.services.telemetryService.startEvent(e.telemetry.ReportEmbedExplorationDeepCopy,i,this.reportEmbedState.reportObjectId,this.embedType,this.embedUrl,this.embedReferrer);if(i){var s={withData:this.reportEmbedState.loadCachedData,withQuery:!0,featureUsage:{}};o=this.services.explorationSerializer.deepCopyExploration(this.reportEmbedState.baseExploration,s),o.report=this.reportEmbedState.baseExploration.report}else o=this.reportEmbedState.baseExploration;a.resolve()}this.services.featureSwitchService.featureSwitches.telemetryV2&&e.fillTelemetryEvent(l,{reportGuid:this.reportEmbedState.reportObjectId,originalReportGuid:void 0,appGuid:void 0,isDirectQuery:void 0,isOnPrem:void 0,source:v.Normal,isUsageMetrics:!1,groupObjectId:this.reportEmbedState.groupId,isReadonlyGroup:void 0,permissions:this.reportEmbedState.report&&this.reportEmbedState.report.permissions,scrubUserInfo:void 0,isB2B:void 0,enterpriseCapacitySkuTier:void 0,bookmarkObjectId:void 0,datasetHost:void 0,modelId:this.reportEmbedState.model&&this.reportEmbedState.model.id,dataCacheMode:void 0,capacityObjectId:this.capacityObjectId,dbName:void 0,serviceAppObjectId:void 0});var n={additionalJsonFilters:this.reportEmbedState.additionalJsonFilters,additionalODataFilter:this.reportEmbedState.additionalODataFilter,canvasLayout:t,exploration:o,instantiationMode:r,model:this.reportEmbedState.model,openExplorationTelemetryEvent:this.openExplorationEvent,report:this.reportEmbedState.reportContainer.report,reportPage:this.reportEmbedState.pageName,hideVisuals:this.reportEmbedState.isPhasedLoading};this.reportEmbedState.isPhasedLoading||this.hideLoadingSplash(),this.loadExplorationContainerWhenReady(n)},t.prototype.loadExplorationContainerWhenReady=function(r){var i=this;if(this.explorationContainerReadyRetries++,this.explorationContainerReadyRetries<=t.explorationContainerReadyMaxRetries&&null==this.services.reportEmbedState.explorationContainer)return void setTimeout((function(){return i.loadExplorationContainerWhenReady(r)}),0);this.explorationContainerReadyRetries>t.explorationContainerReadyMaxRetries&&null==this.services.reportEmbedState.explorationContainer&&this.services.telemetryService.logEvent(e.telemetry.ReportEmbedLoadExplorationFailed);var a=this.services.scopedServices.getExplorationCapabilities();if(a){var s=a.getCapabilities();this.services.reportEmbedState.loadCachedData||(s.visualContainerOptions.disableQueryCacheUpdates=!0),s.disableAnchorTime=this.services.embedModeService.isAnonymousLiveEmbed(),a.setCapabilities(s)}else;this.services.globalEventBridge.publishToChannel(o.loadPowerViewReport,r)},Object.defineProperty(t.prototype,"capacityObjectId",{get:function(){return this.reportEmbedState.model&&this.reportEmbedState.model.contract&&this.reportEmbedState.model.contract.capacityObjectId},enumerable:!0,configurable:!0}),t.prototype.createModel=function(e,r){var t=this,o=this.services.modelConverter.convertModel(e);return null!=r&&(o.getPermissionsCallback=function(){var e=1;return(s.hasFlag(r,t.PowerBIModels.Permissions.Create)||s.hasFlag(r,t.PowerBIModels.Permissions.ReadWrite))&&(e|=3),s.hasFlag(r,t.PowerBIModels.Permissions.All)&&(e=7),e}),o},t.prototype.createReportModel=function(e,r){var t=this,o=this.services.modelConverter.convertReport(e);return r&&(this.reportEmbedState.report.permissions=this.services.sdkModelsConverter.getPermissions(r),o.getPermissionsCallback=function(){return t.reportEmbedState.report.permissions}),this.services.modelConverter.fillReport(o,e),o},t.prototype.hideLoadingSplash=function(){var e=angular.element("#pbi-loading");0!==e.length&&e.remove()},t.prototype.getClusterUriIfTenantIdExists=function(e,r){return __awaiter(this,void 0,y,(function(){return __generator(this,(function(t){return e?[2,this.getClusterUriForTenant(e,r)]:[2,r]}))}))},t.prototype.getClusterUriForTenant=function(e,r){return __awaiter(this,void 0,y,(function(){var o,i;return __generator(this,(function(a){switch(a.label){case 0:return o=t.getAPIMHostUrl(r),[4,this.services.clusterResolverService.getPublicClusterForTenant(e,o)];case 1:return i=a.sent(),[2,i.backendUrl]}}))}))},t.prototype.initClusterUri=function(){return __awaiter(this,void 0,y,(function(){var e,r;return __generator(this,(function(t){switch(t.label){case 0:return e=this.isSaaSEmbedWithAADToken(),[4,this.services.clusterResolverService.getClusterUrl(e)];case 1:return r=t.sent(),S.clusterUri=r.backendUrl,[2,S.clusterUri]}}))}))},t.getAPIMHostUrl=function(e){var r=jsCommon.Utility.getProtocolFromUrl(e),t=jsCommon.Utility.getHostNameForUrl(e),o=t.split(".");return o[0]=o[0].replace("-redirect",""),o[0]=o[0].replace("global-",""),o[0]=o[0]+"-api",r+"://"+o.join(".")},t.prototype.createAndSetEmbedExplorationCapabilities=function(r,t){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(o){switch(o.label){case 0:return e=this.services.embedExplorationCapabilities.createReportExplorationCapabilities(t),this.scope.explorationContainerOptions=e,this.services.reportEmbedState.explorationContainerOptions=this.scope.explorationContainerOptions,r?[4,this.services.embedSettingsService.checkAndUpdateExplorationCapabilities(r,!0,e)]:[3,2];case 1:return e=o.sent(),this.reportEmbedState.useCustomSaveAsDialog=r.useCustomSaveAsDialog,[3,3];case 2:this.scope.explorationContainerOptions=e,this.scope.exploreContainer&&_.merge(this.scope.exploreContainer.options,e),o.label=3;case 3:return[2,e]}}))}))},t.prototype.showSignIn=function(r,t){_.isEmpty(r)?(this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSecurePublishToWeb,!0,null,t,this.embedType,this.embedUrl,this.embedReferrer),this.hideLoadingSplash()):(this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSecurePublishToWeb,!1,null,t,this.embedType,this.embedUrl,this.embedReferrer),this.refreshTokenWatcher(),this.validateInputAndLoadReport({id:t,accessToken:r,uid:void 0,sdkSessionId:void 0}))},t.prototype.onKeyDown=function(e){if(9===e.keyCode){var r=void 0,t=$(document.activeElement).find(".explorationHost .explorationNavigationContent");if(t.length>0&&e.target===e.currentTarget)r=t.find(":tabbable");else{
var o=$(e.currentTarget).next();r=o.is(":tabbable")?o:o.find(":tabbable")}e.shiftKey||e.target!==e.currentTarget?setTimeout((function(){$("logo-bar").parents()[0]===document.activeElement&&$("#embedWrapperId").focus()})):r.length>0&&(r.first().focus(),e.preventDefault())}27===e.keyCode&&$(".embedWrapper")[0]===document.activeElement&&$(document.activeElement).next().focus()},t.prototype.clickToInteract=function(){this.scope.optimizePublishToWeb=!1;var e=this.queryParams.reportId,r=this.queryParams.pageName,t=this.queryParams.filter||this.queryParams.$filter;this.loadReport({id:e,additionalODataFilter:t,pageName:r,accessToken:void 0,uid:void 0,sdkSessionId:void 0})},t.prototype.checkForResourceKey=function(){return!this.services.embedModeService.isAnonymousLiveEmbed()||!_.isEmpty(S.powerBIResourceKey)},t.prototype.refreshTokenWatcher=function(){var e=this,r=jsCommon.DateExtensions.parseIsoDate(S.powerBIAccessTokenExpiry);r&&(this.reportEmbedState.refreshTokenInterval=r.getTime()-(new Date).getTime()-g.bufferTimeToCheckTokenExpiry,this.reportEmbedState.refreshTokenInterval<=0?(window.self!==window.top?(this.scope.isAccessTokenExpired=!0,this.promptForLogin()):this.refreshTokenHandler(),setTimeout((function(){e.refreshTokenWatcher()}),g.minimumRefreshTokenInterval)):setTimeout((function(){e.refreshTokenWatcher()}),this.reportEmbedState.refreshTokenInterval))},t.prototype.refreshTokenHandler=function(){this.services.refreshTokenHandler.refreshToken(_.noop)},t.prototype.shouldLoadCachedData=function(){var e=!_.isEmpty(this.queryParams.disableCachedDataLoad),r=this.reportEmbedState;return!(e||r.additionalODataFilter||r.additionalJsonFilters||r.bookmark||r.slicers)},t.prototype.fillEmbedTelemetryEvent=function(r,t){e.fillTelemetryEvent(r,{reportId:t,embedType:this.embedType,embedUrl:this.embedUrl,embedReferrer:this.embedReferrer})},Object.defineProperty(t.prototype,"embedReferrer",{get:function(){return this.services.embedModeService.getPublicEmbedReferrer()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"embedUrl",{get:function(){return this.services.embedModeService.getPublicEmbedUrl()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMobile",{get:function(){return this.services.embedModeService.isMobile()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reportEmbedState",{get:function(){return this.services.reportEmbedState},enumerable:!0,configurable:!0}),t.prototype.validateInputAndLoadReport=function(r){return __awaiter(this,void 0,e.PbiPromise,(function(){var t,o,i,a,s,n;return __generator(this,(function(d){switch(d.label){case 0:if(this.services.embedRouter.hasLoaded=!1,this.services.embedMessageProxyService.setupRequestId(r.uid),this.services.embedSettingsService.setHideErrors(r.settings),t=this.services.embedTokenService.setAccessToken(r.accessToken,r.tokenType))return this.services.errorService.error(t.detailedMessage,t.message),this.services.embedMessageProxyService.postError(t),[2];this.populateLoadReportParameters(r),d.label=1;case 1:return d.trys.push([1,3,4,5]),[4,this.loadReport(r)];case 2:return d.sent(),[3,5];case 3:throw o=d.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,r.uid,r.id,this.services.embedModeService.getEmbedTypeDescription(),o.message),this.services.embedMessageProxyService.postError(o),o;case 4:return i=this.services.embedModeService.getEmbedTypeDescription(),a=r.phasedRender?e.telemetry.ReportEmbedSDKPrepareReport:e.telemetry.ReportEmbedSDKLoadReport,this.services.telemetryService.logEvent(a,r.uid,r.id,i),r.settings&&(r.settings.customLayout&&(s=r.settings.customLayout,n=void 0!==s.pageSize?s.pageSize.type:void 0,this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKCustomLayout,n,s.displayOption,r.uid,r.id,i)),null!=r.settings.layoutType&&this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKLoadedWithLayoutType,r.settings.layoutType)),[7];case 5:return[2]}}))}))},t.prototype.getSlicersService=function(){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.services.lazyProviderModern.get("@powerbi/ReportEmbed/modules/slicerApiService/slicer-api.module#SlicersApiServiceModule","reportEmbedSlicersApiService")];case 1:return[2,e.sent()]}}))}))},t.prototype.getFilterService=function(){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.services.lazyProviderModern.get("@powerbi/ReportEmbed/modules/filters/filter.module#FilterServiceModule","reportEmbedFilterService")];case 1:return[2,e.sent()]}}))}))},t.prototype.onConfigChanged=function(r){return __awaiter(this,void 0,e.Promise,(function(){var e,t,o;return __generator(this,(function(i){switch(i.label){case 0:return r.pageName&&(this.reportEmbedState.pageName=r.pageName,this.services.mixinCommunicationService.activePage.setPage(r.pageName)),r.bookmark&&(this.reportEmbedState.bookmark=r.bookmark,this.services.mixinCommunicationService.bookmarks.applyBookmarks(this.exploration)),null!=r.viewMode&&(e=r.viewMode===this.PowerBIModels.ViewMode.Edit,this.services.mixinCommunicationService.viewMode.changeViewMode(e)),null==r.slicers?[3,3]:[4,this.getSlicersService()];case 1:return t=i.sent(),[4,t.applySlicers(this.exploration,r.slicers)];case 2:i.sent(),i.label=3;case 3:return null==r.filters?[3,6]:[4,this.getFilterService()];case 4:return o=i.sent(),[4,o.setFilters(r.filters)];case 5:i.sent(),i.label=6;case 6:return[2]}}))}))},t.prototype.renderReport=function(t){return __awaiter(this,void 0,e.PbiPromise,(function(){var o,i,a,s,l,p,u,m,v;return __generator(this,(function(y){switch(y.label){case 0:if(!this.reportEmbedState.isPhasedLoading)throw this.services.embedMessageProxyService.postError(r.HostCommunicationHelper.createError(n.phasedEmbedError,d.phasedEmbedNotInitialized,{level:f.Fatal}));y.label=1;case 1:return y.trys.push([1,6,7,8]),t?(o=!_.isEqual(this.originalConfig.bookmark,t.bookmark),i=!_.isEqual(this.originalConfig.filters,t.filters),a=!_.isEqual(this.originalConfig.slicers,t.slicers),s=this.originalConfig.viewMode!==t.viewMode,l=this.originalConfig.pageName!==t.pageName,(p=o||i||a||s||l)?(this.services.telemetryService.logEvent(e.telemetry.ReportEmbedPhasedRenderConfigChanged,o,i,a,s,l,t.uid,t.id,this.services.embedModeService.getEmbedTypeDescription()),[4,this.onConfigChanged(t)]):[3,3]):[3,3];case 2:y.sent(),y.label=3;case 3:if(this.populateLoadReportParameters(t),u=this.services.embedTokenService.setAccessToken(t.accessToken,t.tokenType))return this.services.errorService.error(u.detailedMessage,u.message),this.services.embedMessageProxyService.postError(u),[2];if(t.id!==this.reportEmbedState.reportObjectId||t.groupId!==this.reportEmbedState.groupId)throw this.services.embedMessageProxyService.postError(r.HostCommunicationHelper.createError(n.phasedEmbedError,d.phasedEmbedIdMismatch,{level:f.Fatal}));return t.settings?[4,this.services.embedSettingsService.updateSettings(t.settings,!0)]:[3,5];case 4:y.sent(),y.label=5;case 5:return this.hideLoadingSplash(),this.services.globalEventBridge.publishToChannel(c.ShowVisuals),[3,8];case 6:return m=y.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,t.uid,t.id,this.services.embedModeService.getEmbedTypeDescription(),m.message),this.services.embedMessageProxyService.postError(m),[3,8];case 7:return v=this.services.embedModeService.getEmbedTypeDescription(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKRenderReport,t.uid,t.id,v),[7];case 8:return[2]}}))}))},t.prototype.populateLoadReportParameters=function(e){var r=e.embedUrl?jsCommon.QueryStringUtil.parseUrl(e.embedUrl):this.queryParams;if(e.additionalODataFilter=e.additionalODataFilter||r.filter||r.$filter,e.pageName=e.pageName||r.pageName,!this.services.embedModeService.isAnonymousLiveEmbed())return!e.id&&(e.id=r.reportId,jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e.id))?(this.services.errorService.error("reportId parameter is not valid","Invalid parameters"),void this.services.embedMessageProxyService.postError(b.InvalidOrNoReportId())):void this.populateGroupIdAndAppId(e,r)},t.prototype.populateGroupIdAndAppId=function(e,r){"2"!==r.w?e.groupId=e.groupId||r.groupId:e.groupId=void 0,e.appId=e.appId||r.appId},t.prototype.createReport=function(t){return __awaiter(this,void 0,e.PbiPromise,(function(){var o,i,a,s,l,p,u,m,p,v,y,g=this;return __generator(this,(function(b){switch(b.label){case 0:if(this.services.embedRouter.hasLoaded=!1,this.services.embedMessageProxyService.setupRequestId(t.uid),this.services.embedModeService.isAnonymousLiveEmbed())throw r.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage();return(o=this.services.embedTokenService.setAccessToken(t.accessToken,t.tokenType))?(this.services.errorService.error(o.detailedMessage,o.message),this.services.embedMessageProxyService.postError(o),[2]):(this.populateGroupIdAndAppId(t,this.queryParams),this.services.embedSettingsService.setHideErrors(t.settings),this.reportLoadedFired=!1,this.reportEmbedState.reportObjectId=this.reportEmbedState.baseExploration=null,i=this.services.telemetryService.startEvent(e.telemetry.ReportEmbedCreateReport,t.sdkSessionId,null,T.sdkVersion,t.datasetId,this.embedType,this.embedUrl,this.embedReferrer),a=this,[4,this.PowerBIModelsModule]);case 1:a.PowerBIModels=b.sent(),b.label=2;case 2:return b.trys.push([2,4,,5]),[4,this.initClusterUri()];case 3:return b.sent(),[3,5];case 4:throw s=b.sent(),l=this.services.embedModeService.isAppTokenEmbed()?d.failedToResolveCluster:d.failedToResolveCluster,p=this.createPropagatedErrors(s,l,n.createReportFailed,null,s&&s.error),i.reject(p.telemetryError),p.hostError;case 5:this.services.activeFolderIdService.activeFolderObjectId=t.groupId,b.label=6;case 6:return b.trys.push([6,8,,9]),[4,this.services.embedModelService.getModel(t.datasetId,i)];case 7:return u=b.sent(),[3,9];case 8:throw m=b.sent(),p=this.createPropagatedErrors(m,d.failedToInitializeCreate,n.getDatasetFailed,d.createReportFailed,m&&m.error),i.reject(p.telemetryError),p.hostError;case 9:return v=this.services.embedExplorationCapabilities.createReportExplorationCapabilities(this.PowerBIModels.Permissions.Create),this.scope.explorationContainerOptions=v,this.services.embedSettingsService.setExtensions(this.exploration,t.settings),this.services.embedSettingsService.setCommandsSettings(this.exploration,t.settings),this.reportEmbedState.isEditing=!0,this.reportEmbedState.initialThemeCollection=null,this.reportEmbedState.theme=t.theme,this.reportEmbedState.useCustomSaveAsDialog=t.settings&&t.settings.useCustomSaveAsDialog,y=this.loadPowerViewForModel(u,t.settings),[2,new e.Promise(function(r,t){return __awaiter(g,void 0,e.Promise,(function(){var e;return __generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,y];case 1:return o.sent(),this.services.reportEmbedState.model&&(i.event.info.modelId=this.services.reportEmbedState.model.id),i.resolve(),this.services.globalEventBridge.publishToChannel(c.openReportFinished,{isError:!1}),r(null),[3,3];case 2:return e=o.sent(),i.reject(e.telemetryError),t(e.hostError),[3,3];case 3:return[2]}}))}))})]}}))}))},t.explorationContainerReadyMaxRetries=5,__decorate([m(l,1)],t.prototype,"initializeReportEmbed",null),__decorate([m(E)],t.prototype,"restartReportEmbed",null),t})();t.ReportEmbedControllerCore=P})(t=r.controllers||(r.controllers={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(t){var o;!(function(o){var i=e.dataServices.models.ContentPackItems,a=e.explore.services.events,s=e.explore.reportembed.constants,n=e.explore.helpers.ReportUtility,d=jsCommon.TraceType;o.ReportAuthoringMixinFactory={ng:["apiGateway","$scope","checkUnsavedService","embedModeService","embedRouter","errorService","explorationSerializer","featureSwitchService","localizationService","moduleLoader","promiseFactory","explorationProxy","reportEmbedState","telemetryService","visualPlugin"],scoped:["eventBridge","bubblingEventBridge","lazyScoped"],fn:function(e){return new l(e)}};var l=(function(){function o(e){this.services=e}return o.prototype.update=function(e){this.explorationContainer=e,this.PowerBIModelsModule=this.services.moduleLoader.require({javascript:"powerbi-models"}),this.services.embedRouter.setupBlock(this),this.setEventListeners()},o.prototype.destroy=function(){this.channelSubscriptionManager.unsubscribeAll(),this.bubblingSubscriptionManager.unsubscribeAll()},o.prototype.setEventListeners=function(){var e=this;this.channelSubscriptionManager=this.services.eventBridge.createChannelSubscriptionManager().subscribe(r.services.events.saveReportCompleted,(function(r,t){return e.onReportSave(t)})).subscribe(r.services.events.customSaveAsTriggered,(function(r){return e.onSaveDialogRequested()})).subscribe(r.services.events.onReportChanged,(function(r,t){return e.onReportChanged(t.explorationContentChanged)})),this.bubblingSubscriptionManager=this.services.bubblingEventBridge.setBubblingScope(this.services.$scope).subscribe(a.saveExploration,(function(r,t){return e.save(r,t)})).subscribe(a.saveAsExploration,(function(r,t){return e.saveAs(r,t)}))},o.prototype.setupRoutes=function(r){var t=this;r.get("/report/hasUnsavedChanges",this.services.apiGateway.blockP2W((function(e,r){return r.send(s.StatusCodes.OK,t.services.checkUnsavedService.userHasUnsavedWork)}))),r.post("/report/save",this.services.apiGateway.blockP2W((function(r,o){t.saveReport().catch((function(r){t.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,t.requestId,t.services.reportEmbedState.reportObjectId,t.services.embedModeService.getEmbedTypeDescription()),t.services.embedRouter.postError("reports",r)})),t.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKSaveExploration,t.requestId,t.services.reportEmbedState.reportObjectId,t.services.embedModeService.getEmbedTypeDescription());var i=t.requestId?void 0:s.WarningMessages.loadReportUIDMissingWarning;return o.send(s.StatusCodes.Accepted,i)}))),r.post("/report/saveAs",this.services.apiGateway.blockP2W((function(r,o){return __awaiter(t,void 0,e.Promise,(function(){var t,i,a=this;return __generator(this,(function(n){switch(n.label){case 0:return t=r.body,[4,this.validateSaveAsParameters(t)];case 1:return(i=n.sent())?[2,o.send(s.StatusCodes.BadRequest,i)]:(this.saveReportAs(t).catch((function(r){a.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,a.requestId,t.name,a.services.embedModeService.getEmbedTypeDescription()),a.services.embedRouter.postError("reports",r)})),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKSaveAsExploration,this.requestId,t.name,this.services.embedModeService.getEmbedTypeDescription()),[2,o.send(s.StatusCodes.Accepted)])}}))}))})))},o.prototype.save=function(e,r){return r&&r.overrideSaveRouting?this.saveReport():this.services.promiseFactory.reject(t.HostCommunicationHelper.createError(s.ErrorCodes.saveReportFailed,s.ErrorMessages.saveExplorationFailed,{level:d.Error}))},o.prototype.saveReport=function(){var e=this.isSaveEnabled();return e?this.services.promiseFactory.reject(e):this.services.reportEmbedState.baseExploration?this.saveReportInternal():this.saveAs(null,{overrideSaveRouting:!0})},o.prototype.saveAs=function(r,t){var o=this;if(t&&t.overrideSaveRouting){var i=this.services.promiseFactory.defer(),s=this.isSaveAsEnabled();return s?(i.reject(s),i.promise):this.services.reportEmbedState.useCustomSaveAsDialog?void this.services.eventBridge.publishToChannel(a.customSaveAsTriggered):(e.explore.controllers.showSaveAsDialog(this.services.errorService,this.services.localizationService).then((function(e){var r={name:e};return o.saveReportAsInternal(r).then((function(){i.resolve(null)}),(function(e){return i.reject(e),e}))}),(function(){})),i.promise)}},o.prototype.saveReportAs=function(e){var r=this.isSaveAsEnabled();return r?this.services.promiseFactory.reject(r):this.saveReportAsInternal(e)},o.prototype.saveReportInternal=function(){var o=this,a=this.services.reportEmbedState.baseExploration,l=this.services.reportEmbedState.reportObjectId,c=this.explorationContainer.viewModel.exploration.contract,p=a.reportId;if(n.HasUnsupportedExploreVisuals(c,this.services.visualPlugin))return this.services.promiseFactory.reject(t.HostCommunicationHelper.createError(s.ErrorCodes.saveReportFailed,s.ErrorMessages.unsupportedVisuals,{level:d.Error}));this.showSaveMask();var u=this.services.embedModeService,m=this.services.telemetryService.startEvent(e.telemetry.ReportEmbedSaveExploration,l,u.getEmbedTypeDescription(),u.getPublicEmbedUrl(),u.getPublicEmbedReferrer()),v=this.services.explorationSerializer.stringifyExplorationConfigs(this.services.explorationSerializer.serializeExploration(a,r.proxies.saveExplorationSerializationOptions));return this.services.explorationProxy.save(v,c,p).then((function(r){var t=r&&r.exploration;if(!t)return void m.reject();o.services.reportEmbedState.reportContainer.report.contract.hasExploration=!0;var a=o.services.reportEmbedState.reportContainer.report;return a&&a.isUsedByContentPack&&o.services.$scope.$emit(e.constants.contentPackDirtyShowNotification,p,i.Report),o.onSaveSuccess(t,o.services.reportEmbedState.reportObjectId,!1,m)}),(function(e){throw o.onSaveFailure(o.services.reportEmbedState.reportObjectId,!1,m,void 0,e)}))},o.prototype.saveReportAsInternal=function(r){var o=this,i=this.services.reportEmbedState.reportObjectId,a=this.explorationContainer.viewModel.exploration.contract;if(n.HasUnsupportedExploreVisuals(a,this.services.visualPlugin))return this.services.promiseFactory.reject(t.HostCommunicationHelper.createError(s.ErrorCodes.saveReportFailed,s.ErrorMessages.unsupportedVisuals,{level:d.Error}));this.showSaveMask();var l=this.services.embedModeService,c=this.services.telemetryService.startEvent(e.telemetry.ReportEmbedSaveAsExploration,this.services.reportEmbedState.useCustomSaveAsDialog,i,l.getEmbedTypeDescription(),l.getPublicEmbedUrl(),l.getPublicEmbedReferrer());return this.services.explorationProxy.saveAs(a,r.name,this.services.reportEmbedState.model.id,this.services.reportEmbedState.model.packageId,this.services.reportEmbedState.report.folderId).then((function(e){var t=e&&e.exploration;if(!t)return void o.onSaveFailure(o.services.reportEmbedState.reportObjectId,!0,c,void 0);o.services.reportEmbedState.reportContainer.report.contract.hasExploration=!0;var i=t.report?t.report.objectId:o.services.reportEmbedState.reportObjectId;return o.onSaveSuccess(t,i,!0,c,r.name)}),(function(e){throw o.onSaveFailure(o.services.reportEmbedState.reportObjectId,!0,c,void 0,e)}))},o.prototype.publishSaveReportCompleted=function(e,r,t,o){var i={reportObjectId:e,reportName:t,saveAs:r,error:o,originalReportObjectId:r?this.services.reportEmbedState.reportObjectId:void 0};this.services.eventBridge.publishToChannel(a.saveReportCompleted,i)},o.prototype.isSaveAsEnabled=function(){return this.services.embedModeService.isAnonymousLiveEmbed()?t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage():this.services.reportEmbedState.model?null:t.HostCommunicationHelper.createError(s.ErrorCodes.saveReportFailed,s.ErrorMessages.reportNotFound,{level:d.Error})},o.prototype.isSaveEnabled=function(){return this.services.reportEmbedState.isEditing?this.services.embedModeService.isAnonymousLiveEmbed()?t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage():null:t.HostCommunicationHelper.createError(s.ErrorCodes.saveReportFailed,s.ErrorMessages.saveReportNotAllowedInViewMode,{level:d.Error})},o.prototype.onSaveSuccess=function(e,r,t,o,i){this.synchronizeExplorationIds(e,this.explorationContainer.viewModel.exploration.contract);var s={featureUsage:{}},n=this.services.explorationSerializer;this.services.reportEmbedState.baseExploration=n.deepCopyExploration(e,s),this.services.reportEmbedState.baseExploration&&(this.services.reportEmbedState.baseExploration.report=e.report),this.services.eventBridge.publishToChannel(a.onReportChanged,{explorationContentChanged:!1}),this.publishSaveReportCompleted(r,t,i),o.resolve(),this.hideSaveMask()},o.prototype.onSaveFailure=function(e,r,o,i,a){var n=a&&401===a.httpStatusCode?"ReportEmbed_ErrorDialogHelperText_Permissions":"ErrorDialogHelperText";this.showModalError(a,this.services.localizationService.get("ExplorationContainer_FailedToSaveReport"),"ExplorationContainer_FailedToSaveReportDefaultDetails",this.services.localizationService.get(n)),o.reject(t.HostCommunicationHelper.prepareEmbedTelemetryErrorDetails(s.ErrorCodes.saveReportFailed,a?a.error:null,a?a.httpStatusCode:null));var l=t.HostCommunicationHelper.buildErrorObjectFromResult(a,s.ErrorCodes.saveReportFailed,s.ErrorMessages.saveExplorationFailed,d.Warning);return this.publishSaveReportCompleted(e,r,i,l),this.hideSaveMask(),l},o.prototype.synchronizeExplorationIds=function(e,t){t.id=e.id,t.reportId=e.reportId,r.SectionUtils.synchronizeSectionsIds(e.sections,t.sections)},o.prototype.showSaveMask=function(){this.explorationContainer.viewModel.showMask=!0},o.prototype.hideSaveMask=function(){this.explorationContainer.viewModel.showMask=!1},o.prototype.showModalError=function(e,r,t,o){this.services.errorService.error(r,t,{requestId:e?e.requestId:void 0,customErrorDialogHelperText:o,level:d.Warning},null,"PowerBI")},o.prototype.onReportSave=function(e){e.error?this.services.embedRouter.postError("reports",e.error):this.services.embedRouter.postEvent("/reports/"+this.requestId+"/events/saved",e)},o.prototype.onSaveDialogRequested=function(){this.services.embedRouter.postEvent("/reports/"+this.requestId+"/events/saveAsTriggered",{})},o.prototype.validateSaveAsParameters=function(r){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return[4,this.PowerBIModelsModule];case 1:return e=t.sent(),[2,e.validateSaveAsParameters(r)]}}))}))},o.prototype.onReportChanged=function(e){var r=this.services.reportEmbedState.isEditing;this.services.checkUnsavedService.setReportSavedState(e&&r)},Object.defineProperty(o.prototype,"requestId",{get:function(){return this.services.embedRouter.requestId},enumerable:!0,configurable:!0}),o})()})(o=t.mixins||(t.mixins={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(t){var o;!(function(o){var i=e.explore.contracts.Bookmark,a=e.explore.reportembed.constants,s=jsCommon.TraceType;o.BookmarksMessageProxyMixinFactory={ng:["apiGateway","embedMessageProxyService","embedModeService","embedRouter","moduleLoader","reportEmbedState","sdkModelsConverter","telemetryService","mixinCommunicationService"],scoped:["eventBridge","lazyScoped"],fn:function(e){return new n(e)}};var n=(function(){function o(e){var r=this;this.services=e,e.mixinCommunicationService.bookmarks={applyBookmarks:function(e,t){return r.init(e,t)}}}return o.prototype.update=function(r){return __awaiter(this,void 0,e.Promise,(function(){var e=this;return __generator(this,(function(t){return this.PowerBIModelsModule=this.services.moduleLoader.require({javascript:"powerbi-models"}),this.setEventListeners(),r.extensions.bookmark={init:function(r,t){return e.init(r,t)},afterInit:function(r){return e.afterInit()}},this.services.embedRouter.setupBlock(this),[2]}))}))},o.prototype.init=function(r,o){return __awaiter(this,void 0,e.PbiPromise,(function(){var e,n,d,l,c,p;return __generator(this,(function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),e=this.services.sdkModelsConverter.getBookmark(this.services.reportEmbedState.bookmark,r),!e||i.isBookmarkGroup(e)?[2]:(e.options=e.options||{},e.options.suppressActiveSection=!!o,n={bookmark:e,resolution:2},[4,this.getBookmarkOnLoadService()]);case 1:return d=u.sent(),l=this,[4,d.applyBookmarkOnLoad(n,r)];case 2:return l.initialLoadImpact=u.sent(),[2,this.initialLoadImpact];case 3:return c=u.sent(),p=t.HostCommunicationHelper.createError(a.ErrorCodes.applyBookmarkFailed,c,{level:s.Error}),this.services.embedMessageProxyService.postError(p),[3,4];case 4:return[2]}}))}))},o.prototype.afterInit=function(){return this.initialLoadImpact},o.prototype.setEventListeners=function(){var e=this;this.services.eventBridge.createChannelSubscriptionManager().subscribe(r.services.events.bookmarkApplied,(function(r,t){return e.onBookmarkApplied(t)}))},o.prototype.onBookmarkApplied=function(r){this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKBookmarkApplied,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),this.services.embedRouter.postEvent("/reports/"+this.requestId+"/events/bookmarkApplied",r)},o.prototype.setupRoutes=function(r){var o=this;r.get("/report/bookmarks",this.services.apiGateway.blockAppTokenAndP2W((function(r,t){return __awaiter(o,void 0,e.Promise,(function(){var r,o,i=this;return __generator(this,(function(s){switch(s.label){case 0:return[4,this.getBookmarkService()];case 1:return r=s.sent(),o=_.map(r.bookmarks,(function(e){return i.services.sdkModelsConverter.getSdkBookmark(e)})),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKGetBookmarks,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,t.send(a.StatusCodes.OK,o)]}}))}))}))),r.post("/report/bookmarks/applyByName",this.services.apiGateway.blockAppTokenAndP2W((function(r,i){return __awaiter(o,void 0,e.Promise,(function(){var o,n,d,l,c,p,l;return __generator(this,(function(u){switch(u.label){case 0:return o=r.body,[4,this.PowerBIModelsModule];case 1:return n=u.sent(),d=n.validateApplyBookmarkByNameRequest(o),d?(l=t.HostCommunicationHelper.createError(a.ErrorCodes.applyBookmarkFailed,a.ErrorMessages.invalidBookmarkRequest,{level:s.Error}),[2,i.send(a.StatusCodes.BadRequest,l)]):[4,this.getBookmarkService()];case 2:return c=u.sent(),[4,c.applyByName(o.name)];case 3:return(p=u.sent())?(this.services.reportEmbedState.loadCachedData=!1,this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKApplyBookmarkByName,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,i.send(a.StatusCodes.OK)]):(l=t.HostCommunicationHelper.createError(a.ErrorCodes.applyBookmarkFailed,a.ErrorMessages.bookmarkNotFound,{level:s.Error}),[2,i.send(a.StatusCodes.BadRequest,l)])}}))}))}))),r.post("/report/bookmarks/applyState",this.services.apiGateway.blockAppTokenAndP2W((function(r,i){return __awaiter(o,void 0,e.Promise,(function(){var o,n,d,l,c,l,p,u;return __generator(this,(function(m){switch(m.label){case 0:return o=r.body,[4,this.PowerBIModelsModule];case 1:return n=m.sent(),(d=n.validateApplyBookmarkStateRequest(o))?(l=t.HostCommunicationHelper.createError(a.ErrorCodes.applyBookmarkFailed,a.ErrorMessages.invalidBookmarkRequest,{level:s.Error}),[2,i.send(a.StatusCodes.BadRequest,l)]):(c=this.services.sdkModelsConverter.getBookmarkFromBase64State(o.state),c?[4,this.getBookmarkService()]:(l=t.HostCommunicationHelper.createError(a.ErrorCodes.applyBookmarkFailed,a.ErrorMessages.invalidBookmarkState,{level:s.Error}),[2,i.send(a.StatusCodes.BadRequest,l)]));case 2:return p=m.sent(),[4,p.create(c.displayName,c.explorationState,c.options)];case 3:return u=m.sent(),[4,p.applyBookmark(u)];case 4:return m.sent(),this.services.reportEmbedState.loadCachedData=!1,this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKApplyBookmarkState,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,this.createBookmarkResponse(i,u)]}}))}))}))),r.post("/report/bookmarks/add",this.services.apiGateway.blockAppTokenAndP2W((function(r,i){return __awaiter(o,void 0,e.Promise,(function(){var o,n,d,l,c,p,u,l,m,v;return __generator(this,(function(y){switch(y.label){case 0:return o=r.body,[4,this.PowerBIModelsModule];case 1:if(n=y.sent(),d=n.validateAddBookmarkRequest(o))return l=t.HostCommunicationHelper.createError(a.ErrorCodes.addBookmarkFailed,a.ErrorMessages.invalidBookmarkRequest,{level:s.Error}),[2,i.send(a.StatusCodes.BadRequest,l)];if(o.state){if(u=this.services.sdkModelsConverter.getBookmarkFromBase64State(o.state),!u)return l=t.HostCommunicationHelper.createError(a.ErrorCodes.addBookmarkFailed,a.ErrorMessages.invalidBookmarkState,{level:s.Error}),[2,i.send(a.StatusCodes.BadRequest,l)];c=u.explorationState,p=u.options}return[4,this.getBookmarkService()];case 2:return m=y.sent(),[4,m.add(o.displayName,c,p,o.apply)];case 3:return v=y.sent(),o.apply&&(this.services.reportEmbedState.loadCachedData=!1),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKAddBookmark,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,this.createBookmarkResponse(i,v)]}}))}))}))),r.post("/report/bookmarks/capture",this.services.apiGateway.blockAppTokenAndP2W((function(r,t){return __awaiter(o,void 0,e.Promise,(function(){var r,o;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.getBookmarkService()];case 1:return r=i.sent(),[4,r.create()];case 2:return o=i.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKCaptureBookmark,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,this.createBookmarkResponse(t,o)]}}))}))}))),r.post("/report/bookmarks/play",this.services.apiGateway.blockAppTokenAndP2W((function(r,i){return __awaiter(o,void 0,e.Promise,(function(){var o,n,d,l,c,p;return __generator(this,(function(u){switch(u.label){case 0:return o=r.body,[4,this.PowerBIModelsModule];case 1:return n=u.sent(),(d=n.validatePlayBookmarkRequest(o))?(l=t.HostCommunicationHelper.createError(a.ErrorCodes.playBookmarkFailed,a.ErrorMessages.invalidBookmarkRequest,{level:s.Error}),[2,i.send(a.StatusCodes.BadRequest,l)]):(c=o.playMode===n.BookmarksPlayMode.Presentation,[4,this.getBookmarkService()]);case 2:return p=u.sent(),p.setPlayMode(c),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKPlayBookmarks,o.playMode,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,i.send(a.StatusCodes.OK)]}}))}))})))},o.prototype.getBookmarkService=function(){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.services.lazyScoped("bookmark")];case 1:return[2,e.sent()]}}))}))},o.prototype.getBookmarkOnLoadService=function(){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.services.lazyScoped("bookmarkOnLoad")];case 1:return[2,e.sent()]}}))}))},o.prototype.createBookmarkResponse=function(e,r){var t=this.services.sdkModelsConverter.getSdkBookmark(r);e.send(a.StatusCodes.OK,t)},Object.defineProperty(o.prototype,"requestId",{get:function(){return this.services.embedRouter.requestId},enumerable:!0,configurable:!0}),o})()})(o=t.mixins||(t.mixins={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(t){var o=e.explore.reportembed.constants.ErrorCodes,i=e.explore.reportembed.constants.ErrorMessages,a=e.explore.reportembed.constants.ExportDataErrorMessages,s=e.explore.reportembed.constants.StatusCodes,n=jsCommon.StringExtensions,d=jsCommon.TraceType;t.ExportDataMessageProxyMixinFactory={ng:["apiGateway","conceptualSchemaProxy","embedModeService","embedRouter","moduleLoader","reportEmbedState","promiseFactory","telemetryService"],scoped:["lazyScoped","filterGenerator","drillToDetails","visualPluginOps"],fn:function(e){return new l(e)}};var l=(function(){function t(e){this.services=e}return t.prototype.update=function(r){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){return this.explorationContainer=r,
this.PowerBIModelsModule=this.services.moduleLoader.require({javascript:"powerbi-models"}),this.services.embedRouter.setupBlock(this),[2]}))}))},t.prototype.setupRoutes=function(r){var t=this;r.post("/report/pages/:pageName/visuals/:visualName/exportData",this.services.apiGateway.blockAppTokenAndP2W((function(r,o){return __awaiter(t,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.validateExportToCsvRequest(r,o)];case 1:return e.sent()?[4,this.exportToCsv(r,o)]:[3,3];case 2:return[2,e.sent()];case 3:return[2]}}))}))})))},t.prototype.validateExportToCsvRequest=function(t,n){return __awaiter(this,void 0,e.Promise,(function(){var l,c,p,u,m,p,p;return __generator(this,(function(v){switch(v.label){case 0:return v.trys.push([0,2,,3]),[4,this.PowerBIModelsModule];case 1:return l=v.sent(),c=l.validateExportDataRequest(t.body),c?(p=r.HostCommunicationHelper.createError(o.exportDataFailed,a.invalidRequest,{level:d.Error}),n.send(s.BadRequest,p),[2,!1]):[3,3];case 2:return u=v.sent(),[3,3];case 3:return m=r.ExplorationHelper.getPageIndexByName(t.params.pageName,this.explorationViewModel.contract),m<0?(this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription(),o.pageNotFound),p=r.HostCommunicationHelper.buildPageNotFoundErrorMessage(t.params.pageName),n.send(s.BadRequest,p),[2]):m!==this.explorationViewModel.contract.activeSectionIndex?(this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription(),o.pageNotActive),p=r.HostCommunicationHelper.createError(o.exportDataFailed,i.pageNotActive,{level:d.Error}),n.send(s.BadRequest,p),[2]):[2,!0]}}))}))},t.prototype.exportToCsv=function(t,n){return __awaiter(this,void 0,e.Promise,(function(){var l,c,p,c,u,m,v,y,g,b,E,f,h=this;return __generator(this,(function(S){switch(S.label){case 0:return l=this.getRowsLimit(t.body),l<=0?(c=r.HostCommunicationHelper.createError(o.exportDataFailed,a.invalidRequest,{level:d.Error}),n.send(s.BadRequest,c),[2]):(p=r.ExplorationHelper.getVisualContainerViewModel(this.explorationViewModel,t.params.visualName),p?this.canExportData(p)?[4,this.getConceptualSchema()]:(u=r.HostCommunicationHelper.createError(o.exportDataFailed,a.notSupportedForVisual,{level:d.Error}),n.send(s.BadRequest,u),[2]):(this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription(),o.visualNotFound),c=r.HostCommunicationHelper.buildVisualNotFoundErrorMessage(t.params.visualName,t.params.pageName),n.send(s.BadRequest,c),[2]));case 1:return(m=S.sent())?(y=this.exploration.dataSources,g=p.visualTitle?p.visualTitle.text:null,[4,this.PowerBIModelsModule]):(v=r.HostCommunicationHelper.createError(o.exportDataFailed,i.failedGettingSchema,{level:d.Error}),n.send(s.InternalServerError,v),[2]);case 2:return b=S.sent(),E=t.body&&t.body.exportDataType,f=E===b.ExportDataType.Underlying?this.exportUnderlyingDataToCsv(p,m,g,y,l):this.exportSummarizedDataToCsv(p,m,g,y,l),[4,f.then((function(e){h.sendExportDataResponse(n,e)}),(function(e){h.sendExportDataErrorResponse(n,e)}))];case 3:return[2,S.sent()]}}))}))},t.prototype.exportSummarizedDataToCsv=function(r,t,o,i,a){return __awaiter(this,void 0,e.Promise,(function(){var e,s,n,d;return __generator(this,(function(l){switch(l.label){case 0:return[4,r.hostServices.getFilters(this.services.filterGenerator,t)];case 1:return e=l.sent(),s=r.contract.config.singleVisual,n=r.getRunningVisual(),[4,this.services.lazyScoped("exportVisualData")];case 2:return d=l.sent(),[4,d.exportToCsv(o,{data:n&&n.getData(),dataTransforms:n&&n.getDataTransforms()},i,s,e,a)];case 3:return[2,l.sent()]}}))}))},t.prototype.exportUnderlyingDataToCsv=function(r,t,o,i,a){return __awaiter(this,void 0,e.Promise,(function(){var e,s,n,d,l,c;return __generator(this,(function(p){switch(p.label){case 0:return e=r.contract.config.singleVisual,s=this.services.drillToDetails,n=s.getDetailsTableTargetMeasures(e),d=s.generateDetailsTable(e,t,n),d?[4,r.hostServices.getFilters(this.services.filterGenerator,t)]:[2,this.services.promiseFactory.reject({blob:null,error:4})];case 1:return l=p.sent(),[4,this.services.lazyScoped("exportVisualData")];case 2:return c=p.sent(),[4,c.exportToCsv(o,null,i,d,l,a)];case 3:return[2,p.sent()]}}))}))},t.prototype.canExportData=function(e){var r=!1,t=e.showWatermark,o=e.contract&&e.contract.config,i=o&&o.singleVisual&&o.singleVisual.visualType;return jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(i)||(r=this.services.visualPluginOps.isQueryVisual(i)),!t&&r},t.prototype.getRowsLimit=function(e){return e&&e.rows?Math.min(e.rows,r.constants.ExportDataLimits.maxRowsLimit):r.constants.ExportDataLimits.maxRowsLimit},t.prototype.sendExportDataErrorResponse=function(t,i){var l=i&&i.errorDetails&&i.errorDetails.errorType?n.format("ExportDataError. error type: {0}",i.errorDetails.errorType.toString()):"ExportDataError";if(this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription(),l),!i||!i.errorDetails){var c=r.HostCommunicationHelper.createError(o.exportDataFailed,a.generalFailure,{level:d.Error});return t.send(s.InternalServerError,c)}var p=a.generalFailure,u=s.InternalServerError;switch(i.errorDetails.errorType){case 4:p=a.generateDetailsTable;break;case 5:p=a.generateFiltersDescription;break;case 1:u=s.BadRequest,p=a.noData;break;case 2:p=a.queryError;break;case 3:p=a.schemaLoadingError;break;case 6:p=a.columnNameCannotBeEmpty}var m=r.HostCommunicationHelper.createError(o.exportDataFailed,p,{level:d.Error});return t.send(u,m)},t.prototype.sendExportDataResponse=function(r,t){return t.errorDetails?void this.sendExportDataErrorResponse(r,t):(this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKExportData,t.isPartialResult,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),void r.send(s.OK,{data:t.blob}))},t.prototype.getConceptualSchema=function(){if(!this.exploration)return this.services.promiseFactory.reject();var e=this.exploration.dataSources;return this.services.conceptualSchemaProxy.get(e)},Object.defineProperty(t.prototype,"explorationViewModel",{get:function(){return this.explorationContainer&&this.explorationContainer.viewModel&&this.explorationContainer.viewModel.exploration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exploration",{get:function(){return this.explorationViewModel.contract},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestId",{get:function(){return this.services.embedRouter.requestId},enumerable:!0,configurable:!0}),t})()})(t=r.mixins||(r.mixins={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(t){var o=e.explore.reportembed.constants;t.FiltersMessageProxyMixinFactory={ng:["apiGateway","embedModeService","embedRouter","moduleLoader","lazyProviderModern","reportEmbedState","promiseFactory","telemetryService"],scoped:[],fn:function(e){return new i(e)}};var i=(function(){function t(e){this.services=e}return t.prototype.update=function(r){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){return this.explorationContainer=r,this.PowerBIModelsModule=this.services.moduleLoader.require({javascript:"powerbi-models"}),this.services.embedRouter.setupBlock(this),[2]}))}))},t.prototype.setupRoutes=function(r){var t=this;r.put("/report/filters",this.services.apiGateway.blockP2W((function(r,i){return __awaiter(t,void 0,e.Promise,(function(){var t,a,s,n;return __generator(this,(function(d){switch(d.label){case 0:return this.services.reportEmbedState.loadCachedData=!1,t=r.body,[4,this.validateFilters(t)];case 1:if(a=d.sent())return[2,i.send(o.StatusCodes.BadRequest,a)];d.label=2;case 2:return d.trys.push([2,5,,6]),[4,this.getReportEmbedFilterService()];case 3:return s=d.sent(),[4,s.setFilters(t)];case 4:return d.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKSetReportLevelFilters,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,i.send(o.StatusCodes.Accepted)];case 5:return n=d.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription(),n.message),[2,i.send(o.StatusCodes.BadRequest,n)];case 6:return[2]}}))}))}))),r.get("/report/filters",this.services.apiGateway.blockP2W((function(r,i){return __awaiter(t,void 0,void 0,(function(){var r,t;return __generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,this.getReportEmbedFilterService()];case 1:return[4,a.sent().getFilters()];case 2:return r=a.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKGetReportLevelFilters,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,i.send(o.StatusCodes.OK,r)];case 3:return t=a.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription(),t.message),[2,i.send(o.StatusCodes.BadRequest,t)];case 4:return[2]}}))}))}))),r.put("/report/pages/:pageName/filters",this.services.apiGateway.blockP2W((function(r,i){return __awaiter(t,void 0,e.Promise,(function(){var t,a,s,n,d,l;return __generator(this,(function(c){switch(c.label){case 0:return this.services.reportEmbedState.loadCachedData=!1,t=r.params.pageName,a=r.body,s={name:t},n=this.validatePageLevel(s),n?[2,i.send(o.StatusCodes.BadRequest,n)]:[4,this.validateFilters(a)];case 1:if(d=c.sent())return[2,i.send(o.StatusCodes.BadRequest,d)];c.label=2;case 2:return c.trys.push([2,5,,6]),[4,this.getReportEmbedFilterService()];case 3:return[4,c.sent().setFilters(a,s)];case 4:return c.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKSetPageLevelFilters,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,i.send(o.StatusCodes.Accepted)];case 5:return l=c.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription(),l.message),[2,i.send(o.StatusCodes.BadRequest,l)];case 6:return[2]}}))}))}))),r.get("/report/pages/:pageName/filters",this.services.apiGateway.blockP2W((function(r,i){return __awaiter(t,void 0,void 0,(function(){var t,a,s,n,d;return __generator(this,(function(l){switch(l.label){case 0:if(t=r.params.pageName,a={name:t},s=this.validatePageLevel(a))return[2,i.send(o.StatusCodes.BadRequest,s)];l.label=1;case 1:return l.trys.push([1,4,,5]),[4,this.getReportEmbedFilterService()];case 2:return[4,l.sent().getFilters(a)];case 3:return n=l.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKGetPageLevelFilters,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,i.send(o.StatusCodes.OK,n)];case 4:return d=l.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription(),d.message),[2,i.send(o.StatusCodes.BadRequest,d)];case 5:return[2]}}))}))}))),r.put("/report/pages/:pageName/visuals/:visualName/filters",this.services.apiGateway.blockP2W((function(r,i){return __awaiter(t,void 0,e.Promise,(function(){var t,a,s,n,d,l,c;return __generator(this,(function(p){switch(p.label){case 0:return this.services.reportEmbedState.loadCachedData=!1,t=r.params.pageName,a=r.params.visualName,s=r.body,n={visualName:a,pageName:t},d=this.validateVisualLevel(n),d?[2,i.send(o.StatusCodes.BadRequest,d)]:[4,this.validateFilters(s)];case 1:if(l=p.sent())return[2,i.send(o.StatusCodes.BadRequest,l)];p.label=2;case 2:return p.trys.push([2,5,,6]),[4,this.getReportEmbedFilterService()];case 3:return[4,p.sent().setFilters(s,n)];case 4:return p.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKSetVisualLevelFilters,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,i.send(o.StatusCodes.Accepted)];case 5:return c=p.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription(),c.message),[2,i.send(o.StatusCodes.BadRequest,c)];case 6:return[2]}}))}))}))),r.get("/report/pages/:pageName/visuals/:visualName/filters",this.services.apiGateway.blockP2W((function(r,i){return __awaiter(t,void 0,void 0,(function(){var t,a,s,n,d,l,c;return __generator(this,(function(p){switch(p.label){case 0:if(t=r.params.pageName,a=r.params.visualName,s={visualName:a,pageName:t},n=this.validateVisualLevel(s))return[2,i.send(o.StatusCodes.BadRequest,n)];p.label=1;case 1:return p.trys.push([1,4,,5]),[4,this.getReportEmbedFilterService()];case 2:return d=p.sent(),[4,d.getFilters(s)];case 3:return l=p.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKGetVisualLevelFilters,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,i.send(o.StatusCodes.OK,l)];case 4:return c=p.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription(),c.message),[2,i.send(o.StatusCodes.BadRequest,c)];case 5:return[2]}}))}))})))},t.prototype.validateFilters=function(r){return __awaiter(this,void 0,e.Promise,(function(){var e,t,o,i,a,s;return __generator(this,(function(n){switch(n.label){case 0:return[4,this.PowerBIModelsModule];case 1:for(t=n.sent(),o=0,i=r;o<i.length;o++)a=i[o],s=t.validateFilter(a),s&&(e=e||[],e=e.concat(s));return[2,e]}}))}))},t.prototype.validatePageLevel=function(e){var t;return r.ExplorationHelper.isPageExists(e.name,this.exploration)||(t=[],t.push({message:o.ErrorMessages.invalidPageName})),t},t.prototype.validateVisualLevel=function(e){return r.ExplorationHelper.isPageExists(e.pageName,this.exploration)?r.ExplorationHelper.isVisualExists(e.pageName,e.visualName,this.exploration)?null:[{message:o.ErrorMessages.invalidVisualName}]:[{message:o.ErrorMessages.invalidPageName}]},Object.defineProperty(t.prototype,"exploration",{get:function(){return this.explorationContainer.viewModel.exploration.contract},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestId",{get:function(){return this.services.embedRouter.requestId},enumerable:!0,configurable:!0}),t.prototype.getReportEmbedFilterService=function(){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(r){switch(r.label){case 0:return this.reportEmbedFilterService?[3,2]:(e=this,[4,this.services.lazyProviderModern.get("@powerbi/ReportEmbed/modules/filters/filter.module#FilterServiceModule","reportEmbedFilterService")]);case 1:e.reportEmbedFilterService=r.sent(),r.label=2;case 2:return[2,this.reportEmbedFilterService]}}))}))},t})()})(t=r.mixins||(r.mixins={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(r){r.InitializeReportMixinFactory={ng:[],scoped:["viewModeState"],fn:function(e){return new t(e)}};var t=(function(){function r(e){this.services=e}return r.prototype.update=function(r){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){return this.services.viewModeState.updateConfig((function(e){e.printProperties.containerPixelPadding=0})),[2]}))}))},r})()})(t=r.mixins||(r.mixins={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(t){var o;!(function(o){var i=e.explore.services.events,a=e.explore.reportembed.constants,s=jsCommon.TraceType;o.InteractivityMessageProxyMixinFactory={ng:["apiGateway","conceptualSchemaProxy","embedModeService","embedRouter","featureSwitchService","moduleLoader","reportEmbedState","telemetryService","lazyProviderModern","promiseFactory","mixinCommunicationService"],scoped:["eventBridge","explorationCapabilities","lazyScoped"],fn:function(e){return new n(e)}};var n=(function(){function o(e){var r=this;this.services=e,this.services.mixinCommunicationService.viewMode={changeViewMode:function(e){return r.changeViewMode(e)}}}return o.prototype.update=function(e){this.explorationContainer=e,this.services.embedRouter.setupBlock(this),this.setEventListeners()},Object.defineProperty(o.prototype,"exploration",{get:function(){return this.explorationContainer.viewModel.exploration.contract},enumerable:!0,configurable:!0}),o.prototype.setEventListeners=function(){var e=this;this.services.eventBridge.createChannelSubscriptionManager().subscribe(r.services.events.sectionChanged,(function(r,t){return e.onSectionChange(t)})).subscribe(r.services.events.dataPointsSelected,(function(r,t){return e.onDataPointsSelection(t)})).subscribe(r.services.events.dataHyperlinkClicked,(function(r,t){return e.onHyperlinkClicked(t)})).subscribe(r.services.events.visualCustomCommand,(function(r,t){return e.onVisualCustomCommand(t)})).subscribe(r.services.events.visualLinkButtonClicked,(function(r,t){return e.onVisualButtonClicked(t)}))},o.prototype.setupRoutes=function(r){var t=this;r.post("/report/switchMode/:viewMode",this.services.apiGateway.blockP2W((function(r,o){return __awaiter(t,void 0,e.Promise,(function(){var t,i,s;return __generator(this,(function(n){switch(n.label){case 0:return t=r.params.viewMode,null==t||"edit"!==t.toLowerCase()&&"view"!==t.toLowerCase()?[2,o.send(a.StatusCodes.BadRequest,a.ErrorMessages.invalidViewMode)]:(i="edit"===t.toLowerCase(),[4,this.changeViewMode(i)]);case 1:return s=n.sent(),s?(this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,this.services.embedRouter.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,o.send(a.StatusCodes.BadRequest,s)]):(this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKChangeViewMode,this.services.embedRouter.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,o.send(a.StatusCodes.OK)])}}))}))})))},o.prototype.changeViewMode=function(r){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(o){return this.exploration?this.services.embedModeService.isAnonymousLiveEmbed()?e=t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage():r&&1===this.services.reportEmbedState.report.permissions?e=t.HostCommunicationHelper.createError(a.ErrorCodes.insufficientPermissions,a.ErrorMessages.insufficientPermissions,{level:s.Error}):r&&this.services.embedModeService.isMobile()?e=t.HostCommunicationHelper.createError(a.ErrorCodes.insufficientPermissions,a.ErrorMessages.mobileLayoutPermissionNotSupported,{level:s.Error}):this.services.reportEmbedState.isEditing!==r&&(this.services.reportEmbedState.isEditing=r,this.updateSettings({filterPaneEnabled:this.services.reportEmbedState.currentSettings.filterPaneEnabled,navContentPaneEnabled:this.services.reportEmbedState.currentSettings.navContentPaneEnabled}),this.services.eventBridge.publishToChannel(i.requestViewModeChange,r?1:0)):e=t.HostCommunicationHelper.createError(a.ErrorCodes.noExploration,a.ErrorMessages.changeViewModeFailed,{level:s.Error}),[2,e]}))}))},o.prototype.updateSettings=function(e){var r=this.services.explorationCapabilities.getCapabilities(),t=this.services.reportEmbedState.currentSettings;t.filterPaneEnabled=null!=e.filterPaneEnabled?e.filterPaneEnabled:t.filterPaneEnabled,t.navContentPaneEnabled=null!=e.navContentPaneEnabled?e.navContentPaneEnabled:t.navContentPaneEnabled,this.services.reportEmbedState.isEditing&&(e.filterPaneEnabled=!0,e.navContentPaneEnabled=!0),r.showVisualizationPane=void 0!==e.filterPaneEnabled?e.filterPaneEnabled:r.showVisualizationPane,r.showNavContentPane=void 0!==e.navContentPaneEnabled?e.navContentPaneEnabled:r.showNavContentPane,r.showAppBar=this.services.reportEmbedState.isEditing,r.disableCustomVisualPluginActions=!0,this.services.explorationCapabilities.setCapabilities(r),_.merge(this.explorationContainer.viewModel.options,r)},o.prototype.onSectionChange=function(e){var r=this.getPageByName(e.name);this.services.embedRouter.postEvent("/reports/"+this.services.embedRouter.requestId+"/events/pageChanged",{initiator:void 0,newPage:r})},o.prototype.onDataPointsSelection=function(r){return __awaiter(this,void 0,e.Promise,(function(){var e,t,o,i,a;return __generator(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,this.services.promiseFactory.all([this.getJsonFilterParser(),this.getConceptualSchema()])];case 1:return e=s.sent(),t=e[0],o=e[1],[4,t.tryGetSelectedDataPoints(this.exploration,o,r.dataPointsDescriptions,r.visualContainer,r.visualTitleText)];case 2:return(i=s.sent())?(this.services.embedRouter.postEvent("/reports/"+this.requestId+"/events/dataSelected",i),[3,4]):[2];case 3:return a=s.sent(),this.services.embedRouter.postError("reports",a),[3,4];case 4:return[2]}}))}))},o.prototype.onHyperlinkClicked=function(r){return __awaiter(this,void 0,e.Promise,(function(){var e,o,e,i;return __generator(this,(function(n){switch(n.label){case 0:return r?[4,this.tryGetSelectedDataPoints(null,r.visualContainer)]:(e=t.HostCommunicationHelper.createError(a.ErrorCodes.failedToExtractHyperlinkData,a.ErrorMessages.failedToExtractHyperlinkClickData,{level:s.Error}),this.services.embedRouter.postError("reports",e),[2]);case 1:return(o=n.sent())?(i={url:r.url,report:o.report,page:o.page,visual:o.visual},this.services.embedRouter.postEvent("/reports/"+this.requestId+"/events/dataHyperlinkClicked",i),[2]):(e=t.HostCommunicationHelper.createError(a.ErrorCodes.failedToExtractHyperlinkData,a.ErrorMessages.failedToExtractHyperlinkClickData,{level:s.Error}),this.services.embedRouter.postError("reports",e),[2])}}))}))},o.prototype.onVisualCustomCommand=function(r){return __awaiter(this,void 0,e.Promise,(function(){var e,o,e,i;return __generator(this,(function(n){switch(n.label){case 0:return r?[4,this.tryGetSelectedDataPoints(r.dataPointsDescriptions,r.visualContainer)]:(e=t.HostCommunicationHelper.createError(a.ErrorCodes.commandFailed,a.ErrorMessages.commandFailed,{level:s.Error}),this.services.embedRouter.postError("reports",e),[2]);case 1:return(o=n.sent())?(i={report:o.report,page:o.page,visual:o.visual,dataPoints:o.dataPoints,command:r.command},this.services.embedRouter.postEvent("/reports/"+this.requestId+"/events/commandTriggered",i),[2]):(e=t.HostCommunicationHelper.createError(a.ErrorCodes.commandFailed,a.ErrorMessages.commandFailed,{level:s.Error}),this.services.embedRouter.postError("reports",e),[2])}}))}))},o.prototype.tryGetSelectedDataPoints=function(r,t){return __awaiter(this,void 0,e.Promise,(function(){var e,o,i,a;return __generator(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,this.services.promiseFactory.all([this.getJsonFilterParser(),this.getConceptualSchema()])];case 1:return e=s.sent(),o=e[0],i=e[1],[4,o.tryGetSelectedDataPoints(this.exploration,i,r,t,null)];case 2:return[2,s.sent()];case 3:return a=s.sent(),this.services.embedRouter.postError("reports",a),[3,4];case 4:return[2]}}))}))},o.prototype.onVisualButtonClicked=function(e){if(!e){var r=t.HostCommunicationHelper.createError(a.ErrorCodes.commandFailed,a.ErrorMessages.commandFailed,{level:s.Error});return void this.services.embedRouter.postError("reports",r)}this.services.embedRouter.postEvent("/reports/"+this.requestId+"/events/buttonClicked",e)},o.prototype.getPageByName=function(e){var r,t=this.exploration&&this.exploration.sections?this.exploration.sections.filter((function(r){return r.name===e})):null;return t&&t.length>0&&(r={name:t[0].name,displayName:t[0].displayName}),r},o.prototype.getConceptualSchema=function(){try{if(!this.exploration)return this.services.promiseFactory.reject();var e=this.exploration.dataSources;return this.services.conceptualSchemaProxy.get(e)}catch(e){throw t.HostCommunicationHelper.buildIErrorFromConceptualSchemaError(e)}},o.prototype.getJsonFilterParser=function(){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(r){switch(r.label){case 0:return this.jsonFilterParser?[3,2]:(e=this,[4,t.JsonFilterHelper.createJsonFilterParser(this.services.promiseFactory,this.services.moduleLoader,this.services.telemetryService,this.services.lazyProviderModern)]);case 1:e.jsonFilterParser=r.sent(),r.label=2;case 2:return[2,this.jsonFilterParser]}}))}))},Object.defineProperty(o.prototype,"requestId",{get:function(){return this.services.embedRouter.requestId},enumerable:!0,configurable:!0}),o})()})(o=t.mixins||(t.mixins={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(r){r.SlicerMessageProxyMixinFactory={ng:["apiGateway","embedRouter","reportEmbedState","lazyProviderModern"],scoped:[],fn:function(e){return new t(e)}};var t=(function(){function r(e){this.services=e}return r.prototype.update=function(e){var r=this;this.explorationContainer=e,e.extensions.slicers={init:function(e){return r.init(e)}},this.services.embedRouter.setupBlock(this)},r.prototype.setupRoutes=function(r){var t=this;r.put("/report/pages/:pageName/visuals/:visualName/slicer",this.services.apiGateway.blockAppTokenAndP2W((function(r,o){return __awaiter(t,void 0,e.Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return[4,this.getSlicersApiService()];case 1:return e=t.sent(),[4,e.putSlicer(this.explorationContainer,r,o)];case 2:return[2,t.sent()]}}))}))}))),r.get("/report/pages/:pageName/visuals/:visualName/slicer",this.services.apiGateway.blockAppTokenAndP2W((function(r,o){return __awaiter(t,void 0,e.Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return[4,this.getSlicersApiService()];case 1:return e=t.sent(),[4,e.getSlicer(this.explorationContainer,r,o)];case 2:return[2,t.sent()]}}))}))})))},r.prototype.init=function(r){return __awaiter(this,void 0,e.PbiPromise,(function(){var e,t;return __generator(this,(function(o){switch(o.label){case 0:return e=this.services.reportEmbedState.slicers,_.isEmpty(e)?[2]:[4,this.getSlicersApiService()];case 1:return t=o.sent(),[4,t.applySlicers(r,e)];case 2:return[2,o.sent()]}}))}))},r.prototype.getSlicersApiService=function(){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(r){switch(r.label){case 0:return this._reportEmbedSlicersApiService?[3,2]:(e=this,[4,this.services.lazyProviderModern.get("@powerbi/ReportEmbed/modules/slicerApiService/slicer-api.module#SlicersApiServiceModule","reportEmbedSlicersApiService")]);case 1:e._reportEmbedSlicersApiService=r.sent(),r.label=2;case 2:return[2,this._reportEmbedSlicersApiService]}}))}))},r})()})(t=r.mixins||(r.mixins={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t=e.common.perfMarkers,o=e.telemetry,i=jsCommon.QueryStringUtil,a=window,s=window,n=["ui.router","powerbi.common","powerbi.explore","powerbi.connectivity","powerbi.dataServices","powerbi.standaloneCommon","ngSanitize"];a.isMobile&&n.push("powerbi.mobileOptimization");var d=i.getQueryStringValue("isE2ERun")||i.getQueryStringValue("isE2ERun2")||window.DEBUG||a.isMobile,l=8192;angular.module("powerbi.reportembed",n).config(["$compileProvider",function(e){d||e.debugInfoEnabled(!1),e.commentDirectivesEnabled(!1),e.cssClassDirectivesEnabled(!1)}]).config(["$httpProvider",function(e){e.useApplyAsync(!0)}]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(r,t,o){o.html5Mode(!0),a.modernEmbed||(t.otherwise("/reportEmbed"),r.state("reportEmbed",{url:"/reportEmbed?&unmin&reportId",templateUrl:"views/interactiveEmbed.html",reloadOnSearch:!1,controller:"ReportEmbedController",resolve:e.common.helpers.LoadJQueryUI}).state("reportEmbedExportHost",{url:"/reportEmbedExportHost?&unmin&reportId",templateUrl:"views/interactiveEmbed.html",reloadOnSearch:!1,controller:"ReportEmbedController",resolve:e.common.helpers.LoadJQueryUI}).state("embedLive/live/report",{url:"/embedLive/live/report.html?unmin&key",templateUrl:"views/interactiveEmbed.html",reloadOnSearch:!1,controller:"ReportEmbedController",resolve:e.common.helpers.LoadJQueryUI}).state("view",{url:"/view?unmin&key&r",templateUrl:"views/interactiveEmbed.html",reloadOnSearch:!1,controller:"ReportEmbedController",resolve:e.common.helpers.LoadJQueryUI}).state("appTokenReportEmbed",{url:"/appTokenReportEmbed?unmin&reportid",templateUrl:"views/interactiveEmbed.html",reloadOnSearch:!1,controller:"ReportEmbedController"}))}]).config(["pbiLazyLoadProvider",function(e){e.setHostEnv(l)}]).config(["lazyProvider",function(r){var t=r.factories;t.odataFilterParserService={source:{javascript:"ODataFilterParser/services/odataFilterParserService"},ng:["featureSwitchService","telemetryService"],fn:function(e,r,t){return e.create(r,t)}},t.pushAccessHttp={source:{javascript:"Sharing/proxies/pushAccessHttp"},fn:function(r){return r.create(e.common.httpService)}}}]).run(["screenshotEngineCommunicator",function(){}]).run(["lazyScopedFactories",function(r){r.loadProgressNotification={source:{javascript:"PowerBICommon/services/loadProgressNotificationService"},ng:["$timeout","screenshotEngineCommunicator","ngZone","embedMessageProxyService"],scoped:["eventBridge"],fn:function(r,t,o,i,s,n){var d=function(){s.onReportRendered(),o.complete(),n.publishToChannel(e.common.events.printSectionReady)},l=function(){o.cancel()},c=a.isLoadReportForExportPending?1e3:0;return r.create(t,d,l,i,c)}},r.interpretProxy={source:{javascript:"QnaWeb/proxies/interpretHttpProxy"},ng:["$timeout","promiseFactory","impersonationService"],fn:function(r,t,o,i){return r.create(t,o,e.common.httpService,i)}}}]).run(["delayedQueryResultResolver",function(e){e.init()}]).factory("folderServiceLegacy",(function(){return[]})).factory("contentPackService",(function(){return[]})).factory("reportService",(function(){return[]})).factory("dashboardService",(function(){return[]})).factory("workbookService",(function(){return[]})).factory("selectGatewayService",(function(){return[]})).factory("appService",["promiseFactory",function(r){return e.dataServices.createMockAppService(r)}]).factory("geolocationService",e.visuals.services.createGeolocation).run(["$rootScope","telemetryService",function(i,a){for(var n=t.getJsParseTimes(s.parseTimeMarkers),d=performance&&performance.getEntriesByType&&performance.getEntriesByType("resource")||[],l=function(e){var r=_.find(d,(function(r){return r.name.indexOf(e.fileName)>=0}));a.logEvent(o.AppJavaScriptParse,e.fileName,e.startEval,r&&r.duration,e.start,e.end)},c=0,p=n;c<p.length;c++){l(p[c])}e.explore.reportembed.notifyModelsAndExplorationReady=function(e){i.$emit(r.constants.modelsAndExplorationReadyEventName,e)},e.explore.reportembed.notifyConceptualSchemaReady=function(e){i.$emit(r.constants.conceptualSchemaReadyEventName,e)}}]).run(["httpService","localizationService",function(r,t){e.common.httpService=r,e.common.localize=t,e.visuals&&e.explore.services.VisualHostServices.initialize(t);
}]).run(["mixinScopedFactories",function(t){t.explorationContainer=[e.common.ScopedRootRegistrarMixinFactory,e.mixins.ExportDataMixinFactory,e.mixins.ErrorNotificationMixinFactory,r.mixins.BookmarksMessageProxyMixinFactory,r.mixins.ExplorationEmbedStateProxyFactory,r.mixins.ExportDataMessageProxyMixinFactory,r.mixins.FiltersMessageProxyMixinFactory,r.mixins.InitializeReportMixinFactory,r.mixins.InteractivityMessageProxyMixinFactory,r.mixins.ReportAuthoringMixinFactory,r.mixins.RefreshMessageProxyMixinFactory,r.mixins.ScopedServicesMixinFactory,r.mixins.SlicerMessageProxyMixinFactory,r.mixins.ThemeMixinFactory,r.mixins.VisualPropertiesMixinFactory,r.mixins.VisualsAuthoringMessageProxyMixinFactory,r.mixins.VisualCapabilitiesMixinFactory],t.explorationAppBar=[e.mixins.FileOperationsAppBarMixinFactory,e.mixins.DropdownMenuMixinFactory]}]).run(["printService",function(){}]).controller("ReportEmbedController",["$rootScope","promiseFactory","embedConceptualSchemaProxy","embedExplorationCapabilities","embedModeService","embedMessageProxyService","embedRouter","embedTelemetry","errorService","embedScopedServices","explorationSerializer","globalEventBridge","modelConverter","syncService","telemetryService","telemetryHostService","refreshTokenHandler","localizationService","reportEmbedState","reportEmbedExplorationService","embedModelService","activeFolderId","clusterResolverService","scopedProvider","moduleLoader","modalDialogService","packageStore","lazyProviderLegacy","featureSwitchService","focusTracker","sdkModelsConverter","lazyProviderModern","embedSettingsService","embedTokenService","legacyScopeService","mixinCommunicationService","embedMwcConnectionService","pageVisibilityService","screenshotEngineCommunicator",function(e,t,o,i,a,s,n,d,l,c,p,u,m,v,y,g,b,E,f,h,S,C,I,F,R,T,D,P,A,M,V,w,N,x,L,k,K,B,_){F.attachTo(e);var U={activeFolderIdService:C,clusterResolverService:I,embedConceptualSchemaProxy:o,embedExplorationCapabilities:i,embedMessageProxyService:s,embedModeService:a,embedTelemetry:d,errorService:l,explorationSerializer:p,globalEventBridge:u,lazyProviderLegacy:P,localizationService:E,modalDialogService:T,modelConverter:m,moduleLoader:R,packageStore:D,promiseFactory:t,reportEmbedExplorationService:h,embedModelService:S,reportEmbedState:f,scopedServices:c,syncService:v,telemetryService:y,telemetryHostService:g,refreshTokenHandler:b,featureSwitchService:A,focusTracker:M,sdkModelsConverter:V,lazyProviderModern:w,embedRouter:n,embedSettingsService:N,embedTokenService:x,legacyScopeService:L,mixinCommunicationService:k,embedMwcConnectionService:K,pageVisibilityService:B,screenshotEngineCommunicator:_};return new r.controllers.ReportEmbedController(e,U)}]),a.isMobile&&(e.mobileOptimization.doubleClick.plugin.register(),e.mobileOptimization.swipeable.plugin.register(),e.mobileOptimization.initialize()),e.common.registerPBICommonBuildingBlocksForHost(l),e.visualHost.registerBuildingBlocksForHost(l),e.explore.registerBuildingBlocksForHost(l),e.explore.exploration.registerBuildingBlocksForHost(l)})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={})),angular.module("powerbi.reportembed").run(["$templateCache",function(e){e.put("views/interactiveEmbed.html",'<pbi-lazy-load-modern ng-if="optimizePublishToWeb && checkForResourceKey()" [module-path]="reportThumbnailModulePath" [component-id]="\'ReportThumbnailComponentId\'" [input-args]="reportThumbnailInputArgs"></pbi-lazy-load-modern><auto-auth ng-if="showPromptForLogin"></auto-auth><request-access ng-if="isUserUnauthorized"></request-access><div><div id="embedWrapperID" class="embedWrapper" tabindex="0" ng-keydown="keyDown($event)" localize-attr="{\'aria-label\': \'Embed_Wrapper_Hint\'}"><div ng-if="!showErrorMessage && !showPromptForLogin && !optimizePublishToWeb && !isUserUnauthorized" class="landingController fillAvailableSpace"><div class="landingContainer"><div id="reportLandingContainer" class="embeddedLandingRootContent reportContainerContent isActive embeddedPV" ng-class="backgroundCssClass + (showLogoBar ? \' embeddedLandingRootContentLogoVisible\' : \' embeddedLandingRootContentLogoHidden\')"><div class="embeddedPV"><exploration-container [use-legacy]="useLegacyExplorationContainer()" [view-model]="exploreContainer" ng-if="exploreContainer" [canvas-options]="canvasOptions" [exploration-container-options]="explorationContainerOptions"></exploration-container></div></div></div></div><div ng-if="showErrorMessage" class="embedError" ng-class="showLogoBar ? \'embeddedLandingRootContentLogoVisible\' : \'embeddedLandingRootContentLogoHidden\'"><span ng-bind="errorMessage" class="errorText"/><br/><a target="_blank" ng-href="{{errorLink}}"><span localize="PowerBI_Learn_More_Message" class="errorText"></span></a></div></div><div class="logoBarWrapper" ng-keydown="keyDown($event)" tabindex="0"><logo-bar ng-if="showLogoBar"></logo-bar></div></div>')}]);var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t=e.data.SQConstantExpr,o=e.data.SQExpr,i=e.data.SQExprBuilder,a=(function(){function r(){}return r.getColorValue=function(e){var r=e&&e.solid&&e.solid.color;if(o.isThemeDataColor(r)){return{id:r.colorId,shade:r.percent}}return t.getTextValue(r)},r.colorValueBuilder=function(e){return _.isString(e)?r.buildSolidColorExpr(e):r.buildThemeColorExpr(i.themeDataColor(e.id,e.shade))},r.buildSolidColorExpr=function(e){return jsCommon.Color.isHexString(e)?{solid:{color:i.text(e)}}:void 0},r.buildThemeColorExpr=function(e){return e&&{solid:{color:e}}},r.isValidColor=function(e){return _.isString(e)&&jsCommon.Color.isHexString(e)||r.isThemeColorProperty(e)},r.isThemeColorProperty=function(e){return e&&_.isNumber(e.id)&&_.isNumber(e.shade)},r.buildConstantTextFromNumber=function(e){return i.text(e.toString())},r.getTextValueAsNumber=function(e){var r=t.getTextValue(e);return _.toInteger(r)},r.decodePropertyValue=function(i){var a=i;if(o.isConstant(a)){if(o.isConstantBoolean(a))return t.getBooleanValue(a);if(o.isConstantText(a))return t.getTextValue(a);if(o.isConstantNumeric(a))return t.getNumericValue(a);if(o.isConstantDate(a))return t.getDateValue(a);if(o.isConstantNull(a))return null}else{if(e.StructuralObjectDefinition.isFillDefinition(i))return r.getColorValue(i);if(e.StructuralObjectDefinition.isImageDefinition(i)){var s=i,n={name:t.getTextValue(s.name),url:t.getTextValue(s.url)};return s.scaling&&(n.scaling=t.getTextValue(s.scaling)),n}if(e.StructuralObjectDefinition.isGeoJsonDefinition(i)){var d=i;return{type:t.getTextValue(d.type),name:t.getTextValue(d.name),content:o.isConstantText(d.content)?t.getTextValue(d.content):null}}}},r.verifyValueTypeBeforeEncode=function(r,t,o,i){var a,s=o.objects;if(!(s&&s[r]&&s[r].properties[t]))return!1;a=s[r].properties[t].type;var n=a,d=a;if(n.bool)return _.isBoolean(i);if(n.text||n.scripting&&n.scripting.source)return _.isString(i);if(n.numeric||n.integer)return _.isNumber(i);if(d.fill){var l=i;return _.isString(i)&&jsCommon.Color.isHexString(i)||l.id&&l.shade&&_.isNumber(l.id)&&_.isNumber(l.shade)}return n.formatting?n.formatting.labelDisplayUnits||n.formatting.displayUnitsWithoutAuto?_.isNumber(i):_.isString(i)||null===i:n.enumeration?_.isNumber(i)||_.isString(i)||null===i:n.misc?_.isString(i)||null===i:n.dateTime?_.isDate(i)||null===i:d.image?i.name&&i.url&&_.isString(i.name)&&_.isString(i.url)&&(!i.scaling||_.isString(i.scaling)):d.geoJson?i.name&&i.type&&_.isString(i.name)&&_.isString(i.type)&&(!i.content||_.isString(i.content)):n.reference?(n.reference.bookmark||n.reference.section)&&(_.isString(i)||null===i):d.filter?i instanceof e.data.SemanticFilter:d.paragraphs?e.StructuralObjectDefinition.isParagraphsDefinition(i):!!d.queryTransform&&e.StructuralObjectDefinition.isQueryTransformDefinition(i)},r})();r.ObjectPropertyHelper=a})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(e){var r;!(function(e){var r;!(function(e){e.ExplorationEmbedStateProxyFactory={ng:["reportEmbedState"],fn:function(e){return new r(e)}};var r=(function(){function e(e){this.services=e}return e.prototype.update=function(e){this.services.reportEmbedState.explorationContainer=e},e})()})(r=e.mixins||(e.mixins={}))})(r=e.reportembed||(e.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(r){var t=e.explore.reportembed.constants,o=e.explore.reportembed.errors.ReportEmbedErrors;r.RefreshMessageProxyMixinFactory={ng:["apiGateway","embedModeService","embedRouter","reportEmbedState","telemetryService"],scoped:["reportRefresh"],fn:function(e){return new i(e)}};var i=(function(){function r(e){this.services=e,this.nextAllowedRefreshTime=new Date(1970,1,1).getTime()}return r.prototype.update=function(r){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){return this.services.embedRouter.setupBlock(this),this.setupRefreshTimer(),[2]}))}))},r.prototype.setupRoutes=function(r){var i=this;r.post("/report/refresh",this.services.apiGateway.blockP2W((function(r,a){return __awaiter(i,void 0,e.Promise,(function(){var r,i;return __generator(this,(function(s){return r=t.ThrottlingLimits.refreshFrequencyInSeconds,i=Date.now(),i>this.nextAllowedRefreshTime?(this.refreshReportData(),this.nextAllowedRefreshTime=i+1e3*r,this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKRefreshReport,!1,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),a.send(202)):(a.headers={"Retry-After":Math.ceil((this.nextAllowedRefreshTime-i)/1e3)},this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKRefreshReport,!0,this.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),a.send(429,o.refreshNotAllowed())),[2]}))}))})))},r.prototype.refreshReportData=function(){this.services.reportRefresh.refreshData()},r.prototype.setupRefreshTimer=function(){var e=this;if(this.services.embedModeService.isAnonymousLiveEmbed()){var r=jsCommon.QueryStringUtil.parseQueryString();this.services.reportEmbedState.setRefreshTime(r.refresh),this.services.reportEmbedState.refreshEnabled&&setInterval((function(){return e.refreshReportData()}),60*this.services.reportEmbedState.refreshIntervalInMinutes*1e3)}},Object.defineProperty(r.prototype,"requestId",{get:function(){return this.services.embedRouter.requestId},enumerable:!0,configurable:!0}),r})()})(t=r.mixins||(r.mixins={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(e){var r;!(function(e){var r;!(function(e){e.ScopedServicesMixinFactory={ng:["$scope","scopedProvider","embedScopedServices"],scoped:[],fn:function(e){return new r(e)}};var r=(function(){function e(e){this.services=e}return e.prototype.update=function(e){this.setScopedServicesProvider()},e.prototype.setScopedServicesProvider=function(){var e=this.services.scopedProvider.find(this.services.$scope);this.services.embedScopedServices.setScopedProviderInstance(e)},e})()})(r=e.mixins||(e.mixins={}))})(r=e.reportembed||(e.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(t){var o=jsCommon.TraceType,i=e.PbiPromise,a=e.explore.reportembed.constants.ErrorCodes,s=e.explore.reportembed.constants.ErrorMessages,n=e.explore.services.events.highContrastModeChanged;t.ThemeMixinFactory={ng:["apiGateway","embedRouter","reportEmbedState","lazyProviderModern"],scoped:["eventBridge"],fn:function(e){return new d(e)}};var d=(function(){function t(e){this.services=e}return t.prototype.update=function(e){var r=this;this.explorationContainer=e,e.extensions.theme={init:function(e){return r.init(e)}},this.services.embedRouter.setupBlock(this)},t.prototype.setupRoutes=function(r){var t=this;r.put("/report/theme",this.services.apiGateway.blockAppTokenAndP2W((function(r,o){return __awaiter(t,void 0,e.Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return[4,this.getThemeService()];case 1:return e=t.sent(),[4,e.putTheme(this.explorationContainer,r,o)];case 2:return[2,t.sent()]}}))}))})))},t.prototype.init=function(e){return __awaiter(this,void 0,i,(function(){var t,i,d,l;return __generator(this,(function(c){switch(c.label){case 0:return t=this.services.reportEmbedState.theme,i=this.services.reportEmbedState.contrastMode,null!=i&&"None"!==i&&this.services.eventBridge.publishToChannel(n,i),t?null!=i&&"None"!==i?(d=r.HostCommunicationHelper.createError(a.invalidThemeContrastCombination,s.invalidThemeContrastCombination,{level:o.Warning}),this.services.embedRouter.postError("reports",d),[2]):[4,this.getThemeService()]:[3,3];case 1:return l=c.sent(),[4,l.applyTheme(e,this.services.reportEmbedState.theme)];case 2:return[2,c.sent()];case 3:return[2]}}))}))},t.prototype.getThemeService=function(){return __awaiter(this,void 0,i,(function(){var e;return __generator(this,(function(r){switch(r.label){case 0:return this.reportEmbedThemeService?[3,2]:(e=this,[4,this.services.lazyProviderModern.get("@powerbi/ReportEmbed/modules/themeService/theme-service.module#ReportEmbedThemeModule","reportEmbedThemeService")]);case 1:e.reportEmbedThemeService=r.sent(),r.label=2;case 2:return[2,this.reportEmbedThemeService]}}))}))},t})()})(t=r.mixins||(r.mixins={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(t){var o=e.explore.reportembed.constants;t.VisualCapabilitiesMixinFactory={ng:["apiGateway","embedModeService","embedRouter","reportEmbedState","sdkModelsConverter","telemetryService"],scoped:["visualPlugin"],fn:function(e){return new i(e)}};var i=(function(){function t(e){this.services=e}return t.prototype.update=function(e){this.services.embedRouter.setupBlock(this)},t.prototype.setupRoutes=function(t){var i=this;t.get("/report/visuals/types/:visualType/capabilities",this.services.apiGateway.blockAppTokenAndP2W((function(t,a){var s=t.params&&t.params.visualType,n=i.services.visualPlugin.capabilities(s);if(!n)return i.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKGetVisualCapabilities,s,o.ErrorMessages.failedToResolveVisualCapabilities,i.requestId,i.reportObjectId,i.embedTypeDescription),void a.send(o.StatusCodes.BadRequest,r.HostCommunicationHelper.buildFailedToResolveVisualCapabilitiesErrorMessage(s));var d=i.services.sdkModelsConverter.getSdkVisualCapabilities(n);i.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKGetVisualCapabilities,s,null,i.requestId,i.reportObjectId,i.embedTypeDescription),a.send(o.StatusCodes.OK,d)})))},Object.defineProperty(t.prototype,"requestId",{get:function(){return this.services.embedRouter.requestId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reportObjectId",{get:function(){return this.services.reportEmbedState.reportObjectId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"embedTypeDescription",{get:function(){return this.services.embedModeService.getEmbedTypeDescription()},enumerable:!0,configurable:!0}),t})()})(t=r.mixins||(r.mixins={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(r){var t=e.data.DataViewObjectDefinitions,o=e.explore.reportembed.ObjectPropertyHelper,i=e.explore.reportembed.constants,a=e.data.SQConstantExpr,s=e.data.SQExprBuilder,n=e.explore.contracts.VisualContainer;r.VisualPropertiesMixinFactory={ng:["apiGateway","embedModeService","embedRouter","reportEmbedState","telemetryService"],scoped:["visualAuthoring","visualPlugin"],fn:function(e){return new d(e)}};var d=(function(){function r(e){var r=this;this.services=e,this.supportedProperties={tooltip:{visible:{getProperty:function(e){return r.getBasicPropertyValue(e,"visualTooltip","show",a.getBooleanValue,_.isBoolean)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"visualTooltip","show",t,s.boolean,_.isBoolean)}},valueColor:{getProperty:function(e){return r.getBasicPropertyValue(e,"visualTooltip","valueFontColor",o.getColorValue,o.isValidColor)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"visualTooltip","valueFontColor",t,o.colorValueBuilder,o.isValidColor)}},labelColor:{getProperty:function(e){return r.getBasicPropertyValue(e,"visualTooltip","titleFontColor",o.getColorValue,o.isValidColor)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"visualTooltip","titleFontColor",t,o.colorValueBuilder,o.isValidColor)}},textSize:{getProperty:function(e){return r.getBasicPropertyValue(e,"visualTooltip","fontSize",o.getTextValueAsNumber,_.isNumber)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"visualTooltip","fontSize",t,o.buildConstantTextFromNumber,_.isNumber)}},fontFamily:{getProperty:function(e){return r.getBasicPropertyValue(e,"visualTooltip","fontFamily",a.getTextValue,_.isString)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"visualTooltip","fontFamily",t,s.text,_.isString)}},backgroundColor:{getProperty:function(e){return r.getBasicPropertyValue(e,"visualTooltip","background",o.getColorValue,o.isValidColor)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"visualTooltip","background",t,o.colorValueBuilder,o.isValidColor)}},transparency:{getProperty:function(e){return r.getBasicPropertyValue(e,"visualTooltip","transparency",a.getNumericValue,_.isNumber)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"visualTooltip","transparency",t,s.integer,_.isNumber)}}},background:{visible:{getProperty:function(e){return r.getBasicPropertyValue(e,"background","show",a.getBooleanValue,_.isBoolean)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"background","show",t,s.boolean,_.isBoolean)}},color:{getProperty:function(e){return r.getBasicPropertyValue(e,"background","color",o.getColorValue,o.isValidColor)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"background","color",t,o.colorValueBuilder,o.isValidColor)}},transparency:{getProperty:function(e){return r.getBasicPropertyValue(e,"background","transparency",a.getNumericValue,_.isNumber)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"background","transparency",t,s.integer,_.isNumber)}}},visualHeader:{visible:{getProperty:function(e){return r.getBasicPropertyValue(e,"visualHeader","show",a.getBooleanValue,_.isBoolean)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"visualHeader","show",t,s.boolean,_.isBoolean)}},backgroundColor:{getProperty:function(e){return r.getBasicPropertyValue(e,"visualHeader","background",o.getColorValue,o.isValidColor)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"visualHeader","background",t,o.colorValueBuilder,o.isValidColor)}},border:{getProperty:function(e){return r.getBasicPropertyValue(e,"visualHeader","border",o.getColorValue,o.isValidColor)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"visualHeader","border",t,o.colorValueBuilder,o.isValidColor)}},transparency:{getProperty:function(e){return r.getBasicPropertyValue(e,"visualHeader","transparency",a.getNumericValue,_.isNumber)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"visualHeader","transparency",t,s.integer,_.isNumber)}},iconColor:{getProperty:function(e){return r.getBasicPropertyValue(e,"visualHeader","foreground",o.getColorValue,o.isValidColor)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"visualHeader","foreground",t,o.colorValueBuilder,o.isValidColor)}}},border:{visible:{getProperty:function(e){return r.getBasicPropertyValue(e,"border","show",a.getBooleanValue,_.isBoolean)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"border","show",t,s.boolean,_.isBoolean)}},color:{getProperty:function(e){return r.getBasicPropertyValue(e,"border","color",o.getColorValue,o.isValidColor)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"border","color",t,o.colorValueBuilder,o.isValidColor)}},radius:{getProperty:function(e){return r.getBasicPropertyValue(e,"border","radius",a.getNumericValue,_.isNumber)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"border","radius",t,s.integer,_.isNumber)}}},lockAspect:{enabled:{getProperty:function(e){return r.getBasicPropertyValue(e,"lockAspect","show",a.getBooleanValue,_.isBoolean)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"lockAspect","show",t,s.boolean,_.isBoolean)}}},title:{visible:{getProperty:function(e){return r.getBasicPropertyValue(e,"title","show",a.getBooleanValue,_.isBoolean)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"title","show",t,s.boolean,_.isBoolean)}},alignment:{getProperty:function(e){return r.getBasicPropertyValue(e,"title","alignment",a.getTextValue,_.isString)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"title","alignment",t,s.text,_.isString)}},fontColor:{getProperty:function(e){return r.getBasicPropertyValue(e,"title","fontColor",o.getColorValue,o.isValidColor)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"title","fontColor",t,o.colorValueBuilder,o.isValidColor)}},textSize:{getProperty:function(e){return r.getBasicPropertyValue(e,"title","fontSize",o.getTextValueAsNumber,_.isNumber)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"title","fontSize",t,o.buildConstantTextFromNumber,_.isNumber)}},fontFamily:{getProperty:function(e){return r.getBasicPropertyValue(e,"title","fontFamily",a.getTextValue,_.isString)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"title","fontFamily",t,s.text,_.isString)}},backgroundColor:{getProperty:function(e){return r.getBasicPropertyValue(e,"title","background",o.getColorValue,o.isValidColor)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"title","background",t,o.colorValueBuilder,o.isValidColor)}},titleText:{getProperty:function(e){return r.getBasicPropertyValue(e,"title","text",a.getTextValue,_.isString)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"title","text",t,s.text,_.isString)}}},legend:{visible:{getProperty:function(e){return r.getBasicPropertyValue(e,"legend","show",a.getBooleanValue,_.isBoolean)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"legend","show",t,s.boolean,_.isBoolean)}},position:{getProperty:function(e){return r.getBasicPropertyValue(e,"legend","position",a.getTextValue,_.isString)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"legend","position",t,s.text,_.isString)}}},dataLabels:{visible:{getProperty:function(e){return r.getBasicPropertyValue(e,"labels","show",a.getBooleanValue,_.isBoolean)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"labels","show",t,s.boolean,_.isBoolean)}}},categoryAxis:{visible:{getProperty:function(e){return r.getBasicPropertyValue(e,"categoryAxis","show",a.getBooleanValue,_.isBoolean)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"categoryAxis","show",t,s.boolean,_.isBoolean)}}},valueAxis:{visible:{getProperty:function(e){return r.getBasicPropertyValue(e,"valueAxis","show",a.getBooleanValue,_.isBoolean)},setProperty:function(e,t){return r.setBasicPropertyValue(e,"valueAxis","show",t,s.boolean,_.isBoolean)}}}}}return r.prototype.update=function(e){this.services.embedRouter.setupBlock(this)},r.prototype.setupRoutes=function(r){var t=this;r.post("/report/pages/:pageName/visuals/:visualName/property",this.services.apiGateway.blockAppTokenAndP2W(this.services.apiGateway.requireVisual((function(e,r,o){return t.handleGetVisualProperty(e,r,o)}),(function(r,o){return t.logTelemetryEvent(e.telemetry.ReportEmbedSDKGetVisualProperty,void 0,o.body.detailedMessage)})))),r.put("/report/pages/:pageName/visuals/:visualName/property",this.services.apiGateway.blockAppTokenAndP2W(this.services.apiGateway.requireVisual((function(e,r,o){return t.handlePutVisualProperty(e,r,o)}),(function(r,o){return t.logTelemetryEvent(e.telemetry.ReportEmbedSDKPutVisualProperty,void 0,o.body.detailedMessage)}))))},r.prototype.handleGetVisualProperty=function(r,t,a){var s=r.body;if(!s)return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKGetVisualProperty,void 0,i.ErrorMessages.invalidVisualPropertyRequest),t.send(i.StatusCodes.BadRequest,{message:i.ErrorCodes.invalidVisualPropertyRequest,detailedMessage:i.ErrorMessages.invalidVisualPropertyRequest});var n=a.visualContainer,d=n.config.singleVisual,l=d.visualType,c=this.services.visualPlugin.isCustomVisual(l);try{if(c&&!this.isVisualContainerProperty(s)){var p=this.services.visualPlugin.capabilities(l);if(!this.isAllowedPropertyDescriptor(s,p))return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKGetVisualProperty,l,i.ErrorMessages.getPropertyFailed),t.send(i.StatusCodes.NotFound,{message:i.ErrorCodes.getPropertyFailed,detailedMessage:i.ErrorMessages.getPropertyFailed});var u=this.getVisualPropertyDefintion(n,s),m=void 0;if(u){var v=o.decodePropertyValue(u);if(void 0===v)return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKGetVisualProperty,l,i.ErrorMessages.unsupportedType),t.send(i.StatusCodes.NotFound,{message:i.ErrorCodes.unsupportedType,detailedMessage:i.ErrorMessages.unsupportedType});m={schema:i.PropertySchemas.Property,value:v}}else m={schema:i.PropertySchemas.Default,value:{}};return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKGetVisualProperty,l),t.send(i.StatusCodes.OK,m)}if(this.isSupportedProperty(s)){var y=this.supportedProperties[s.objectName][s.propertyName],m=y.getProperty(n);return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKGetVisualProperty,l),t.send(i.StatusCodes.OK,m)}return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKGetVisualProperty,l,i.ErrorMessages.unsupportedProperty),t.send(i.StatusCodes.NotFound,{message:i.ErrorCodes.unsupportedProperty,detailedMessage:i.ErrorMessages.unsupportedProperty})}catch(r){var g=r&&r.detailedMessage||i.ErrorMessages.getPropertyFailed;return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKGetVisualProperty,l,g),t.send(i.StatusCodes.BadRequest,r)}},r.prototype.handlePutVisualProperty=function(r,t,a){var s=r.body&&r.body.selector,n=r.body&&r.body.value;if(!s||!n)return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKPutVisualProperty,void 0,i.ErrorMessages.invalidVisualPropertyRequest),t.send(i.StatusCodes.BadRequest,{message:i.ErrorCodes.invalidVisualPropertyRequest,detailedMessage:i.ErrorMessages.invalidVisualPropertyRequest});var d=a.visualContainer,l=d.config.singleVisual,c=l.visualType,p=this.services.visualPlugin.isCustomVisual(c);try{if(p&&!this.isVisualContainerProperty(s)){var u=this.services.visualPlugin.capabilities(c);if(!this.isAllowedPropertyDescriptor(s,u))return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKPutVisualProperty,c,i.ErrorMessages.setPropertyFailed),t.send(i.StatusCodes.NotFound,{message:i.ErrorCodes.setPropertyFailed,detailedMessage:i.ErrorMessages.setPropertyFailed});var m=this.isDefaultPropertyValue(n);if(!o.verifyValueTypeBeforeEncode(s.objectName,s.propertyName,u,n.value)&&!m){this.logTelemetryEvent(e.telemetry.ReportEmbedSDKPutVisualProperty,c,i.ErrorMessages.unsupportedType);var v={message:i.ErrorCodes.unsupportedType,detailedMessage:i.ErrorMessages.unsupportedType};return t.send(i.StatusCodes.BadRequest,v)}var y=[{objectName:s.objectName,selector:null,properties:{}}];y[0].properties[s.propertyName]=n.value;var g={merge:y};return m&&(g={remove:y}),this.services.visualAuthoring.persistProperties(g,d,!1)?(this.services.visualAuthoring.raiseVisualContainerChanged(d),this.logTelemetryEvent(e.telemetry.ReportEmbedSDKPutVisualProperty,c),t.send(i.StatusCodes.OK,null)):(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKPutVisualProperty,c,i.ErrorMessages.setPropertyFailed),t.send(i.StatusCodes.NotFound,{message:i.ErrorCodes.setPropertyFailed,detailedMessage:i.ErrorMessages.setPropertyFailed}))}if(!this.isSupportedProperty(s))return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKPutVisualProperty,c,i.ErrorMessages.unsupportedProperty),t.send(i.StatusCodes.NotFound,{message:i.ErrorCodes.unsupportedProperty,detailedMessage:i.ErrorMessages.unsupportedProperty});var b=this.supportedProperties[s.objectName][s.propertyName];try{return b.setProperty(d,n),this.logTelemetryEvent(e.telemetry.ReportEmbedSDKPutVisualProperty,c),t.send(i.StatusCodes.OK,null)}catch(r){var E=r&&r.detailedMessage||i.ErrorMessages.setPropertyFailed;return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKPutVisualProperty,c,E),t.send(i.StatusCodes.NotFound,r)}}catch(r){var E=r&&r.detailedMessage||i.ErrorMessages.setPropertyFailed;return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKPutVisualProperty,c,E),t.send(i.StatusCodes.BadRequest,r)}},r.prototype.isSupportedProperty=function(e){return!(!this.supportedProperties[e.objectName]||!this.supportedProperties[e.objectName][e.propertyName])},r.prototype.getVisualPropertyDefintion=function(e,r){var o=e.config.singleVisual,a={objectName:r.objectName,propertyName:r.propertyName},s=this.isVisualContainerProperty(r)?o.vcObjects:o.objects;if(s&&s[r.objectName]){if(s[r.objectName].length>1){throw{message:i.ErrorCodes.unsupportedProperty,detailedMessage:i.ErrorMessages.unsupportedProperty}}}return t.getValue(s,a,null)},r.prototype.isAllowedPropertyDescriptor=function(e,r){var t=r&&r.objects&&r.objects[e.objectName];return this.isObjectPropertyExists(t,e.propertyName)},r.prototype.isVisualContainerProperty=function(e){var r=n.CommonObjectDescriptors[e.objectName];return this.isObjectPropertyExists(r,e.propertyName)},r.prototype.isObjectPropertyExists=function(e,r){return!!(e&&e.properties&&e.properties[r])},r.prototype.getBasicPropertyValue=function(e,r,t,o,a){var s={objectName:r,propertyName:t},n=this.isVisualContainerProperty(s),d=e.config.singleVisual,l=this.services.visualPlugin.capabilities(d.visualType);if(!n&&!this.isAllowedPropertyDescriptor(s,l)){var c={message:i.ErrorCodes.unsupportedProperty,detailedMessage:i.ErrorMessages.unsupportedProperty};throw c}var p,u=this.getVisualPropertyDefintion(e,s);if(u){var m=o(u);if(!a(m)){var c={message:i.ErrorCodes.unsupportedType,detailedMessage:i.ErrorMessages.unsupportedType};throw c}p={schema:i.PropertySchemas.Property,value:m}}else p={schema:i.PropertySchemas.Default,value:{}};return p},r.prototype.setBasicPropertyValue=function(e,r,o,a,s,n){var d={objectName:r,propertyName:o},l=this.isVisualContainerProperty(d),c=e.config.singleVisual,p=this.services.visualPlugin.capabilities(c.visualType);if(!l&&!this.isAllowedPropertyDescriptor(d,p)){var u={message:i.ErrorCodes.unsupportedProperty,detailedMessage:i.ErrorMessages.unsupportedProperty};throw u}if(!n(a.value)&&!this.isDefaultPropertyValue(a)){var u={message:i.ErrorCodes.unsupportedType,detailedMessage:i.ErrorMessages.unsupportedType};throw u}var m=(l?c.vcObjects:c.objects)||{};if(this.isDefaultPropertyValue(a))t.deleteProperty(m,r,null,o);else{var v=s(a.value);if(!v)return;t.setValue(m,d,null,v),l?c.vcObjects=m:c.objects=m}this.services.visualAuthoring.raiseVisualContainerChanged(e)},r.prototype.isDefaultPropertyValue=function(e){return e.schema===i.PropertySchemas.Default&&_.isEmpty(e.value)},r.prototype.logTelemetryEvent=function(e,r,t){this.services.telemetryService.logEvent(e,r,t,this.services.embedRouter.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription())},r})()})(t=r.mixins||(r.mixins={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(t){var o;!(function(o){var i=e.explore.reportembed.constants.ErrorCodes,a=e.explore.reportembed.constants.ErrorMessages,s=jsCommon.TraceType,n=e.explore.reportembed.constants.StatusCodes,d=e.data.SQExpr;o.VisualsAuthoringMessageProxyMixinFactory={ng:["apiGateway","conceptualSchemaProxy","embedModeService","embedRouter","featureSwitchService","lazyProviderModern","moduleLoader","pbiLazyLoad","promiseFactory","reportEmbedState","sdkModelsConverter","sdkReportModelsConverter","telemetryService"],
scoped:["dataSources","sort","visualAuthoring","visualAuthoringOperations","visualPlugin"],fn:function(e){return new l(e)}};var l=(function(){function o(e){this.services=e}return o.prototype.update=function(e){this.explorationContainer=e,this.services.embedRouter.setupBlock(this)},o.prototype.setupRoutes=function(r){var o=this;r.get("/report/pages/:pageName/visuals",this.services.apiGateway.blockP2W((function(r,d){return __awaiter(o,void 0,e.Promise,(function(){var o,l,c,p;return __generator(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),this.exploration&&this.exploration.sections?(l=this.tryGetSection(r.params.pageName,d),l?[4,this.getVisuals(l)]:(this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,this.services.embedRouter.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription(),a.pageNotFound),[2,null])):(o=t.HostCommunicationHelper.createError(i.noExploration,a.getAllVisualsFailed,{level:s.Error}),[2,d.send(n.BadRequest,o)]);case 1:return c=u.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKGetAllVisuals,this.services.embedRouter.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()),[2,d.send(n.OK,c)];case 2:return p=u.sent(),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,this.services.embedRouter.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription(),a.getAllVisualsFailed),[2,d.send(n.InternalServerError,a.getAllVisualsFailed)];case 3:return[2]}}))}))}))),r.get("/report/availableVisualTypes",this.services.apiGateway.blockAppTokenAndP2W((function(r,t){return __awaiter(o,void 0,e.Promise,(function(){return __generator(this,(function(e){return[2,this.handleGetAvailableVisualTypes(r,t)]}))}))}))),r.post("/report/pages/:pageName/visuals/:visualName/clone",this.services.apiGateway.blockAppTokenAndP2W(this.services.apiGateway.requireVisual((function(r,t,i){return __awaiter(o,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.handleCloneVisual(r,t,i)];case 1:return[2,e.sent()]}}))}))}),(function(r,t){return o.logTelemetryEvent(e.telemetry.ReportEmbedSDKCloneVisual,void 0,void 0,t.body.detailedMessage)})))),r.post("/report/pages/:pageName/createVisual",this.services.apiGateway.blockAppTokenAndP2W((function(r,t){return __awaiter(o,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.createVisual(r,t)];case 1:return[2,e.sent()]}}))}))}))),r.post("/report/pages/:pageName/visuals/:visualName/dataroles/:dataRole/fields",this.services.apiGateway.blockAppTokenAndP2W(this.services.apiGateway.requireVisual((function(r,t,i){return __awaiter(o,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.addDataRoleField(r,t,i)];case 1:return[2,e.sent()]}}))}))}),(function(r,t){return o.logTelemetryEvent(e.telemetry.ReportEmbedSDKAddDataRoleField,void 0,void 0,t.body.detailedMessage)})))),r.delete("/report/pages/:pageName/visuals/:visualName/dataroles/:dataRole/fields/:index",this.services.apiGateway.blockAppTokenAndP2W(this.services.apiGateway.requireVisual((function(r,t,i){return __awaiter(o,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.deleteDataRoleField(r,t,i)];case 1:return[2,e.sent()]}}))}))}),(function(r,t){return o.logTelemetryEvent(e.telemetry.ReportEmbedSDKDeleteDataRoleField,void 0,void 0,t.body.detailedMessage)})))),r.get("/report/pages/:pageName/visuals/:visualName/dataroles/:dataRole/fields",this.services.apiGateway.blockAppTokenAndP2W(this.services.apiGateway.requireVisual((function(r,t,i){return __awaiter(o,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getDataRoleFields(r,t,i)];case 1:return[2,e.sent()]}}))}))})))),r.post("/report/pages/:pageName/deleteVisual",this.services.apiGateway.blockAppTokenAndP2W(this.services.apiGateway.requireVisual((function(e,r,t){return o.deleteVisual(e,r,t)}),(function(r,t){return o.logTelemetryEvent(e.telemetry.ReportEmbedSDKDeleteVisual,void 0,void 0,t.body.detailedMessage)})))),r.post("/report/pages/:pageName/visuals/:visualName/changeType",this.services.apiGateway.blockAppTokenAndP2W(this.services.apiGateway.requireVisual((function(e,r,t){return __awaiter(o,void 0,void 0,(function(){return __generator(this,(function(o){switch(o.label){case 0:return[4,this.changeVisualType(e,r,t)];case 1:return[2,o.sent()]}}))}))}),(function(r,t){return o.logTelemetryEvent(e.telemetry.ReportEmbedSDKChangeVisualType,void 0,void 0,t.body.detailedMessage)})))),r.put("/report/pages/:pageName/visuals/:visualName/sortBy",this.services.apiGateway.blockAppTokenAndP2W(this.services.apiGateway.requireVisual((function(r,t,i){return __awaiter(o,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.handleSortByVisual(r,t,i)];case 1:return[2,e.sent()]}}))}))}),(function(r,t){return o.logTelemetryEvent(e.telemetry.ReportEmbedSDKSortVisual,void 0,void 0,t.body.detailedMessage)}))))},o.prototype.getVisuals=function(r){return __awaiter(this,void 0,e.Promise,(function(){var e,t,o=this;return __generator(this,(function(s){switch(s.label){case 0:e=null,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.getConceptualSchema()];case 2:return e=s.sent(),[3,4];case 3:return t=s.sent(),this.services.embedRouter.postError("report",{message:i.failedGettingSchema,detailedMessage:a.failedGettingSchema}),[3,4];case 4:return[2,r.visualContainers.map((function(r){return o.services.sdkReportModelsConverter.getSdkVisual(r,e)}))]}}))}))},o.prototype.handleGetAvailableVisualTypes=function(e,r){var t=this.services.visualPlugin.getStorage();if(!t)return r.send(n.InternalServerError,{message:i.getAvailableVisualTypesFailed,detailedMessage:a.getAvailableVisualTypesFailed});var o=t.getLoadedPlugins(),s=o.map((function(e){return e.name}));return r.send(n.OK,s)},o.prototype.handleCloneVisual=function(t,o,s){return __awaiter(this,void 0,e.Promise,(function(){var d,l,c,p,u,m,v,y,g,b,E,f,h,S,C,I,F,R;return __generator(this,(function(T){switch(T.label){case 0:return d=t.body,l=s.visualContainer.config&&s.visualContainer.config.singleVisual&&s.visualContainer.config.singleVisual.visualType,d?[4,this.services.pbiLazyLoad.load(r.modules.ExploreUIShellModule)]:(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKCloneVisual,l,void 0,a.failedCloningVisual),[2,o.send(n.BadRequest,{message:i.invalidCloneVisualRequest,detailedMessage:a.invalidCloneVisualRequest})]);case 1:if(T.sent(),c=s.visualContainer.filters,!d.filters)return[3,9];c=[],p=void 0,u=void 0,T.label=2;case 2:return T.trys.push([2,4,,5]),[4,this.services.promiseFactory.all([this.getJsonFilterParser(),this.getConceptualSchema()])];case 3:return R=T.sent(),p=R[0],u=R[1],[3,5];case 4:return m=T.sent(),this.logTelemetryEvent(e.telemetry.ReportEmbedSDKCloneVisual,l,void 0,a.failedCloningVisual),[2,o.send(n.InternalServerError,m)];case 5:v={filters:[]},y=0,g=d.filters,T.label=6;case 6:return y<g.length?(b=g[y],[4,p.tryCreateFilterContainer(v,u,b)]):[3,9];case 7:E=T.sent(),E?c.push(E):this.services.embedRouter.postError("report",{message:i.invalidFilter,detailedMessage:a.invalidFilter}),T.label=8;case 8:return y++,[3,6];case 9:return d.layout&&(f=this.services.sdkModelsConverter.getVisualContainerPosition(d.layout)),h=s.visualContainer.layouts&&s.visualContainer.layouts.withId(0),S=_.cloneDeep(h.position),f=_.merge(S,f),C=this.services.visualAuthoringOperations.addVisualContainerFromConfig(s.visualContainer.config,c,this.explorationViewModel.exploreCanvas,f,d.autoFocus!==!1),[4,this.tryGetConceptualSchema(o)];case 10:return(I=T.sent())?(F=this.services.sdkReportModelsConverter.getSdkVisual(C,I),this.logTelemetryEvent(e.telemetry.ReportEmbedSDKCloneVisual,l,void 0),[2,o.send(n.OK,{visual:F,visualName:C.name})]):(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKCloneVisual,l,void 0,a.failedCloningVisual),[2])}}))}))},o.prototype.createVisual=function(r,t){return __awaiter(this,void 0,e.Promise,(function(){var o,s,d,l,c,p,u,m,v,y;return __generator(this,(function(g){switch(g.label){case 0:if(o=r.body,!o||!o.visualType)return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKCreateVisual,void 0,void 0,a.missingVisualType),[2,t.send(n.BadRequest,{message:i.invalidCreateVisualRequest,detailedMessage:a.missingVisualType})];if(s=r.params&&r.params.pageName,d=this.tryGetSection(s,t),!d)return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKCreateVisual,void 0,void 0,a.pageNotFound),[2,null];if(l=this.validateRequest(s,o.visualType))return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKCreateVisual,void 0,void 0,l),[2,t.send(n.BadRequest,{message:i.invalidCreateVisualRequest,detailedMessage:l})];p={singleVisual:{visualType:o.visualType}},o.layout&&(c=this.services.sdkModelsConverter.getVisualContainerPosition(o.layout),p.singleVisual.display=this.services.sdkModelsConverter.getDisplayState(o.layout.displayState));try{u=this.services.visualAuthoringOperations.addVisualContainerFromConfig(p,void 0,this.explorationViewModel.exploreCanvas,c,o.autoFocus!==!1)}catch(r){return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKCreateVisual,void 0,void 0,a.createVisualFailed),[2,t.send(n.InternalServerError,{message:i.invalidCreateVisualRequest,detailedMessage:a.createVisualFailed})]}return[4,this.tryGetConceptualSchema(t)];case 1:return(m=g.sent())?(v=this.services.sdkReportModelsConverter.getSdkVisual(u,m),this.logTelemetryEvent(e.telemetry.ReportEmbedSDKCreateVisual,o.visualType,!!o.layout),y={visual:v},[2,t.send(n.OK,y)]):(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKCreateVisual,void 0,void 0,a.createVisualFailed),[2])}}))}))},o.prototype.deleteVisual=function(r,o,s){var d=s.visualContainer.config&&s.visualContainer.config.singleVisual&&s.visualContainer.config.singleVisual.visualType;if(!s.explorationViewModel)return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKDeleteVisual,d,void 0,a.failedDeletingVisual),o.send(n.NotFound,{message:i.notReady,detailedMessage:a.reportNotReady});if(t.ExplorationHelper.getPageIndexByName(s.section.name,s.exploration)!==s.exploration.activeSectionIndex)return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKDeleteVisual,d,void 0,a.failedDeletingVisual),o.send(n.BadRequest,{message:i.pageNotActive,detailedMessage:a.pageNotActive});try{this.services.visualAuthoring.deleteVisualContainer(s.visualContainer,s.explorationViewModel.exploreCanvas)}catch(r){return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKDeleteVisual,d,void 0,a.failedDeletingVisual),o.send(n.InternalServerError,{message:i.failedDeletingVisual,detailedMessage:a.failedDeletingVisual})}return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKDeleteVisual,d,void 0),o.send(n.OK,null)},o.prototype.changeVisualType=function(r,t,o){return __awaiter(this,void 0,e.Promise,(function(){var s,d,l,c,p,u,m;return __generator(this,(function(v){switch(v.label){case 0:return s=r.body&&r.body.visualType,d=o.visualContainer.config.singleVisual&&o.visualContainer.config.singleVisual.visualType,s?(l=this.services.visualPlugin.getStorage(),l.getLoadedPlugin(s)?[4,this.tryGetConceptualSchema(t)]:(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKChangeVisualType,d,s,a.invalidVisualType),[2,t.send(n.BadRequest,{message:i.invalidChangeVisualTypeRequest,detailedMessage:a.invalidVisualType})])):(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKChangeVisualType,d,void 0,a.missingVisualType),[2,t.send(n.BadRequest,{message:i.invalidChangeVisualTypeRequest,detailedMessage:a.missingVisualType})]);case 1:return(c=v.sent())?s===d||(p=this.services.visualAuthoringOperations.convert(c,o.visualContainer,s))?(u=this.services.sdkReportModelsConverter.getSdkVisual(o.visualContainer,c),this.logTelemetryEvent(e.telemetry.ReportEmbedSDKChangeVisualType,d,s),m={visual:u},[2,t.send(n.OK,m)]):(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKChangeVisualType,d,s,a.changeVisualTypeFailed),[2,t.send(n.InternalServerError,{message:i.invalidChangeVisualTypeRequest,detailedMessage:a.changeVisualTypeFailed})]):(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKChangeVisualType,d,s,a.changeVisualTypeFailed),[2])}}))}))},o.prototype.tryGetSection=function(e,r){var o=t.ExplorationHelper.getSectionByName(this.exploration,e);return o?o:(r.send(n.BadRequest,t.HostCommunicationHelper.buildPageNotFoundErrorMessage(e)),null)},o.prototype.validateRequest=function(e,r){if(!this.explorationViewModel)return a.reportNotReady;if(t.ExplorationHelper.getPageIndexByName(e,this.exploration)!==this.explorationViewModel.contract.activeSectionIndex)return a.pageNotActive;if(r){if(!this.services.visualPlugin.getStorage().getLoadedPlugin(r))return a.invalidVisualType}},Object.defineProperty(o.prototype,"explorationViewModel",{get:function(){return this.explorationContainer&&this.explorationContainer.viewModel&&this.explorationContainer.viewModel.exploration},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"exploration",{get:function(){return this.explorationViewModel&&this.explorationViewModel.contract||this.services.reportEmbedState.baseExploration},enumerable:!0,configurable:!0}),o.prototype.tryGetConceptualSchema=function(r){return __awaiter(this,void 0,e.Promise,(function(){var e,t;return __generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.getConceptualSchema()];case 1:return e=o.sent(),[2,e];case 2:return t=o.sent(),r.send(n.InternalServerError,{message:i.failedGettingSchema,detailedMessage:a.failedGettingSchema}),[2,null];case 3:return[2]}}))}))},o.prototype.getConceptualSchema=function(){return __awaiter(this,void 0,e.Promise,(function(){var e,r,t;return __generator(this,(function(o){switch(o.label){case 0:return e=this.services.dataSources.get(),[4,this.services.conceptualSchemaProxy.get(e)];case 1:if(r=o.sent(),!r)throw t={message:i.failedGettingSchema,detailedMessage:a.failedGettingSchema};return[2,r]}}))}))},o.prototype.getJsonFilterParser=function(){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(r){switch(r.label){case 0:return this.jsonFilterParser?[3,2]:(e=this,[4,t.JsonFilterHelper.createJsonFilterParser(this.services.promiseFactory,this.services.moduleLoader,this.services.telemetryService,this.services.lazyProviderModern)]);case 1:e.jsonFilterParser=r.sent(),r.label=2;case 2:return[2,this.jsonFilterParser]}}))}))},o.prototype.deleteDataRoleField=function(r,o,i){return __awaiter(this,void 0,e.Promise,(function(){var s,d,l,c,p,u,m;return __generator(this,(function(v){switch(v.label){case 0:if(s=r.params&&r.params.dataRole,d=r.params&&r.params.index&&parseInt(r.params.index,10),l=i.visualContainer.config.singleVisual&&i.visualContainer.config.singleVisual.visualType,isNaN(d)||d<0||!s)return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKDeleteDataRoleField,l,void 0,a.missingOrInvalidDataFieldRequestParameters),o.send(n.BadRequest,t.HostCommunicationHelper.buildFailedToDeleteDataFieldErrorMessage(a.missingOrInvalidDataFieldRequestParameters)),[2];if(c=this.validateDataRole(s,i.visualContainer))return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKDeleteDataRoleField,l,void 0,a.invalidOrMissingDataRole),[2,o.send(n.BadRequest,t.HostCommunicationHelper.buildFailedToValidateDataRoleErrorMessage())];try{i.visualContainer.config.singleVisual.query&&(p=i.visualContainer.config.singleVisual.query.tryGetExprs(s))}catch(r){return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKDeleteDataRoleField,l,void 0,a.failedToGetDataRoleFields),o.send(n.InternalServerError,t.HostCommunicationHelper.buildFailedToDeleteDataFieldErrorMessage(a.failedToGetDataRoleFields)),[2]}return p?p.length<=d?(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKDeleteDataRoleField,l,void 0,a.invalidDataFieldIndex),o.send(n.BadRequest,t.HostCommunicationHelper.buildFailedToDeleteDataFieldErrorMessage(a.invalidDataFieldIndex)),[2]):[4,this.tryGetConceptualSchema(o)]:(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKDeleteDataRoleField,l,void 0,a.failedToGetDataRoleFields),o.send(n.InternalServerError,t.HostCommunicationHelper.buildFailedToDeleteDataFieldErrorMessage(a.failedToGetDataRoleFields)),[2]);case 1:return u=v.sent(),u?[4,this.services.visualAuthoringOperations.removeField(p[d],u,[i.visualContainer])]:(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKDeleteDataRoleField,l,p[d].kind.toString(),a.failedToDeleteDataRoleField),[2]);case 2:return(m=v.sent())?(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKDeleteDataRoleField,l,p[d].kind.toString()),[2,o.send(n.OK,null)]):(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKDeleteDataRoleField,l,p[d].kind.toString(),a.failedToDeleteDataRoleField),o.send(n.InternalServerError,t.HostCommunicationHelper.buildFailedToDeleteDataFieldErrorMessage(a.failedToDeleteDataRoleField)),[2])}}))}))},o.prototype.getDataRoleFields=function(r,o,i){return __awaiter(this,void 0,e.Promise,(function(){var s,d,l,c,p,u,m,v;return __generator(this,(function(y){switch(y.label){case 0:return s=r.params&&r.params.dataRole,d=i.visualContainer.config.singleVisual&&i.visualContainer.config.singleVisual.visualType,l=this.validateDataRole(s,i.visualContainer),l?(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKGetDataRoleFields,d,a.invalidOrMissingDataRole),[2,o.send(n.BadRequest,t.HostCommunicationHelper.buildFailedToValidateDataRoleErrorMessage())]):[4,this.tryGetConceptualSchema(o)];case 1:if(c=y.sent(),!c)return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKGetDataRoleFields,d,a.failedToGetDataRoleFields),[2];p=[];try{i.visualContainer.config.singleVisual.query&&(u=i.visualContainer.config.singleVisual.query.tryGetExprs(s))}catch(r){return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKGetDataRoleFields,d,a.failedToGetDataRoleFields),[2,o.send(n.InternalServerError,t.HostCommunicationHelper.buildFailedToGetDataFieldsErrorMessage(s))]}y.label=2;case 2:return y.trys.push([2,5,,6]),u?[4,this.getJsonTargetParserService()]:[3,4];case 3:m=y.sent(),p=u.map((function(e){return m.getTarget(e,c)})),y.label=4;case 4:return[3,6];case 5:return v=y.sent(),this.logTelemetryEvent(e.telemetry.ReportEmbedSDKGetDataRoleFields,d,a.failedToGetDataRoleFields),[2,o.send(n.InternalServerError,v)];case 6:return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKGetDataRoleFields,d),[2,o.send(n.OK,p)]}}))}))},o.prototype.validateDataRole=function(e,r){var o=r.config&&r.config.singleVisual&&r.config.singleVisual.visualType;try{var i=this.services.visualPlugin.capabilities(o),a=i.dataRoles;if(!_.find(a,(function(r){return r.name===e})))return t.HostCommunicationHelper.buildFailedToValidateDataRoleErrorMessage()}catch(e){return t.HostCommunicationHelper.buildFailedToValidateDataRoleErrorMessage()}},o.prototype.addDataRoleField=function(r,i,s){return __awaiter(this,void 0,e.Promise,(function(){var d,l,c,p,u,m,v,y,g,b;return __generator(this,(function(E){switch(E.label){case 0:return d=r.params&&r.params.dataRole,l=s.visualContainer.config.singleVisual&&s.visualContainer.config.singleVisual.visualType,(c=this.validateDataRole(d,s.visualContainer))?(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKAddDataRoleField,l,void 0,a.invalidOrMissingDataRole),[2,i.send(n.BadRequest,t.HostCommunicationHelper.buildFailedToValidateDataRoleErrorMessage())]):(p=r.body)?(u=!1,this.isAggregation(p)&&p.aggregationFunction===o.doNotSummarize&&(p.aggregationFunction=null,u=!0),[4,this.tryGetConceptualSchema(i)]):(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKAddDataRoleField,l,void 0,a.missingDataField),i.send(n.BadRequest,t.HostCommunicationHelper.buildFailedToAddDataFieldErrorMessage(a.missingDataField)),[2]);case 1:if(m=E.sent(),!m)return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKAddDataRoleField,l,void 0,a.failedToAddDataFieldToRole),[2];E.label=2;case 2:return E.trys.push([2,4,,5]),[4,this.getJsonTargetParserService()];case 3:return v=E.sent().getFieldExpr(p,m),[3,5];case 4:return y=E.sent(),this.logTelemetryEvent(e.telemetry.ReportEmbedSDKAddDataRoleField,l,void 0,y.message),i.send(n.InternalServerError,t.HostCommunicationHelper.buildFailedToAddDataFieldErrorMessage(y.message)),[2];case 5:if(!v)return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKAddDataRoleField,l,void 0,a.failedToAddDataFieldToRole),i.send(n.InternalServerError,t.HostCommunicationHelper.buildFailedToAddDataFieldErrorMessage(a.failedToAddDataFieldToRole)),[2];g=!!p.aggregationFunction||u;try{b=this.services.visualAuthoringOperations.addFieldInRole(m,v,d,s.visualContainer,null,g)}catch(r){return this.logTelemetryEvent(e.telemetry.ReportEmbedSDKAddDataRoleField,l,v.kind.toString(),a.failedToAddDataFieldToRole),i.send(n.InternalServerError,t.HostCommunicationHelper.buildFailedToAddDataFieldErrorMessage(a.failedToAddDataFieldToRole)),[2]}return b?(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKAddDataRoleField,l,v.kind.toString()),[2,i.send(n.OK,null)]):(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKAddDataRoleField,l,v.kind.toString(),a.failedToAddDataFieldToRole),i.send(n.InternalServerError,t.HostCommunicationHelper.buildFailedToAddDataFieldErrorMessage(a.failedToAddDataFieldToRole)),[2])}}))}))},o.prototype.getJsonTargetParserService=function(){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(r){switch(r.label){case 0:return this.jsonParserServiceInstance?[3,2]:(e=this,[4,this.services.lazyProviderModern.get("@powerbi/JsonContracts/json-contracts.module#JsonContractsModule","jsonTargetParserService")]);case 1:e.jsonParserServiceInstance=r.sent(),r.label=2;case 2:return[2,this.jsonParserServiceInstance]}}))}))},o.prototype.handleSortByVisual=function(r,o,i){return __awaiter(this,void 0,e.Promise,(function(){var s,l,c,p,u,m,v,y,g,b,E,f,h;return __generator(this,(function(S){switch(S.label){case 0:return S.trys.push([0,3,,4]),s=r.body,l=this.services.sdkModelsConverter.getSortDirection(s.direction),c=i.visualContainer.config&&i.visualContainer.config.singleVisual,p=s.orderBy,p?1!==l&&2!==l?(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKSortVisual,c.visualType,void 0,a.invalidSortVisualRequest),[2,o.send(n.BadRequest,t.HostCommunicationHelper.buildInvalidSortVisualRequestErrorMessage(a.missingOrInvalidDirection))]):[4,this.tryGetConceptualSchema(o)]:(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKSortVisual,c.visualType,void 0,a.invalidSortVisualRequest),[2,o.send(n.BadRequest,t.HostCommunicationHelper.buildInvalidSortVisualRequestErrorMessage(a.missingOrderBy))]);case 1:return u=S.sent(),u?[4,this.getJsonTargetParserService()]:(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKSortVisual,c.visualType,void 0,a.failedSortingVisual),[2]);case 2:return(m=S.sent().getFieldExpr(p,u))?(v=this.services.visualPlugin.capabilities(c.visualType),y={mappings:v.dataViewMappings,queryDefn:c.query&&c.query.defn,queryProjections:c.query&&c.query.projections,schema:u,objectDescriptors:v.objects,objectDefinitions:c.objects,roles:v.dataRoles,featureSwitches:this.services.featureSwitchService.featureSwitches},g=e.data.compileDataView(y),b=this.services.sort.getSortableFields({query:c.query,schema:u,visualType:c.visualType,columnProperties:c.columnProperties,compiledMappings:g||[]}),E=_.flatMap(b,(function(e){return e.exprs})).map((function(e){return e.expr})),_.find(E,(function(e){return d.equals(e,m,!0,!0)}))?(f=[{expr:m,direction:l}],this.services.visualAuthoringOperations.setOrderBy(i.visualContainer,f),[3,4]):(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKSortVisual,c.visualType,void 0,a.failedSortingVisual),[2,o.send(n.BadRequest,t.HostCommunicationHelper.buildFailedSortingVisualErrorMessage(a.targetDoesNotMatch))])):(this.logTelemetryEvent(e.telemetry.ReportEmbedSDKSortVisual,c.visualType,void 0,a.failedSortingVisual),[2,o.send(n.BadRequest,t.HostCommunicationHelper.buildFailedSortingVisualErrorMessage(a.invalidOrderBy))]);case 3:return h=S.sent(),this.logTelemetryEvent(e.telemetry.ReportEmbedSDKSortVisual,void 0,void 0,a.failedSortingVisual),[2,o.send(n.InternalServerError,t.HostCommunicationHelper.buildFailedSortingVisualErrorMessage(a.failedSortingVisual))];case 4:return[2]}}))}))},o.prototype.isAggregation=function(e){return null!=e.aggregationFunction},o.prototype.logTelemetryEvent=function(r,t,o,i){r===e.telemetry.ReportEmbedSDKDeleteVisual||r===e.telemetry.ReportEmbedSDKCloneVisual?this.services.telemetryService.logEvent(r,t,i,this.services.embedRouter.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription()):this.services.telemetryService.logEvent(r,o,t,i,this.services.embedRouter.requestId,this.services.reportEmbedState.reportObjectId,this.services.embedModeService.getEmbedTypeDescription())},o.doNotSummarize="DoNotSummarize",o})()})(o=t.mixins||(t.mixins={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));;"use strict";var __extends=this&&this.__extends||(function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}})(),__awaiter=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?a(e.value):new t(function(n){n(e.value)}).then(i,s)}c((r=r.apply(e,n||[])).next())})},__generator=this&&this.__generator||function(e,n){function t(e){return function(n){return r([e,n])}}function r(t){if(a)throw new TypeError("Generator is already executing.");for(;c;)try{if(a=1,o&&(i=2&t[0]?o.return:t[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,t[1])).done)return i;switch(o=0,i&&(t=[2&t[0],i.value]),t[0]){case 0:case 1:i=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,o=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(i=c.trys,!(i=i.length>0&&i[i.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){c.label=t[1];break}if(6===t[0]&&c.label<i[1]){c.label=i[1],i=t;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(t);break}i[2]&&c.ops.pop(),c.trys.pop();continue}t=n.call(e,c)}catch(e){t=[6,e],o=0}finally{a=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var a,o,i,s,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},powerbi;!(function(e){var n;!(function(n){function t(n){var t=n[0].toLowerCase()+n.slice(1),r=e.infonav.components[n];angular.module("powerbi.infonavbootstrap").component(t,r)}angular.module("powerbi.infonavbootstrap",["powerbi.common"]).run(["scopedProvider",function(e){e.register("interpretProbe",{services:["promiseFactory","$timeout","featureSwitchService"],scopedServices:["lazyScoped"],fn:function(e,t,r,a){return n.services.createInterpretProbeService(a,e,t,r)}})}]),n.registerInfonavBootstrapComponent=t})(n=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var n;!(function(e){var n;!(function(e){e.LanguageNotSupported="LanguageNotSupported",e.BuildingLanguageModel="BuildingLanguageModel",e.BuildingDataIndex="BuildingDataIndex",e.UpdatingLanguageModel="UpdatingLanguageModel",e.UpdatingDataIndex="UpdatingDataIndex",e.FailedToUpdateLanguageModel="FailedToUpdateLanguageModel",e.FailedToUpdateIndex="FailedToUpdateDataIndex",e.FailedToBuildIndex="FailedToBuildDataIndex",e.SessionIsInactive="SessionIsInactive",e.MissingRuntimeModule="MissingRuntimeModule"})(n=e.HostWarningConstants||(e.HostWarningConstants={}))})(n=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var n;!(function(e){var n;!(function(e){e.QnaCoreModule={name:"powerbi.qnacore",namespace:"powerbi.explore.infonav",dependency:{javascript:"qnacore",css:["qnacore"]}},e.QnaWebModule={name:"powerbi.qnaweb",namespace:"powerbi.explore.infonav",dependency:{javascript:"qnaweb",css:["qnaweb"]}}})(n=e.modules||(e.modules={}))})(n=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var n;!(function(e){var n;!(function(e){e.openTileAction="/openQnA",e.openTileEventName="openQnaTile",e.pinSelectedVisual="pinSelectedVisual",e.showQnaStart="showQnaStart",e.ScopedInstanceProviderName="infonav",e.DefaultVisualMaxWidth=1024,e.DefaultVisualMaxHeight=768})(n=e.constants||(e.constants={}))})(n=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var n;!(function(e){var n;!(function(e){var n;!(function(e){function n(e,n){return r(t(n),e)}function t(e){var n;if(_.isEmpty(e))return n;for(var t=0,r=e;t<r.length;t++){var a=r[t];if(n&&a.Language!==n){n=void 0;break}n=a.Language}return n}function r(e,n){var t="";if(e){var r=!1,i=a(n.currentLanguageLocale);e=a(e);var s=o[e];s&&(t=s.resStringSuffix,r=s.preview),r||e!==i||(t="")}return n.get("Qna_Input_Placeholder"+t)}function a(e){if(e){return e.split("-")[0].toLowerCase()}}var o={en:{resStringSuffix:"_English"},es:{resStringSuffix:"_Spanish",preview:!0}};e.getPlaceholderText=n})(n=e.QnaLanguageUtil||(e.QnaLanguageUtil={}))})(n=e.utils||(e.utils={}))})(n=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var n;!(function(n){var t;!(function(n){var t,r=e.common.helpers.ModelConverterHelper;!(function(e){function n(e,n){return{InterpretRequestSubscopes:_(e).filter((function(e){return e&&e.model&&r.getIsQnaSupported(e.model,n)&&!_.isEmpty(e.model.vsName)&&!_.isEmpty(e.model.dbName)})).map((function(e){return{DbMoniker:{VirtualServerName:e.model.vsName,DatabaseName:e.model.dbName},ReportIds:e.reportIds}})).value()}}function t(e,n){return{model:e,reportIds:n}}function a(e){if(e)return e.replace(/^Show /,"Showing ")}e.createInterpretRequestScopeWireContract=n,e.createInterpretRequestScope=t,e.updateRestatement=a})(t=n.InterpretUtil||(n.InterpretUtil={}))})(t=n.utils||(n.utils={}))})(n=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var n;!(function(n){var t;!(function(n){var t,r=jsCommon.Lazy,a=e.visuals.plugins;!(function(e){function n(e){return i.getValue()[e]}function t(e){return s.getValue()[e]}function o(e,n){for(var t=[],r={},a=0,o=n.length;a<o;a++){var i=n[a];r[i.vsName+i.dbName]=i}for(var s=e.configs,c=0,u=s.length;c<u;c++){var l=s[c],p=l.Query||e.queryDefn,d=l.DataShapeBinding||e.dataShapeBinding,f=l.QueryMetadata||e.queryMetadata,i=r[e.virtualServerName+e.databaseName];null!=i&&t.push({config:{Query:p,QueryMetadata:f,DataShapeBinding:d,VisualizationType:l.VisualizationType,VisualElements:l.VisualElements,InsightType:l.InsightType},model:i,dataViewSource:e.dataViewSource})}return t}var i=new r(function(){var e={};return e[3]=a.card,e[13]=a.lineClusteredColumnComboChart,e[29]=a.multiRowCard,e[7]=a.clusteredBarChart,e[10]=a.clusteredColumnChart,e[20]=a.donutChart,e[16]=a.funnel,e[30]=a.gauge,e[22]=a.heatMap,e[9]=a.hundredPercentStackedBarChart,e[12]=a.hundredPercentStackedColumnChart,e[4]=a.lineChart,e[1]=a.map,e[19]=a.filledMap,e[2]=a.pivotTable,e[5]=a.pieChart,e[6]=a.scatterChart,e[8]=a.barChart,e[11]=a.columnChart,e[0]=a.tableEx,e[17]=a.treemap,e[23]=a.waterfallChart,e[26]=a.stackedAreaChart,e[32]=a.areaChart,e[33]=a.ribbonChart,e}),s=new r(function(){var e={};return e[a.card.name]=3,e[a.lineClusteredColumnComboChart.name]=13,e[a.multiRowCard.name]=29,e[a.clusteredBarChart.name]=7,e[a.clusteredColumnChart.name]=10,e[a.donutChart.name]=20,e[a.funnel.name]=16,e[a.gauge.name]=30,e[a.heatMap.name]=22,e[a.hundredPercentStackedBarChart.name]=9,e[a.hundredPercentStackedColumnChart.name]=12,e[a.lineChart.name]=4,e[a.map.name]=1,e[a.filledMap.name]=19,e[a.matrix.name]=2,e[a.pivotTable.name]=2,e[a.pieChart.name]=5,e[a.scatterChart.name]=6,e[a.barChart.name]=8,e[a.columnChart.name]=11,e[a.table.name]=0,e[a.tableEx.name]=0,e[a.treemap.name]=17,e[a.waterfallChart.name]=23,e[a.stackedAreaChart.name]=26,e[a.areaChart.name]=32,e[a.ribbonChart.name]=33,e});e.getPlugin=n,e.getType=t,e.interpretResultToConfig=o})(t=n.visualUtil||(n.visualUtil={}))})(t=n.utils||(n.utils={}))})(n=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var n;!(function(n){var t;!(function(n){var t;!(function(n){var t,r=e.visuals.plugins,a=e.explore.QueryProjectionBuilderCoreUtils.QueryProjectionBuilder,o=e.infonav.utils.visualUtil;!(function(e){function n(e,n,t){var r=o.getPlugin(e);if(null!=r){var a;switch(e){case 3:case 29:case 0:a=new i(r,n,t);break;case 2:a=new m(r,n,t);break;case 20:case 16:case 4:case 26:case 32:case 5:a=new s(r,n,t);break;case 23:a=new c(r,n,t);break;case 7:case 10:case 9:case 12:case 8:case 11:case 33:case 13:a=new u(r,n,t);break;case 1:case 22:a=new d(r,n,t);break;case 19:a=new f(r,n,t);break;case 17:a=new h(r,n,t);break;case 6:a=new p(r,n,t);break;case 30:a=new l(r,n,t);break;default:return}return a}}e.createProjectionBuilder=n})(t=n.QueryProjectionBuilderUtils||(n.QueryProjectionBuilderUtils={}));var i=(function(e){function n(n,t,r){return e.call(this,n,t,r)||this}return __extends(n,e),n.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 1===e.length&&e[0].name===a.ValuesRole},n.prototype.build=function(e){var n={};if(1===this.projectionsInfo.length)return a.addValuesRole(n,this.projectionsInfo[0]),n;for(var t=e.Primary.Groupings,r=t[0].Projections,o=0,i=r.length;o<i;o++)a.addValuesRole(n,this.projectionsInfo[r[o]]);return n},n})(a),s=(function(e){function n(n,t,r){return e.call(this,n,t,r)||this}return __extends(n,e),n.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return this.plugin.name===r.funnel.name?4===e.length&&e[0].name===a.CategoryRole&&e[1].name===a.YRole&&e[2].name===a.GradientRole&&e[3].name===a.TooltipRole:4===e.length&&e[0].name===a.CategoryRole&&e[1].name===a.SeriesRole&&e[2].name===a.YRole&&e[3].name===a.TooltipRole},n.prototype.build=function(e){var n=e.Primary.Groupings,t={};if(this.processPrimaryGroup(n[0],t),e.Secondary){var r=e.Secondary.Groupings;1===r.length&&this.processSecondaryGroup(r[0],t)}return t},n.prototype.processPrimaryGroup=function(e,n){for(var t=e.Projections,r=0,o=t.length;r<o;r++){var i=t[r],s=this.projectionsInfo[i];0===s.metadata.kind?(a.addCategoryRole(n,s),n[a.CategoryRole].addActiveQueryReference(s.projection.queryRef)):1===s.metadata.kind&&a.addYRole(n,s)}},n.prototype.processSecondaryGroup=function(e,n){for(var t=e.Projections,r=0,o=t.length;r<o;r++){var i=t[r];a.addSeriesRole(n,this.projectionsInfo[i])}},n})(a),c=(function(e){function n(n,t,r){return e.call(this,n,t,r)||this}return __extends(n,e),n.prototype.processSecondaryGroup=function(e,n){for(var t=e.Projections,r=0,o=t.length;r<o;r++){var i=t[r];a.addBreakdownRole(n,this.projectionsInfo[i])}},n})(s),u=(function(e){function n(n,t,r){return e.call(this,n,t,r)||this}return __extends(n,e),n.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return this.plugin.name===r.ribbonChart.name?4===e.length&&e[0].name===a.CategoryRole&&e[1].name===a.SeriesRole&&e[2].name===a.YRole&&e[3].name===a.TooltipRole:5===e.length&&e[0].name===a.CategoryRole&&e[1].name===a.SeriesRole&&e[2].name===a.YRole&&e[3].name===a.GradientRole&&e[4].name===a.TooltipRole},n})(s),l=(function(e){function n(n,t,r){return e.call(this,n,t,r)||this}return __extends(n,e),n.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 5===e.length&&e[0].name===a.YRole&&e[1].name===a.MinValueRole&&e[2].name===a.MaxValueRole&&e[3].name===a.TargetValueRole&&e[4].name===a.TooltipRole},n.prototype.processPrimaryGroup=function(e,n){for(var t=e.Projections,r=0,o=0,i=t;o<i.length;o++){var s=i[o],c=this.projectionsInfo[s];if(1===c.metadata.kind){switch(r){case 0:a.addYRole(n,c);break;case 1:a.addTargetValueRole(n,c);break;case 2:a.addMaxValueRole(n,c);break;case 3:a.addMinValueRole(n,c);break;case 4:a.addTooltipRole(n,c)}r++}}},n})(s),p=(function(e){function n(n,t,r){return e.call(this,n,t,r)||this}return __extends(n,e),n.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 8===e.length&&e[0].name===a.CategoryRole&&e[1].name===a.SeriesRole&&e[2].name===a.XRole&&e[3].name===a.YRole&&e[4].name===a.SizeRole&&e[5].name===a.GradientRole&&e[6].name===a.PlayRole&&e[7].name===a.TooltipRole},n.prototype.processPrimaryGroup=function(e,n){for(var t=e.Projections,r=0,o=0,i=t.length;o<i;o++){var s=t[o],c=this.projectionsInfo[s];if(0===c.metadata.kind)a.addCategoryRole(n,c);else if(1===c.metadata.kind){switch(r){case 0:a.addXRole(n,c);break;case 1:a.addYRole(n,c);break;case 2:a.addSizeRole(n,c);break;case 3:a.addGradientRole(n,c);break;case 4:a.addTooltipRole(n,c)}r++}}},n})(s),d=(function(e){function n(n,t,r){return e.call(this,n,t,r)||this}return __extends(n,e),n.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 7===e.length&&e[0].name===a.CategoryRole&&e[1].name===a.SeriesRole&&e[2].name===a.YRole&&e[3].name===a.XRole&&e[4].name===a.SizeRole&&e[5].name===a.GradientRole&&e[6].name===a.TooltipRole},n.prototype.processPrimaryGroup=function(e,n){for(var t=e.Projections,r=0,o=0,i=t;o<i.length;o++){var s=i[o],c=this.projectionsInfo[s];if(0===c.metadata.kind)a.addCategoryRole(n,c);else if(1===c.metadata.kind){switch(r){case 0:a.addSizeRole(n,c);break;case 1:a.addXRole(n,c);break;case 2:a.addYRole(n,c);break;case 3:a.addGradientRole(n,c);break;case 4:a.addTooltipRole(n,c)}r++}}},n})(s),f=(function(e){function n(n,t,r){return e.call(this,n,t,r)||this}return __extends(n,e),n.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 6===e.length&&e[0].name===a.CategoryRole&&e[1].name===a.SeriesRole&&e[2].name===a.YRole&&e[3].name===a.XRole&&e[4].name===a.SizeRole&&e[5].name===a.TooltipRole},n.prototype.processPrimaryGroup=function(e,n){for(var t=e.Projections,r=0,o=0,i=t;o<i.length;o++){var s=i[o],c=this.projectionsInfo[s];if(0===c.metadata.kind)a.addCategoryRole(n,c);else if(1===c.metadata.kind){switch(r){case 0:a.addSizeRole(n,c);break;case 1:a.addXRole(n,c);break;case 2:a.addYRole(n,c);break;case 3:a.addTooltipRole(n,c)}r++}}},n})(s),h=(function(e){function n(n,t,r){return e.call(this,n,t,r)||this}return __extends(n,e),n.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 5===e.length&&e[0].name===a.GroupRole&&e[1].name===a.DetailsRole&&e[2].name===a.ValuesRole&&e[3].name===a.GradientRole&&e[4].name===a.TooltipRole},n.prototype.processPrimaryGroup=function(e,n){for(var t=e.Projections,r=0,o=t.length;r<o;r++){var i=t[r],s=this.projectionsInfo[i];0===s.metadata.kind?(a.addGroupRole(n,s),n[a.GroupRole].addActiveQueryReference(s.projection.queryRef)):1===s.metadata.kind&&a.addValuesRole(n,s)}},n.prototype.processSecondaryGroup=function(e,n){for(var t=e.Projections,r=0,o=t.length;r<o;r++){var i=t[r];a.addDetailsRole(n,this.projectionsInfo[i])}},n})(s),m=(function(e){function n(n,t,r){return e.call(this,n,t,r)||this}return __extends(n,e),n.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 3===e.length&&e[0].name===a.RowsRole&&e[1].name===a.ColumnsRole&&e[2].name===a.ValuesRole},n.prototype.build=function(e){var n=e.Primary.Groupings,t={};if(this.processPrimaryGroups(n,t),e.Secondary){var r=e.Secondary.Groupings;this.processSecondaryGroups(r,t)}return t},n.prototype.processPrimaryGroups=function(e,n){if(e)for(var t=0,r=e.length;t<r;t++)this.processPrimaryGroup(e[t],n)},n.prototype.processSecondaryGroups=function(e,n){if(e)for(var t=0,r=e.length;t<r;t++)this.processSecondaryGroup(e[t],n)},n.prototype.processPrimaryGroup=function(e,n){for(var t=e.Projections,r=0,o=t.length;r<o;r++){var i=(t[r],this.projectionsInfo[t[r]]);0===i.metadata.kind?(a.addRowsRole(n,i),n[a.RowsRole].addActiveQueryReference(i.projection.queryRef)):1===i.metadata.kind&&a.addValuesRole(n,i)}},n.prototype.processSecondaryGroup=function(e,n){for(var t=e.Projections,r=0,o=t.length;r<o;r++){var i=this.projectionsInfo[t[r]];a.addColumnsRole(n,i),n[a.ColumnsRole].addActiveQueryReference(i.projection.queryRef)}},n})(a)})(t=n.util||(n.util={}))})(t=n.infonav||(n.infonav={}))})(n=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var n;!(function(n){var t;!(function(t){var r=e.infonav.utils.InterpretUtil,a=e.common.helpers.ModelConverterHelper,o=(function(){function t(e,t){this.services=t,this.placeholder=n.utils.QnaLanguageUtil.getPlaceholderText(this.services.localizationService),this.sendInterpretProbe()}return t.createOptions=function(){return{additionalServices:["$timeout","featureSwitchService","promiseFactory","conceptualSchemaProxy","localizationService"],scopedDependencies:["interpretProbe"]}},t.prototype.launchQna=function(){this.showQna(),this.services.$timeout((function(){return $(".qnaInputContainer #content").focus()}))},t.prototype.sendInterpretProbe=function(e){var o=this,i=_.filter(this.models,(function(e){return e&&a.getIsQnaSupported(e,o.services.featureSwitchService.featureSwitches)})),s=this.services.interpretProbe.probe(_.map(i,(function(e){return r.createInterpretRequestScope(e)})),e),c=this.services.promiseFactory.defer();return s.then((function(e){o.placeholder=n.utils.QnaLanguageUtil.getPlaceholderText(o.services.localizationService,e),t.preloadConceptualSchemas(o.models||[],o.services.conceptualSchemaProxy),c.resolve({})}),(function(){c.reject()})),c.promise},t.preloadConceptualSchemas=function(e,n){for(var r=3,a=Math.min(e.length,r),o=0,i=_.take(e,a);o<i.length;o++){var s=i[o];n.get(t.createDataSourceArray(s))}},t.createDataSourceArray=function(n){return e.explore.contracts.createDataSourceArray([{type:"dsr",id:n.id,packageId:n.packageId,name:void 0,dsr:{schemaName:void 0,vsName:n.vsName,dbName:n.dbName,modelId:n.id}}])},t})();t.QnaInputLauncherController=o})(t=n.controllers||(n.controllers={}))})(n=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var n;!(function(n){var t;!(function(t){t.QnaInputLauncher={templateUrl:"qnaInputLauncher/qnaInputLauncher.html",bindings:{models:"=",showQna:"=",qnaStyle:"<"},controller:e.common.createController(n.controllers.QnaInputLauncherController)}})(t=n.components||(n.components={}))})(n=e.infonav||(e.infonav={}))})(powerbi||(powerbi={})),powerbi.infonav.registerInfonavBootstrapComponent("QnaInputLauncher");var powerbi;!(function(e){var n;!(function(e){var n;!(function(n){function t(e,n,t,a,o){return new r(e,n,a,o||6e5)}n.createInterpretProbeService=t;var r=(function(){function n(e,n,t,r){this.lazyScoped=e,this.promiseFactory=n,this.featureSwitchService=t,this.probePromiseCache=new a(r)}return n.prototype.probe=function(n,t,r){var a=e.utils.InterpretUtil.createInterpretRequestScopeWireContract(n,this.featureSwitchService.featureSwitches);return _.isEmpty(a.InterpretRequestSubscopes)?this.promiseFactory.reject():this.probeInternal(a,t,r).promise},n.prototype.isProbeCompleted=function(e){var n=this.probePromiseCache.getPromise(e);return n&&n.isComplete},n.prototype.probeInternal=function(e,n,t){var r=this,a=this.probePromiseCache.getPromise(e);if(!a){var o=this.promiseFactory.defer();a={promise:o.promise,waitingInterprets:t?[t]:[],isComplete:!1},this.probePromiseCache.setPromise(e,a),this.sendProbeRequest(e,n).then((function(e){o.resolve(e.data)}),(function(){o.reject(),r.probePromiseCache.clearPromise(e)})),o.promise.finally((function(){a.isComplete=!0;var e=a.waitingInterprets,n=e.length;if(n>0){e[n-1].runToCompletion().finally((function(){for(var t=0;t<n-1;t++)e[t].reject()}))}a.waitingInterprets=[]}))}return t&&a.waitingInterprets.push(t),a},n.prototype.sendProbeRequest=function(e,n){return this.lazyScoped("interpretProxy").then((function(t){return t.probe(e,n)}))},n})(),a=(function(){function e(e){this.cache={},this.expirationInMilliseconds=e}return e.prototype.getPromise=function(n){var t=e.getCacheKey(n),r=this.cache[t];return r&&r.expiration<Date.now()&&(delete this.cache[t],r=void 0),r},e.prototype.setPromise=function(n,t){t.expiration=Date.now()+this.expirationInMilliseconds,this.cache[e.getCacheKey(n)]=t},e.prototype.clearPromise=function(n){delete this.cache[e.getCacheKey(n)]},e.getCacheKey=function(e){return _(e.InterpretRequestSubscopes).sortBy((function(e){return e.DbMoniker.VirtualServerName})).sortBy((function(e){return e.DbMoniker.DatabaseName})).map((function(e){return e.DbMoniker.DatabaseName+":"+e.DbMoniker.VirtualServerName+(e.ReportIds?":"+e.ReportIds.join(","):"")})).value().join("::")},e})()})(n=e.services||(e.services={}))})(n=e.infonav||(e.infonav={}))})(powerbi||(powerbi={})),define("InfoNavBootstrap/services/qnaExplore",["require","exports"],(function(e,n){function t(e,n,t,r,a,o,s){return new i(e,n,t,r,a,o,s)}Object.defineProperty(n,"__esModule",{value:!0});var r=powerbi,a=r.infonav.HostWarningConstants,o=r.explore.util.VisualContainerUtils;n.create=t;var i=(function(){function e(e,n,t,r,a,o,i){this.$compile=e,this.$timeout=n,this.featureSwitchService=t,this.eventBridge=r,this.lazyScoped=a,this.errorService=o,this.localizationService=i}return e.prototype.isSupported=function(e,n,t,r,o,i){return void 0===i&&(i=!1),__awaiter(this,void 0,powerbi.Promise,(function(){var s,c,u;return __generator(this,(function(l){switch(l.label){case 0:return!this.featureSwitchService.featureSwitches.qnaExplore||n&&!t||!r?[2,!1]:_.some(e.schemas,(function(e){return!e.isExtensionSchema&&!_.isEmpty(e.entities)&&e.capabilities&&e.capabilities.supportsQna}))?[4,this.lazyScoped("interpretProxy")]:[2,!1];case 1:return s=l.sent(),[4,s.probe(o?{InterpretRequestSubscopes:[{DbMoniker:o}]}:void 0,null)];case 2:return c=l.sent(),u=c&&!_.isEmpty(c.data)&&c.data[0].HostWarnings,u&&u.Code===a.MissingRuntimeModule&&!i&&this.errorService.infoCustom(this.localizationService.get("Qna_Explore_MissingBinariesTitle"),this.localizationService.get("Qna_Explore_MissingBinaries")),[2,!u||u.Code!==a.LanguageNotSupported&&u.Code!==a.SessionIsInactive&&u.Code!==a.MissingRuntimeModule]}}))}))},e.prototype.launch=function(e,n){var t=this,a=e.$new(),i={qnaCoreConfig:r.infonav.modules.QnaCoreModule,qnaArgs:{visualContainer:n}};_.assign(a,i);var s=this.$compile('<div class="qnaBox" pbi-lazy-load-contents="qnaCoreConfig"><qna-explore args="qnaArgs"></qna-explore></div>')(a);n.toolbar={element:$(s),theme:"lightTheme",removeOnBlur:_.noopTrue,preferHorizontalLayout:!1},this.$timeout((function(){t.eventBridge.publishToChannel(r.explore.services.events.visualContainerChanged,{affectContainer:o.contractEqualityComparator(n)})}))},e})()})),angular.module("powerbi.infonavbootstrap").run(["$templateCache",function(e){e.put("qnaInputLauncher/qnaInputLauncher.html",'<button class="qnaInputLauncher" ng-click="$ctrl.launchQna()" ng-style="$ctrl.qnaStyle"><span class="glyphicon pbi-glyph-qna icon"></span><span class="qnaInputLauncherText" ng-bind="$ctrl.placeholder"></span></button>')}]);