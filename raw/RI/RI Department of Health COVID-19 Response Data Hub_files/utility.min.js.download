var jsCommon;!function(e){var t;!function(e){function t(e){try{return btoa(atob(e))===e}catch(e){return!1}}e.isBase64=t}(t=e.Base64Utils||(e.Base64Utils={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t;!function(e){function t(e,t,r){if(e||t||r)return!e||t||r?e||!t||r?e||t||!r?$.extend(e,t,r):r:t:e}e.mergeUnionType=t}(t=e.UnionExtensions||(e.UnionExtensions={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t;!function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.SecurityWarning=2]="SecurityWarning"}(t=e.ModalDialogNotificationType||(e.ModalDialogNotificationType={})),e.PowerBIDefaultHelpPage="https://support.powerbi.com";var r=250,n=3e3,o=".infonav-modalDialog",i=".infonav-dialogTitle",a=".infonav-dialogCloseIcon",s=".infonav-dialogContent",u=".infonav-dialogActions",c=".glyphicon",l=".infonav-dialogContentNotificationText",d="infonav-modalContainerHost",m="."+d,f=".dialogMessage",p="infonav-describedBy",g='<div tabindex="0" prevent-focus-loss="true" focus-nav-mode="Group" class="infonav-modalContainer'+(location.search.indexOf("renderAsModalDialog")!==-1?" small":"")+'"><div class="infonav-modalDialog" tabindex="-1"><div class="infonav-dialogLayout themeableElement"><div class="infonav-dialogTitle" id='+p+' role="heading" aria-level="1"></div><input type="button" class="infonav-dialogCloseIcon"></input><div class="infonav-dialogContent"><div class="infonav-dialogActions"></div></div></div></div></div>',v='<div class="infonav-dialogContentNotification"><span class="glyphicon"></span><span class= "infonav-dialogContentNotificationText" > </span></div>',h='<input type="button"></input>',y='<input type="checkbox"></input>',C='<label class="form-label">',b="</label>",E=function(){function E(e,t){this.dialogHost=e,this.localizationMap=t,this.messageQueue=[],this.isReady=!1,this.messageCurrentlyShown=!1,this.initialized=!1}return E.prototype.refocus=function(){this.modalContainer.focus()},E.prototype.showMessage=function(e,t,r,n){var o=this;this.ensureInitialized();var i,a=[],s="primary";if(r||(r=this.localizationMap?this.localizationMap.closePromptText:InJs.UnlocalizedStrings.dialogCloseActionLabel),n){var u=$('<a target="_blank"/>').text(n.label).attr("href",n.url);i=$("<div/>").text(t+" ").append(u),t=void 0}a[0]=this.createButton(r,function(){o.hideDialog()},null,s),this.pushMessage(e,t,i,a,!0)},E.prototype.showPrompt=function(e,t,r,n){this.ensureInitialized();for(var o=new Array,i=0;i<r.length;i++){var a=r[i],s=a.cssClass;0===i&&(s+=" primary"),o[i]=this.createButton(a.labelText,a.actionCallback,a.data,s,a.disabled)}this.pushMessage(e,t,void 0,o,!!n)},E.prototype.showError=function(t,r,n,o,i){this.showCustomError(InJs.UnlocalizedStrings.errorDialogTitle,t,r,r!==e.TraceType.Fatal,n,o,i)},E.prototype.showCustomError=function(t,r,o,i,a,s,u,c,l,d,m,f,p){var g=this;this.ensureInitialized();var v=new Array;u?u.forEach(function(e){v.push(g.createButton(e.label,function(){g.hideDialog(),$.isFunction(s)&&s(e.resultValue)},null,e.cssClass,e.disabled))}):o!==e.TraceType.Fatal?v[0]=this.createButton(this.localizationMap?this.localizationMap.closePromptText:InJs.UnlocalizedStrings.dialogCloseActionLabel,function(){g.hideDialog(),$.isFunction(s)&&s(0)}):v[0]=this.createButton(this.localizationMap?this.localizationMap.refreshPagePromptText:InJs.UnlocalizedStrings.dialogRefreshPageActionLabel,function(){window.location.reload()},null,"primary");var h;h=d?$("<div/>").append(d):$("<div/>").text(r);var y,C=$("<div/>").addClass("infonav-dialogFooter");if(!_.isEmpty(a)){y=this.localizationMap&&this.localizationMap.errorDialogHelperText?this.localizationMap.errorDialogHelperText:InJs.UnlocalizedStrings.errorDialogHelperText,m&&(y=m),h.append($("<br/>")).append(y);var b=this.localizationMap?this.localizationMap.copyPromptText:InJs.UnlocalizedStrings.CopyActionLabel,E=this.localizationMap?this.localizationMap.copySuccessText:InJs.UnlocalizedStrings.SuccessActionLabel,T={title:t,message:d?d.text():r,helperText:y,additionalErrorInfo:a},F=$("<button></button>").text(b).addClass("modalCopyToClipboard").click(function(){g.tryCopyToClipboard(T)&&(F.text(E).addClass("modalCopySuccess"),setTimeout(function(){F.text(b).removeClass("modalCopySuccess")},n))});C.prepend(F)}this.addAdditionalErrorInfo(h,a,this.localizationMap?this.localizationMap.showTechnicalDetailsText:InJs.UnlocalizedStrings.showDetailsText),c&&(c.url===e.PowerBIDefaultHelpPage||c.isGetHelpTextReplaced?C.prepend($('<a class="modalErrorHelpLink" target="_blank"/>').text(c.label).attr("href",c.url)):v.unshift(this.createButton(c.label,function(){window.open(c.url)},null,"primary"))),h.append(C),this.pushMessage(t||InJs.UnlocalizedStrings.errorDialogTitle,void 0,h,v,i,l,void 0,void 0,f,p)},E.prototype.showCustomDialog=function(e,t,r,n,o,i,a,s,u,c,l,d,m,f,p,g){this.ensureInitialized(),this.modalDialogResizeHandler=this.modalDialogResizeHandler.bind(this),$(window).on("resize.modalDialog",this.modalDialogResizeHandler);var v=[];p&&(v[0]=this.createCheckbox(p.labelText,p.actionCallback,p.data));for(var h=0;h<r.length;h++){var y=r[h],C=y.cssClass;d||0!==h||(C+=" primary");v[p?h+1:h]=this.createButton(y.labelText,y.actionCallback,y.data,C,y.disabled)}return this.pushMessage(e,void 0,t,v,!!o,u,n,i,a,s,c,l,d,m,f,g),this.dialogContent},E.prototype.hideDialog=function(){var t=this;this.ensureInitialized(),$(window).off("resize.modalDialog"),this.modalContainer.fadeTo(r,0,function(){t.modalContainer.css(e.CssConstants.displayProperty,e.CssConstants.noneValue),t.modalDialogElement.removeClass(t.modalDialogCustomClass),t.modalContainer.removeClass(t.modalContainerCustomClass),t.currentModalDialogMessage&&t.currentModalDialogMessage.onDialogClosed&&t.currentModalDialogMessage.onDialogClosed(),t.messageCurrentlyShown=!1;var r=t.messageQueue.shift();r?t.showDialogInternal(r):(t.modalContainer.off(),t.modalContainer.remove(),$(m).off(),$(m).remove(),t.initialized=!1,t.unregisterFocusManager&&t.unregisterFocusManager())})},E.prototype.ensureInitialized=function(){var t=this;if(!this.initialized){if(this.modalContainer=$(g),this.modalDialogElement=this.modalContainer.find(o),this.dialogTitle=this.modalContainer.find(i),this.dialogCloseButton=this.modalContainer.find(a),this.dialogContent=this.modalContainer.find(s),this.dialogActions=this.modalContainer.find(u),this.dialogCloseButton.on(e.DOMConstants.mouseClickEventName,function(){return t.hideDialog()}).attr("aria-label",this.localizationMap?this.localizationMap.closePromptText:InJs.UnlocalizedStrings.dialogCloseActionLabel),!this.dialogHost){var r=$(m);_.isEmpty(r)||r.remove(),r=InJs.DomFactory.div().addClass(d),r.attr("role","dialog"),r.attr("aria-labelledby",p),this.dialogHost=$(e.DOMConstants.DocumentBody).append(r),this.dialogHost=r}this.dialogHost.append(this.modalContainer),this.isReady=!0,this.messageQueue.length>0&&this.showDialogInternal(this.messageQueue.shift()),this.initialized=!0,this.unregisterFocusManager=e.FocusManager.getInstance().register(this.dialogHost.get(0),!0),this.dialogHost=void 0}},E.prototype.updatePosition=function(t){var n=(this.modalContainer.height()-this.modalDialogElement.height())/2,o=(this.modalContainer.width()-this.modalDialogElement.width())/2,i={top:n+e.CssConstants.pixelUnits,left:o+e.CssConstants.pixelUnits};t?this.modalDialogElement.animate(i,r):this.modalDialogElement.css(i)},E.prototype.addAdditionalErrorInfo=function(t,r,n){var o=this;if(!_.isEmpty(r)){for(var i=$("<p />"),a=0,s=r;a<s.length;a++){var u=s[a];i.append(InJs.InfoNavUtility.constructErrorField(u.errorInfoKey,u.errorInfoValue))}var c=InJs.InfoNavUtility.constructShowDetailsContainer(i,n);t.append($("<br />")),t.append(c),t.find(".showAdditionalDetailsLink").on(e.DOMConstants.mouseClickEventName,function(){o.updatePosition(!0)})}},E.prototype.pushMessage=function(e,t,r,n,o,i,a,s,u,c,l,d,m,f,p,g){"undefined"==typeof o&&(o=!0),"undefined"==typeof u&&(u=""),"undefined"==typeof c&&(c="");var v={titleText:e,messageText:t,dialogContent:r,dialogButtons:n,onDialogDisplayed:a,isDismissable:o,dialogCssClass:u,containerCssClass:c,onDialogClosed:i,notificationType:l,notificationText:d,htmlMessageText:f};this.messageQueue.push(v),!this.messageCurrentlyShown&&this.isReady&&this.showDialogInternal(this.messageQueue.shift(),s,m,p,g)},E.prototype.tryCopyToClipboard=function(e){if(!e)return!1;var t=[];if(e.title&&t.push(e.title),e.message&&t.push(e.message),e.helperText&&t.push(e.helperText),e.additionalErrorInfo)for(var r=0,n=e.additionalErrorInfo;r<n.length;r++){var o=n[r];t.push(o.errorInfoKey+": "+o.errorInfoValue)}var i=t.join("\n");try{return powerbi.CopyPasteService.create().copyText(i),!0}catch(e){return!1}},E.prototype.showDialogInternal=function(t,n,o,i,a){var s=this;if(this.currentModalDialogMessage=t,this.messageCurrentlyShown=!0,this.dialogContentNotification=$(v),this.dialogContentNotificationIcon=this.dialogContentNotification.find(c),this.dialogContentNotificationText=this.dialogContentNotification.find(l),this.dialogTitle.empty(),this.dialogContent.empty(),this.dialogActions.empty(),this.dialogTitle.text(t.titleText).attr("title",t.titleText),i?(this.appendNotification(t.notificationType,t.notificationText),this.appendMessageText(t.dialogContent,t.messageText,t.htmlMessageText)):(this.appendMessageText(t.dialogContent,t.messageText,t.htmlMessageText),this.appendNotification(t.notificationType,t.notificationText)),t.isDismissable?this.dialogCloseButton.css(e.CssConstants.displayProperty,e.CssConstants.blockValue):this.dialogCloseButton.css(e.CssConstants.displayProperty,e.CssConstants.noneValue),t.dialogButtons.length>0){this.dialogActions.show();for(var u=0,d=t.dialogButtons;u<d.length;u++){var m=d[u];this.dialogActions.append(m)}}else this.dialogActions.hide();var f=this.dialogContent.find(".infonav-dialogFooter");f.length>0?f.append(this.dialogActions):this.dialogContent.after(this.dialogActions),t.dialogCssClass&&(this.modalDialogElement.addClass(t.dialogCssClass),this.modalDialogCustomClass=t.dialogCssClass),t.containerCssClass&&(this.modalContainer.addClass(t.containerCssClass),this.modalContainerCustomClass=t.containerCssClass);var p=this.modalContainer.css(e.CssConstants.displayProperty)===e.CssConstants.noneValue?this.modalContainer:this.modalDialogElement;p.fadeTo(0,0),this.updatePosition(!1),p.fadeTo(r,1,function(){if(t.onDialogDisplayed&&t.onDialogDisplayed(s.dialogContent),!(s.modalDialogElement.find("dialog-frame").length>0)){0===s.modalDialogElement.find(":focus").length&&s.modalDialogElement.focus(),a&&s.modalDialogElement.keydown(function(e){27===e.keyCode&&s.hideDialog()});var e=s.dialogActions.find("input");!o&&e.length>0&&e[0].focus(),n&&s.dialogContent.parent().find(".infonav-dialogActions input[type=button]:first").focus()}})},E.prototype.appendMessageText=function(e,t,r){_.isEmpty(t)&&e?this.dialogContent.append(e):this.dialogContent.text(t),_.isEmpty(r)||(this.dialogContentMessage=this.dialogContent.find(f),this.dialogContentMessage.html(r))},E.prototype.appendNotification=function(e,r){if(null!==e&&!_.isEmpty(r)){switch(e){case t.Info:this.dialogContentNotificationIcon.addClass("pbi-glyph-info glyph-mini"),this.dialogContentNotification.addClass("typeInfo");break;case t.Warning:this.dialogContentNotificationIcon.addClass("pbi-glyph-warning glyph-mini"),this.dialogContentNotification.addClass("typeWarning");break;case t.SecurityWarning:this.dialogContentNotificationIcon.addClass("pbi-glyph-securityalert glyph-mini"),this.dialogContentNotification.addClass("typeSecurityWarning")}this.dialogContentNotificationText.html(r),this.dialogContent.append(this.dialogContentNotification)}},E.prototype.createButton=function(t,r,n,o,i){var a=this,s=$(h);return s.attr("value",t),s.on(e.DOMConstants.mouseClickEventName,function(){r(s,a.dialogContent,n)}),o&&s.addClass(o),i&&s.prop("disabled",!0),s},E.prototype.createCheckbox=function(t,r,n){var o=this,i='<div class="pbi-input checkbox">'+y+C+t+b+"</div>",a=$(i),s=a.find("input");return s.on(e.DOMConstants.changeEventName,function(){r(s,o.dialogContent,n)}),a},E.prototype.modalDialogResizeHandler=function(){this.updatePosition(!1)},E}();e.ModalDialog=E}(jsCommon||(jsCommon={}));var InJs;!function(e){var t=function(){function e(e,t,r,n,o){this.labelText=e,this.actionCallback=t,this.data=r,this.cssClass=n,this.disabled=!!o}return e}();e.ModalDialogAction=t}(InJs||(InJs={}));var jsCommon;!function(e){var t=function(){function e(e){this.count=0,this.top=-1,this.size=e,this.data=new Array(e)}return e.prototype.item=function(e){var t=this.top-(this.count-1);return t<0&&(t+=this.size),this.data[(e+t)%this.size]},e.prototype.push=function(e){this.count<this.size&&this.count++,this.top=++this.top%this.size,this.data[this.top]=e},e.prototype.pop=function(){if(0!==this.count){this.count--;var e=this.data[this.top];return delete this.data[this.top],--this.top===-1&&this.count>0&&(this.top=this.size-1),e}},e.prototype.peek=function(){return this.data[this.top]},e.prototype.clear=function(){this.count=0,this.top=-1,this.data=new Array(this.size)},Object.defineProperty(e.prototype,"length",{get:function(){return this.count},enumerable:!0,configurable:!0}),e}();e.CircularStack=t}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t,r=powerbi.Double;!function(e){function t(e,t,n){if(0===n)return null;for(var o=0,i=0,a=t+n-1;i<n;i++,a--){var s=e.charCodeAt(a)-48;if(s<0||9<s)return null;o+=s*r.pow10(i)}return o}function n(e,t){return new RegExp(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t)}e.parseIntSubstrFast=t,e.literalStringToRegex=n}(t=e.StringExtensions||(e.StringExtensions={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t,r=powerbi.Double,n=powerbi.contract,o=e.StringExtensions.parseIntSubstrFast;!function(t){function i(e){return(e.getTime()-6e4*e.getTimezoneOffset())%864e5===0}function a(){return"undefined"!=typeof moment}function s(e){var t=u(e);if(t)return t;var r=moment(e);return r.isValid()?r.toDate():null}function u(e){if(e){var t=e.length;if(!(t<=18||t>28)){var n=e[10];if("-"===e[4]&&"-"===e[7]&&("T"===n||" "===n)&&":"===e[13]&&":"===e[16]){var i=o(e,0,4),a=o(e,5,2),s=o(e,8,2),u=o(e,11,2),c=o(e,14,2),l=o(e,17,2),d="Z"===e.charAt(t-1);d&&t--;var m=0;if(t>19){if("."!==e[19])return;var f=t-20,p=o(e,20,f);if(null===p)return;m=p*r.pow10(3-f)}if(null!==i&&null!==a&&null!==s&&null!==u&&null!==c&&null!==l&&null!==m)return d?new Date(Date.UTC(i,a-1,s,u,c,l,m)):new Date(i,a-1,s,u,c,l,m)}}}}function c(e){return moment.utc(e).toDate()}function l(e){return h+e.getTime().toString()+y}function d(r){if(e.Utility.throwIfNullOrEmptyString(r,null,"deserializeDate","Cannot deserialize empty string"),n.check(0===r.indexOf(h)&&_.endsWith(r,y),"Cannot deserialize empty string"),t.isMomentPresent()){var o=moment(r);return n.check(o.isValid(),"parsedValue.isValid must be true"),o.toDate()}var i=r.substring(h.length,r.length-y.length);n.check(/^\-?\d+$/.test(i),"Cannot deserialize invalid date");var a=parseInt(i,10);return n.check(!isNaN(a),"Cannot deserialize invalid date"),new Date(a)}function m(e){try{return d(e)}catch(e){}}function f(e,t,r,n){var o=moment().subtract(r,t);return n&&(o=o.startOf(t)),moment(e)>=o}function p(e,t){return t.toLocaleTimeString(e,{second:"numeric",minute:"numeric",hour:"numeric"})}function g(e,t){return t.toLocaleDateString(e,{second:"numeric",minute:"numeric",hour:"numeric",weekday:"short"})}function v(e,t){return t.toLocaleDateString(e,{second:"numeric",minute:"numeric",hour:"numeric",day:"numeric",month:"short",year:"numeric"})}var h="/Date(",y=")/";t.isLocalMidnight=i,t.isMomentPresent=a,t.parseIsoDate=s,t.parseIsoDateFast=u,t.parseUtcDate=c,t.serializeDate=l,t.deserializeDate=d,t.tryDeserializeDate=m,t.isContainedInTimeFrame=f,t.GetTime=p,t.GetDayWithTime=g,t.GetFullDateWithTime=v}(t=e.DateExtensions||(e.DateExtensions={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t;!function(e){function t(e){e.message=e.message&&i(e.message),e.stack=e.stack&&i(e.stack)}function r(t,r,n,o){if(!(n instanceof Error))try{throw new Error("Error wrapper for thrown object: "+JSON.stringify(n))}catch(e){n=e}if(!(n.rejection&&n.rejection.clientError&&n.rejection.clientError.ignorable)){e.stripPII(n);var i=n.message,a=n.stack;try{o?t.logChildEvent(o.event,r,a,i):t.logEvent(r,a,i)}catch(e){}}}function n(e,r,n){return function(o,i){t(o);var a=o.message+' (caused by "'+i+'")\n',s=(o.stack||o).toString(),u=a+s;try{e.logEvent(n,s,a);var c={consoleMessage:u,type:"console_log",createdTime:new Date};r.addLogEntry(c)}catch(e){}}}function o(e,r,n,o){return function(i,a,s,u,c){if(2!==s||8228!==u||!_.includes(a,"powerbiportal.dependencies.bundle")){if(c&&c.message&&c.stack){t(c);var l=c.message,d=c.stack;e.logEvent(o,a,s,u||0,d,l)}else if("object"==typeof i&&i.message&&i.stack){t(i);var l=i.message,d=i.stack;e.logEvent(o,a,s,u||0,d,l)}else{var l=JSON.stringify(i,Object.getOwnPropertyNames(i));e.logEvent(n,a,s,u||0,l)}return r(i,a,s,u,c),!0}}}function i(e){return e.indexOf("infdig")>=0?"[$rootScope:infdig]: (PII Removed)":e}e.stripPII=t,e.handleErrorAndLogTelemetry=r,e.getExceptionHandler=n,e.getWindowOnErrorWrapper=o}(t=e.ExceptionHelper||(e.ExceptionHelper={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t=function(){function e(){}return e.clearQueryString=function(t){var r=e.parseQueryString();return delete r[t],e.rebuildQueryString(r)},e.clearQueryStrings=function(t){for(var r=e.parseQueryString(),n=0,o=t;n<o.length;n++){delete r[o[n]]}return e.rebuildQueryString(r)},e.addOrUpdateQueryString=function(t,r){var n=e.parseQueryString();return n[t]=r,e.rebuildQueryString(n)},e.addOrUpdateQueryStringToUrl=function(t,r){for(var n=e.parseUrl(t),o=e.clearAllQueriesFromUrl(t),i=0,a=Object.keys(r);i<a.length;i++){var s=a[i];n[s]=r[s]}return o+e.rebuildQueryString(n)},e.getQueryStringValue=function(t){return e.parseQueryString()[t]},e.parseUrl=function(t){var r=t.indexOf("?"),n=r>=0?t.substr(r):void 0;return e.parseQueryString(n)},e.parseQueryString=function(e){void 0===e&&(e=window.location.search);var t={},r=e;if(r&&"?"===r.substr(0,1))for(var n=r.substr(1).split("&"),o=0,i=n;o<i.length;o++){var a=i[o],s=a.split("="),u=s[0],c=s.slice(1),l=c.join("=");t[decodeURIComponent(u)]=decodeURIComponent(l)}return t},e.rebuildQueryString=function(e){var t="",r=!0;for(var n in e)r||(t+="&"),t+=encodeURIComponent(n)+"=",e[n]&&(t+=encodeURIComponent(e[n])),r=!1;return r||(t="?"+t),t},e.clearAllQueriesFromUrl=function(e){var t=e.indexOf("?");return t>=0?e.substr(0,t):e},e.OriginClientActivityIdParameterName="caid",e.OriginRootActivityIdParameterName="raid",e.OriginActivityIdParameterName="aid",e}();e.QueryStringUtil=t}(jsCommon||(jsCommon={}));var powerbi;!function(e){function t(e){return new n(e)}function r(e){return new n(e)}e.createRejectablePromise2=t,e.createRejectablePromise=r;var n=function(){function e(e){var t=this;this.deferred=e,this.state=0,e.promise.then(function(){return t.state=1},function(){return t.state=2})}return e.prototype.then=function(e,t){return this.deferred.promise.then(e,t)},e.prototype.catch=function(e){return this.deferred.promise.catch(e)},e.prototype.finally=function(e){return this.deferred.promise.finally(e)},e.prototype.resolved=function(){return 1===this.state},e.prototype.rejected=function(){return 2===this.state},e.prototype.pending=function(){return 0===this.state},e.prototype.reject=function(e){this.pending()&&(this.deferred.reject(e),this.state=2)},e}()}(powerbi||(powerbi={}));var powerbi;!function(e){var t=500,r=function(){function r(e,r){this.maxCacheEntries=r?r:t,this.cache={},this.promiseFactory=e}return r.prototype.getEntryCount=function(){return Object.keys(this.cache).length},r.prototype.hasCacheEntry=function(e){return!!this.getCacheEntry(e)},r.prototype.createCacheEntry=function(t,r,n,o){var i=this,a=this.getCacheEntry(t);if(t&&!a){var s=this.promiseFactory,u=this.cache,c=s.defer(o),l=e.createRejectablePromise(c),d=s.defer(o),m=e.createRejectablePromise2(d);return a={promise:m,refCount:0,context:r},this.appendCacheEntryInternal(t,a),this.getEntryCount()>this.maxCacheEntries&&this.removeCacheEntryInternal(this.firstKey),l.then(function(e){a=a,a.updateResult&&(e=a.updateResult(e)),a.result=n?n(e):e,d.resolve(e)},function(e){return d.reject(e)}).finally(function(){delete a.updateResult}),m.finally(function(){u[t]&&(delete u[t].promise,m.rejected()&&i.removeCacheEntryInternal(t))}).catch(function(e){return l.reject(e)}),{deferred:c,promise:l}}},r.prototype.clearEntry=function(e,t){var r=this.getCacheEntry(e);if(r){var n=r.promise;return t&&n?n.reject():this.removeCacheEntryInternal(e),!0}return!1},r.prototype.clearAllEntries=function(e){for(var t in this.cache)this.clearEntry(t,e)},r.prototype.bindCacheEntry=function(t,r,n){var o=this.getCacheEntry(t);if(void 0!==o){var i=this.promiseFactory.defer(n),a=e.createRejectablePromise2(i);if(o.result){var s=r?r(o.result):o.result;return i.resolve(s),a}var u=o.promise;if(!u)return i.reject(void 0),a;o.refCount++;var c=function(e){o.refCount--,0===o.refCount&&u.pending()&&u.reject(e)};return a.then(function(){return c()},function(e){return c(e)}),u.then(function(e){var t=r?r(e):e;i.resolve(t)},function(e){return i.reject(e)}),a}},r.prototype.getEntryContext=function(e){var t=this.getCacheEntry(e);if(t)return t.context},r.prototype.keys=function(){return Object.keys(this.cache)},r.prototype.rewriteAllEntries=function(e){var t=[],r=!!e.rewriteKey,n=!!e.rewriteResult,o=this.cache;for(var i in o){if(r){var a=e.rewriteKey(i);a!==i&&t.push({oldKey:i,newKey:a})}if(n){var s=o[i];s&&s.result&&e.rewriteResult?s.result=e.rewriteResult(s.result,i):s.updateResult=function(t){return e.rewriteResult&&e.rewriteResult(t,i)||t}}}for(var u=0,c=t.length;u<c;u++)this.changeCacheKey(t[u].oldKey,t[u].newKey)},r.prototype.putCacheResult=function(e,t,r){var n=this.getCacheEntry(e);n&&(n.result?n.result=r?r(t):t:n.updateResult=function(){return t})},r.prototype.appendCacheEntryInternal=function(e,t){if(this.cache[e]&&this.removeCacheEntryInternal(e),this.firstKey){this.cache[this.lastKey].nextKey=e,t.previousKey=this.lastKey,this.lastKey=e,t.nextKey=void 0}else this.firstKey=e,this.lastKey=e,t.nextKey=void 0,t.previousKey=void 0;this.cache[e]=t},r.prototype.removeCacheEntryInternal=function(e){var t=this.cache[e];if(t){var r=t.previousKey,n=t.nextKey;if(r){this.cache[r].nextKey=n}else this.firstKey=n;if(n){this.cache[n].previousKey=r}else this.lastKey=r;delete this.cache[e]}},r.prototype.changeCacheKey=function(e,t){if(!t)return this.clearEntry(e,!0);if(this.hasCacheEntry(t)||!this.hasCacheEntry(e))return!1;var r=this.getCacheEntry(e);return this.removeCacheEntryInternal(e),this.appendCacheEntryInternal(t,r),!0},r.prototype.getCacheEntry=function(e){var t;if(e&&(t=this.cache[e])&&(t.promise||t.result))return t},r}();e.RejectablePromiseCache=r}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e){return null!=e.composed&&null!=e.repeat&&(!e.composed||e.repeat&&(17===e.keyCode||r.isNudgeModifierKey(e.keyCode)))}var r=jsCommon.KeyUtils;e.visualThemeChanged={type:2,name:"visualThemeChanged"},e.isKeyboardEventIncomplete=t}(t=e.events||(e.events={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){e.HighContrastModeChangedEvent={type:1,name:"highContrastModeChanged"}}(t=e.events||(e.events={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t,r=jsCommon.ArrayExtensions;!function(e){function t(e,t){if(e&&t){var r;return g(e,t,function(e,t,n){return r=t,e}),r}}function n(e,t){var r;return g(e.name,t,function(e,t,n){return r=e,e}),r}function o(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return e.concat(t)}function i(e,t,n){return g(t.name,n,function(t,n,o){if(!h(n))return t;var i=n.clone?n.clone():_.clone(n);i.children=n.children.concat([e]);for(var a=0,s=i.children;a<s.length;a++){s[a].parentGroup=i}return r.rewriteArray(t,function(e){return e===n?i:e})})}function a(e,t,n){return void 0===n&&(n=!0),t=g(e.name,t,function(e,t,n){return r.filterArray(e,function(e){return t!==e})}),n&&(t=p(t)),t}function s(e,t){return e=v(e,function(e){return r.filterArray(e,function(e){return!t(e)})}),p(e)}function u(e,t,n,o){return e.parentGroup=void 0,n=a(e,n,!1),n=g(t.name,n,function(t,n,i){return r.spliceArray(t,function(t){return t===n?o?[t,e]:[e,t]:[t]})}),p(n)}function c(e,t){for(var r=0,n=e.children;r<n.length;r++){n[r].parentGroup=e}return t=f(e.children,e,t),p(t)}function l(e,t){for(var n=0,o=e.children;n<o.length;n++){o[n].parentGroup=void 0}return g(e.name,t,function(t,n,o){return r.spliceArray(t,function(t){return t===e?e.children:[t]})})}function d(e,t){if(e.length<2)return t;var r=_.chain(e).map(function(e){return e.children}).flatten().value(),n=e[0],o=n.clone?n.clone():_.clone(n);o.children=r;for(var i=0,a=o.children;i<a.length;i++){a[i].parentGroup=o}return f(e,o,t)}function m(e,t,r){for(var n=r||[],o=0,i=e;o<i.length;o++){var a=i[o];h(a)?n=m(a.children,t,n):t(a)&&(n=n.concat([a]))}return n}function f(e,t,n){return v(n,function(n){return r.spliceArray(n,function(r){return r===e[0]?[t]:_.includes(e,r)?[]:[r]})})}function p(e){return v(e,function(e){return r.filterArray(e,function(e){return!h(e)||!_.isEmpty(e.children)})})}function g(e,t,n){for(var o=function(o){var i=t[o];if(i.name===e)return{value:n(t,i,o)};if(h(i)){var a=g(e,i.children,n);if(a!==i.children){var s=i.clone?i.clone():_.clone(i);s.children=a;for(var u=0,c=s.children;u<c.length;u++){c[u].parentGroup=s}return{value:r.rewriteArray(t,function(e){return e===i?s:e})}}}},i=0;i<t.length;i++){var a=o(i);if("object"==typeof a)return a.value}return t}function v(e,t){for(var n=function(n){if(h(n)){var o=v(n.children,t);if(o!==n.children){var i=n.clone?n.clone():_.clone(n);i.children=o;for(var a=0,s=i.children;a<s.length;a++){s[a].parentGroup=i}e=r.rewriteArray(e,function(e){return e===n?i:e})}}},o=0,i=e;o<i.length;o++){n(i[o])}return e=t(e)}function h(e){return void 0!==e.children}e.find=t,e.getSiblingList=n,e.add=o,e.addToGroup=i,e.remove=a,e.removeBy=s,e.move=u,e.group=c,e.ungroup=l,e.merge=d,e.flattenItems=m}(t=e.ItemGroupingManager||(e.ItemGroupingManager={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t=function(){function t(e){this.telemetryService=e,this.element=document.createElement("textarea"),this.element.style.position="absolute",this.element.style.left="-9999px"}return t.prototype.copyText=function(e,t,r){var n;"string"==typeof e?n=e:"function"==typeof e?n=e():debug.assertNever(e),this.copyToClipboard(n),this.logTelemetry(t,"Value",r)},t.prototype.copyGrid=function(e,t,r){var n=e(),o=n.grid,i=n.coveragePercentage,a=[];if(!_.isEmpty(o))for(var s=0,u=o;s<u.length;s++){var c=u[s];if(!_.isEmpty(c)){for(var l=0,d=c;l<d.length;l++){var m=d[l];m=this.removeBreaks(m)}a.push(c.join("\t"))}}this.copyToClipboard(a.join("\n")),this.logTelemetry(t,"Selection",r,i)},t.prototype.removeBreaks=function(e){return e.replace(new RegExp("\t","g")," ").replace(new RegExp("\r\n","g")," ").replace(new RegExp("\n","g")," ")},t.prototype.copyToClipboard=function(e){this.element.value=e,document.body.appendChild(this.element);var t=document.activeElement;this.element.select(),document.execCommand("copy"),document.body.removeChild(this.element),t&&t.focus()},t.prototype.logTelemetry=function(t,r,n,o){t&&t.logEvent(e.telemetry.EXCopyActionClicked,r,n||"(unknown)",o||0)},t}();e.CopyPasteService=t,function(e){function t(){return r||(r=new e),r}var r;e.create=t}(t=e.CopyPasteService||(e.CopyPasteService={}))}(powerbi||(powerbi={}));var powerbi;!function(e){function t(e,t,r,o,i){return new n(e,t,r,o,i)}var r=jsCommon.Utility;e.createHighContrastService=t;var n=function(){function t(t,r,n,o,i){var a=this;this.hostService=t,this.highContrastCssGenerationService=r,this.themeServiceBase=n,this.eventBridge=o;o.createChannelSubscriptionManager().subscribe(e.events.HighContrastModeChangedEvent,function(e,t){return a.onHighContrastModeChanged(t)});this.currentTheme=e.getThemeMetadata("None",2,i),this.initialize()}return t.prototype.initialize=function(e){this.themes=e||{};var t=this.hostService.getHighContrastTheme();this.onHighContrastModeChanged({HighContrastThemeJson:t})},t.prototype.getHighContrastTheme=function(){var e=this.hostService.getHighContrastTheme();return e&&JSON.parse(e)},t.prototype.onHighContrastModeChanged=function(e){var t=e.HighContrastThemeJson,n=t&&JSON.parse(t);if(_.isEmpty(n))this.setHighContrastMode("None",n);else{var o=this.themeServiceBase.createHighContrastTheme(n),i=o.name+r.generateGuid();this.themeServiceBase.addCustomTheme(i,o),this.setHighContrastMode(i,n)}},t.prototype.setHighContrastMode=function(t,r){this.currentTheme=this.themes.highContrastTheme||this.currentTheme,this.currentTheme.name!==t&&("None"!==t?(this.currentTheme.name=t,this.highContrastCssGenerationService.applyHighContrastTheme(t,{foregroundColor:r.foreground,backgroundColor:r.background,linkColor:r.hyperlink,buttonBackgroundColor:r.buttonBackground||r.background,buttonForegroundColor:r.buttonText||r.button,disabledTextColor:r.disabledText,selectedBackgroundColor:r.selectedBackground||r.selected,selectedForegroundColor:r.selectedText||r.foreground}),this.themes.highContrastTheme=this.currentTheme):(this.highContrastCssGenerationService.removeHighContrastStyle(),delete this.themes.highContrastTheme),this.eventBridge.publishToChannel(e.events.visualThemeChanged))},t}()}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){e.EventFactories={}}(t=e.telemetry||(e.telemetry={}))}(powerbi||(powerbi={})),function(e){function t(e){var t,r,n,o=0;if(0===e.length)return o;var i=e.toLowerCase();for(t=0,n=i.length;t<n;t++)r=i.charCodeAt(t),o=(o<<5)-o+r,o|=0;return o}function r(e){return t(e).toString()}function n(e,t,r){var n=r||e||{};if(r&&e&&(r=jsCommon.UnionExtensions.mergeUnionType(r,e)),t)for(var o in t)if(t.hasOwnProperty(o)){var i=t[o];void 0!==i&&i!==!1&&(n[o]=i)}return n}function o(e,t,r){if(r){var n=[];for(var o in r){var i=t[r[o]];void 0!==i&&i!==!1||n.push(r[o])}t=_.omit(t,n)}return _.extend(e,t),e}function i(e,t,r,n,i,a,s,u,c){var m={};return _.isEmpty(n)||(m=d[n](t).info),{name:e,category:i,eventTypeId:a,level:s,mobileCategory:u,time:Date.now(),id:l.generateGuid(),formatted:function(){return o(m,t,c)},info:t,loggers:r}}function a(e,t){var r=Zone.current;if(r&&r.name===e){var n=r.get("data");if(n){for(var o=0,i=m;o<i.length;o++){var a=i[o];if(void 0!==t[a])throw new Error("Field '"+a+"' is restricted from override.")}var s=n.monitoredActivity&&n.monitoredActivity.activityEvent;_.extend(s.info,t)}}}function s(e,t,r){return e?e.run(function(){return t.apply(r)}):r?r.fn():t()}function u(e){return e&&e.get("isAngularZone")===!0}function c(e){for(var t=!1,r=e;r&&u(r);){if(r._zoneDelegate._taskCounts.microTask>0){t=!0;break}r=r.parent}return t}var l=jsCommon.Utility,d=e.telemetry.EventFactories,m=["sessionId","tenantObjectId","userObjectId","userId","isInternalUser","sessionSource"];e.getHashCode=t,e.obfuscate=r,e.extendFormatted=n,e.extendFormattedEx=o,e.telemetryEventFactory=i,e.fillTelemetryEvent=a,e.zoneify=s,e.isAngularZone=u,e.hasPendingMicrotasks=c}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(t,r,n,o,i,a,s,u,c,l,d,m,f,p){void 0===r&&(r=!1),void 0===n&&(n=void 0),void 0===o&&(o=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===s&&(s=!1),void 0===u&&(u=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===m&&(m=!1),void 0===f&&(f=void 0),void 0===p&&(p=!1);var g={parentId:t,isError:r,errorSource:n,errorCode:o,activityName:i,activityId:a,isCancelled:s,pingLatency:u,errorMessage:c,folderId:l,activeFolderCapacityId:d,fluentUI:m,baseVersion:f,isFireAndForget:p};return{info:g,formatted:function(){return e.extendFormatted({parentId:g.parentId},{isError:g.isError,errorSource:g.errorSource,errorCode:g.errorCode,activityName:g.activityName,activityId:g.activityId,isCancelled:g.isCancelled,pingLatency:g.pingLatency,errorMessage:g.errorMessage,folderId:g.folderId,activeFolderCapacityId:g.activeFolderCapacityId,
fluentUI:g.fluentUI,baseVersion:g.baseVersion,isFireAndForget:g.isFireAndForget})}}}function n(t,n,o,i,a,s,u,c,l,d,m,f,p,g,v,h){var y=r(o,i,a,s,u,c,l,d,m,f,p,g,v,h),C=P(y.info,{start:t,end:n});return{info:C,formatted:function(){return e.extendFormatted({start:C.start,end:C.end},null,y.formatted())}}}function o(t,n,o,i,a,s,u,c,l,d,m,f,p,g){var v=r(t,n,o,i,a,s,u,c,l,d,m,f,p,g);return{info:v.info,formatted:function(){return e.extendFormatted(null,null,v.formatted())}}}function i(t,r,n,i,a,s,u,c,l,d,m,f,p,g,v,h){var y=o(n,i,a,s,u,c,l,d,m,f,p,g,v,h),C=P(y.info,{start:t,end:r});return{info:C,formatted:function(){return e.extendFormatted({start:C.start,end:C.end},null,y.formatted())}}}function a(r,n,o){var i={type:r,message:n,additionalInfoJson:o};return{name:t.TraceEventName,category:e.TelemetryCategory.Trace,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({type:i.type,message:i.message,additionalInfoJson:i.additionalInfoJson},null)},info:i,loggers:t.TraceLoggers}}function s(r){var n={message:r};return{name:t.ErrorEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({message:n.message},null)},info:n,loggers:t.ErrorLoggers}}function u(t,r){var n={stack:t,message:r};return{info:n,formatted:function(){return e.extendFormatted({stack:n.stack,message:n.message},null)}}}function c(r,n,o,i,a){var s=u(i,a),c=P(s.info,{source:r,lineNumber:n,columnNumber:o});return{name:t.ErrorWithStackTraceAndSourceDetailsEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({source:c.source,lineNumber:c.lineNumber,columnNumber:c.columnNumber},null,s.formatted())},info:c,loggers:t.ErrorWithStackTraceAndSourceDetailsLoggers}}function l(t,n,o,i,a,s,u,c,l,d,m,f,p,g){var v=r(t,n,o,i,a,s,u,c,l,d,m,f,p,g);return{info:v.info,formatted:function(){return e.extendFormatted(null,null,v.formatted())}}}function d(r,n,i,a,s,u,c,l,d,m,f,p,g,v){var h=o(r,n,i,a,s,u,c,l,d,m,f,p,g,v),y=P(h.info,{});return{name:t.DashboardRootSessionEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,h.formatted())},info:y,loggers:t.DashboardRootSessionLoggers}}function m(r,n,i,a,s,u,c,l,d,m,f,p,g,v,h,y){var C=o(i,a,s,u,c,l,d,m,f,p,g,v,h,y),b=P(C.info,{errorCode1:r,errorType:n});return{name:t.WFEErrorEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({errorCode1:b.errorCode1,errorType:b.errorType},null,C.formatted())},info:b,loggers:t.WFEErrorLoggers}}function f(r,n,o,i,a){void 0===i&&(i=void 0);var s={raid:r,caid:n,errorType:o,errorSource:i,message:a};return{name:t.DashboardErrorDialogEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({raid:s.raid,caid:s.caid,errorType:s.errorType,message:s.message},{errorSource:s.errorSource})},info:s,loggers:t.DashboardErrorDialogLoggers}}function p(r,n,o,i,a,s,u,c,d,m,f,p,g,v){var h=l(r,n,o,i,a,s,u,c,d,m,f,p,g,v),y=P(h.info,{});return{name:t.MobileLandingContinuedToWebEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,h.formatted())},info:y,loggers:t.MobileLandingContinuedToWebLoggers}}function g(r,n,o,i,a,s,u,c,d,m,f,p,g,v){var h=l(r,n,o,i,a,s,u,c,d,m,f,p,g,v),y=P(h.info,{});return{name:t.MobileLandingDownloadAppEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,h.formatted())},info:y,loggers:t.MobileLandingDownloadAppLoggers}}function v(r,n){var o=u(r,n),i=P(o.info,{});return{name:t.DashboardUnhandledAngularExceptionEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,o.formatted())},info:i,loggers:t.DashboardUnhandledAngularExceptionLoggers}}function h(r,n,o,i,a,s,u,c,l){var d={visualType:r,isCustom:n,apiVersion:o,visualName:i,source:a,lineNumber:s,columnNumber:u,stack:c,message:l};return{name:t.VisualExceptionEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({visualType:d.visualType,isCustom:d.isCustom,apiVersion:d.apiVersion,visualName:d.visualName,source:d.source,lineNumber:d.lineNumber,columnNumber:d.columnNumber,stack:d.stack,message:d.message},null)},info:d,loggers:t.VisualExceptionLoggers}}function y(r,n,o,i,a){var s={source:r,lineNumber:n,columnNumber:o,stack:i,message:a};return{name:t.DashboardUnhandledExceptionEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({source:s.source,lineNumber:s.lineNumber,columnNumber:s.columnNumber,stack:s.stack,message:s.message},null)},info:s,loggers:t.DashboardUnhandledExceptionLoggers}}function C(r,n,o){var i=u(n,o),a=P(i.info,{additionalInfo:r});return{name:t.HandledExceptionEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({additionalInfo:a.additionalInfo},null,i.formatted())},info:a,loggers:t.HandledExceptionLoggers}}function b(r,n,o,i){var a={source:r,lineNumber:n,columnNumber:o,message:i};return{name:t.DashboardUnhandledStacklessExceptionEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({source:a.source,lineNumber:a.lineNumber,columnNumber:a.columnNumber,message:a.message},null)},info:a,loggers:t.DashboardUnhandledStacklessExceptionLoggers,logRatio:1e-4}}function E(r,n,o,i,a){var s={errorCode:r,targetVisualType:n,debugErrorInfo:o,visualName:i,message:a};return{name:t.VisualErrorEventName,category:e.TelemetryCategory.CriticalError,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({errorCode:s.errorCode,targetVisualType:s.targetVisualType,debugErrorInfo:s.debugErrorInfo,visualName:s.visualName,message:s.message},null)},info:s,loggers:t.VisualErrorLoggers}}function T(r,n,o,i,a,s,u,c,d,m,f,p,g,v){var h=l(r,n,o,i,a,s,u,c,d,m,f,p,g,v),y=P(h.info,{});return{name:t.WFEReopenUserAccountEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,h.formatted())},info:y,loggers:t.WFEReopenUserAccountLoggers}}function F(r,n,o,i,a,s,u,c,d,m,f,p,g,v){var h=l(r,n,o,i,a,s,u,c,d,m,f,p,g,v),y=P(h.info,{});return{name:t.WFEAccountClosedPageEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted(null,null,h.formatted())},info:y,loggers:t.WFEAccountClosedPageLoggers}}function N(r,n,i,a,s,u,c,l,d,m,f,p,g,v,h,y){var C=o(i,a,s,u,c,l,d,m,f,p,g,v,h,y),b=P(C.info,{targetVisualType:r,visualName:n});return{name:t.VisualWarningEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({targetVisualType:b.targetVisualType,visualName:b.visualName},null,C.formatted())},info:b,loggers:t.VisualWarningLoggers}}function D(r,n,o,a,s,u,c,l,d,m,f,p,g,v,h,y,C,b,E,T,F){var N=i(u,c,l,d,m,f,p,g,v,h,y,C,b,E,T,F),D=P(N.info,{name:r,apiVersion:n,custom:o,visualVersion:a,visualName:s});return{name:t.VisualApiUsageEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({name:D.name,apiVersion:D.apiVersion,custom:D.custom,visualVersion:D.visualVersion,visualName:D.visualName},null,N.formatted())},info:D,loggers:t.VisualApiUsageLoggers}}function S(r,n,o,i,a,s,u,c,d,m,f,p,g,v,h,y,C){var b=l(i,a,s,u,c,d,m,f,p,g,v,h,y,C),E=P(b.info,{copyType:r,visualType:n,copySelectionPercentage:o});return{name:t.EXCopyActionClickedEventName,category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({copyType:E.copyType,visualType:E.visualType,copySelectionPercentage:E.copySelectionPercentage},null,b.formatted())},info:E,loggers:t.EXCopyActionClickedLoggers}}function A(r,n,i,a,s,u,c,l,d,m,f,p,g,v,h,y){var C=o(i,a,s,u,c,l,d,m,f,p,g,v,h,y),b=P(C.info,{name:r,parentActivity:n});return{name:t.StartActivityEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({name:b.name,parentActivity:b.parentActivity},null,C.formatted())},info:b,loggers:t.StartActivityLoggers}}function w(r,n,i,a,s,u,c,l,d,m,f,p,g,v,h,y){var C=o(i,a,s,u,c,l,d,m,f,p,g,v,h,y),b=P(C.info,{name:r,parentActivity:n});return{name:t.EndActivityEventName,category:e.TelemetryCategory.Verbose,time:Date.now(),id:x(),formatted:function(){return e.extendFormatted({name:b.name,parentActivity:b.parentActivity},null,C.formatted())},info:b,loggers:t.EndActivityLoggers}}var x,I=jsCommon.Utility,P=jsCommon.UnionExtensions.mergeUnionType,M=e.telemetry.EventFactories;x=I?I.generateGuid:Function.prototype,t.BaseEventEventName="BaseEvent",t.BaseEvent=r,M[t.BaseEventEventName]=function(t){return e.telemetryEventFactory(void 0,t,void 0,void 0,void 0,void 0,void 0,void 0,["isError","errorSource","errorCode","activityName","activityId","isCancelled","pingLatency","errorMessage","folderId","activeFolderCapacityId","fluentUI","baseVersion","isFireAndForget"])},t.TimedEventEventName="TimedEvent",t.TimedEvent=n,M[t.TimedEventEventName]=function(r){return e.telemetryEventFactory(void 0,r,void 0,t.BaseEventEventName,void 0,void 0,void 0,void 0,null)},t.VerboseEventName="Verbose",t.Verbose=o,M[t.VerboseEventName]=function(r){return e.telemetryEventFactory(void 0,r,void 0,t.BaseEventEventName,void 0,void 0,void 0,void 0,null)},t.VerboseTimedEventEventName="VerboseTimedEvent",t.VerboseTimedEvent=i,M[t.VerboseTimedEventEventName]=function(r){return e.telemetryEventFactory(void 0,r,void 0,t.VerboseEventName,void 0,void 0,void 0,void 0,null)},t.TraceEventName="Trace",t.Trace=a,M[t.TraceEventName]=function(r){return e.telemetryEventFactory(t.TraceEventName,r,t.TraceLoggers,void 0,e.TelemetryCategory.Trace,void 0,void 0,void 0,null)},t.ErrorEventName="Error",t.Error=s,M[t.ErrorEventName]=function(r){return e.telemetryEventFactory(t.ErrorEventName,r,t.ErrorLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},t.ErrorWithStackTraceEventName="ErrorWithStackTrace",t.ErrorWithStackTrace=u,M[t.ErrorWithStackTraceEventName]=function(t){return e.telemetryEventFactory(void 0,t,void 0,void 0,void 0,void 0,void 0,void 0,null)},t.ErrorWithStackTraceAndSourceDetailsEventName="ErrorWithStackTraceAndSourceDetails",t.ErrorWithStackTraceAndSourceDetails=c,M[t.ErrorWithStackTraceAndSourceDetailsEventName]=function(r){return e.telemetryEventFactory(t.ErrorWithStackTraceAndSourceDetailsEventName,r,t.ErrorWithStackTraceAndSourceDetailsLoggers,t.ErrorWithStackTraceEventName,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},t.CustomerActionEventName="CustomerAction",t.CustomerAction=l,M[t.CustomerActionEventName]=function(r){return e.telemetryEventFactory(void 0,r,void 0,t.BaseEventEventName,void 0,void 0,void 0,void 0,null)},t.DashboardRootSessionEventName="PBI.Dashboard.RootSession",t.DashboardRootSession=d,M[t.DashboardRootSessionEventName]=function(r){return e.telemetryEventFactory(t.DashboardRootSessionEventName,r,t.DashboardRootSessionLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.WFEErrorEventName="PBI.WFE.Error",t.WFEError=m,M[t.WFEErrorEventName]=function(r){return e.telemetryEventFactory(t.WFEErrorEventName,r,t.WFEErrorLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.DashboardErrorDialogEventName="PBI.Dashboard.ErrorDialog",t.DashboardErrorDialog=f,M[t.DashboardErrorDialogEventName]=function(r){return e.telemetryEventFactory(t.DashboardErrorDialogEventName,r,t.DashboardErrorDialogLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,["errorSource"])},t.MobileLandingContinuedToWebEventName="PBI.MobileLanding.ContinuedToWeb",t.MobileLandingContinuedToWeb=p,M[t.MobileLandingContinuedToWebEventName]=function(r){return e.telemetryEventFactory(t.MobileLandingContinuedToWebEventName,r,t.MobileLandingContinuedToWebLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.MobileLandingDownloadAppEventName="PBI.MobileLanding.DownloadApp",t.MobileLandingDownloadApp=g,M[t.MobileLandingDownloadAppEventName]=function(r){return e.telemetryEventFactory(t.MobileLandingDownloadAppEventName,r,t.MobileLandingDownloadAppLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.DashboardUnhandledAngularExceptionEventName="PBI.Dashboard.UnhandledAngularException",t.DashboardUnhandledAngularException=v,M[t.DashboardUnhandledAngularExceptionEventName]=function(r){return e.telemetryEventFactory(t.DashboardUnhandledAngularExceptionEventName,r,t.DashboardUnhandledAngularExceptionLoggers,t.ErrorWithStackTraceEventName,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},t.VisualExceptionEventName="PBI.Visual.Exception",t.VisualException=h,M[t.VisualExceptionEventName]=function(r){return e.telemetryEventFactory(t.VisualExceptionEventName,r,t.VisualExceptionLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},t.DashboardUnhandledExceptionEventName="PBI.Dashboard.UnhandledException",t.DashboardUnhandledException=y,M[t.DashboardUnhandledExceptionEventName]=function(r){return e.telemetryEventFactory(t.DashboardUnhandledExceptionEventName,r,t.DashboardUnhandledExceptionLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},t.HandledExceptionEventName="PBI.HandledException",t.HandledException=C,M[t.HandledExceptionEventName]=function(r){return e.telemetryEventFactory(t.HandledExceptionEventName,r,t.HandledExceptionLoggers,t.ErrorWithStackTraceEventName,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},t.DashboardUnhandledStacklessExceptionEventName="PBI.Dashboard.UnhandledStacklessException",t.DashboardUnhandledStacklessException=b,M[t.DashboardUnhandledStacklessExceptionEventName]=function(r){return e.telemetryEventFactory(t.DashboardUnhandledStacklessExceptionEventName,r,t.DashboardUnhandledStacklessExceptionLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},t.VisualErrorEventName="PBI.Visual.Error",t.VisualError=E,M[t.VisualErrorEventName]=function(r){return e.telemetryEventFactory(t.VisualErrorEventName,r,t.VisualErrorLoggers,void 0,e.TelemetryCategory.CriticalError,void 0,void 0,void 0,null)},t.WFEReopenUserAccountEventName="PBI.WFE.ReopenUserAccount",t.WFEReopenUserAccount=T,M[t.WFEReopenUserAccountEventName]=function(r){return e.telemetryEventFactory(t.WFEReopenUserAccountEventName,r,t.WFEReopenUserAccountLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.WFEAccountClosedPageEventName="PBI.WFE.AccountClosedPage",t.WFEAccountClosedPage=F,M[t.WFEAccountClosedPageEventName]=function(r){return e.telemetryEventFactory(t.WFEAccountClosedPageEventName,r,t.WFEAccountClosedPageLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.VisualWarningEventName="PBI.Visual.Warning",t.VisualWarning=N,M[t.VisualWarningEventName]=function(r){return e.telemetryEventFactory(t.VisualWarningEventName,r,t.VisualWarningLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.VisualApiUsageEventName="PBI.Visual.ApiUsage",t.VisualApiUsage=D,M[t.VisualApiUsageEventName]=function(r){return e.telemetryEventFactory(t.VisualApiUsageEventName,r,t.VisualApiUsageLoggers,t.VerboseTimedEventEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.EXCopyActionClickedEventName="PBI.EX.CopyActionClicked",t.EXCopyActionClicked=S,M[t.EXCopyActionClickedEventName]=function(r){return e.telemetryEventFactory(t.EXCopyActionClickedEventName,r,t.EXCopyActionClickedLoggers,t.CustomerActionEventName,e.TelemetryCategory.CustomerAction,void 0,void 0,void 0,null)},t.StartActivityEventName="StartActivity",t.StartActivity=A,M[t.StartActivityEventName]=function(r){return e.telemetryEventFactory(t.StartActivityEventName,r,t.StartActivityLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)},t.EndActivityEventName="EndActivity",t.EndActivity=w,M[t.EndActivityEventName]=function(r){return e.telemetryEventFactory(t.EndActivityEventName,r,t.EndActivityLoggers,t.VerboseEventName,e.TelemetryCategory.Verbose,void 0,void 0,void 0,null)}}(t=e.telemetry||(e.telemetry={}))}(powerbi||(powerbi={}));var powerbi;!function(e){function t(e,t,i){return void 0===t&&(t=3),void 0===i&&(i=0),function(a,s,u){var c=u.value;return u.value=function(){for(var a=this,s=[],u=0;u<arguments.length;u++)s[u]=arguments[u];for(var l=jsCommon.WindowUtils.GetWindowObject();!(l==window.top||l.featureSwitchService&&l.telemetryService);)l=l.parent;var d,m=l.featureSwitchService,f=l.telemetryService,p=!1;if(m&&m.isFeatureSwitchesRegistered()&&m.featureSwitches&&m.featureSwitches.telemetryV2&&f||(p=!0),p)return d=c.apply(this,s);var g=Zone&&Zone.current,v=g&&g.get("data"),h=v&&v.monitoredActivity;n.hasFlag(t,1)&&(h=f.startMonitoredActivity(h,e,{baseVersion:o,isFireAndForget:1===i||void 0}),g=h.currentZone);try{g.run(function(){return d=c.apply(a,s)})}catch(e){if(n.hasFlag(t,2))return void r(h,e);throw e}return n.hasFlag(t,2)&&(d&&_.isObject(d)&&d.then&&_.isFunction(d.then)?d.then(function(){r(h)},function(e){r(h,e)}):r(h)),d},u}}function r(e,t){e&&(t?e.reject(t):e.resolve())}var n=jsCommon.EnumExtensions,o="v2";e.MonitorWith=t}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(e){switch(e){case 2:return"External";case 1:return"User";case 0:default:return"PowerBI"}}function n(e,t,r){var n=o(e,r);return n&&(n.errorMessage=t),n}function o(e,t){if(e&&e.code){var r=e.code,n=e["pbi.error"]&&e["pbi.error"].exceptionCulprit;return null!=n?{errorCode:r,errorSource:c(n)}:null==t||401!==t&&403!==t?{errorCode:r,errorSource:"PowerBI"}:{errorCode:r,errorSource:"User"}}if(null!=t)return{errorCode:"HttpStatusCode = "+t,errorSource:"PowerBI"}}function i(e,t){var r=o(e,t);if(r)return null==t||401!==t&&403!==t||(r.errorSource="User"),r}function a(e){if(e)return{errorCode:e.errorCode,errorMessage:"StatusCode="+e.statusCode,errorSource:null!=e.exceptionCulprit?u(e.exceptionCulprit):void 0}}function s(e){if(e){if(e.error)return e.error.code;if(e.status)return e.status.toString()}}function u(t){switch(t){case e.ExceptionCulpritExternal:return"External";case e.ExceptionCulpritUser:return"User";case e.ExceptionCulpritSystem:default:return"PowerBI"}}function c(e){switch(e){case 2:return"External";case 1:return"User";case 0:default:return"PowerBI"}}t.getErrorSource=r,t.getTelemetryErrorDetailsWithResourceKey=n,t.getTelemetryErrorDetails=o,t.getTelemetryErrorDetailsFromHttpStatus=i,t.getTelemetryErrorDetailsFromServiceError=a,t.getErrorCode=s}(t=e.errorDetailsHelper||(e.errorDetailsHelper={}))}(powerbi||(powerbi={}));var jsCommon;!function(e){var t;!function(e){function t(e,t){if(!e&&!t)return!0;if(!!e!=!!t||e.length!==t.length)return!1;for(var r=0,n=e.length;r<n;r++)if(!e[r].equals(t[r]))return!1;return!0}e.comparableSequenceEqual=t}(t=e.ArrayExtensions||(e.ArrayExtensions={}))}(jsCommon||(jsCommon={}));var powerbi;!function(e){var t;!function(t){var r=function(){function r(){}return r.getFullName=function(){return e.session.userInfo.givenName+" "+e.session.userInfo.surname},r.isInternalUser=function(){if(!e.session.userInfo||!e.session.userInfo.name)return!1;var t=e.session.userInfo.name.toLowerCase();return t.indexOf("@microsoft.com")>=0||t.indexOf(".microsoft.com")>=0},r.getUPN=function(){return t.userInfo.name},r.getEmailAddressForReceivingMail=function(){var t=e.session.userInfo;return null==t?"":_.isEmpty(t.alternateEmail)?t.name:t.alternateEmail},r}();t.UserInfoUtils=r}(t=e.session||(e.session={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){e.pbiClientName="PowerBI.com",e.httpActivityIdHeader="ActivityId",e.httpRequestIdHeader="RequestId"}(t=e.telemetryConstants||(e.telemetryConstants={}))}(powerbi||(powerbi={}));var InJs;!function(e){var t;!function(e){e.infoNavErrorCodeTemplate="{0} ({1})",e.errorCodeText="Error Code",e.errorActivityIdText="Activity Id",e.errorRequestIdText="Request Id",e.correlationIdText="Correlation Id",e.errorLineNumberText="Line number",e.errorColumnNumberText="Column number",e.errorStackTraceText="Stack trace",e.errorSourceFileText="Source file",e.errorTimestampText="Time",e.showDetailsText="Show technical details",e.dialogCloseActionLabel="Close",e.dialogRefreshPageActionLabel="Refresh Page",e.errorDialogTitle="oops, something went wrong",e.unsupportedBrowserMessageTitle="Unsupported browser detected",e.unsupportedBrowserMessageText="Power BI Q&A requires Internet Explorer 10 or higher, please upgrade your browser and try again",e.errorDialogHelperText="Please try again later or contact support. If you contact support, please provide these details.",e.CopyActionLabel="Copy",e.SuccessActionLabel="Success!"}(t=e.UnlocalizedStrings||(e.UnlocalizedStrings={}))}(InJs||(InJs={}));var jsCommon;!function(e){var t;!function(e){function t(){return r()&&l()&&d()}function r(){return c()}function n(){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("msie ")>-1||e.indexOf("trident/")>-1}function o(){return window.navigator.userAgent.toLowerCase().indexOf("edge/")>-1}function i(){return/^((?!chrome|android).)*safari/i.test(window.navigator.userAgent)}function a(){return!o()&&/ chrome\/([0-9]+)(\.[0-9]+)+/i.test(window.navigator.userAgent)}function s(){return/ firefox\/([0-9]+)(\.[0-9]+)+/i.test(window.navigator.userAgent)}function u(){var e=0;if("Microsoft Internet Explorer"===navigator.appName||window.navigator.userAgent.indexOf("MSIE")>=0){var t=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),r=t.exec(window.navigator.userAgent);r&&(e=parseFloat(r[1]))}return e}function c(){if(!Object.defineProperty)return!1;try{var e={},t={get:function(){return!0},enumerable:!0,configurable:!1};return Object.defineProperty(e,"customProperty",t),!0}catch(e){return!1}}function l(){return!!Function.prototype.bind}function d(){return!!$.support.cors}e.isBrowserSupported=t,e.browserSupportsEssentials=r,e.isInternetExplorerBrowser=n,e.isEdgeBrowser=o,e.isSafari=i,e.isChrome=a,e.isFirefox=s,e.getInternetExplorerVersion=u}(t=e.BrowserUtility||(e.BrowserUtility={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t;!function(e){function t(e,t){if(t&&t.document&&t.document.cookie)for(var r=t.document.cookie.split(";"),n=0,o=r;n<o.length;n++){var i=o[n],a=i.split("=");if(a.length>0&&a[0].trim()===e)return a[1]}}function r(e,t,r){r&&r.document&&(r.document.cookie=e+" = "+t+";secure")}e.getCookie=t,e.setCookie=r}(t=e.CookieUtil||(e.CookieUtil={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t,r=e.CssConstants.createClassAndSelector("explorationContainer");!function(e){function t(e){return!!(1&e)}function r(e){return!!(2&e)}function n(e){return!!(4&e)}function o(e){return!!(8&e)}e.isAbove=t,e.isRightOf=r,e.isBelow=n,e.isLeftOf=o}(t=e.DropPosition||(e.DropPosition={}));var n;!function(t){t.None=e.CssConstants.createClassAndSelector("notDroppable"),t.Replace=e.CssConstants.createClassAndSelector("dropover"),t.Prepend=e.CssConstants.createClassAndSelector("prepend"),t.Append=e.CssConstants.createClassAndSelector("append")}(n=e.HighlightClasses||(e.HighlightClasses={}));var o;!function(t){function n(e){return e.attr(t.DragAttribute)}function o(t){var r=t.clone();return r.find("[id]").removeAttr(e.DOMConstants.idAttribute),r}function a(e){var t=e.parents(r.selector);return t}function s(e,t){var r=t();return r?(e.data[i.DropTarget]=r,!0):(e.data[i.DropEventHandled]=!0,!1)}function u(e,t){return!e.data[i.DropEventHandled]&&e.data[i.DropTarget]===t&&(e.data[i.DropEventHandled]=!0,!0)}function c(e,t){var r=t.height(),n=t.width(),o=t.offset(),i=e.pageY,a=e.pageX,s=0;return s|=o.top+r/2>i?1:4,s|=o.left+n/2>a?8:2}function l(e,r){if(!e)return!0;var n=t.getDragSourceType(e);return r.indexOf(n)>=0}t.DragoverClass="dragover",t.DragAttribute="drag",t.getDragSourceType=n,t.prepareDragHelper=o,t.getElementToAppendDragHelper=a,t.tryFindChildDropTarget=s,t.isDropOnExpectedTarget=u,t.getDropPosition=c,t.isValidDropLocation=l}(o=e.DragDropUtils||(e.DragDropUtils={}));var i;!function(e){e.DragScrollHandler="DragScrollHandler",e.DropEventHandled="DropEventHandled",e.DropTarget="DropTarget"}(i=e.DragDropDataKeys||(e.DragDropDataKeys={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t;!function(e){function t(e){return e&&e.requestId&&e.responseRequestId?e.requestId===e.responseRequestId:null}function r(e){return e&&e.responseRequestId?e.responseRequestId:null}function n(e){switch(e){case 401:case 403:case 413:case 400:case 404:case 409:case 412:case 422:return!1;default:return!0}}e.clientAndServerRequestIdMatch=t,e.getResponseRequestId=r,e.shouldRetryRequest=n}(t=e.HttpUtils||(e.HttpUtils={}))}(jsCommon||(jsCommon={}));var InJs;!function(e){e.RtlDirAttrVal="rtl";var t;!function(t){function r(t,r){var n=$("<div />"),o=$("<a class=\"showAdditionalDetailsLink\" href='javascript:' />");return o.addClass(a),o.text(r||e.UnlocalizedStrings.showDetailsText),o.on(jsCommon.DOMConstants.mouseClickEventName,function(){n.find(jsCommon.Utility.createClassSelector(a)).remove(),n.find(jsCommon.Utility.createClassSelector(i)).css(jsCommon.CssConstants.displayProperty,jsCommon.CssConstants.blockValue)}),t.css(jsCommon.CssConstants.displayProperty,jsCommon.CssConstants.noneValue),t.addClass(i),n.append(o),n.append(t),n}function n(e,t){var r=$(s.replace("{FieldTitle}",e));return r.find(".infonav-errorInfoText").multiline(t),r}function o(){return $("html").attr("dir")===e.RtlDirAttrVal}var i="infonav-additionalError",a="infonav-showAdditionalError",s='<div class="infonav-errorInfoItem"><span class="infonav-errorInfoHeader">{FieldTitle}</span><span class="infonav-errorInfoText">{FieldValue}</span></div>';t.constructShowDetailsContainer=r,t.constructErrorField=n,t.isRTL=o}(t=e.InfoNavUtility||(e.InfoNavUtility={}))}(InJs||(InJs={}));var jsCommon;!function(e){var t;!function(e){function t(e,t,r){try{return JSON.parse(e,t)}catch(e){}}function r(e){if(e&&"string"==typeof e){try{JSON.parse(e)}catch(e){return!1}return!0}return!1}e.tryParseJSON=t,e.isJsonString=r}(t=e.JsonExtensions||(e.JsonExtensions={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t;!function(e){function t(e,t){return null==e||isNaN(e)?t:null==t||isNaN(t)?e:Math.min(e,t)}function r(e,t){return null==e||isNaN(e)?t:null==t||isNaN(t)?e:Math.max(e,t)}e.min=t,e.max=r}(t=e.MathExtensions||(e.MathExtensions={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t;!function(e){function t(e,t){t=t||{};var r=t.isPolite?"screen_reader_alert_polite":"screen_reader_alert_assertive",n=100,o=document.querySelector("#"+r);o||(o=document.createElement("div"),o.setAttribute("style","position:absolute;text-indent:-9999px;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0;"),o.setAttribute("aria-live",t.isPolite?"polite":"assertive"),o.setAttribute("aria-atomic","true"),o.setAttribute("id",r),t.isPolite||o.setAttribute("role","alert"),document.body.appendChild(o));var i=document.createTextNode(e);o.innerHTML="";var a=setTimeout(function(){o.appendChild(i),clearTimeout(a)},n)}e.alertScreenReader=t}(t=e.ScreenReaderUtil||(e.ScreenReaderUtil={}))}(jsCommon||(jsCommon={}));var powerbi;!function(e){function t(e,t,r){return{name:e,version:r,type:t}}e.ThemePrecedenceList=["highContrastTheme","customTheme","baseTheme"],e.getThemeMetadata=t}(powerbi||(powerbi={}));var jsCommon;!function(e){var t;!function(e){function t(){try{return window.self!==window.top}catch(e){return!0}}function r(){return t()&&n(document.referrer)!==n(document.URL)}function n(e){if(e&&""!==e.trim()){var t=document.createElement("a");return t.href=e,t.hostname}return""}e.isHostedInIFrame=t,e.isHostedInCrossDomainIFrame=r,e.getHostName=n}(t=e.iFrameUtility||(e.iFrameUtility={}));var r;!function(t){function r(t){if(t)try{var r=atob(t);return pako.inflate(r,{to:"string"})}catch(t){e.Trace.error("Error while uncompressing TileData: "+JSON.stringify(t),null==t.stack)}return null}function n(t){if(t)try{var r=pako.gzip(t,{to:"string"});return btoa(r)}catch(t){e.Trace.error("Error while compressing data: "+JSON.stringify(t),null==t.stack)}return null}t.uncompress=r,t.compress=n}(r=e.GzipUtility||(e.GzipUtility={}));var n;!function(t){t.isE2EV2Run=function(){var t;return function(){return null==t&&(t=!!e.QueryStringUtil.getQueryStringValue("isE2ERun2")),t}}()}(n=e.E2EUtils||(e.E2EUtils={}));var o;!function(e){function t(){return window}e.GetWindowObject=t}(o=e.WindowUtils||(e.WindowUtils={}))}(jsCommon||(jsCommon={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e){this.cultureInfo=e,this.maxDecimalPlaces=15}return e.prototype.updateFormatUponDataTypeChange=function(e,t){var r=this;return this.updateFormatInformation(e,t,function(t){return _.includes(r.getValidFormatsForDataType(e),t.format)||(t=r.getDefaultFormatInformationForDataType(e)),r.updateFormatInformationForDateTimeDataType(e,t),t})},e.prototype.changeFormat=function(e,t,r){var n=this;return this.updateFormatInformation(e,t,function(e){return n.setFormatAndDownstreamEffects(e,r),e})},e.prototype.toggleThousandsSeparator=function(e,t){var r=this;return this.updateFormatInformation(e,t,function(t){var n=r.getThousandSeparatorValidSettingsForFormat(t.format).isChangeable;if(!n){var o=r.getFormatThatWillAllowThousandSeparatorToChange(e);null!=o&&(r.setFormatAndDownstreamEffects(t,o),n=!0)}return n&&(t.thousandSeparator=!t.thousandSeparator),t})},e.prototype.setAccuracy=function(e,t,r){var n=this;return this.updateFormatInformation(e,t,function(t){var o=n.isAccuracyValidForFormat(t.format,r);if(!o){var i=n.getFormatThatWillAllowAccuracyToChange(e,t.format);o=!(!i||!n.isAccuracyValidForFormat(i,r)),o&&n.setFormatAndDownstreamEffects(t,i)}return o&&(t.accuracy=r),t})},e.prototype.setDateTimeFormat=function(e,t,r,n,o){var i=this;return this.updateFormatInformation(e,t,function(e){return i.setFormatAndDownstreamEffects(e,r),o||(o=i.buildDateTimeFormatString(n)),e.dateTimeCustomFormat={lcid:i.cultureInfo.lcid,formatGroup:n,formatString:o},e})},e.prototype.setCurrencyFormat=function(e,t,r,n,o,i,a,s){var u=this;return this.updateFormatInformation(e,t,function(e){return u.setFormatAndDownstreamEffects(e,r),e.currencyFormat={lcid:n,displayName:o,currencySymbol:i,positivePattern:a,negativePattern:s},e})},e.prototype.setCustomFormatString=function(e,t,r){var n=this;return this.updateFormatInformation(e,r,function(e){return n.setFormatAndDownstreamEffects(e,"Custom"),e.formatString=t,e})},e.prototype.updateFormatInformation=function(e,t,r){return t||(t=this.getDefaultFormatInformationForDataType(e)),t=r(t),"Custom"!==t.format&&this.finalizeFormatInformation(t),t},e.prototype.getValidFormatsForDataType=function(e){switch(e){case 11:return["Binary"];case 5:return["Boolean"];case 2:case 3:case 4:return["General","NumberDecimal","NumberWhole","CurrencyCustom","CurrencyGeneral","Percentage","Scientific"];case 7:case 8:case 6:case 9:return["DateTimeGeneralPattern","DateTimeCustom"];case 1:case 13:return["Text"];default:return[]}},e.prototype.getDefaultFormatInformationForDataType=function(e){var t=this.getDefaultFormatForDataType(e);return t?{formatString:null,format:t,accuracy:this.getDefaultAccuracyForFormat(t),thousandSeparator:this.getDefaultThousandSeparatorForFormat(t),currencyFormat:this.isCurrencyFormat(t)?this.buildDefaultCurrencyFormat():null,dateTimeCustomFormat:this.isDateTimeFormat(t)?this.buildDefaultDateTimeFormat():null}:null},e.prototype.getDefaultFormatForDataType=function(e){switch(e){default:case 0:case 12:case 13:return null;case 1:return"Text";case 2:return"CurrencyGeneral";case 3:return"General";
case 4:return"NumberWhole";case 5:return"Boolean";case 6:case 7:case 8:case 9:case 10:return"DateTimeGeneralPattern";case 11:return"Binary"}},e.prototype.setFormatAndDownstreamEffects=function(e,t){e.format=t,this.makeAccuracyValid(e),this.makeThousandSeparatorValid(e),this.makeCurrencyFormatValid(e),this.makeDateTimeFormatValid(e)},e.prototype.makeAccuracyValid=function(e){var t=this.getAccuracyRangeForFormat(e.format);t?(null==e.accuracy||e.accuracy<t.min||e.accuracy>t.max)&&(e.accuracy=t.default):e.accuracy=void 0},e.prototype.getFormatThatWillAllowAccuracyToChange=function(e,t){switch(e){case 2:return"CurrencyCustom";case 3:case 4:return"CurrencyGeneral"===t?"CurrencyCustom":"NumberDecimal";default:return}},e.prototype.getDefaultAccuracyForFormat=function(e){var t=this.getAccuracyRangeForFormat(e);return t&&t.default},e.prototype.isAccuracyValidForFormat=function(e,t){var r=this.getAccuracyRangeForFormat(e);return null!=r&&t>=r.min&&t<=r.max},e.prototype.getAccuracyRangeForFormat=function(e){switch(e){case"NumberWhole":return{min:0,max:0,default:0};case"CurrencyCustom":return{min:0,max:this.maxDecimalPlaces,default:this.cultureInfo.currencyDecimalDigits};case"NumberDecimal":case"Scientific":return{min:0,max:this.maxDecimalPlaces,default:this.cultureInfo.numberDecimalDigits};case"Percentage":return{min:0,max:this.maxDecimalPlaces,default:this.cultureInfo.percentDecimalDigits};default:return}},e.prototype.makeThousandSeparatorValid=function(e){var t=this.getThousandSeparatorValidSettingsForFormat(e.format);t.isChangeable||(e.thousandSeparator=t.defaultValue)},e.prototype.getFormatThatWillAllowThousandSeparatorToChange=function(e){switch(e){case 2:case 3:return"NumberDecimal";case 4:return"NumberWhole";default:return}},e.prototype.getDefaultThousandSeparatorForFormat=function(e){return this.getThousandSeparatorValidSettingsForFormat(e).defaultValue},e.prototype.getThousandSeparatorValidSettingsForFormat=function(e){switch(e){case"CurrencyGeneral":case"CurrencyCustom":return{isChangeable:!1,defaultValue:!0};case"General":case"Scientific":case"Binary":case"Boolean":case"DateTimeGeneralPattern":case"DateTimeCustom":case"Text":default:return{isChangeable:!1,defaultValue:!1};case"NumberDecimal":case"NumberWhole":case"Percentage":return{isChangeable:!0,defaultValue:!1}}},e.prototype.finalizeFormatInformation=function(e){e.formatString=this.buildFormatString(e)},e.prototype.buildFormatString=function(e){var t=this.buildThousandsPartOfFormatString(e.thousandSeparator),r=this.buildDecimalPartOfFormatString(e.accuracy);switch(e.format){case"Text":case"General":return"G";case"NumberDecimal":return t+"0"+r;case"NumberWhole":return t+"0";case"CurrencyGeneral":case"CurrencyCustom":"CurrencyGeneral"===e.format&&(r=".###############");var n=e.currencyFormat,o=n.currencySymbol,i=t+"0"+r,a=this.buildCurrencyPositiveFormatter(o,n.positivePattern,i),s=this.buildCurrencyNegativeFormatter(o,n.negativePattern,i);return a+";"+s+";"+a;case"Percentage":var u=this.cultureInfo.percentSymbol,c=this.cultureInfo.percentPositivePattern,l=this.cultureInfo.percentNegativePattern,i=t+"0"+r,a=this.buildPercentPositiveFormatter(u,c,i),s=this.buildPercentNegativeFormatter(u,l,i);return a+";"+s+";"+a;case"Scientific":return"0"+r+"E+000";case"DateTimeGeneralPattern":case"DateTimeCustom":return e.dateTimeCustomFormat.formatString;case"Boolean":return'"TRUE";"TRUE";"FALSE"'}return""},e.prototype.buildThousandsPartOfFormatString=function(e){return e?"#,":""},e.prototype.buildDecimalPartOfFormatString=function(e){return null==e||e<=0?"":"."+_.repeat("0",e)},e.prototype.buildCurrencyNegativeFormatter=function(e,t,r){switch(e=this.escapeCurrencySymbol(e),t){case 0:return"("+e+r+")";case 1:return"-"+e+r;case 2:return e+"-"+r;case 3:return""+e+r+"-";case 4:return"("+r+e+")";case 5:return"-"+r+e;case 6:return r+"-"+e;case 7:return""+r+e+"-";case 8:return"-"+r+" "+e;case 9:return"-"+e+" "+r;case 10:return r+" "+e+"-";case 11:return e+" "+r+"-";case 12:return e+" -"+r;case 13:return r+"- "+e;case 14:return"("+e+" "+r+")";case 15:return"("+r+" "+e+")"}return""},e.prototype.buildCurrencyPositiveFormatter=function(e,t,r){switch(e=this.escapeCurrencySymbol(e),t){case 0:return""+e+r;case 1:return""+r+e;case 2:return e+" "+r;case 3:return r+" "+e}return""},e.prototype.escapeCurrencySymbol=function(e){return"$"===e?"\\$":'"'+e+'"'},e.prototype.buildPercentNegativeFormatter=function(e,t,r){switch(t){case 0:return"-"+r+" "+e;case 1:return"-"+r+e;case 2:return"-"+e+r;case 3:return e+"-"+r;case 4:return""+e+r+"-";case 5:return r+"-"+e;case 6:return""+r+e+"-";case 7:return"-"+e+" "+r;case 8:return r+" "+e+"-";case 9:return e+" "+r+"-";case 10:return e+" -"+r;case 11:return r+"- "+e}return""},e.prototype.buildPercentPositiveFormatter=function(e,t,r){switch(t){case 0:return r+" "+e;case 1:return""+r+e;case 2:return""+e+r;case 3:return e+" "+r}return""},e.prototype.buildDateTimeFormatString=function(e){switch(e){case"GeneralDateTimeLong":return"G";case"ShortDate":return this.cultureInfo.shortDatePattern;case"LongDate":return this.cultureInfo.longDatePattern;case"MonthDay":return this.cultureInfo.monthDayPattern;case"RFC1123":return this.cultureInfo.rfc1123Pattern;case"SortableDateTime":return this.cultureInfo.sortableDateTimePattern;case"ShortTime":return this.cultureInfo.shortTimePattern;case"LongTime":return this.cultureInfo.longTimePattern;case"UniversalSortableDateTime":return this.cultureInfo.universalSortableDateTimePattern;case"YearMonth":return this.cultureInfo.yearMonthPattern;case"YearYY":return"yy";case"YearYYYY":return"yyyy";case"FullDateTimeShort":case"GeneralDateTimeShort":case"RoundTripDateTime":case"UniversalFullDateTime":case"FullDateTimeLong":default:return this.cultureInfo.fullDateTimePattern}},e.prototype.buildDateTimeFormat=function(e){return{lcid:this.cultureInfo.lcid,formatGroup:e,formatString:this.buildDateTimeFormatString(e)}},e.prototype.buildDefaultDateTimeFormat=function(){return this.buildDateTimeFormat("GeneralDateTimeLong")},e.prototype.buildDefaultDateFormat=function(){return this.buildDateTimeFormat("LongDate")},e.prototype.buildDefaultTimeFormat=function(){return this.buildDateTimeFormat("LongTime")},e.prototype.updateFormatInformationForDateTimeDataType=function(e,t){if(6===e||9===e){var r=t.dateTimeCustomFormat,n=r.formatGroup;6===e?"LongDate"!==n&&"ShortDate"!==n&&(t.dateTimeCustomFormat=this.buildDefaultDateFormat()):"LongTime"!==n&&"ShortTime"!==n&&(t.dateTimeCustomFormat=this.buildDefaultTimeFormat())}},e.prototype.makeDateTimeFormatValid=function(e){this.isDateTimeFormat(e.format)?e.dateTimeCustomFormat||(e.dateTimeCustomFormat=this.buildDefaultDateTimeFormat()):e.dateTimeCustomFormat=null},e.prototype.isDateTimeFormat=function(e){return"DateTimeCustom"===e||"DateTimeGeneralPattern"===e},e.prototype.buildDefaultCurrencyFormat=function(){return{lcid:this.cultureInfo.lcid,displayName:this.cultureInfo.currencySymbol+" "+this.cultureInfo.displayName,currencySymbol:this.cultureInfo.currencySymbol,positivePattern:this.cultureInfo.currencyPositivePattern,negativePattern:this.cultureInfo.currencyNegativePattern}},e.prototype.makeCurrencyFormatValid=function(e){this.isCurrencyFormat(e.format)?e.currencyFormat||(e.currencyFormat=this.buildDefaultCurrencyFormat()):e.currencyFormat=null},e.prototype.isCurrencyFormat=function(e){return"CurrencyCustom"===e||"CurrencyGeneral"===e},e}();e.FormatUtils=t}(t=e.util||(e.util={}))}(t=e.explore||(e.explore={}))}(powerbi||(powerbi={}));var jsCommon;!function(e){var t;!function(e){function t(e){return $(e).closest("[contentEditable]").length>0}function r(e){if($(e).is(":disabled"))return!1;var t=e.nodeName.toLowerCase();return e.nodeType===Node.ELEMENT_NODE&&("textarea"===t||"select"===t||"input"===t&&/^(?:text|email|number|search|tel|url|password)$/i.test(e.type))}function n(e,t){return 0!==(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINS)}function o(e,t,r,n){void 0===n&&(n=!0),r=r||document.body;var o=e;if(o!==r||n&&t(o))for(!n&&e&&(o=o.parentElement||o.parentNode||void 0);o&&o!==document.body&&o.nodeType===Node.ELEMENT_NODE;){if(t(o))return o;if(o===r)break;o=o.parentElement||o.parentNode||void 0}}function i(e){return $(e).is(":tabbable")===!0}function a(e,t){return t=t||document.body,o(e,i,t,!1)}function s(e){return c(e)[0]}function u(e){return $(e).find(":tabbable").get()}function c(e){return _.filter(u(e),function(t){return!$.contains(e,a(t,e))})}function l(e,t){t=t||document.body;var r=a(e,t);if((!r||t&&$.contains(r,t))&&(r=t),r){for(var o=c(r),i=[],s=0,u=0,l=o;u<l.length;u++){var d=l[u];d===e||n(e,d)?s=0:i.splice(s++,0,d)}return i}return[]}function d(e,t){return t=t||document.body,l(e,t)[0]}function m(e,t){t=t||document.body;var r=l(e,t);return r[r.length-1]}function f(e){return $(e).is(":visible")}function p(e){return $(e).parents(":tabbable:first").get(0)}e.isElementContentEditable=t,e.isTextElement=r,e.contains=n,e.getFirstMatchingAncestor=o,e.isElementTabbable=i,e.getTabbableParent=a,e.getFirstTabbableChild=s,e.getTabbableDescendants=u,e.getTabbableChildren=c,e.getTabbableSiblings=l,e.getNextTabbableSibling=d,e.getPrevTabbableSibling=m,e.isElementVisible=f,e.getParentFocusElement=p}(t=e.FocusNavigationUtility||(e.FocusNavigationUtility={}))}(jsCommon||(jsCommon={}));var jsCommon;!function(e){function t(e){return $(e).is(":tabbable")===!0&&$(e).is(":disabled")===!1}function r(t,r){if(!_.isEmpty(t)){for(var o={element:r,keycode:-1,focusPriority:e.ShortcutContainer.getFocusPriority(r),shortcutString:t},i=t.split(" "),a=i[0].split("-"),s=0,u=a;s<u.length;s++){var c=u[s];switch(c){case"shift":o.shift=!0;break;case"alt":o.alt=!0;break;case"ctrl":o.ctrl=!0;break;default:var l=n[c];o.keycode=l}}return i.length>1&&"scoped"===i[1]&&(o.scoped=!0),o}}var n=e.DOMConstants.KeyDictionary;e.FocusManagerFocusEventName="focusManager_focus",e.FocusManagerFocusOnEventName="focusManager_focusOn",e.isTabbable=t,e.createElementShortcut=r,e.FocusNavModeAttribute="focus-nav-mode",e.TabOrderEnabledAttribute="tab-order-enabled",e.TabOrderRecursiveEnabledAttribute="tab-order-recursive-enabled",e.TabOrderAttribute="tab-order",e.TabOrderChildAttribute="tab-order-child",e.TabIndexAttribute="tabindex",e.SkipChildrenFocusAttribute="skip-children-focus",e.SkipArrowNavigationAttribute="skip-arrow-navigation",e.FocusNavModeGroupMatcher="["+e.FocusNavModeAttribute+'="Group"]:first';var o=function(){function t(){this.registeredElements=[],this.shortcutContainer=new e.ShortcutContainer}return t.getInstance=function(){return this._instance||(this._instance=new t)},t.prototype.register=function(t,r,n){var o=this;void 0===r&&(r=!1),void 0===n&&(n=!1);var i=[new e.FocusGroupNavigation(n),new e.HierarchicalNavigation],a=function(e){return o.handleKeyPress(e,r,i)};_.includes(this.registeredElements,t)||(t.addEventListener("keydown",a),this.registeredElements.push(t));var s=_.find(this.registeredElements,t);return function(){s.removeEventListener("keydown",a),_.pull(o.registeredElements,t)}},t.prototype.setOnFocusGroupChangedHandler=function(e){this.shortcutContainer.setFocusChangeHandler(e)},t.prototype.registerShortcut=function(e){this.shortcutContainer.add(e)},t.prototype.unregisterShortcut=function(e){this.shortcutContainer.remove(e)},t.focusChildInGroup=function(r){var n="Group"===r.getAttribute(e.FocusNavModeAttribute)?r:$(r).find(e.FocusNavModeGroupMatcher).get(0);n&&t.focus(e.FocusGroupNavigation.getFocusNextElement(!0,n))},t.focus=function(r,n){if(void 0===n&&(n=!0),r){var o=document.activeElement;e.Zone.setTimeout(function(){e.BrowserUtils.focus(r),$(r).triggerHandler(e.FocusManagerFocusOnEventName,o),$(r).trigger(e.FocusManagerFocusEventName,o),n&&(t.keyboardFocused=!0,$("html").attr("data-focus-source","key"))})}},t.prototype.focusOnGroupByIndex=function(e,t,r,n,o){this.shortcutContainer.handleByPriority(e,t,r,n,o)},t.setFocusOnPreviousElementOnDestroy=function(t,r,n){var o=null;return t.on(e.FocusManagerFocusEventName,function(e,n){e.stopPropagation(),!n||r&&o||$.contains(t[0],n)||(o=n)}),function(){var r=document.activeElement;o&&$(o).closest(document.documentElement)&&(!n||$.contains(t[0],r))&&e.FocusManager.focus(o,!1)}},t.prototype.handleKeyPress=function(r,n,o){if(this.handleShortcut(r))return r.stopPropagation(),void r.preventDefault();var i=document.activeElement;if(i){for(var a,s=e.FocusNavigationUtility.getFirstMatchingAncestor(i,function(t){return t.hasAttribute(e.FocusNavModeAttribute)},document.body),u=function(){var t=s.getAttribute(e.FocusNavModeAttribute);if("Browser"===t)return{value:void 0};var n=_.find(o,function(e){return e.name===t});return n&&n.shouldHandleFocus(i,s)&&(a=n.findNextElementToFocus(i,r,s)),a?"break":void(s=e.FocusNavigationUtility.getFirstMatchingAncestor(s,function(t){return t.hasAttribute(e.FocusNavModeAttribute)},document.body,!1))};s&&s!==document.body;){var c=u();if("object"==typeof c)return c.value;if("break"===c)break}a&&t.focus(a),n&&r.stopPropagation(),a&&13!==r.keyCode&&32!==r.keyCode&&(r.stopPropagation(),r.preventDefault())}},t.prototype.handleShortcut=function(e){return this.shortcutContainer.handle(e)},t.prototype.focusNextElement=function(r){t.focus(e.FocusGroupNavigation.getFocusNextElement(!0,r))},t.keyboardFocused=!1,t}();e.FocusManager=o}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t=function(){function t(){}return t.prototype.findNext=function(t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!1);var o=this.getDomWalker(r),i=t.getAttribute(e.FocusNavModeAttribute);return"Group"===i||"Browser"===i||n?this.traverseDown(t,o):this.searchFocusElement(t,o)},t.prototype.searchFocusElement=function(t,r){var n=this.traverseForward(r.getNextSibling(t),r);return n||(t.parentElement&&"Group"!==t.parentElement.getAttribute(e.FocusNavModeAttribute)?n=this.searchFocusElement(t.parentElement,r):t.parentNode&&t.parentNode.nodeType===Node.ELEMENT_NODE&&"Group"!==t.parentNode.getAttribute(e.FocusNavModeAttribute)&&(n=this.searchFocusElement(t.parentNode,r))),n},t.prototype.traverseForward=function(t,r){if(t){if(e.isTabbable(t))return t;var n;return null==t.getAttribute(e.SkipChildrenFocusAttribute)&&(n=this.traverseDown(t,r)),n||(n=this.traverseForward(r.getNextSibling(t),r)),n}},t.prototype.traverseDown=function(t,r){if(t&&"Skip"!==t.getAttribute(e.FocusNavModeAttribute))return this.traverseForward(r.getNextChild(t),r)},t.prototype.getDomWalker=function(e){var t=this;return e?{getNextSibling:function(e){return e.nextElementSibling},getNextChild:function(r){return _.isEmpty(r.children)?r.hasChildNodes()?t.getNextChildNodes(r,e):void 0:r.children[0]}}:{getNextSibling:function(e){return e.previousElementSibling},getNextChild:function(r){return _.isEmpty(r.children)?r.hasChildNodes()?t.getNextChildNodes(r,e):void 0:r.children[r.children.length-1]}}},t.prototype.getNextChildNodes=function(e,t){var r=e.childNodes,n=r.length,o=t?1:-1,i=t?0:n-1;do{var a=r[i];if(a&&a.nodeType===Node.ELEMENT_NODE)return a;i+=o}while(i>=0&&i<n)},t}();e.DomOrderFocusFinder=t}(jsCommon||(jsCommon={}));var jsCommon;!function(e){function t(t){return u(t,e.TabOrderEnabledAttribute)}function r(t){return parseFloat(t.getAttribute(e.TabOrderAttribute))}function n(t){return null!=t.getAttribute(e.TabOrderAttribute)}function o(t){return null!=t.getAttribute(e.TabOrderEnabledAttribute)}function i(t){return null!=t.getAttribute(e.TabOrderChildAttribute)}function a(e){return e?10000001:-1}function s(t){return u(t,e.TabOrderAttribute)}function u(e,t){var r=$(e).closest("["+t+"]");return r&&r.get(0)}var c=function(){function u(){}return u.prototype.findNext=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!0);var u;if(o(e))u=this.getNextTabOrderChild(e,t,a(t));else if(n(e))u=this.getNextTabOrderSibling(e,t,r);else if(i(e)){var c=s(e);u=this.getNextTabOrderSibling(c,t,r)}return u},u.prototype.getNextTabOrderSibling=function(r,n,o){var i,s=r.getAttribute(e.TabOrderAttribute),u=parseFloat(s),c=!isNaN(u);if(c){var l=t(r);i=this.getNextTabOrderChild(l,n,u),!i&&o&&(i=this.getNextTabOrderChild(l,n,a(n)))}return i},u.prototype.getNextTabOrderChild=function(t,n,o){var i,a;return $(t).find("["+e.TabOrderAttribute+"]").each(function(e,t){var s=r(t);if(s>=0&&(n?s<o:s>o)){var u=void 0===i&&void 0===a,c=n?s>a:s<a;(u||c)&&(a=s,i=t)}}),i},u}();e.TabOrderFocusFinder=c,e.hasTabOrderAttribute=n,e.hasTabOrderEnabledAttribute=o,e.hasTabOrderChildAttribute=i}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t=function(){function t(e){void 0===e&&(e=!1),this.skipCyclicNavigation=e}return Object.defineProperty(t.prototype,"name",{get:function(){return"Group"},enumerable:!0,configurable:!0}),t.prototype.shouldHandleFocus=function(t,r){return!$.contains(r,e.FocusNavigationUtility.getTabbableParent(t,r))},t.prototype.findNextElementToFocus=function(r,n){var o=t.getGroupNavigationElement(r);switch(n.keyCode){case 39:case 40:if(t.groupElementSupportsArrows(o)&&!t.canHandleKeyEvents(r))return t.getFocusNextElement(!0);break;case 38:case 37:if(t.groupElementSupportsArrows(o)&&!t.canHandleKeyEvents(r))return t.getFocusNextElement(!1);break;case 9:if(!e.FocusNavigationUtility.isElementContentEditable(r))return t.getFocusNextElement(!n.shiftKey,void 0,this.skipCyclicNavigation);break;case 27:return e.FocusNavigationUtility.getTabbableParent(document.activeElement);case 13:if(o&&null!=o.getAttribute(e.TabOrderRecursiveEnabledAttribute))return e.FocusNavigationUtility.getFirstTabbableChild(document.activeElement)}},t.getFocusNextElement=function(r,n,o){if(void 0===n&&(n=null),void 0===o&&(o=!1),n=n||t.getFirstFocusableParent(document.activeElement)){var i=t.getGroupNavigationElement(n),a=void 0,s=void 0;if(i&&null!=i.getAttribute(e.TabOrderRecursiveEnabledAttribute))a=new e.TabOrderRecursiveFocusFinder(i),s=a.findNext(n,r);else{var u=e.hasTabOrderEnabledAttribute(n)||e.hasTabOrderAttribute(n);u&&(a=new e.TabOrderFocusFinder,s=a.findNext(n,r)),s&&u||(a=new e.DomOrderFocusFinder,s=a.findNext(n,r))}if(s)return s;if("Group"!==n.getAttribute(e.FocusNavModeAttribute)&&!o){var c=document.activeElement&&t.getParentGroupElement(document.activeElement);return c?a.findNext(c,r):void 0}}},t.getGroupNavigationElement=function(r){var n=r.getAttribute(e.FocusNavModeAttribute);return n&&"Group"===n?r:t.getParentGroupElement(r)},t.getFirstFocusableParent=function(t){if(!t)return null;if(e.isTabbable(t)||"Group"===t.getAttribute(e.FocusNavModeAttribute))return t;for(var r=t.parentElement||t.parentNode&&t.parentNode.nodeType===Node.ELEMENT_NODE?t.parentNode:null;r;){if(e.isTabbable(r)||"Group"===r.getAttribute(e.FocusNavModeAttribute))return r;r=r.parentElement||r.parentNode&&r.parentNode.nodeType===Node.ELEMENT_NODE?r.parentNode:null}return r},t.getParentGroupElement=function(t){return $(t).parents(e.FocusNavModeGroupMatcher).get(0)},t.canHandleKeyEvents=function(t){return e.FocusNavigationUtility.isElementContentEditable(t)||e.FocusNavigationUtility.isTextElement(t)},t.groupElementSupportsArrows=function(t){return!t||null==t.getAttribute(e.TabOrderRecursiveEnabledAttribute)||null==t.getAttribute(e.SkipArrowNavigationAttribute)},t}();e.FocusGroupNavigation=t}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t=function(){function t(){}return Object.defineProperty(t.prototype,"name",{get:function(){return"Hierarchy"},enumerable:!0,configurable:!0}),t.prototype.shouldHandleFocus=function(){return!0},t.prototype.findNextElementToFocus=function(t,r,n){switch(r.keyCode){case 9:if(e.FocusNavigationUtility.isElementContentEditable(t))return;var o=e.FocusNavigationUtility.getTabbableChildren(n),i=e.FocusNavigationUtility.getTabbableParent(t,n)===n;if(r.shiftKey){if(o.length>0&&(t!==o[0]||i))return e.FocusNavigationUtility.getPrevTabbableSibling(t,n)}else{if(o.length>0&&(t!==o[o.length-1]||i))return e.FocusNavigationUtility.getNextTabbableSibling(t,n);var a=e.FocusNavigationUtility.getTabbableDescendants(n);if(a.length>0)return void a[a.length-1].focus()}break;case 27:if(t!==n)return e.FocusNavigationUtility.getTabbableParent(t);break;case 13:return e.FocusNavigationUtility.getFirstTabbableChild(t)}},t}();e.HierarchicalNavigation=t}(jsCommon||(jsCommon={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){e.events={HighContrastModeChangedEvent:{type:4,name:"HighContrastModeChangedEvent"},SaveStartedEvent:{type:4,name:"SaveStartedEvent"},SaveEndedEvent:{type:4,name:"SaveEndedEvent"},LuciaDomainModelChangedEvent:{type:4,name:"LuciaDomainModelChangedEvent"},LuciaSessionActivationChangedEvent:{type:4,name:"LuciaSessionActivationChangedEvent"},EmulationChangedEvent:{type:4,name:"EmulationChangedEvent"},ReportContentsReplacedEvent:{type:4,name:"ReportContentsReplacedEvent"},ModelChangedEvent:{type:4,name:"ModelChangedEvent"},SchemaItemActivationChangedEvent:{type:4,name:"SchemaItemActivationChangedEvent"},SignInStatusChangedEvent:{type:4,name:"SignInStatusChangedEvent"},WindowStateChangedEvent:{type:4,name:"WindowStateChangedEvent"}}}(t=e.global||(e.global={}))}(t=e.host||(e.host={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){e.JQueryUIModule={javascript:"jquery-ui",css:["jquery-ui"]}}(t=e.modules||(e.modules={}))}(t=e.common||(e.common={}))}(powerbi||(powerbi={}));var jsCommon;!function(e){var t,r=e.StringExtensions.parseIntSubstrFast;!function(e){function t(e){for(var t,o=0,i=0,a=0,s=0,u=0,c=0,l=e.length;u<=l;u++){var d=u===l?46:e.charCodeAt(u);switch(d){case 46:case 45:if(u===c)return;var m=r(e,c,u-c);if(null==m)return;switch(s){case 0:o=m;break;case 1:i=m;break;case 2:a=m;break;default:return}if(s++,c=u+1,45===d){if(3!==s)return;if(t=e.substr(u+1),!n(t))return;u=l}break;default:if(d<48||d>57)return}}var f={major:o,minor:i,patch:a};return t&&(f.prerel=t),f}function n(e){for(var t=0,r=e.length;t<r;t++){var n=e.charCodeAt(t);if(!(65<=n&&n<=90||97<=n&&n<=122||48<=n&&n<=57||45===n||46===n))return!1}return!0}function o(e){return _.isString(e)?e:null==e.prerel?e.major+"."+e.minor+"."+e.patch:e.major+"."+e.minor+"."+e.patch+"-"+e.prerel}function i(e,t){return l(c(e),c(t))>0}function a(e,t){return l(c(e),c(t))<0}function s(e,t){return e=c(e),t=c(t),!l(c(e),c(t))}function u(e,t){return i(c(e),c(t))?e:t}function c(r){return _.isString(r)?t(r)||e.Zero:r}function l(e,t){var r=d(e.major,t.major);return r?r:(r=d(e.minor,t.minor))?r:(r=d(e.patch,t.patch),r?r:m(e.prerel,t.prerel))}function d(e,t){e=e||0,t=t||0;var r=e-t;return 0===r?0:r<0?-1:1}function m(e,t){var n=_.isEmpty(e),o=_.isEmpty(t);if(n)return o?0:1;if(o)return-1;var i=r(e,0,e.length),a=r(t,0,t.length);return null!=i?null!=a?d(i,a):-1:null!=a?1:e.localeCompare(t)}e.Zero={major:0,minor:0,patch:0},e.ZeroStr="0.0",e.LargestVersion="99.9",e.tryParse=t,e.toString=o,e.gt=i,e.lt=a,e.eq=s,e.max=u}(t=e.Version||(e.Version={}))}(jsCommon||(jsCommon={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;jsCommon.DateExtensions;!function(e){function t(e,t,n){void 0===n&&(n=!1);var o=moment().diff(e),i=moment.duration(o),a=Math.floor,s=a(i.asYears());if(s>1)return t.format("RelativeDate_YearsAgo",[s]);if(1===s)return t.get(r("RelativeDate_YearAgo",n));var u=a(i.asMonths());if(u>1)return t.format("RelativeDate_MonthsAgo",[u]);if(1===u)return t.get(r("RelativeDate_MonthAgo",n));var c=a(i.asDays());if(c>1)return t.format("RelativeDate_DaysAgo",[c]);if(1===c)return t.get(r("RelativeDate_DayAgo",n));var l=a(i.asHours());if(l>1)return t.format("RelativeDate_HoursAgo",[l]);if(1===l)return t.get(r("RelativeDate_HourAgo",n));var d=a(i.asMinutes());if(d>1)return t.format("RelativeDate_MinutesAgo",[d]);if(1===d)return t.get(r("RelativeDate_MinuteAgo",n));var m=a(i.asSeconds());return m>=30?t.format("RelativeDate_SecondsAgo",[m]):t.get("RelativeDate_Now")}function r(e,t){return t?e+"_Capitalize":e}e.getPrettyRelativeDate=t}(t=e.DateFormatter||(e.DateFormatter={}))}(t=e.utils||(e.utils={}))}(t=e.common||(e.common={}))}(powerbi||(powerbi={}));var jsCommon;!function(e){var t=function(){function t(e){this.groupElement=e}return t.prototype.findNext=function(e,t){var r=this;void 0===t&&(t=!0);var n=e===this.groupElement?-1:this.getTabIndex(e),o=e!==this.groupElement&&!isNaN(n),i=t?1/0:0;o||(n=t?-1:1/0);var a;return this.buildTabOrderMany([].slice.call(this.groupElement.children)).forEach(function(e){var o=r.getTabIndex(e.elem);isNaN(o)||(t?o>n&&o<=i:o<n&&o>=i)&&(i=o,a=e.elem)}),a},t.prototype.getTabIndex=function(t){return parseFloat(t.getAttribute(e.TabIndexAttribute))},t.prototype.buildTabOrderMany=function(t){var r=this,n=[];return t.forEach(function(t){null==t.getAttribute(e.SkipChildrenFocusAttribute)&&(n=_.concat(n,r.buildTabOrders(t)))}),n},t.prototype.buildTabOrders=function(e){var t=this.getTabIndex(e);return isNaN(t)?this.buildTabOrderMany([].slice.call(e.children)):[{tabOrder:t,elem:e}]},t}();e.TabOrderRecursiveFocusFinder=t}(jsCommon||(jsCommon={}));var jsCommon;!function(e){var t=256;e.FocusPriorityAttribute="focus-priority",e.KeyboardShortcutsAttribute="keyboard-shortcuts";var r=function(){function r(){this.shortcuts=[],this.scopedShortcuts=[]}return r.prototype.add=function(e){var t=this.getKeyCode(e.keycode,e.shift,e.alt,e.ctrl),r=e.scoped?this.scopedShortcuts:this.shortcuts;r[t]&&!_.find(r[t],function(t){return $(t.element).is(e.element)})?r[t].push(e):_.isEmpty(this.shortcuts[t])&&(r[t]=[e])},r.prototype.remove=function(e){var t=this.getKeyCode(e.keycode,e.shift,e.alt,e.ctrl),r=e.scoped?this.scopedShortcuts:this.shortcuts;_.remove(r[t],function(t){return $(t.element).is(e.element)})},r.prototype.handle=function(r){if(r.keyCode>t)return!1;var n=this.getKeyCode(r.keyCode,r.shiftKey,r.altKey,e.BrowserUtils.isCtrlOrMeta(r)),o=this.findScopedShortcut(n);if(!o){var i=this.filterGroups(this.shortcuts[n]);if(_.isEmpty(i))return!1;o=this.getNextShortcutElementToFocus(i)}return!!o&&(this.focusOnGroup(r.keyCode,r.shiftKey,r.altKey,e.BrowserUtils.isCtrlOrMeta(r),o),!0)},r.prototype.handleByPriority=function(e,t,r,n,o){this.focusOnGroup(e,t,r,n,this.getNextShortcutElementToFocus(this.filterGroups(this.shortcuts[this.getKeyCode(e,t,r,n)]),o))},r.prototype.setFocusChangeHandler=function(e){this.onFocusGroupChangedHandler=e},r.prototype.focusOnGroup=function(t,n,o,i,a){this.onFocusGroupChangedHandler&&this.onFocusGroupChangedHandler(t,n,o,i,r.getFocusPriority(a)),e.FocusManager.focus(e.FocusGroupNavigation.getFocusNextElement(!0,a))},r.prototype.getKeyCode=function(e,t,r,n){var o=e;return t&&(o|=512),n&&(o|=1024),r&&(o|=2048),o},r.prototype.filterGroups=function(t){return _.filter(t,function(t){return e.FocusNavigationUtility.isElementVisible(t.element)&&!!e.FocusGroupNavigation.getFocusNextElement(!0,t.element)})},r.getFocusPriority=function(t,r){if(void 0===r&&(r=!0),t){var n=t.getAttribute(e.FocusPriorityAttribute);if(null!=n)return parseInt(n,10);if(null!=t.parentElement&&r)return this.getFocusPriority(t.parentElement)}},r.prototype.findScopedShortcut=function(e){var t=document.activeElement,r=this.scopedShortcuts[e],n=this.filterGroups(r);if(!_.isEmpty(n)&&t)for(var o=0,i=n;o<i.length;o++){var a=i[o];if(a&&($(t).is(a.element)||$.contains(t,a.element)))return a.element}},r.prototype.findCurrentFocusedShortcutElement=function(t){if(document.activeElement)for(var r=document.activeElement;r;){var n=r.getAttribute(e.KeyboardShortcutsAttribute);if(n===t)return r;r=r.parentElement}},r.prototype.getNextShortcutElementToFocus=function(e,t){e=_.sortBy(e,function(e){return e.focusPriority});var r=e[0];if(document.activeElement&&e.length>1)for(var n=null==t?this.findCurrentFocusedShortcutElement(r.shortcutString):null,o=0;o<e.length-1;o++){var i=e[o];if(null!=t&&t>(i.focusPriority||-1)||n&&$(n).is(i.element)){r=e[(o+1)%e.length];break}}return r.element},r}();e.ShortcutContainer=r}(jsCommon||(jsCommon={}));var powerbi;!function(e){var t;!function(e){e[e.Verbose=0]="Verbose",e[e.CustomerAction=1]="CustomerAction",e[e.CriticalError=2]="CriticalError",e[e.Trace=3]="Trace",e[e.SnapShotEmbedUserAction=4]="SnapShotEmbedUserAction"}(t=e.TelemetryCategory||(e.TelemetryCategory={}));var r;!function(e){e[e.LocalyticsDeprecated=1]="LocalyticsDeprecated",e[e.AppInsightDeprecated=2]="AppInsightDeprecated",e[e.AppInsight=4]="AppInsight",e[e.Etw=8]="Etw",e[e.Mobile=16]="Mobile",e[e.WinJs=32]="WinJs",e[e.Designer=64]="Designer"}(r=e.LoggerServiceType||(e.LoggerServiceType={}));var n=function(){function t(t,r){var n=this;this.end=r,this.event=t,this.promise=new e.Promise(function(e,t){n.onResolve=e,n.onReject=t}),this.isEnded=!1}return t.prototype.resolve=function(){this.isEnded||(this.isEnded=!0,this.end&&this.end(this.event),this.onResolve(this.event))},t.prototype.reject=function(e){if(!this.isEnded){this.isEnded=!0;var t=this.event;t.info.isError=!0,t.info.errorSource=e&&e.errorSource?e.errorSource:"PowerBI",t.info.errorCode=e?e.errorCode:"UnknownError",t.info.errorMessage=e?e.errorMessage:void 0,t.info.asErrorCode=e&&e.asErrorCode,this.end&&this.end(t),this.onReject(t)}},t}();e.DeferredTelemetryEvent=n}(powerbi||(powerbi={}));